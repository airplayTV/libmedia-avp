!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.AVPlayer=e():t.AVPlayer=e()}(self,(()=>(()=>{var t,e,r={92246:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(16030),a=r(4624),n=r(9705);class o{constructor(t){(0,i.A)(this,"resampler",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"inputParameters",void 0),(0,i.A)(this,"outputParameters",void 0),this.options=t,this.resampler=new s.A(this.options.resource)}async open(t,e){this.inputParameters=t,this.outputParameters=e,await this.resampler.run(),this.resampler.invoke("resample_set_input_parameters",t.sampleRate,t.channels,t.format,t.layout||0),this.resampler.invoke("resample_set_output_parameters",e.sampleRate,e.channels,e.format,e.layout||0);let r=this.resampler.invoke("resample_init");return r<0?(a.z3(`open resampler failed, ret: ${r}`,"src\\audioresample\\Resampler.ts",85),n.nr):0}resample(t,e,r){return this.resampler.invoke("resample_process",t,e,r)}getOutputSampleCount(t){return this.resampler.invoke("resample_nb_sample",t)}close(){this.resampler.invoke("resample_destroy"),this.resampler.destroy()}getInputPCMParameters(){return this.inputParameters}getOutputPCMParameters(){return this.outputParameters}}},70089:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(16030);class a{constructor(t){(0,i.A)(this,"processor",void 0),(0,i.A)(this,"options",void 0),this.options=t,this.processor=new s.A(this.options.resource)}async open(t){await this.processor.run(),this.processor.invoke("stretchpitch_init"),this.processor.invoke("stretchpitch_set_channels",t.channels),this.processor.invoke("stretchpitch_set_samplerate",t.sampleRate)}setRate(t){this.processor.invoke("stretchpitch_set_rate",t)}setRateChange(t){this.processor.invoke("stretchpitch_set_rate_change",t)}setTempo(t){this.processor.invoke("stretchpitch_set_tempo",t)}setTempoChange(t){this.processor.invoke("stretchpitch_set_tempo_change",t)}setPitch(t){this.processor.invoke("stretchpitch_set_pitch",t)}setPitchOctaves(t){this.processor.invoke("stretchpitch_set_pitch_octaves",t)}setPitchSemiTones(t){this.processor.invoke("stretchpitch_set_pitch_semi_tones",t)}sendSamples(t,e){this.processor.invoke("stretchpitch_send_samples",t,e)}receiveSamples(t,e){return this.processor.invoke("stretchpitch_receive_samples",t,e)}flush(){this.processor.invoke("stretchpitch_flush")}clear(){this.processor.invoke("stretchpitch_clear")}getUnprocessedSamplesCount(){return this.processor.invoke("stretchpitch_get_unprocessed_samples_num")}getInputOutputSamplesRatio(){return this.processor.invoke("stretchpitch_get_input_output_sample_ratio")}getLatency(){return this.processor.invoke("get_latency")}close(){this.processor.invoke("stretchpitch_destroy"),this.processor.destroy()}}},53616:(t,e,r)=>{"use strict";r.d(e,{A:()=>l});var i=r(134),s=r(63939),a=r(9705),n=r(26235),o=r(59996),c=r(62624),d=r(9787),h=r(43950);class l{constructor(t){(0,i.A)(this,"options",void 0),(0,i.A)(this,"frame",void 0),(0,i.A)(this,"decoder",void 0),this.options=t}getAVFrame(){return this.frame?this.frame:this.frame={pts:BigInt(0),duration:BigInt(0),rects:[],timeBase:{den:1,num:1}}}outputAVFrame(){this.frame&&(this.options.onReceiveSubtitle&&this.options.onReceiveSubtitle(this.frame),this.frame=void 0)}receiveAVFrame(){return this.decoder.receiveAVFrame(this.getAVFrame())}async open(t){switch(s.f[15](t+4)){case 94226:this.decoder=new n.A;break;case 94232:this.decoder=new c.A;break;case 94210:case 94225:this.decoder=new h.A;break;case 94213:this.decoder=new d.A;break;case 94212:case 94230:this.decoder=new o.A;break;default:return a.r8}return 0}decode(t){let e=this.decoder.sendAVPacket(t);if(e)return e;for(;;){if(e=this.receiveAVFrame(),1!==e){if(e<0)return e;break}this.outputAVFrame()}return 0}async flush(){for(this.decoder.flush();;){if(this.receiveAVFrame()<1)return;this.outputAVFrame()}}close(){this.frame&&(this.frame=void 0)}}},59996:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(134),s=r(63939),a=r(81023),n=r(71517),o=r(50011);class c extends a.A{constructor(){super(),(0,i.A)(this,"queue",void 0),this.queue=[]}sendAVPacket(t){return this.queue.push({data:(0,n.iI)(t).slice(),pts:s.f[17](t+8),duration:s.f[17](t+48),timeBase:{den:s.f[15](t+76),num:s.f[15](t+72)}}),0}receiveAVFrame(t){if(this.queue.length){const e=this.queue.shift();t.pts=e.pts,t.duration=e.duration,t.timeBase.den=e.timeBase.den,t.timeBase.num=e.timeBase.num;let r=o.decode(e.data);return/^\w+?\s*:/.test(r)||(r="Dialogue: "+r),t.rects.push({type:3,text:r,flags:0}),1}return 0}flush(){return 0}}},81023:(t,e,r)=>{"use strict";r.d(e,{A:()=>i});class i{}},43950:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(134),s=r(63939),a=r(81023),n=r(71517),o=r(50011);class c extends a.A{constructor(){super(),(0,i.A)(this,"queue",void 0),this.queue=[]}sendAVPacket(t){return this.queue.push({data:(0,n.iI)(t).slice(),pts:s.f[17](t+8),duration:s.f[17](t+48),timeBase:{den:s.f[15](t+76),num:s.f[15](t+72)}}),0}receiveAVFrame(t){if(this.queue.length){const e=this.queue.shift();return t.pts=e.pts,t.duration=e.duration,t.timeBase.den=e.timeBase.den,t.timeBase.num=e.timeBase.num,t.rects.push({type:1,text:o.decode(e.data),flags:0}),1}return 0}flush(){return 0}}},9787:(t,e,r)=>{"use strict";r.d(e,{A:()=>d});var i=r(134),s=r(63939),a=r(81023),n=r(71517),o=r(50011),c=r(4624);class d extends a.A{constructor(){super(),(0,i.A)(this,"queue",void 0),this.queue=[]}sendAVPacket(t){const e=(0,n.iI)(t).slice();if(e.length<2)return 0;const r=e[0]<<8|e[1];if(r+2>e.length)return c.R8(`invalid timed text data, need ${r+2} but got ${e.length}, ignore it`,"src\\avcodec\\subtitle\\decoder\\TimedTextDecoder.ts",59),0;const i=o.decode(e.subarray(2,2+r));return this.queue.push({text:i,pts:s.f[17](t+8),duration:s.f[17](t+48),timeBase:{den:s.f[15](t+76),num:s.f[15](t+72)}}),0}receiveAVFrame(t){if(this.queue.length){const e=this.queue.shift();return t.pts=e.pts,t.duration=e.duration,t.timeBase.den=e.timeBase.den,t.timeBase.num=e.timeBase.num,t.rects.push({type:1,text:e.text,flags:0}),1}return 0}flush(){return 0}}},62624:(t,e,r)=>{"use strict";r.d(e,{A:()=>h});var i=r(134),s=r(63939),a=r(81023),n=r(50011),o=r(71517),c=r(77231),d=r(74762);class h extends a.A{constructor(){super(),(0,i.A)(this,"queue",void 0),this.queue=[]}sendAVPacket(t){let e=n.decode((0,o.iI)(t));return e?(/<tt/.test(e.trim())?this.queue=this.queue.concat(d.q(e).queue):this.queue.push({pts:s.f[17](t+8),duration:s.f[17](t+48),context:e,region:"Default"}),0):0}receiveAVFrame(t){if(this.queue.length){const e=this.queue.shift();return t.pts=e.pts,t.duration=e.duration,t.timeBase.den=c.qs,t.timeBase.num=1,t.rects.push({type:2,text:e.context,flags:0}),1}return 0}flush(){return 0}}},26235:(t,e,r)=>{"use strict";r.d(e,{A:()=>h});var i=r(134),s=r(63939),a=r(81023),n=r(50011),o=r(71517),c=r(54825),d=r(77231);class h extends a.A{constructor(){super(),(0,i.A)(this,"queue",void 0),this.queue=[]}findTimelineTag(t){const e=t.indexOf("<");if(e>=0){const r=t.indexOf(">",e);if(r>e&&/^(\d{2,}:)?\d{2}:\d{2}\.\d{1,3}$/.test(t.substring(e+1,r)))return{start:e,end:r}}return{start:-1,end:-1}}sendAVPacket(t){let e=n.decode((0,o.iI)(t)),r=s.f[17](t+8);const i=r+s.f[17](t+48),a=[];for(;;){const{start:i,end:n}=this.findTimelineTag(e);if(i<0)break;const o=(0,c.j)(e.substring(i+1,n));a.push(e.substring(0,i)),this.queue.push({context:a.join(""),pts:r,duration:o-r,timeBase:{den:s.f[15](t+76),num:s.f[15](t+72)}}),r=o,e=e.substring(n+1)}return a.push(e),this.queue.push({context:a.join(""),pts:r,duration:i-r,timeBase:{den:s.f[15](t+76),num:s.f[15](t+72)}}),0}receiveAVFrame(t){if(this.queue.length){const e=this.queue.shift();return t.pts=e.pts,t.duration=e.duration,t.timeBase.den=d.qs,t.timeBase.num=1,t.rects.push({type:2,text:e.context,flags:0}),1}return 0}flush(){return 0}}},75742:(t,e,r)=>{"use strict";r.d(e,{A:()=>g});var i=r(134),s=r(63939),a=r(50932),n=r(11473),o=r(16030),c=r(56024),d=r(4624),h=r(95797),l=(r(56490),r(95335)),u=r(73749),f=r(67672),p=r(37837),m=r(9705);class g{constructor(t){(0,i.A)(this,"options",void 0),(0,i.A)(this,"decoder",void 0),(0,i.A)(this,"frame",0),(0,i.A)(this,"decoderOptions",0),(0,i.A)(this,"timeBase",void 0),this.options=t,this.decoder=new o.A(t.resource)}getAVFrame(){return this.frame?this.frame:this.frame=this.options.avframePool?this.options.avframePool.alloc():(0,c.FP)()}outputAVFrame(){this.frame&&(this.options.onReceiveAVFrame?(a.M[15](this.frame+124,this.timeBase.den),a.M[15](this.frame+120,this.timeBase.num),this.options.onReceiveAVFrame(this.frame)):this.options.avframePool?this.options.avframePool.release(this.frame):(0,c.xj)(this.frame),this.frame=0)}receiveAVFrame(){return this.decoder.invoke("decoder_receive",this.getAVFrame())}async open(t,e={}){await this.decoder.run();const r=n.s_.malloc(4);a.M[20](r,0),l.HP(e).length&&(this.decoderOptions&&(u.AO(this.decoderOptions),n.s_.free(this.decoderOptions),this.decoderOptions=0),this.decoderOptions=(0,p.Gy)(8),l.__(e,((t,e)=>{(f.Yj(t)||f.Yj(e))&&u.a5(this.decoderOptions,e,t)})),a.M[20](r,this.decoderOptions));let i=0;return h.A.jspi?i=await this.decoder.invokeAsync("decoder_open",t,0,1,r):(i=this.decoder.invoke("decoder_open",t,0,1,r),await this.decoder.childThreadsReady()),this.decoderOptions=s.f[20](r),n.s_.free(r),i<0?(d.z3(`open audio decoder failed, ret: ${i}`,"src\\avcodec\\wasmcodec\\AudioDecoder.ts",128),m.r8):(this.timeBase=void 0,0)}decode(t){this.timeBase||(this.timeBase={den:s.f[15](t+76),num:s.f[15](t+72)});let e=this.decoder.invoke("decoder_decode",t);if(e)return e;for(;;){if(e=this.receiveAVFrame(),1!==e){if(e<0)return e;break}this.outputAVFrame()}return 0}async flush(){for(this.decoder.invoke("decoder_flush");;){const t=this.receiveAVFrame();if(t<1)return t;this.outputAVFrame()}return 0}close(){this.decoder.invoke("decoder_close"),this.decoder.destroy(),this.frame&&(this.options.avframePool?this.options.avframePool.release(this.frame):(0,c.xj)(this.frame),this.frame=0),this.decoderOptions&&(u.AO(this.decoderOptions),n.s_.free(this.decoderOptions),this.decoderOptions=0)}}},40417:(t,e,r)=>{"use strict";r.d(e,{A:()=>g});var i=r(134),s=r(63939),a=r(50932),n=r(11473),o=r(16030),c=r(56024),d=r(4624),h=r(95797),l=(r(56490),r(95335)),u=r(73749),f=r(67672),p=r(37837),m=r(9705);class g{constructor(t){(0,i.A)(this,"options",void 0),(0,i.A)(this,"decoder",void 0),(0,i.A)(this,"frame",0),(0,i.A)(this,"parameters",0),(0,i.A)(this,"decoderOptions",0),(0,i.A)(this,"timeBase",void 0),(0,i.A)(this,"dtsQueue",[]),this.options=t,this.decoder=new o.A(this.options.resource)}getAVFrame(){return this.frame?this.frame:this.frame=this.options.avframePool?this.options.avframePool.alloc():(0,c.FP)()}outputAVFrame(){this.frame&&(2&s.f[15](this.parameters+160)&&this.dtsQueue.length&&a.M[17](this.frame+104,this.dtsQueue.shift()),this.options.onReceiveAVFrame?(a.M[15](this.frame+124,this.timeBase.den),a.M[15](this.frame+120,this.timeBase.num),this.options.onReceiveAVFrame(this.frame)):this.options.avframePool?this.options.avframePool.release(this.frame):(0,c.xj)(this.frame),this.frame=0)}receiveAVFrame(){return this.decoder.invoke("decoder_receive",this.getAVFrame())}async open(t,e=1,r={}){await this.decoder.run(void 0,e);let i=0;const o=n.s_.malloc(4);return a.M[20](o,0),l.HP(r).length&&(this.decoderOptions&&(u.AO(this.decoderOptions),n.s_.free(this.decoderOptions),this.decoderOptions=0),this.decoderOptions=(0,p.Gy)(8),l.__(r,((t,e)=>{(f.Yj(t)||f.Yj(e))&&u.a5(this.decoderOptions,e,t)})),a.M[20](o,this.decoderOptions)),h.A.jspi?i=await this.decoder.invokeAsync("decoder_open",t,0,e,o):(i=this.decoder.invoke("decoder_open",t,0,e,o),await this.decoder.childThreadsReady()),this.decoderOptions=s.f[20](o),n.s_.free(o),i<0?(d.z3(`open video decoder failed, ret: ${i}`,"src\\avcodec\\wasmcodec\\VideoDecoder.ts",171),m.r8):(this.parameters=t,this.timeBase=void 0,this.dtsQueue.length=0,0)}decode(t){this.timeBase||(this.timeBase={den:s.f[15](t+76),num:s.f[15](t+72)});let e=this.decoder.invoke("decoder_decode",t);if(e)return e;for(2&s.f[15](this.parameters+160)&&this.dtsQueue.push(s.f[17](t+16));;){if(e=this.receiveAVFrame(),1!==e){if(e<0)return e;break}this.outputAVFrame()}return 0}async flush(){for(this.decoder.invoke("decoder_flush");;){const t=this.receiveAVFrame();if(t<1)return t;this.outputAVFrame()}return 0}close(){this.decoder.invoke("decoder_close"),this.decoder.destroy(),this.frame&&(this.options.avframePool?this.options.avframePool.release(this.frame):(0,c.xj)(this.frame),this.frame=0),this.parameters=0,this.decoderOptions&&(u.AO(this.decoderOptions),n.s_.free(this.decoderOptions),this.decoderOptions=0)}setSkipFrameDiscard(t){this.decoder.invoke("decoder_discard",t)}getChildThreadCount(){return this.decoder?this.decoder.getChildThreadCount():0}}},77104:(t,e,r)=>{"use strict";r.d(e,{A:()=>f});var i=r(134),s=r(63939),a=r(79756),n=r(14686),o=r(71517),c=r(22898),d=r(4624),h=r(9705),l=r(72739);const u="src\\avcodec\\webcodec\\AudioDecoder.ts";class f{constructor(t){(0,i.A)(this,"options",void 0),(0,i.A)(this,"decoder",void 0),(0,i.A)(this,"parameters",0),(0,i.A)(this,"extradata",void 0),(0,i.A)(this,"currentError",null),this.options=t}output(t){this.options.onReceiveAudioData?this.options.onReceiveAudioData(t):t.close()}error(t){this.currentError=t,this.options.onError(t)}async open(t){this.currentError=null,this.parameters=t,this.extradata=void 0,0!==s.f[20](t+12)&&(this.extradata=(0,n.s3)(s.f[20](t+12),s.f[15](t+16)).slice());const e={codec:(0,a.A)(this.parameters),sampleRate:s.f[15](t+136),numberOfChannels:s.f[15](t+116),description:this.extradata};e.description||delete e.description;try{if(!(await AudioDecoder.isConfigSupported(e)).supported)return d.z3("not support",u,94),h.nr}catch(t){return d.z3(`${t}`,u,99),h.r8}return this.decoder&&"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=new AudioDecoder({output:this.output.bind(this),error:this.error.bind(this)}),this.decoder.reset(),this.decoder.configure(e),this.currentError?(d.z3(`open audio decoder error, ${this.currentError}`,u,116),h.r8):0}changeExtraData(t){return l.FB(t,this.extradata)?0:(this.currentError=null,this.extradata=t.slice(),this.decoder.reset(),this.decoder.configure({codec:(0,a.A)(this.parameters),sampleRate:s.f[15](this.parameters+136),numberOfChannels:s.f[15](this.parameters+116),description:this.extradata}),this.currentError?(d.z3(`change extra data error, ${this.currentError}`,u,140),h.r8):0)}decode(t){if(this.currentError)return d.z3(`decode error, ${this.currentError}`,u,149),h.LR;const e=(0,o.rU)(t,1);if(0!==e){let t=this.changeExtraData((0,n.s3)(s.f[20](e),s.f[25](e+4)));if(t)return t}const r=(0,c.A)(t);try{this.decoder.decode(r)}catch(t){return d.z3(`decode error, ${t}`,u,168),h.LR}return 0}async flush(){if(this.currentError)return d.z3(`flush error, ${this.currentError}`,u,177),h.LR;try{return await this.decoder.flush(),0}catch(t){return d.z3(`flush error, ${t}`,u,185),h.LR}}close(){"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=void 0}getQueueLength(){var t,e;return null!==(t=null===(e=this.decoder)||void 0===e?void 0:e.decodeQueueSize)&&void 0!==t?t:0}static async isSupported(t){let e;0!==s.f[20](t+12)&&(e=(0,n.s3)(s.f[20](t+12),s.f[15](t+16)).slice());const r={codec:(0,a.A)(t),sampleRate:s.f[15](t+136),numberOfChannels:s.f[15](t+116),description:e};r.description||delete r.description;try{return(await AudioDecoder.isConfigSupported(r)).supported}catch(t){return!1}}}},71039:(t,e,r)=>{"use strict";r.d(e,{A:()=>w});var i=r(134),s=r(63939),a=(r(9599),r(86834)),n=r(28875),o=r(14686),c=r(71517),d=r(39365),h=r(28917),l=r(4624),u=r(44690),f=r(62815),p=r(67659),m=r(59166),g=r(9705),v=r(72739),A=r(77231),y=r(44328);const b="src\\avcodec\\webcodec\\VideoDecoder.ts";class w{constructor(t){(0,i.A)(this,"decoder",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"parameters",0),(0,i.A)(this,"extradata",void 0),(0,i.A)(this,"currentError",null),(0,i.A)(this,"inputQueue",void 0),(0,i.A)(this,"outputQueue",void 0),(0,i.A)(this,"dtsQueue",void 0),(0,i.A)(this,"sort",void 0),(0,i.A)(this,"keyframeRequire",!1),(0,i.A)(this,"extradataRequire",!1),this.options=t,this.inputQueue=[],this.outputQueue=[],this.dtsQueue=[],this.sort=!!(a.A.safari&&!a.A.checkVersion(a.A.version,"17.4",!0)||u.A.ios&&!a.A.checkVersion(u.A.version,"17.4",!0))}async output(t){if(2&s.f[15](this.parameters+160)&&this.dtsQueue.length){const e=t;t=new VideoFrame(e,{timestamp:this.dtsQueue.shift()}),e.close()}if(this.sort){let e=0;for(;e<this.outputQueue.length;e++)if(this.outputQueue[e].timestamp>t.timestamp){this.outputQueue.splice(e,0,t);break}for(e===this.outputQueue.length&&this.outputQueue.push(t);this.outputQueue.length>2&&this.outputQueue[0].timestamp===this.inputQueue[0];){const t=this.outputQueue.shift();this.options.onReceiveVideoFrame?this.options.onReceiveVideoFrame(t):t.close(),this.inputQueue.shift()}}else this.options.onReceiveVideoFrame?this.options.onReceiveVideoFrame(t):t.close()}error(t){this.currentError=t,this.options.onError(t)}changeExtraData(t){var e;return v.FB(t,this.extradata)?0:(this.currentError=null,this.extradata=t.slice(),this.decoder.reset(),this.decoder.configure({codec:(0,n.A)(this.parameters,t),description:this.extradata,hardwareAcceleration:(0,d.C)(null===(e=this.options.enableHardwareAcceleration)||void 0===e||e)}),this.currentError?(l.z3(`change extra data error, ${this.currentError}`,b,152),g.r8):(this.keyframeRequire=!0,0))}async open(t){var e;this.currentError=null,this.extradata=void 0,0!==s.f[20](t+12)&&(this.extradata=(0,o.s3)(s.f[20](t+12),s.f[15](t+16)).slice()),this.parameters=t;const r={codec:(0,n.A)(t),codedWidth:s.f[15](t+56),codedHeight:s.f[15](t+60),description:1&s.f[15](t+160)?void 0:this.extradata,hardwareAcceleration:(0,d.C)(null===(e=this.options.enableHardwareAcceleration)||void 0===e||e)};r.description||delete r.description;try{if(!(await VideoDecoder.isConfigSupported(r)).supported)return l.z3("not support",b,185),g.nr}catch(t){return l.z3(`${t}`,b,190),g.r8}return this.decoder&&"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=new VideoDecoder({output:this.output.bind(this),error:this.error.bind(this)}),this.decoder.reset(),this.decoder.configure(r),this.currentError?(l.z3(`open video decoder error, ${this.currentError}`,b,207),g.r8):(this.keyframeRequire=!0,1&s.f[15](t+160)&&(this.extradataRequire=!0),2&s.f[15](this.parameters+160)&&(this.sort=!1),this.inputQueue.length=0,this.outputQueue.length=0,this.dtsQueue.length=0,0)}decode(t){if(this.currentError)return l.z3(`decode error, ${this.currentError}`,b,229),g.LR;const e=(0,c.rU)(t,1);if(0!==e){let t=this.changeExtraData((0,o.s3)(s.f[20](e),s.f[25](e+4)));if(t)return t}const r=1&s.f[15](t+36);if(this.keyframeRequire){if(!r)return 0;if(1&s.f[15](this.parameters+160)&&this.extradata&&this.extradataRequire){if(27===s.f[15](this.parameters+4)){if(!f.sL((0,c.iI)(t))){const e=f.kM((0,c.iI)(t),this.extradata);e&&(0,c.NX)(t,e.bufferPointer,e.length)}}else if(173===s.f[15](this.parameters+4)){if(!p.sL((0,c.iI)(t))){const e=p.kM((0,c.iI)(t),this.extradata);e&&(0,c.NX)(t,e.bufferPointer,e.length)}}else if(196===s.f[15](this.parameters+4)&&!m.sL((0,c.iI)(t))){const e=m.kM((0,c.iI)(t),this.extradata);e&&(0,c.NX)(t,e.bufferPointer,e.length)}this.extradataRequire=!1}}const i=(0,h.A)(t),a=i.timestamp;if(this.sort){let t=0;for(;t<this.inputQueue.length;t++)if(this.inputQueue[t]>a){this.inputQueue.splice(t,0,a);break}t===this.inputQueue.length&&this.inputQueue.push(a)}try{this.decoder.decode(i),2&s.f[15](this.parameters+160)&&this.dtsQueue.push(Number((0,y.Mr)(s.f[17](t+16),t+72,A.KR)))}catch(t){return l.z3(`decode error, ${t}`,b,304),g.LR}return r&&(this.keyframeRequire=!1),0}async flush(){if(this.currentError)return l.z3(`flush error, ${this.currentError}`,b,317),g.LR;try{await this.decoder.flush()}catch(t){return l.z3(`flush error, ${t}`,b,324),g.LR}if(this.sort)for(;this.outputQueue.length;){const t=this.outputQueue.shift();this.options.onReceiveVideoFrame?this.options.onReceiveVideoFrame(t):t.close()}return this.keyframeRequire=!0,0}close(){var t;this.decoder&&"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=void 0,this.currentError=null,null!==(t=this.outputQueue)&&void 0!==t&&t.length&&this.outputQueue.forEach((t=>{t.close()})),this.inputQueue.length=0,this.outputQueue.length=0}getQueueLength(){var t,e;return null!==(t=null===(e=this.decoder)||void 0===e?void 0:e.decodeQueueSize)&&void 0!==t?t:0}setSkipFrameDiscard(t){}static async isSupported(t,e){let r;0!==s.f[20](t+12)&&(r=(0,o.s3)(s.f[20](t+12),s.f[15](t+16)).slice());const i={codec:(0,n.A)(t),codedWidth:s.f[15](t+56),codedHeight:s.f[15](t+60),description:1&s.f[15](t+160)?void 0:r,hardwareAcceleration:(0,d.C)(null==e||e)};i.description||delete i.description;try{return(await VideoDecoder.isConfigSupported(i)).supported}catch(t){return!1}}}},44315:(t,e,r)=>{"use strict";r.d(e,{Xv:()=>p,fG:()=>m,oD:()=>f});var i=r(134),s=r(63939),a=r(50932),n=r(68960),o=r(71517),c=r(7417),d=r(73783);const h=c.z1(4,4),l=c.z1(4,4);class u{constructor(){(0,i.A)(this,"packetBuffer",void 0),this.packetBuffer=[]}}class f{constructor(){(0,i.A)(this,"metadataHeaderPadding",-1),(0,i.A)(this,"metadata",void 0),(0,i.A)(this,"streams",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"chapters",void 0),(0,i.A)(this,"privateData",void 0),(0,i.A)(this,"privateData2",void 0),(0,i.A)(this,"iformat",void 0),(0,i.A)(this,"oformat",void 0),(0,i.A)(this,"ioReader",void 0),(0,i.A)(this,"ioWriter",void 0),(0,i.A)(this,"errorFlag",void 0),(0,i.A)(this,"interval",void 0),(0,i.A)(this,"streamIndex",void 0),(0,i.A)(this,"getDecoderResource",null),this.streams=[],this.errorFlag=0,this.streamIndex=0,this.interval=new u,this.options={},this.privateData={},this.metadata={},this.chapters=[]}get format(){return this.iformat?this.iformat.type:this.oformat?this.oformat.type:-1}getStreamById(t){return this.streams.find((e=>e.id===t))}getStreamByIndex(t){return this.streams.find((e=>e.index===t))}getStreamByMediaType(t){return this.streams.find((e=>{var r;return(null===(r=e.codecpar)||void 0===r?void 0:r.codecType)===t}))}createStream(){const t=new n.A;return t.index=this.streamIndex++,(0,d.s2)(l),t.id=s.f[15](h),a.M[15](h,t.id+1),(0,d.Tl)(l),this.removeStreamByIndex(t.index),this.streams.push(t),t}addStream(t){this.removeStreamByIndex(t.index),this.streams.push(t)}removeStream(t){this.removeStreamByIndex(t.index)}removeStreamById(t){const e=this.streams.findIndex((e=>e.id===t));if(e>-1){const t=this.streams.splice(e,1);t[0]&&t[0].destroy()}}removeStreamByIndex(t){const e=this.streams.findIndex((e=>e.index===t));if(e>-1){const t=this.streams.splice(e,1);t[0]&&t[0].destroy()}}async destroy(){this.oformat&&this.oformat.destroy(this),this.iformat&&await this.iformat.destroy(this),this.interval.packetBuffer.length&&this.interval.packetBuffer.forEach((t=>{(0,o.Qe)(t)})),this.streams.forEach((t=>{t.destroy()})),this.streams=[],this.interval=null,this.ioReader=this.ioWriter=null,this.oformat=this.iformat=null}}function p(){return new f}function m(){return new f}},64436:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(63939),a=(r(77162),r(37837)),n=r(71766);class o{constructor(){(0,i.A)(this,"inCodecpar",void 0),(0,i.A)(this,"inTimeBase",void 0),(0,i.A)(this,"outCodecpar",void 0)}init(t,e){return this.inCodecpar=(0,a.Gy)(168),(0,n.Yi)(this.inCodecpar,t),this.inTimeBase={den:s.f[15](e+4),num:s.f[15](e)},0}destroy(){this.inCodecpar&&((0,n.dn)(this.inCodecpar),this.inCodecpar=0)}}},26173:(t,e,r)=>{"use strict";r.d(e,{A:()=>m});var i=r(134),s=r(63939),a=r(50932),n=r(64436),o=r(71517),c=r(62815),d=r(67659),h=r(59166),l=r(14686),u=r(9705),f=r(37837),p=r(4624);class m extends n.A{constructor(t=!1){super(),(0,i.A)(this,"cache",void 0),(0,i.A)(this,"cached",void 0),(0,i.A)(this,"reverseSps",void 0),this.reverseSps=t}init(t,e){return super.init(t,e),this.cache=(0,o._5)(),this.cached=!1,0}destroy(){super.destroy(),(0,o.Qe)(this.cache),this.cache=0}sendAVPacket(t){if(64&s.f[15](t+36)){let e;(0,o.zu)(this.cache,t);const r=(0,l.JW)(s.f[20](t+24),s.f[15](t+28));if(27===s.f[15](this.inCodecpar+4)?e=c.oT(r,this.reverseSps):173===s.f[15](this.inCodecpar+4)?e=d.oT(r,this.reverseSps):196===s.f[15](this.inCodecpar+4)?e=h.oT(r,this.reverseSps):p.h2(`not support for codecId: ${s.f[15](this.inCodecpar+4)}`,"src\\avformat\\bsf\\h2645\\Annexb2AvccFilter.ts",96),a.M[15](this.cache+36,-65&s.f[15](this.cache+36)),(0,o.NX)(this.cache,e.bufferPointer,e.length),e.key&&a.M[15](this.cache+36,1|s.f[15](this.cache+36)),e.extradata){const t=(0,f.sY)(e.extradata.length);(0,l.lW)(t,e.extradata.length,e.extradata),(0,o.Ow)(this.cache,1,t,e.extradata.length)}}else(0,o.rN)(this.cache,t);return this.cached=!0,0}receiveAVPacket(t){return this.cached?((0,o.Up)(t),(0,o.rN)(t,this.cache),this.cached=!1,0):u.LR}reset(){return 0}}},16160:(t,e,r)=>{"use strict";r.d(e,{V:()=>s,v:()=>i});const i=256e3,s=BigInt(5e3)},75:(t,e,r)=>{"use strict";r.d(e,{Cj:()=>R,Ib:()=>M,ho:()=>_,jF:()=>D});var i=r(61499),s=r(63939),a=r(50932),n=r(36981),o=r(29170),c=r(9599),d=r(95335),h=r(72739),l=r(77231),u=r(31425),f=r(44328),p=r(71517),m=r(16160),g=r(9705),v=r(4624),A=r(40417),y=r(75742),b=r(56024),w=r(14686),k=r(31633),x=r(55680),I=r(89478);const T="src\\avformat\\demux.ts",P=16,S={fastOpen:!1,maxAnalyzeDuration:15e3};async function _(t,e={}){const r=d.X$({},S,e);return t.ioReader||v.h2("need IOReader",T,86),t.iformat||v.h2("need iformat",T,89),2===t.iformat.type&&(r.maxAnalyzeDuration=Math.max(r.maxAnalyzeDuration,2e3)),t.iformat.init(t),t.options=r,t.iformat.readHeader(t)}async function M(t){const e={},r={},g={},v={},w={},T={},S={},_=t.iformat.getAnalyzeStreamsCount();let M=0;const C=[];let B=0;function D(){if(!t.getDecoderResource)return!0;for(let e=0;e<t.streams.length;e++)if(T[t.streams[e].index]&&!S[t.streams[e].index])return!1;return!0}function U(t,e){let i=r[t.index];const n=g[t.index];let o=t.codecpar.videoDelay;if(null!=n&&n.length&&(o=Math.min(Math.max((0,x.A)(n),t.codecpar.videoDelay),16),e&&(t.codecpar.videoDelay=o)),!i&&null!=n&&n.length){i=o?(0,I.A)(o,n):n.slice();const e={delay:o,dtsQueue:i};i=[],w[t.index]=e;for(let r=0;r<C.length;r++)if(t.index===s.f[15](C[r]+32)){const n=e.dtsQueue.shift();a.M[17](C[r]+16,n),i.push(n);const o=t.sampleIndexes.find((t=>t.pts===s.f[17](C[r]+8)));o&&(o.dts=s.f[17](C[r]+16))}}if(i&&i.length>1){let e=BigInt(0);for(let t=1;t<i.length;t++)e+=i[t]-i[t-1];if(1===t.codecpar.codecType&&t.codecpar.sampleRate>0&&!t.codecpar.frameSize){let r=Number(e)/(i.length-1);t.codecpar.frameSize=Math.round(r/t.timeBase.den*t.timeBase.num*t.codecpar.sampleRate)}else if(0===t.codecpar.codecType){const r=(0,f.j2)(t.timeBase.den*(i.length-1)/(Number(e)*t.timeBase.num),l.go);t.codecpar.framerate.num=r.num,t.codecpar.framerate.den=r.den,(0,k.A)(t.codecpar.framerate)}const r=Number(i[i.length-1]-t.startTime)*t.timeBase.num/t.timeBase.den;r&&(t.codecpar.bitrate=BigInt(Math.floor(8*v[t.index]/r)))}}function E(){t.streams.forEach((t=>{U(t,!0),1===t.codecpar.codecType&&(1===t.codecpar.chLayout.nbChannels?(t.codecpar.chLayout.u.mask=BigInt(4),t.codecpar.chLayout.order=1):2===t.codecpar.chLayout.nbChannels&&(t.codecpar.chLayout.u.mask=BigInt(3),t.codecpar.chLayout.order=1))}))}for(;;){if(t.streams.length>=_&&t.options.fastOpen&&(0,u.$)(t)){E();break}M||(M=(0,p._5)());let a=!1;if(B=await R(t,M),0!==B){E();break}const d=t.getStreamByIndex(s.f[15](M+32));let h=s.f[17](M+8);if(h===l.Dh&&(h=s.f[17](M+16)),s.f[15](M+28)&&(a=!0,C.push(M),e[d.index]?h<d.startTime&&(d.startTime=h):(d.firstDTS=s.f[17](M+16),d.startTime=h,e[d.index]=!0),s.f[17](M+16)!==l.Dh&&(r[d.index]?r[d.index].push(s.f[17](M+16)):r[d.index]=[s.f[17](M+16)]),g[d.index]?g[d.index].push(h):g[d.index]=[h],v[d.index]?v[d.index]+=s.f[15](M+28):v[d.index]=s.f[15](M+28),!S[d.index]&&t.getDecoderResource&&!t.options.fastOpen&&!d.metadata.encryption)){let e=T[d.index];if(!e){const r=await t.getDecoderResource(d.codecpar.codecType,d.codecpar.codecId);r&&(1===d.codecpar.codecType?e=new y.A({resource:r,onReceiveAVFrame:t=>{d.codecpar.format=s.f[15](t+80),d.codecpar.frameSize=s.f[15](t+76),d.codecpar.sampleRate=s.f[15](t+152),d.codecpar.chLayout=(0,o.A)(t+288,n.r),(0,b.xj)(t),S[d.index]=!0}}):0===d.codecpar.codecType&&(r.threadModule&&delete r.threadModule,e=new A.A({resource:r,onReceiveAVFrame:t=>{d.codecpar.format=s.f[15](t+80),d.codecpar.colorRange=s.f[15](t+208),d.codecpar.colorSpace=s.f[15](t+220),d.codecpar.colorPrimaries=s.f[15](t+212),d.codecpar.colorTrc=s.f[15](t+216),d.codecpar.chromaLocation=s.f[15](t+224),s.f[15](t+92)&&s.f[15](t+96)&&(d.codecpar.sampleAspectRatio=(0,o.A)(t+92,c.P)),d.codecpar.width=s.f[15](t+68),d.codecpar.height=s.f[15](t+72),(0,b.xj)(t),S[d.index]=!0}})),await e.open(d.codecpar[i.o9])?(e.close(),S[d.index]=!0):T[d.index]=e)}e&&e.decode(M)&&(S[d.index]=!0)}if(g[d.index]&&g[d.index].length===P&&U(d,!1),d.startTime!==l.Dh&&h-d.startTime>(0,f.k)(BigInt(Math.floor(t.options.maxAnalyzeDuration)),l.i0,d.timeBase)&&(t.streams.length>=_&&(0,u.$)(t)||h-d.startTime>(0,f.k)(BigInt(15e3),l.i0,d.timeBase)&&(!g[d.index]||g[d.index].length>450))&&D()){E(),a&&(M=0);break}a&&(M=0)}return M&&(0,p.Qe)(M),C.length&&(t.interval.packetBuffer=C.concat(t.interval.packetBuffer)),d.__(T,(t=>{t&&t.close()})),d.__(w,((e,r)=>{const i=t.getStreamByIndex(+r);i.privateData2?d.X$(i.privateData2,e):i.privateData2=e})),-1048576===B||-1048572===B?0:0!==B?B:(2===t.iformat.type&&1&t.ioReader.flags&&!(2&t.ioReader.flags)&&await async function(t){const e=await t.ioReader.fileSize();if(e<=BigInt(0))return;const r=t.interval.packetBuffer;t.interval.packetBuffer=[];let i=t.ioReader.getPos(),a=0;for(;a<4;){const r=e-BigInt(Math.floor(m.v<<a)),n=await t.iformat.seek(t,null,r,2);if(n<0)break;!a&&n>0&&(i=n);const o={},c=(0,p._5)();for(;!(await R(t,c)<0);){let e=s.f[17](c+8);e===l.Dh&&(e=s.f[17](c+16));const r=t.getStreamByIndex(s.f[15](c+32));r.startTime!==l.Dh?e-=r.startTime:e-=r.firstDTS,e>BigInt(0)&&((r.duration===l.Dh||!o[s.f[15](c+32)]||r.duration<e&&Math.abs(Number(e-r.duration))<60*r.timeBase.den/r.timeBase.num)&&(r.duration=e),o[c.streamIndex]=e)}(0,p.Qe)(c);let d=!0;if(h.__(t.streams,(t=>{if(t.duration===l.Dh)return d=!1,!1})),d)break;a++}h.__(t.interval.packetBuffer,(t=>{(0,p.Qe)(t)})),t.interval.packetBuffer=r.filter((t=>!(s.f[17](t+56)>=i&&((0,p.Qe)(t),1)))),await t.iformat.seek(t,null,i,2)}(t),0)}function C(t,e){let r=s.f[17](e+8);r===l.Dh&&(r=s.f[17](e+16));const i=h.El(t.sampleIndexes,(t=>t.pts<r?1:-1)),a={dts:s.f[17](e+16),pts:r,pos:s.f[17](e+56),size:s.f[15](e+28),duration:s.f[17](e+48),flags:s.f[15](e+36)};i>-1?(t.sampleIndexesPosMap.set(s.f[17](e+56),i),t.sampleIndexes.splice(i,0,a)):(t.sampleIndexesPosMap.set(s.f[17](e+56),t.sampleIndexes.length),t.sampleIndexes.push(a))}async function B(t,e){const r=t.getStreamByIndex(s.f[15](e+32));if(s.f[17](e+16)===l.Dh){const t=r.privateData2;t&&(t.delay?(h._(t.dtsQueue,s.f[17](e+8),(t=>t<s.f[17](e+8)?1:-1)),t.dtsQueue.length>t.delay&&a.M[17](e+16,t.dtsQueue.shift())):a.M[17](e+16,s.f[17](e+8)))}let i=0;if(r&&(27===r.codecpar.codecId||173===r.codecpar.codecId||196===r.codecpar.codecId||86018===r.codecpar.codecId))if(!s.f[15](e+28)&&(0,p.fQ)(e,1))for(;;){const r=(0,p._5)();if(i=await t.iformat.readAVPacket(t,r),0!==i){if(t.interval.packetBuffer.length){let r=t.interval.packetBuffer.shift();return(0,p.Up)(e),(0,p.rN)(e,r),(0,p.Qe)(r),B(t,e)}return i}if(s.f[15](r+32)!==s.f[15](e+32)){let e=t.interval.packetBuffer.length-1,i=!0;for(;e>=0;e--)if(s.f[15](t.interval.packetBuffer[e]+32)===s.f[15](r+32)){s.f[15](t.interval.packetBuffer[e]+28)||s.f[15](r+28)?!s.f[15](t.interval.packetBuffer[e]+28)&&s.f[15](r+28)&&((0,p.Zx)(t.interval.packetBuffer[e],r),(0,p.Qe)(r),i=!1):((0,p.Qe)(t.interval.packetBuffer[e]),t.interval.packetBuffer.splice(e,1,r),i=!1);break}i&&t.interval.packetBuffer.push(r)}else{if(s.f[15](r+28))return(0,p.Zx)(e,r),a.M[17](e+16,s.f[17](r+16)),a.M[17](e+8,s.f[17](r+8)),(0,p.Qe)(r),0;(0,p.Up)(e),(0,p.rN)(e,r),(0,p.Qe)(r)}}else if(32&s.f[15](e+36))return R(t,e);if(1&t.ioReader.flags&&!r.sampleIndexesPosMap.has(s.f[17](e+56)))if(0===r.codecpar.codecType)1&s.f[15](e+36)&&C(r,e);else if(1===r.codecpar.codecType){const t=h.El(r.sampleIndexes,(t=>t.pts<s.f[17](e+8)?1:-1));(!r.sampleIndexes.length||t<0&&(0,f.Mr)(s.f[17](e+8)-r.sampleIndexes[r.sampleIndexes.length-1].pts,e+72,l.i0)>=m.V||t>0&&t<r.sampleIndexes.length-1&&(0,f.Mr)(s.f[17](e+8)-r.sampleIndexes[t-1].pts,e+72,l.i0)>=m.V||0===t&&(0,f.Mr)(r.sampleIndexes[0].pts-s.f[17](e+8),e+72,l.i0)>=m.V)&&C(r,e)}return 0}async function R(t,e){let r=0;if((0,p.Up)(e),t.interval.packetBuffer.length){const r=t.interval.packetBuffer.shift();return(0,p.rN)(e,r),(0,p.Qe)(r),B(t,e)}return r=await t.iformat.readAVPacket(t,e),0!==r?((0,p.Up)(e),r):B(t,e)}async function D(t,e,r,i){let n=e>-1?t.streams.find((t=>t.index===e)):null;if(n||(n=t.getStreamByMediaType(0),n||(n=t.getStreamByMediaType(1)),n||(n=t.getStreamByMediaType(3))),!n)return v.z3(`not found any stream to seek, streamIndex: ${n.index}`,T,734),BigInt(g.LR);v.Yz(`seek in ${0===n.codecpar.codecType?"video":"audio"} stream, streamIndex: ${n.index}, timestamp: ${r}, flags: ${i}`,T,738),r=(0,f.k)(r,l.i0,n.timeBase);const o=await t.iformat.seek(t,n,r,i);if(o>=BigInt(0)){h.__(t.interval.packetBuffer,(e=>{if(2&t.ioReader.flags){const r=(0,p.rU)(e,1),i=t.streams[s.f[15](e+32)];!i.sideData[1]&&r&&(i.sideData[1]=(0,w.s3)(s.f[20](r),s.f[25](r+4)).slice())}(0,p.Qe)(e)})),t.interval.packetBuffer.length=0;const e={};t.streams.forEach((t=>{const r=t.privateData2;null!=r&&r.dtsQueue&&(r.dtsQueue.length=0,r.delay&&(e[t.index]=r.delay,r.delay=P))}));const r=[];for(;t.streams.some((t=>{const e=t.privateData2;return e&&e.dtsQueue&&e.dtsQueue.length<e.delay}));){const e=(0,p._5)();if(await R(t,e)){(0,p.Qe)(e);break}r.push(e)}return t.streams.forEach((t=>{const i=t.privateData2;if(null!=i&&i.delay){i.delay=e[t.index],i.dtsQueue=(0,I.A)(i.delay,i.dtsQueue);for(let e=0;e<r.length;e++)if(t.index===s.f[15](r[e]+32)){a.M[17](r[e]+16,i.dtsQueue.shift());const n=t.sampleIndexes.find((t=>t.pts===s.f[17](r[e]+8)));n&&(n.dts=s.f[17](r[e]+16))}}})),t.interval.packetBuffer=r.concat(t.interval.packetBuffer),BigInt(0)}return o}},548:(t,e,r)=>{"use strict";r.d(e,{Ay:()=>B,L_:()=>M,eG:()=>_,yl:()=>S});var i=r(69736),s=r.n(i),a=r(61499),n=r(63939),o=r(36981),c=r(29170),d=r(9599),h=r(44315),l=r(95335),u=r(62751),f=r(67672),p=r(44328),m=r(77231),g=r(20525),v=r(62100),A=r(95832),y=r(62815),b=r(67659),w=r(21477),k=r(82014),x=r(64093),I=r(24310);function T(t){t<0&&(t=BigInt(0));const e=Number(BigInt.asIntN(32,t%BigInt(1e3))),r=Number(BigInt.asIntN(32,t/BigInt(1e3)%BigInt(60))),i=Number(BigInt.asIntN(32,t/BigInt(1e3)/BigInt(60)%BigInt(60))),s=Number(BigInt.asIntN(32,t/BigInt(1e3)/BigInt(3600)));return g.GP("%02d:%02d:%02d.%03d",s,i,r,e)}function P(t){return t<BigInt(1e4)?(0,v.A)(Number(BigInt.asIntN(32,t)))+" bps/s":Number(BigInt.asIntN(32,t/BigInt(1e3)))+" kbps/s"}function S(t,e,r="unknown"){let i=r;return l.__(t,((t,r)=>{if(e===t)return i=r,!1})),i}function _(t,e){return 1===t?S(u.n1,e):0===t?S(u._R,e):3===t?S(u.Xp,e):"unknown"}function M(t){return S(u.iW,t)}function C(t,e){switch(t){case 86018:return A.uF[e]||"LC";case 86017:return x.He[e]||"Layer3";case 27:return y.tZ[e]||"High";case 173:return b.dT[e]||"Main";case 225:return w.zk[e]||"Main";case 167:return k.wN[e]||"Profile0"}}function B(t,e){let r="";return t.forEach(((t,i)=>{if(t instanceof h.oD){const e=[];for(let r=0;r<t.streams.length;r++){const i=t.streams[r];e.push({index:i.index,id:i.id,codecpar:i.codecpar[a.o9],nbFrames:i.nbFrames,metadata:i.metadata,duration:i.duration,startTime:i.startTime,disposition:i.disposition,timeBase:i.timeBase})}t={metadata:t.metadata,format:t.format,chapters:t.chapters,streams:e}}r+=function(t,e,r){let i=`${r.tag} #${e}, ${r.isLive?"live":"vod"}, ${S(u.iW,t.format)}, from '${r.from}':\n`;s()(t.metadata).length&&(i+="  Metadata:\n",l.__(t.metadata,((t,e)=>{f.Ik(t)&&f.YO(t)||(i+=`    ${e}: ${t}\n`)})));let a=BigInt(0),h=BigInt(0),g=-BigInt(1);return t.streams.forEach((t=>{const e=(0,p.k)(t.duration,t.timeBase,m.i0),r=(0,p.k)(t.startTime,t.timeBase,m.i0);e>a&&(a=e),(r<g||g===-BigInt(1))&&(g=r),h+=n.f[17](t.codecpar+32)})),i+=`  Duration: ${T(a)}, start: ${T(g)}, bitrate: ${P(h)}\n`,t.streams.forEach(((t,r)=>{i+=function(t,e,r){const i=S(u.Mb,n.f[15](t.codecpar)),a=[];if(1===n.f[15](t.codecpar)){const e=C(n.f[15](t.codecpar+4),n.f[15](t.codecpar+48)),r=S(u.n1,n.f[15](t.codecpar+4));a.push(`${r}${e?` (${e})`:""}`),a.push(`${n.f[15](t.codecpar+136)} Hz`);let i=`${n.f[15](t.codecpar+116)} channels`;if(1===n.f[15](t.codecpar+112)){const e=S(u.IY,Number((0,c.A)(t.codecpar+120,o.r,"u").mask),"");e&&(i=e)}a.push(i),a.push(S(u.Sz,n.f[15](t.codecpar+28))),n.f[17](t.codecpar+32)>BigInt(0)&&a.push(`${P(n.f[17](t.codecpar+32))}`)}else if(0===n.f[15](t.codecpar)){const e=C(n.f[15](t.codecpar+4),n.f[15](t.codecpar+48)),r=S(u._R,n.f[15](t.codecpar+4));if(a.push(`${r}${e?` (${e})`:""}`),n.f[15](t.codecpar+28)!==m.N_){const e=S(u.qO,n.f[15](t.codecpar+28),`unknown(${n.f[15](t.codecpar+28)})`),r=S(u.mX,n.f[15](t.codecpar+84),"tv"),i=S(u._m,n.f[15](t.codecpar+96),"bt709"),s=S(u.Eh,n.f[15](t.codecpar+88),"bt709"),o=S(u.d8,n.f[15](t.codecpar+92),"bt709"),c=(0,I.A)(t.codecpar);i===s&&s===o?a.push(`${e}(${r}, ${i}, ${c?"HDR":"SDR"})`):a.push(`${e}(${r}, ${i}/${s}/${o}, ${c?"HDR":"SDR"})`)}const i={num:n.f[15](t.codecpar+56)*n.f[15](t.codecpar+64),den:n.f[15](t.codecpar+60)*n.f[15](t.codecpar+68)};(0,p.iU)(i),a.push(`${n.f[15](t.codecpar+56)}x${n.f[15](t.codecpar+60)} [SAR: ${n.f[15](t.codecpar+64)}:${n.f[15](t.codecpar+68)} DAR ${i.num}:${i.den}]`),n.f[17](t.codecpar+32)>BigInt(0)&&a.push(`${P(n.f[17](t.codecpar+32))}`),(0,p.lb)((0,c.A)(t.codecpar+72,d.P))>0&&(a.push(`${(0,p.lb)((0,c.A)(t.codecpar+72,d.P)).toFixed(2)} fps`),a.push(`${(0,p.lb)((0,c.A)(t.codecpar+72,d.P)).toFixed(2)} tbr`)),a.push(`${h=BigInt(Math.floor((0,p.lb)({num:t.timeBase.den,den:t.timeBase.num}))),h<BigInt(1e4)?(0,v.A)(Number(BigInt.asIntN(32,h))):Number(BigInt.asIntN(32,h/BigInt(1e3)))+"k"} tbn`)}else if(3===n.f[15](t.codecpar)){const e=S(u.Xp,n.f[15](t.codecpar+4));a.push(e),n.f[17](t.codecpar+32)>BigInt(0)&&a.push(`${P(n.f[17](t.codecpar+32))}`)}else n.f[17](t.codecpar+32)>BigInt(0)&&a.push(`${P(n.f[17](t.codecpar+32))}`);var h;let g="";t.disposition&&(g=" ",1&t.disposition&&(g+=`(${S(u.Ki,1)}) `),2&t.disposition&&(g+=`(${S(u.Ki,2)}) `),4&t.disposition&&(g+=`(${S(u.Ki,4)}) `),8&t.disposition&&(g+=`(${S(u.Ki,8)}) `),16&t.disposition&&(g+=`(${S(u.Ki,16)}) `),32&t.disposition&&(g+=`(${S(u.Ki,32)}) `),64&t.disposition&&(g+=`(${S(u.Ki,64)}) `),128&t.disposition&&(g+=`(${S(u.Ki,128)}) `),256&t.disposition&&(g+=`(${S(u.Ki,256)}) `),512&t.disposition&&(g+=`(${S(u.Ki,512)}) `),1024&t.disposition&&(g+=`(${S(u.Ki,1024)}) `),2048&t.disposition&&(g+=`(${S(u.Ki,2048)}) `),65536&t.disposition&&(g+=`(${S(u.Ki,65536)}) `),131072&t.disposition&&(g+=`(${S(u.Ki,131072)}) `),262144&t.disposition&&(g+=`(${S(u.Ki,262144)}) `),524288&t.disposition&&(g+=`(${S(u.Ki,524288)}) `),1048576&t.disposition&&(g+=`(${S(u.Ki,1048576)}) `));let A=`${r}Stream #${e}:${t.index} ${i}: ${a.join(", ")}${g}\n`;return s()(t.metadata).length&&(A+=`${r}  Metadata:\n`,l.__(t.metadata,((e,i)=>{f.Ik(e)||f.YO(e)?"matrix"===i&&0===n.f[15](t.codecpar)&&(A+=`${r}    ${i}: [${e.toString()}]\n`):A+=`${r}    ${i}: ${e}\n`}))),A}(t,e,"  ")})),i}(t,i,e[i])})),r}},51597:(t,e,r)=>{"use strict";r.d(e,{A:()=>s,E:()=>a});var i=r(134);class s{constructor(){(0,i.A)(this,"type",-1)}async destroy(t){}}const a={15:[86018],10:[86017,86019,86018,12,27],17:[86028],0:[86017,86018,86051,69645,86049,65543,65542,86019,86056,86076,86028,12,27,173,225,167,139,196],5:[139,167],8:[86021,86076,86018,86017,86028,86032,86020,86056,86019,65557,65537,65536,139,167,225,27,173,196,12,30,94226,94212,94230,94210,94225],9:[86021,86076,139,167,225,94226],1:[86021,86076,86018,86017,86028,86051,86019,86056,167,225,27,173,196,12,94226,94213],14:[86017],2:[86076,86018,86017,86019,,86020,86065,86056,12,225,27,173,196],3:[86058,86016,86017,86019,,86020,2,12,27,173,196],4:[86021,86076,86028,86051],16:[65557,65559,65541,65536,65548,65544,65567],18:[94226],20:[94230,94212],19:[94225],21:[94232],11:[27],12:[173],13:[196],6:[86076,86018,86017,65543,65542,2,12,27,173,139,167,225],7:[86017,86018,86051,69645,86049,65543,65542,12,27,173,225,167,196]}},69765:(t,e,r)=>{"use strict";r.d(e,{A:()=>U});var i=r(134),s=r(61499),a=r(63939),n=r(9599),o=r(29170),c=r(51597),d=r(9690),h=r(65977),l=r(75473),u=r(38106),f=r(3384),p=r(35336),m=r(72739),g=r(4624),v=r(92647),A=r(79804),y=r(77231),b=r(95335),w=r(20841),k=r(59989),x=r(44328),I=r(71517),T=r(26173),P=r(67672),S=r(43607),_=r(87518),M=r(14686),C=r(14041),B=r(50315);const R="src\\avformat\\formats\\OMovFormat.ts",D={fragmentMode:0,movMode:0,fragment:!1,fastOpen:!1,defaultBaseIsMoof:!1,reverseSpsInAvcc:!1,ignoreEncryption:!1,minFragmentLength:5e3,minFragmentIndexLength:5e3,hasTfra:!0};class U extends c.A{constructor(t={}){super(),(0,i.A)(this,"type",1),(0,i.A)(this,"context",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"annexb2AvccFilter",void 0),(0,i.A)(this,"avpacket",void 0),this.options=b.X$({},D,t),this.context=(0,d.A)()}init(t){t.ioWriter.setEndian(!0);const e=t.getStreamByMediaType(0);return!e||27!==e.codecpar.codecId&&173!==e.codecpar.codecId&&196!==e.codecpar.codecId||(this.annexb2AvccFilter=new T.A(this.options.reverseSpsInAvcc),this.annexb2AvccFilter.init(e.codecpar[s.o9],e.timeBase[s.o9])),this.avpacket=(0,I._5)(),0}async destroy(t){this.annexb2AvccFilter&&(this.annexb2AvccFilter.destroy(),this.annexb2AvccFilter=null),this.avpacket&&((0,I.Qe)(this.avpacket),this.avpacket=0)}enableStreams(t){const e=[],r=[];for(let t=0;t<5;t++)e[t]=0,r[t]=-1;m.__(t.streams,((t,i)=>{if(-1===t.codecpar.codecType||t.codecpar.codecType>=5)return!0;r[t.codecpar.codecType]<0&&(r[t.codecpar.codecType]=i),1&t.disposition&&(e[t.codecpar.codecType]++,t.privData.flags|=1)}));for(let i=0;i<5;i++)switch(i){case 0:case 1:case 3:e[i]>1&&(t.streams[e[i]].privData.perStreamGrouping=!0),!e[i]&&r[i]>=0&&(t.streams[r[i]].privData.flags|=1)}}writeHeader(t){if(this.context.majorBrand=(0,h.A)("isom"),this.context.minorVersion=512,this.context.compatibleBrand=[(0,h.A)("isom")],this.context.timescale=1e3,this.context.ignoreEncryption=this.options.ignoreEncryption,this.options.fragment&&(this.context.compatibleBrand.push((0,h.A)("iso6")),this.context.fragment=!0),1===this.options.movMode&&(this.context.isom=!0,this.context.majorBrand=(0,h.A)("qt  "),this.context.compatibleBrand=[this.context.majorBrand]),1!==this.options.movMode){this.context.compatibleBrand.push((0,h.A)("iso2"));const e=t.getStreamByMediaType(0);e&&27===e.codecpar.codecId&&this.context.compatibleBrand.push((0,h.A)("avc1")),this.context.compatibleBrand.push((0,h.A)("mp41"))}if(l.l7(t.ioWriter,this.context),this.context.holdMoovPos=t.ioWriter.getPos(),this.options.fragment)this.context.currentFragment={pos:BigInt(0),currentTrack:null,sequence:1,tracks:[],size:0,firstWrote:!1},m.__(t.streams,((t,e)=>{const r=(0,u.A)();t.privData=r,r.chunkOffsets=[],r.cttsSampleCounts=[],r.cttsSampleOffsets=[],r.stscFirstChunk=[],r.stscSamplesPerChunk=[],r.stscSampleDescriptionIndex=[],r.stssSampleNumbers=[],r.sampleSizes=[],r.sttsSampleCounts=[],r.sttsSampleDeltas=[],r.alternateGroup=e;const i=(0,f.A)();i.baseIsMoof=this.options.defaultBaseIsMoof,i.streamIndex=t.index,i.trackId=this.context.nextTrackId++,r.trackId=i.trackId;const s=this.options.encryption||t.metadata.encryption;if(s){const t=this.context.cencs||{};t[i.trackId]={schemeType:s.schemeType,schemeVersion:s.schemeVersion,cryptByteBlock:s.cryptByteBlock,skipByteBlock:s.skipByteBlock,defaultConstantIV:s.constantIV,isProtected:1,defaultPerSampleIVSize:s.perSampleIVSize,defaultKeyId:s.kid,pattern:!!s.pattern},this.context.cencs=t}i.ioWriter=new p.A,i.ioWriter.onFlush=t=>(i.buffers.push(t.slice()),0),this.context.currentFragment.tracks.push(i)})),this.enableStreams(t),l.dI(t.ioWriter,t,this.context),t.ioWriter.flush();else{m.__(t.streams,((t,e)=>{const r=(0,u.A)();t.privData=r,r.trackId=this.context.nextTrackId++,r.chunkOffsets=[],r.cttsSampleCounts=[],r.cttsSampleOffsets=[],r.stscFirstChunk=[],r.stscSamplesPerChunk=[],r.stscSampleDescriptionIndex=[],r.stssSampleNumbers=[],r.sampleSizes=[],r.sttsSampleCounts=[],r.sttsSampleDeltas=[],r.alternateGroup=e})),this.enableStreams(t);const e=t.ioWriter.getPos();t.ioWriter.writeUint32(0),t.ioWriter.writeUint32((0,h.A)("mdat")),this.context.boxsPositionInfo.push({pos:e,type:"mdat",size:0})}return t.getStreamByMediaType(0)||(this.context.audioOnly=!0),0}updateCurrentChunk(t){let e=this.context.currentChunk;if(!e||!e.sampleCount)return;const r=t.streams.find((t=>t.index===e.streamIndex)).privData;r.chunkCount++,r.chunkOffsets.push(e.pos),r.stscFirstChunk.length?r.lastStscCount!==e.sampleCount&&(r.stscFirstChunk.push(r.chunkCount),r.stscSamplesPerChunk.push(e.sampleCount),r.stscSampleDescriptionIndex.push(1),r.lastStscCount=e.sampleCount):(r.stscFirstChunk.push(r.chunkCount),r.stscSamplesPerChunk.push(e.sampleCount),r.stscSampleDescriptionIndex.push(1),r.lastStscCount=e.sampleCount)}updateCurrentFragment(t,e){if(this.context.currentFragment.firstWrote){m.__(this.context.currentFragment.tracks,(r=>{const i=t.streams.find((t=>t.index===r.streamIndex));if(!r.sampleCount||!i)return!0;const s=i.privData;var a,n;r.baseDataOffset=t.ioWriter.getPos(),this.context.currentFragment.pos=t.ioWriter.getPos(),r.sampleDurations.length?e&&r.sampleDurations.length===r.sampleSizes.length-1&&r.sampleDurations.push(Number(e-s.lastDts)):1===i.codecpar.codecType?e?r.sampleDurations.push(Number(e-s.lastDts)):i.codecpar.frameSize>0?r.sampleDurations.push(Number((0,x.k)(BigInt(i.codecpar.frameSize/i.codecpar.sampleRate*y.SF),y.KR,i.timeBase))):(i.codecpar.codecId,r.sampleDurations.push(Number((0,x.k)(BigInt(1024/i.codecpar.sampleRate*y.SF),y.KR,i.timeBase)))):0===i.codecpar.codecType?e?r.sampleDurations.push(Number(e-s.lastDts)):(0,x.lb)(i.codecpar.framerate)>0?r.sampleDurations.push(Number((0,x.k)(BigInt(Math.floor(1/(0,x.lb)(i.codecpar.framerate)*y.SF)),y.KR,i.timeBase))):r.sampleDurations.push(i.timeBase.den/(30*i.timeBase.num)>>>0):r.sampleDurations.push(0),s.lastDuration=r.sampleDurations[r.sampleSizes.length-1],(1===r.sampleFlags.length||(0,k.A)(r.sampleFlags,1))&&(r.firstSampleFlags=r.sampleFlags[0],r.defaultSampleFlags=null!==(a=r.sampleFlags[1])&&void 0!==a?a:r.firstSampleFlags,r.sampleFlags=[]),(1===r.sampleSizes.length||(0,k.A)(r.sampleSizes))&&(r.defaultSampleSize=r.sampleSizes[0],r.sampleSizes=[]),(1===r.sampleDurations.length||(0,k.A)(r.sampleDurations))&&(r.defaultSampleDuration=r.sampleDurations[0],r.sampleDurations=[]),r.cenc&&(1===r.cenc.sampleSizes.length||(0,k.A)(r.cenc.sampleSizes))&&(r.cenc.defaultSampleInfoSize=r.cenc.sampleSizes[0],r.cenc.sampleSizes=[]),1===i.codecpar.codecType?r.defaultSampleFlags=33554432:r.sampleFlags.length&&(r.defaultSampleFlags=r.sampleFlags[0]),r.sampleSizes.length&&(r.defaultSampleSize=r.sampleSizes[0]),r.sampleDurations.length&&(r.defaultSampleDuration=r.sampleDurations[0]),this.options.hasTfra&&(!s.fragIndexes.length||0===this.options.fragmentMode||(0,x.k)(r.baseDataOffset-r.lastFragIndexDts,i.timeBase,y.i0)>=this.options.minFragmentIndexLength)&&(s.fragIndexes.push({pos:r.baseDataOffset,time:r.baseMediaDecodeTime+BigInt(Math.floor(null!==(n=r.sampleCompositionTimeOffset[0])&&void 0!==n?n:0))}),r.lastFragIndexDts=s.lastDts)})),t.ioWriter.flush(),l.Ro(t.ioWriter,t,this.context);let r=this.context.currentFragment.size+8;const i=[];let s=8;m.__(this.context.currentFragment.tracks,(e=>{if(!e.sampleCount)return!0;e.ioWriter.flush();const a=(0,v.A)(Uint8Array,e.buffers);e.dataOffset=r,r+=a.length,s+=a.length,i.push(a),(0,w.A)(t.ioWriter,e.dataOffsetPos,e.dataOffset,"int32"),e.cenc&&e.cenc.offsetPos&&(0,w.A)(t.ioWriter,e.cenc.offsetPos,e.cenc.offset,"int32"),e.buffers=[],e.sampleFlags=[],e.sampleSizes=[],e.sampleDurations=[],e.sampleCompositionTimeOffset=[],e.sampleCount=0,e.firstSampleFlags=0,e.cenc=null})),t.ioWriter.writeUint32(s),t.ioWriter.writeUint32((0,h.A)("mdat")),m.__(i,(e=>{t.ioWriter.writeBuffer(e)})),(0,A.A)(t.ioWriter,this.context),t.ioWriter.flush(),this.context.currentFragment.firstWrote=!1,this.context.currentFragment.sequence++}}handleEAC3(t,e){this.context.ac3Info||(this.context.ac3Info={done:!1,numBlocks:0,dataRate:0,ac3BitrateCode:-1,numIndSub:0,substream:[]});const r=this.context.ac3Info,i=_.R((0,M.s3)(a.f[20](t+24),a.f[15](t+28)));if(P.ai(i))r.done=!0;else if(r.dataRate=Math.max(r.dataRate,i.bitrate/1e3),r.ac3BitrateCode=Math.max(r.ac3BitrateCode,i.ac3BitrateCode),!r.done){if(i.bitstreamId<=10&&0!=i.substreamId)return;if(0===i.frameType||2==i.frameType){var s;if(i.substreamId>r.numIndSub+1)return;if(i.substreamId==r.numIndSub+1)return;if(i.substreamId<r.numIndSub||0==i.substreamId&&null!==(s=r.substream[0])&&void 0!==s&&s.bsid)return void(r.done=!0)}else if(0!=i.substreamId)return;if(r.substream[i.substreamId]||(r.substream[i.substreamId]={fscod:0,bsid:0,bsmod:0,acmod:0,lfeon:0,numDepSub:0,chanLoc:0}),r.substream[i.substreamId].fscod=i.srCode,r.substream[i.substreamId].bsid=i.bitstreamId,r.substream[i.substreamId].bsmod=i.bitstreamMode,r.substream[i.substreamId].acmod=i.channelMode,r.substream[i.substreamId].lfeon=i.lfeOn,86019===e.codecpar.codecId)return void(r.done=!0)}}writeAVPacket(t,e){if(!a.f[15](e+28))return g.R8(`packet's size is 0: ${a.f[15](e+32)}, ignore it`,R,639),0;const r=t.getStreamByIndex(a.f[15](e+32));if(!r)return void g.R8(`can not found the stream width the avpacket's streamIndex: ${a.f[15](e+32)}, ignore it`,R,646);const i=r.privData;let s=(0,x.Mr)(a.f[17](e+16),e+72,r.timeBase),c=(0,x.Mr)(a.f[17](e+8)!==y.Dh?a.f[17](e+8):a.f[17](e+16),e+72,r.timeBase);const d=a.f[17](e+48)!==y.Dh?(0,x.Mr)(a.f[17](e+48),e+72,r.timeBase):-BigInt(1);if((27===r.codecpar.codecId||173===r.codecpar.codecId||196===r.codecpar.codecId)&&64&a.f[15](e+36)?(this.annexb2AvccFilter.sendAVPacket(e),this.annexb2AvccFilter.receiveAVPacket(this.avpacket),e=this.avpacket):86019!==r.codecpar.codecId&&86056!==r.codecpar.codecId||this.context.ac3Info&&this.context.ac3Info.done||this.handleEAC3(e,r),this.context.fragment){const h=this.context.currentFragment.tracks.find((t=>t.streamIndex===a.f[15](e+32)));if(h){if(h.tfdtDelay===y.Dh&&(h.tfdtDelay=s<0?-s:BigInt(0),c<0&&(h.trunPtsDelay=h.tfdtDelay)),s+=h.tfdtDelay,c+=h.trunPtsDelay,(0===this.options.fragmentMode&&(0===r.codecpar.codecType&&1&a.f[15](e+36)||this.context.audioOnly&&(0,x.k)(s-h.baseMediaDecodeTime,r.timeBase,y.i0)>=this.options.minFragmentLength)||1===this.options.fragmentMode)&&(1===this.context.currentFragment.tracks.length?this.updateCurrentFragment(t,s):this.updateCurrentFragment(t)),h.ioWriter.writeBuffer((0,I.iI)(e)),h.sampleSizes.length||(h.baseMediaDecodeTime=s),h.sampleSizes.length&&(!h.sampleDurations[h.sampleSizes.length-1]||h.sampleDurations[h.sampleSizes.length-1]<=0)&&(h.sampleDurations[h.sampleSizes.length-1]=Number(s-i.lastDts)),a.f[17](e+48)>0&&h.sampleDurations.push(Number((0,x.k)(a.f[17](e+48),(0,o.A)(e+72,n.P),r.timeBase))),h.sampleSizes.push(a.f[15](e+28)),0===r.codecpar.codecType){let t=0;1&a.f[15](e+36)?t|=33554432:t|=16842752,h.sampleCompositionTimeOffset.push(Number((c!==y.Dh?c:s)-s)),h.sampleFlags.push(t)}const l=(0,I.Un)(e+40,e+44,25),u=this.context.cencs&&this.context.cencs[i.trackId];if(l&&u){const t=(0,B.p$)((0,M.s3)(a.f[20](l),a.f[25](l+4)));h.cenc||(h.cenc={sampleCount:0,defaultSampleInfoSize:0,sampleSizes:[],offset:0,useSubsamples:!1,sampleInfoOffset:[],sampleEncryption:[]}),t.subsamples.length&&(!h.cenc.useSubsamples&&h.cenc.sampleSizes.length&&(h.cenc.sampleSizes=h.cenc.sampleSizes.map((t=>t+2))),h.cenc.useSubsamples=!0),h.cenc.sampleCount++,h.cenc.sampleSizes.push(u.defaultPerSampleIVSize+(h.cenc.useSubsamples?2+6*t.subsamples.length:0)),h.cenc.sampleEncryption.push({iv:t.iv,subsamples:t.subsamples})}h.sampleCount++,i.lastPts=S.T9(i.lastPts,c+(d!==y.Dh?d:BigInt(0))),i.lastDts=s,this.context.currentFragment.firstWrote=!0}else g.R8(`can not found track width streamIndex ${a.f[15](e+32)}, ignore it`,R,786)}else{const n=t.ioWriter.getPos();let o=this.context.currentChunk;if(o?o.streamIndex!==a.f[15](e+32)?(this.updateCurrentChunk(t),o.streamIndex=a.f[15](e+32),o.sampleCount=1,o.pos=n):o.sampleCount++:o=this.context.currentChunk={pos:n,streamIndex:a.f[15](e+32),sampleCount:1},t.ioWriter.writeBuffer((0,I.iI)(e)),i.sampleSizes.push(a.f[15](e+28)),0===r.codecpar.codecType&&1&a.f[15](e+36)&&i.stssSampleNumbers.push(i.sampleSizes.length),i.firstWrote){const t=Number(s-i.lastDts);i.sttsSampleCounts.length&&i.sttsSampleDeltas[i.sttsSampleDeltas.length-1]===t?i.sttsSampleCounts[i.sttsSampleCounts.length-1]++:(i.sttsSampleCounts.push(1),i.sttsSampleDeltas.push(t))}else i.startDts=s,i.startCT=Number((c!==y.Dh?c:s)-s),i.firstWrote=!0;if(c>=0&&(i.startPts===y.Dh?i.startPts=c:i.startPts=S.jk(i.startPts,c)),0===r.codecpar.codecType){const t=Number((c!==y.Dh?c:s)-s);i.cttsSampleCounts.length&&i.cttsSampleOffsets[i.cttsSampleOffsets.length-1]===t?i.cttsSampleCounts[i.cttsSampleCounts.length-1]++:(i.cttsSampleCounts.push(1),i.cttsSampleOffsets.push(t))}i.lastPts=S.T9(i.lastPts,c+(d!==y.Dh?d:BigInt(0))),i.lastDts=s,i.lastDuration=Number(d)}return 0}writeTrailer(t){if(this.context.fragment)m.__(this.context.currentFragment.tracks,(e=>{const r=t.streams.find((t=>t.index===e.streamIndex)).privData;e.sampleCount&&(e.sampleDurations.length?e.sampleDurations.push(e.sampleDurations[e.sampleDurations.length-1]):e.sampleDurations=[r.lastDuration])})),this.updateCurrentFragment(t),this.options.hasTfra?l.yT(t.ioWriter,t,this.context):(t.ioWriter.writeUint32(8),t.ioWriter.writeString("mfra")),t.ioWriter.flush();else{this.updateCurrentChunk(t);let e=BigInt(0);m.__(t.streams,(t=>{const r=t.privData;r.sampleSizes.length&&(r.sttsSampleDeltas.length?r.lastDuration>0&&r.lastDuration!==r.sttsSampleDeltas[r.sttsSampleDeltas.length-1]?(r.sttsSampleCounts.push(1),r.sttsSampleDeltas.push(r.lastDuration)):r.sttsSampleCounts[r.sttsSampleCounts.length-1]++:(r.sttsSampleCounts=[1],r.sttsSampleDeltas=[0]));const i=(0,x.k)((0,C.A)(r),t.timeBase,{den:1e3,num:1});i>e&&(e=i)})),this.context.duration=e;const r=this.context.boxsPositionInfo[this.context.boxsPositionInfo.length-1];if("mdat"!==r.type&&g.z3("last box is not mdat",R,917),r.size=Number(t.ioWriter.getPos()-r.pos),r.size>y.f7){const e=t.ioWriter.getPos();t.ioWriter.seek(r.pos-BigInt(8)),t.ioWriter.writeUint32(1),t.ioWriter.writeUint32((0,h.A)("mdat")),t.ioWriter.writeUint64(BigInt(r.size)+BigInt(8)),t.ioWriter.seek(e),this.context.boxsPositionInfo.pop(),this.context.use64Mdat=!0}if((0,A.A)(t.ioWriter,this.context),this.options.fastOpen){t.ioWriter.flush();let e=[];const r=t.ioWriter.onFlush;t.ioWriter.onFlush=t=>(e.push(t.slice()),0),l.dI(t.ioWriter,t,this.context),t.ioWriter.flush();let i=(0,v.A)(Uint8Array,e);m.__(t.streams,(t=>{const e=t.privData;if(e.chunkOffsets.length)for(let t=0;t<e.chunkOffsets.length;t++)e.chunkOffsets[t]+=BigInt(Math.floor(i.length))})),e=[],l.dI(t.ioWriter,t,this.context),t.ioWriter.flush(),i=(0,v.A)(Uint8Array,e),r&&r(i,this.context.holdMoovPos),t.ioWriter.onFlush=r}else l.dI(t.ioWriter,t,this.context),t.ioWriter.flush()}return 0}flush(t){return this.options.fragment&&(m.__(this.context.currentFragment.tracks,(e=>{const r=t.streams.find((t=>t.index===e.streamIndex)).privData;e.sampleCount&&(e.sampleDurations.length?e.sampleDurations.push(e.sampleDurations[e.sampleDurations.length-1]):e.sampleDurations=[r.lastDuration])})),this.updateCurrentFragment(t)),t.ioWriter.flush(),0}}},5028:(t,e,r)=>{"use strict";r.d(e,{Q:()=>i});const i=["ReadOrder","Layer","Start","End","Style","Name","MarginL","MarginR","MarginV","Effect","Text"]},51785:(t,e,r)=>{"use strict";r.d(e,{Bp:()=>d,Ew:()=>l,wj:()=>u}),r(7210);var i=r(4624),s=r(5028),a=r(54825),n=r(44453),o=r(93935);const c="src\\avformat\\formats\\ass\\iass.ts";function d(t){return function(t,e){const r=e.match(/Format\s*:\s*(.*)/i)[1].split(/\s*,\s*/),s=[];for(let e=0;e<r.length;e++){const a=t.find((t=>t.toLowerCase()===r[e].toLowerCase()));a||i.R8(`not support ass field(${r[e]})`,c,40),s.push(a||r[e])}return s}(s.Q,t)}function h(t,e){let r=e.split(",");if(r.length>t.length){const e=r.slice(t.length-1).join(",");r=r.slice(0,t.length-1),r.push(e)}return r}function l(t,e,r,i){const[,,s]=e.match(/^(\w+?)\s*:\s*(.*)/i),n=h(t,s);return{start:(0,a.j)(n[r]),end:(0,a.j)(n[i])}}function u(t,e){const[,r,i]=e.match(/^(\w+?)\s*:\s*(.*)/i);let s=0;switch(r){case"Comment":s=2;break;case"Dialogue":s=1;break;case"Command":s=6;break;case"Movie":s=5;break;case"Picture":s=3;break;case"Sound":s=4}const c=h(t,i),d={type:s};for(let e=0;e<c.length;e++){d[t[e]]=c[e];const r=t[e],i=c[e].trim();switch(r){case"Layer":case"MarginL":case"MarginR":case"MarginV":d[r]=+i;break;case"Start":case"End":d[r]=(0,a.j)(i);break;case"Effect":d[r]=(0,n.d)(i);break;case"Text":d[r]=(0,o.r)(i);break;default:d[r]=i}}return d}},21071:(t,e,r)=>{"use strict";r.d(e,{_l:()=>i,gQ:()=>s});const i=["hmhd","nmhd","iods","xml ","url ","bxml","ipro","mere","stts","ctts","stss","stsz","stz2","stsc","stco","co64","stsd","dref","mvhd","tkhd","mdhd","hdlr"],s=["moov","trak","edts","mdia","minf","dinf","stbl","mvex","moof","traf","vttc","tref","iref","mfra","hnti","hinf","strd","sinf","rinf","schi","trgr","udta","iprp","ipco","strk","meco","encv","enca","sinf","schi"]},3384:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(77231);function s(){return{trackId:0,baseDataOffset:BigInt(0),defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlags:0,baseMediaDecodeTime:BigInt(0),sampleCount:0,dataOffset:0,remainDataOffsets:[],remainDataOffsetIndex:[],dataOffsetPos:BigInt(0),firstSampleFlags:0,sampleDurations:[],sampleSizes:[],sampleFlags:[],sampleCompositionTimeOffset:[],baseIsMoof:!1,ioWriter:null,buffers:[],lastFragIndexDts:BigInt(0),tfdtDelay:i.Dh,trunPtsDelay:BigInt(0)}}},9690:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(77231);function s(){return{isom:!1,timescale:i.N_,duration:i.Dh,foundMoov:!1,foundMdat:!1,majorBrand:0,minorVersion:0,compatibleBrand:[],creationTime:BigInt(0),modificationTime:BigInt(0),rate:i.N_,volume:i.N_,matrix:null,nextTrackId:1,fragment:!1,trexs:[],currentFragment:null,boxsPositionInfo:[],holdMoovPos:BigInt(0),currentChunk:null}}},38106:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(77231);function s(){return{chunkOffsets:null,cttsSampleCounts:null,cttsSampleOffsets:null,stscFirstChunk:null,stscSamplesPerChunk:null,stscSampleDescriptionIndex:null,stssSampleNumbersMap:null,stssSampleNumbers:null,sampleSizes:null,sttsSampleCounts:null,sttsSampleDeltas:null,duration:BigInt(0),trackId:i.N_,layer:0,alternateGroup:0,volume:0,matrix:null,width:0,height:0,audioCid:0,samplesPerFrame:0,bytesPerFrame:0,currentSample:0,sampleEnd:!1,samplesIndex:[],samplesEncryption:[],fragIndexes:[],lastPts:i.Dh,lastDts:i.Dh,startDts:i.Dh,startCT:i.N_,startPts:i.Dh,lastDuration:0,chunkCount:0,firstWrote:!1,lastStscCount:0,perStreamGrouping:!1,index:0,flags:0}}},14041:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(77231);function s(t){return t.startPts!==i.Dh?t.lastPts-t.startPts:t.startDts===i.Dh?t.lastPts:t.lastPts-(t.startDts+BigInt(0|t.startCT))}},79804:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(72739);function s(t,e){const r=t.getPos(),s=t.getPointer(),a=r-BigInt(Math.floor(s)),n=[];i.__(e.boxsPositionInfo,(e=>{e.pos<r&&e.pos>=a?(t.seekInline(s+Number(e.pos-r)),t.writeUint32(e.size)):n.push(e)})),i.__(n,(e=>{t.seek(e.pos),t.writeUint32(e.size)})),n.length?t.seek(r):t.seekInline(s),e.boxsPositionInfo=[]}},14202:(t,e,r)=>{"use strict";r.d(e,{BB:()=>s,Ip:()=>a,Jl:()=>i});const i={1:function(t){return[{type:"tkhd"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"smhd"},t.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stsc"},{type:"stsz"},{type:"stco"}]}]}]}]},0:function(t){return[{type:"tkhd"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"vmhd"},t.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stsc"},{type:"stsz"},{type:"stco"}]}]}]}]}},s={1:function(t){return[{type:"tkhd"},{type:"edts"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"smhd"},t.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stsc"},{type:"stsz"},{type:t.use64Mdat?"co64":"stco"}]}]}]}]},0:function(t){return[{type:"tkhd"},{type:"edts"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"vmhd"},t.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stss"},{type:"ctts"},{type:"stsc"},{type:"stsz"},{type:t.use64Mdat?"co64":"stco"}]}]}]}]}},a=function(t){return[{type:"tfhd"},{type:"tfdt"},{type:"trun"},t.cenc&&(t.cenc.defaultSampleInfoSize||t.cenc.sampleSizes.length)?{type:"saiz"}:null,t.cenc&&(t.cenc.defaultSampleInfoSize||t.cenc.sampleSizes.length)?{type:"saio"}:null,t.cenc?{type:"senc"}:null]}},6660:(t,e,r)=>{"use strict";r.d(e,{Q9:()=>a,f3:()=>n,uf:()=>o,zs:()=>s});var i=r(65977);const s={86018:64,86017:105,86076:173,86028:193,86021:221,12:32,27:33,173:35,196:51,167:177,0:0},a={32:12,33:27,35:173,51:196,177:167,64:86018,102:86018,103:86018,104:86018,105:86017,107:86017,173:86076,193:86028,221:86021,0:0},n={vide:0,soun:1,clcp:3,sbtl:3,subt:3,subp:3,text:3},o={[(0,i.A)("mp4a")]:86018,1836253269:86017,[(0,i.A)("Opus")]:86076,[(0,i.A)("fLaC")]:86028,[(0,i.A)("spex")]:86051,[(0,i.A)("SPXN")]:86051,[(0,i.A)("ac-3")]:86019,[(0,i.A)("sac3")]:86019,[i.A.mp4v]:12,[(0,i.A)("av01")]:225,[(0,i.A)("vp08")]:139,[(0,i.A)("vp09")]:167,[(0,i.A)("avc1")]:27,[(0,i.A)("hev1")]:173,[(0,i.A)("hvc1")]:173,[(0,i.A)("vvc1")]:196,[(0,i.A)("vvi1")]:196,[(0,i.A)("text")]:94213,[(0,i.A)("tx3g")]:94213}},75473:(t,e,r)=>{"use strict";r.d(e,{Ro:()=>v,dI:()=>g,l7:()=>p,yT:()=>A});var i=r(61499),s=r(63939),a=r(65977),n=r(21071),o=r(72739),c=r(80025),d=r(14202),h=r(79804),l=r(71517),u=r(50315),f=r(14686);function p(t,e){t.flush();const r=t.getPointer(),i=t.getPos();t.writeUint32(0),t.writeUint32((0,a.A)("ftyp")),t.writeUint32(e.majorBrand||(0,a.A)("isom")),t.writeUint32(e.minorVersion||512),o.__(e.compatibleBrand,(e=>{t.writeUint32(e)})),function(t,e,r){const i=t.getPointer();t.seekInline(e),t.writeUint32(r),t.seekInline(i)}(t,r,Number(t.getPos()-i)),e.isom?(t.writeUint32(8),t.writeUint32((0,a.A)("wide"))):e.fragment||(t.writeUint32(8),t.writeUint32((0,a.A)("free")))}function m(t,e,r,i){o.__(e,(e=>{if(!e)return!0;if(c.A[e.type])c.A[e.type](t,r,i);else if(e.children){const s=t.getPos();t.writeUint32(0),t.writeUint32((0,a.A)(e.type)),m(t,e.children,r,i),i.boxsPositionInfo.push({pos:s,type:e.type,size:Number(t.getPos()-s)})}else!function(t,e){const r=o.zy(n._l,e);t.writeUint32(r?12:8),t.writeUint32((0,a.A)(e)),r&&t.writeUint32(0)}(t,e.type)}))}function g(t,e,r){const n=t.getPos();if(t.writeUint32(0),t.writeUint32((0,a.A)("moov")),c.A.mvhd(t,null,r),o.__(e.streams,(e=>{const i=t.getPos();t.writeUint32(0),t.writeUint32((0,a.A)("trak")),m(t,r.fragment?d.Jl[e.codecpar.codecType](r):d.BB[e.codecpar.codecType](r),e,r),r.boxsPositionInfo.push({pos:i,type:"trak",size:Number(t.getPos()-i)})})),r.fragment){const n=t.getPos();t.writeUint32(0),t.writeUint32((0,a.A)("mvex")),o.__(e.streams,(e=>{c.A.trex(t,e,r)})),r.boxsPositionInfo.push({pos:n,type:"mvex",size:Number(t.getPos()-n)}),r.ignoreEncryption||function(t,e,r){const n=[];o.__(e.streams,(t=>{const e=(0,l.Un)(t.codecpar[i.o9]+20,t.codecpar[i.o9]+24,24);e&&(0,u.ZK)((0,f.s3)(s.f[20](e),s.f[25](e+4))).forEach((t=>{(function(t){if(!n.length)return!1;for(let e=0;e<n.length;e++){const r=n[e];if(!o.FB(r.systemId,t.systemId))return!1;if(!r.keyIds||!t.keyIds)return!1;if(r.keyIds.length!==t.keyIds.length)return!1;for(let e=0;e<r.keyIds.length;e++)if(!o.FB(r.keyIds[e],t.keyIds[e]))return!1;if(!o.FB(r.data,t.data))return!1}return!0})(t)||n.push(t)}))})),n.length&&n.forEach((e=>{const i=t.getPos();t.writeUint32(0),t.writeUint32((0,a.A)("pssh")),t.writeUint8(1),t.writeUint24(0),t.writeBuffer(e.systemId),t.writeUint32(e.keyIds.length),e.keyIds.forEach((e=>{t.writeBuffer(e)})),t.writeUint32(e.data.length),t.writeBuffer(e.data),r.boxsPositionInfo.push({pos:i,type:"pssh",size:Number(t.getPos()-i)})}))}(t,e,r)}r.boxsPositionInfo.push({pos:n,type:"moov",size:Number(t.getPos()-n)}),(0,h.A)(t,r)}function v(t,e,r){const i=t.getPos();t.writeUint32(0),t.writeUint32((0,a.A)("moof")),c.A.mfhd(t,null,r),o.__(r.currentFragment.tracks,(i=>{if(!i.sampleCount)return!0;const s=t.getPos();t.writeUint32(0),t.writeUint32((0,a.A)("traf"));const n=e.streams.find((t=>t.privData.trackId===i.trackId));m(t,(0,d.Ip)(i),n,r),r.boxsPositionInfo.push({pos:s,type:"traf",size:Number(t.getPos()-s)})}));const s=Number(t.getPos()-i);r.boxsPositionInfo.push({pos:i,type:"moof",size:s}),r.currentFragment.size=s}function A(t,e,r){let i=24;o.__(r.currentFragment.tracks,(t=>{const r=e.streams.find((e=>e.index===t.streamIndex)).privData;r.fragIndexes.length&&(i+=24+19*r.fragIndexes.length)})),t.writeUint32(i),t.writeString("mfra"),o.__(r.currentFragment.tracks,(r=>{const i=e.streams.find((t=>t.index===r.streamIndex)).privData;i.fragIndexes.length&&(t.writeUint32(24+19*i.fragIndexes.length),t.writeString("tfra"),t.writeUint8(1),t.writeUint24(0),t.writeUint32(r.trackId),t.writeUint32(0),t.writeUint32(i.fragIndexes.length),i.fragIndexes.forEach((e=>{t.writeUint64(e.time),t.writeUint64(e.pos),t.writeUint8(1),t.writeUint8(1),t.writeUint8(1)})))})),t.writeUint32(16),t.writeString("mfro"),t.writeUint32(0),t.writeUint32(i)}},39878:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(14686);function s(t,e,r){var s;t.writeUint32(8+(null!==(s=e.codecpar.extradataSize)&&void 0!==s?s:0)),t.writeString("av1C"),r.fragment&&e.sideData[1]?(t.writeBuffer(e.sideData[1]),delete e.sideData[1]):e.codecpar.extradata&&t.writeBuffer((0,i.s3)(e.codecpar.extradata,e.codecpar.extradataSize))}},61600:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(14686),s=r(60264),a=r(62815);function n(t,e,r){let n;r.fragment&&e.sideData[1]?(n=e.sideData[1],delete e.sideData[1]):e.codecpar.extradata&&(n=(0,i.s3)(e.codecpar.extradata,e.codecpar.extradataSize)),n&&s.Bs(n)&&(n=a.S1(n)),t.writeUint32(8+(n?n.length:0)),t.writeString("avcC"),n&&t.writeBuffer(n)}},93861:(t,e,r)=>{"use strict";function i(t,e,r){t.writeUint32(20),t.writeString("btrt"),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0)}r.d(e,{A:()=>i})},34445:(t,e,r)=>{"use strict";function i(t,e,r){const i=e.privData.chunkOffsets||[];t.writeUint32(16+8*i.length),t.writeString("co64"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(i.length);for(let e=0;e<i.length;e++)t.writeUint64(i[e])}r.d(e,{A:()=>i})},853:(t,e,r)=>{"use strict";function i(t,e,r){const i=e.sideData[28];if(i)t.writeUint32(12+i.length),t.writeString("colr"),t.writeString("prof"),t.writeBuffer(i);else{const r=2===e.codecpar.colorRange;t.writeUint32(19),t.writeString("colr"),t.writeString("nclx"),t.writeUint16(e.codecpar.colorPrimaries),t.writeUint16(e.codecpar.colorTrc),t.writeUint16(e.codecpar.colorSpace),t.writeUint8(r?128:0)}}r.d(e,{A:()=>i})},18387:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(4624);const s="src\\avformat\\formats\\mov\\writing\\ctts.ts";function a(t,e,r){const a=e.privData,n=a.cttsSampleCounts||[],o=a.cttsSampleOffsets||[];n.length!==o.length&&i.R8("ctts sampleCounts's length is not match sampleOffsets's length",s,39);const c=Math.min(n.length,o.length);t.writeUint32(16+8*c),t.writeString("ctts"),t.writeUint8(1),t.writeUint24(0),t.writeUint32(c);for(let e=0;e<c;e++)t.writeUint32(n[e]),t.writeInt32(o[e])}},80648:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(83314);function s(t,e,r){t.writeUint32(11),t.writeString("dac3");const s=new i.A(3),a=r.ac3Info;s.writeU(2,a.substream[0].fscod),s.writeU(5,a.substream[0].bsid),s.writeU(3,a.substream[0].bsmod),s.writeU(3,a.substream[0].acmod),s.writeU(1,a.substream[0].lfeon),s.writeU(5,a.ac3BitrateCode),s.writeU(5,0),t.writeBuffer(s.getBuffer())}},55668:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(83314);function s(t,e,r){const s=r.ac3Info,a=new i.A(2+(34*(s.numIndSub+1)+7>>3));a.writeU(13,s.dataRate),a.writeU(3,s.numIndSub);for(let t=0;t<s.numIndSub;t++)a.writeU(2,s.substream[t].fscod),a.writeU(5,s.substream[t].bsid),a.writeU(1,0),a.writeU(1,0),a.writeU(3,s.substream[t].bsmod),a.writeU(3,s.substream[t].acmod),a.writeU(1,s.substream[t].lfeon),a.writeU(5,0),a.writeU(4,s.substream[t].numDepSub),s.substream[t].numDepSub?a.writeU(9,s.substream[t].chanLoc):a.writeU(1,0);a.padding();const n=a.getPointer();t.writeUint32(8+n),t.writeString("dec3"),t.writeBuffer(a.getBuffer().subarray(0,n))}},47280:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(14686),s=r(4624),a=r(14769);const n="src\\avformat\\formats\\mov\\writing\\dfla.ts";function o(t,e,r){let o;r.fragment&&e.sideData[1]?(o=e.sideData[1],delete e.sideData[1]):e.codecpar.extradata&&(o=(0,i.s3)(e.codecpar.extradata,e.codecpar.extradataSize)),o&&o.length===a.ob?(t.writeUint32(o.length+16),t.writeString("dfLa"),t.writeUint8(0),t.writeUint24(0),t.writeUint8(128),t.writeUint24(o.length),t.writeBuffer(o)):s.z3("invalid extradata",n,57)}},82181:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(14686),s=r(31865);function a(t,e,r){let a;if(r.fragment&&e.sideData[1]?(a=e.sideData[1],delete e.sideData[1]):e.codecpar.extradata&&(a=(0,i.s3)(e.codecpar.extradata,e.codecpar.extradataSize)),!a||a.length<19)t.writeUint32(19),t.writeString("dOps"),t.writeUint8(0),t.writeUint8(e.codecpar.chLayout.nbChannels),t.writeUint16(e.codecpar.initialPadding),t.writeUint32(e.codecpar.sampleRate),t.writeUint16(0),t.writeUint8(0);else{const e=new s.A(a,!1);t.writeUint32(a.length),t.writeString("dOps"),t.writeUint8(0),e.seek(9),t.writeUint8(e.readUint8()),t.writeUint16(e.readUint16()),t.writeUint32(e.readUint32()),t.writeUint16(e.readUint16()),t.writeBuffer(a.subarray(18))}}},12412:(t,e,r)=>{"use strict";function i(t,e,r){t.writeUint32(28),t.writeString("dref"),t.writeUint32(0),t.writeUint32(1),t.writeUint32(12),t.writeString("url "),t.writeUint32(1)}r.d(e,{A:()=>i})},44473:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(77231),s=r(44328),a=r(14041);function n(t,e,r){const n=e.privData;let o=(0,s.k)((0,a.A)(n),e.timeBase,{den:r.timescale,num:1}),c=n.startCT;const d=(0,s.k)(n.startDts+BigInt(Math.floor(c)),e.timeBase,{den:r.timescale,num:1});let h=o<i.go?0:1;h|=d<i.go?0:1;const l=1+(d>0?1:0),u=24+l*(1===h?20:12);t.writeUint32(u),t.writeString("edts"),t.writeUint32(u-8),t.writeString("elst"),t.writeUint8(h),t.writeUint24(0),t.writeUint32(l),d>0?(1===h?(t.writeUint64(d),t.writeInt64(i.Dh)):(t.writeUint32(Number(d)),t.writeInt32(-1)),t.writeUint32(65536)):(c=-Math.min(Number(n.startDts),0),o+=d),r.fragment&&(o=BigInt(0)),1===h?(t.writeUint64(o),t.writeInt64(BigInt(Math.floor(c)))):(t.writeUint32(Number(o)),t.writeInt32(c)),t.writeUint32(65536)}},4652:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(6660),s=r(14686);function a(t,e,r){t.writeUint8(e);for(let e=3;e>0;e--)t.writeUint8(r>>7*e|128);t.writeUint8(127&r)}function n(t,e,r){const n=e.privData,o=e.codecpar.extradata?5+e.codecpar.extradataSize:0,c=t.getPos();t.writeUint32(0),t.writeString("esds"),t.writeUint32(0),a(t,3,21+o+5+1),t.writeUint16(n.trackId),t.writeUint8(0),a(t,4,13+o),(86016===e.codecpar.codecId||86017===e.codecpar.codecId)&&e.codecpar.sampleRate>24e3?t.writeUint8(107):t.writeUint8(i.zs[e.codecpar.codecId]),94208===e.codecpar.codecId?t.writeUint8(225):1===e.codecpar.codecType?t.writeUint8(21):t.writeUint8(17),t.writeUint24(0),t.writeUint32(0),t.writeUint32(0),e.codecpar.extradata&&(a(t,5,e.codecpar.extradataSize),t.writeBuffer((0,s.s3)(e.codecpar.extradata,e.codecpar.extradataSize))),a(t,6,1),t.writeUint8(2),r.boxsPositionInfo.push({pos:c,type:"esds",size:Number(t.getPos()-c)})}},87384:(t,e,r)=>{"use strict";function i(t,e,r,i,s,a,n){t.writeInt32(Math.floor(65536*e)),t.writeInt32(Math.floor(65536*r)),t.writeInt32(0),t.writeInt32(Math.floor(65536*i)),t.writeInt32(Math.floor(65536*s)),t.writeInt32(0),t.writeInt32(Math.floor(65536*a)),t.writeInt32(Math.floor(65536*n)),t.writeInt32(1073741824)}r.d(e,{A:()=>i})},17923:(t,e,r)=>{"use strict";function i(t,e,r){const i=t.getPos();t.writeUint32(0),t.writeString("hdlr"),t.writeUint8(0),t.writeUint24(0);let s="dhlr",a="url ",n="DataHandler";e&&(s="mhlr",1===e.codecpar.codecType?(a="soun",n="SoundHandler"):0===e.codecpar.codecType?(a="vide",n="VideoHandler"):3===e.codecpar.codecType?(a="text",n="SubtitleHandler"):(e.metadata.handlerName&&(n=e.metadata.handlerName),e.metadata.hdlrType&&(a=e.metadata.hdlrType))),t.writeString(s),t.writeString(a),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),e&&!r.isom||t.writeUint8(n.length),t.writeString(n),e&&!r.isom&&t.writeUint8(0),r.boxsPositionInfo.push({pos:i,type:"hdlr",size:Number(t.getPos()-i)})}r.d(e,{A:()=>i})},78669:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(14686),s=r(60264),a=r(67659);function n(t,e,r){let n;r.fragment&&e.sideData[1]?(n=e.sideData[1],delete e.sideData[1]):e.codecpar.extradata&&(n=(0,i.s3)(e.codecpar.extradata,e.codecpar.extradataSize)),n&&s.Bs(n)&&(n=a.S1(n)),t.writeUint32(8+(n?n.length:0)),t.writeString("hvcC"),n&&t.writeBuffer(n)}},6e3:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(77231),s=r(14041);function a(t,e,r){const a=e.privData,n=(0,s.A)(a),o=e.metadata.creationTime||0,c=e.metadata.modificationTime||0,d=e.metadata.language||21956;let h=n<BigInt(i.f7)?0:1;h=o<i.f7?0:1,h=c<i.f7?0:1,t.writeUint32(1===h?44:32),t.writeString("mdhd"),t.writeUint8(h),t.writeUint24(0),1===h?(t.writeUint64(o),t.writeUint64(c)):(t.writeUint32(Number(o)),t.writeUint32(Number(c))),t.writeUint32(e.timeBase.den),1===h?t.writeUint64(n):t.writeUint32(Number(n)),t.writeUint16(d),t.writeUint16(0)}},31130:(t,e,r)=>{"use strict";function i(t,e,r){t.writeUint32(16),t.writeString("mfhd"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(r.currentFragment.sequence)}r.d(e,{A:()=>i})},48669:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(17923);function s(t,e,r){(0,i.A)(t,null,r)}},7114:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(77231),s=r(87384);function a(t,e,r){const a=r.duration,n=r.creationTime||0,o=r.modificationTime||0,c=r.timescale||0;let d=r.nextTrackId||1;r.fragment&&(d=2);let h=a<BigInt(i.f7)?0:1;h=n<i.f7?0:1,h=o<i.f7?0:1,t.writeUint32(1===h?120:108),t.writeString("mvhd"),t.writeUint8(h),t.writeUint24(0),1===h?(t.writeUint64(n),t.writeUint64(o)):(t.writeUint32(Number(n)),t.writeUint32(Number(o))),t.writeUint32(c),1===h?t.writeUint64(a):t.writeUint32(Number(a)),t.writeUint32(65536),t.writeUint16(256),t.writeUint16(0),t.writeUint32(0),t.writeUint32(0),(0,s.A)(t,1,0,0,1,0,0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(d)}},65629:(t,e,r)=>{"use strict";function i(t,e,r){t.writeUint32(16),t.writeString("pasp"),t.writeUint32(1),t.writeUint32(1)}r.d(e,{A:()=>i})},37241:(t,e,r)=>{"use strict";function i(t,e,r){const i=r.currentFragment.tracks.find((t=>t.trackId===e.privData.trackId));t.writeUint32(20),t.writeString("saio"),t.writeUint32(0),t.writeUint32(1),i.cenc.offsetPos=t.getPos(),t.writeUint32(0)}r.d(e,{A:()=>i})},32366:(t,e,r)=>{"use strict";function i(t,e,r){const i=r.currentFragment.tracks.find((t=>t.trackId===e.privData.trackId)),s=t.getPos();t.writeUint32(0),t.writeString("saiz"),t.writeUint32(0),t.writeUint8(i.cenc.sampleSizes.length?0:i.cenc.defaultSampleInfoSize),t.writeUint32(i.cenc.sampleCount),i.cenc.sampleSizes.length&&i.cenc.sampleSizes.forEach((e=>{t.writeUint8(e)})),r.boxsPositionInfo.push({pos:s,type:"saiz",size:Number(t.getPos()-s)})}r.d(e,{A:()=>i})},90842:(t,e,r)=>{"use strict";function i(t,e,r){const i=r.currentFragment.tracks.find((t=>t.trackId===e.privData.trackId)),s=r.cencs?r.cencs[i.trackId]:null,a=t.getPos();t.writeUint32(0),t.writeString("senc"),t.writeUint32(i.cenc.useSubsamples?2:0),t.writeUint32(i.cenc.sampleEncryption.length),i.cenc.offset=Number(t.getPos()-r.currentFragment.pos),i.cenc.sampleEncryption.forEach((e=>{s.defaultPerSampleIVSize&&t.writeBuffer(e.iv),i.cenc.useSubsamples&&(t.writeUint16(e.subsamples.length),e.subsamples.forEach((e=>{t.writeUint16(e.bytesOfClearData),t.writeUint32(e.bytesOfProtectedData)})))})),r.boxsPositionInfo.push({pos:a,type:"senc",size:Number(t.getPos()-a)})}r.d(e,{A:()=>i})},11573:(t,e,r)=>{"use strict";function i(t,e,r){t.writeUint32(16),t.writeString("smhd"),t.writeUint32(0),t.writeUint16(0),t.writeUint16(0)}r.d(e,{A:()=>i})},2204:(t,e,r)=>{"use strict";function i(t,e,r){const i=e.privData.chunkOffsets||[];t.writeUint32(16+4*i.length),t.writeString("stco"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(i.length);for(let e=0;e<i.length;e++)t.writeUint32(Number(i[e]))}r.d(e,{A:()=>i})},84360:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(4624);const s="src\\avformat\\formats\\mov\\writing\\stsc.ts";function a(t,e,r){const a=e.privData,n=a.stscFirstChunk,o=a.stscSamplesPerChunk,c=a.stscSampleDescriptionIndex;n.length===o.length&&n.length===c.length||i.R8("ctts firstChunk's length is not match samplesPerChunk's length or sampleDescriptionIndex's length",s,42);const d=Math.min(n.length,o.length,c.length);t.writeUint32(16+12*d),t.writeString("stsc"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(d);for(let e=0;e<d;e++)t.writeUint32(n[e]),t.writeUint32(o[e]),t.writeUint32(c[e])}},69301:(t,e,r)=>{"use strict";r.d(e,{A:()=>S});var i=r(61600),s=r(78669),a=r(1263),n=r(99193),o=r(39878),c=r(47280),d=r(82181),h=r(4652),l=r(853),u=r(65629),f=r(93861),p=r(57756),m=r(80648),g=r(55668),v=r(14686),A=r(61619),y=r(65977);const b={27:"avc1",173:"hvc1",196:"vvc1",225:"av01",167:"vp09",86019:"ac-3",86056:"ec-3"};function w(t){if(t.codecTag)return(0,A.A)(t.codecTag);let e=b[t.codecId];return e||(e=0===t.codecType?"mp4v":1===t.codecType?86076===t.codecId?"Opus":86028===t.codecId?"fLaC":"mp4a":3===t.codecType?"text":"none"),e}function k(t,e,r){const i=e.privData,s=r.cencs[i.trackId],a=t.getPos();t.writeUint32(0),t.writeString("sinf"),t.writeUint32(12),t.writeString("frma"),t.writeString(w(e.codecpar)),t.writeUint32(20),t.writeString("schm"),t.writeUint32(0),t.writeUint32(s.schemeType||(0,y.A)("cenc")),t.writeUint32(s.schemeVersion||65536),t.writeUint32(16+s.defaultKeyId.length+8+(s.defaultConstantIV?1+s.defaultConstantIV.length:0)),t.writeString("schi"),t.writeUint32(16+s.defaultKeyId.length+(s.defaultConstantIV?1+s.defaultConstantIV.length:0)),t.writeString("tenc"),s.cryptByteBlock||s.skipByteBlock||s.pattern?t.writeUint8(1):t.writeUint8(0),t.writeUint24(0),t.writeUint8(0),t.writeUint8((15&(s.cryptByteBlock||0))<<4|15&(s.skipByteBlock||0)),t.writeUint8(1),t.writeUint8(s.defaultPerSampleIVSize),t.writeBuffer(s.defaultKeyId),s.defaultConstantIV&&(t.writeUint8(s.defaultConstantIV.length),t.writeBuffer(s.defaultConstantIV)),r.boxsPositionInfo.push({pos:a,type:"sinf",size:Number(t.getPos()-a)})}function x(t,e,r){const i=r.isom?1:0;t.writeUint32(0),t.writeUint16(0),t.writeUint16(1),t.writeUint16(i),t.writeUint16(0),t.writeUint32(0),r.isom?(t.writeUint16(e.codecpar.chLayout.nbChannels),65541===e.codecpar.codecId||65540===e.codecpar.codecId?t.writeUint16(8):69643===e.codecpar.codecId?t.writeUint16(e.codecpar.bitsPerCodedSample):t.writeUint16(16),t.writeUint16(-2)):(86028===e.codecpar.codecId||86032===e.codecpar.codecId||86076===e.codecpar.codecId?t.writeUint16(e.codecpar.chLayout.nbChannels):t.writeUint16(2),86028===e.codecpar.codecId||86032===e.codecpar.codecId?t.writeUint16(e.codecpar.bitsPerRawSample):t.writeUint16(16),t.writeUint16(0)),t.writeUint16(0),86076===e.codecpar.codecId?t.writeUint16(48e3):86060===e.codecpar.codecId?t.writeUint32(e.codecpar.sampleRate):t.writeUint16(e.codecpar.sampleRate),86060!==e.codecpar.codecId&&t.writeUint16(0),1===i&&(t.writeUint32(e.codecpar.frameSize),t.writeUint32(0),t.writeUint32(0),t.writeUint32(2))}function I(t,e,r){const i=w(e.codecpar);!r.isom||86018!==e.codecpar.codecId&&86019!==e.codecpar.codecId&&86056!==e.codecpar.codecId&&73728!==e.codecpar.codecId&&86032!==e.codecpar.codecId&&69638!==e.codecpar.codecId&&69633!==e.codecpar.codecId&&86035!==e.codecpar.codecId?86028===e.codecpar.codecId?(0,c.A)(t,e,r):86076===e.codecpar.codecId?(0,d.A)(t,e,r):86019===e.codecpar.codecId?(0,m.A)(t,e,r):86056===e.codecpar.codecId?(0,g.A)(t,e,r):"mp4a"==i&&(0,h.A)(t,e,r):(0,p.A)(t,e,r)}function T(t,e,r){const i=13==e.codecpar.codecId&&15==e.codecpar.format||13==e.codecpar.codecId&&1==e.codecpar.format||202==e.codecpar.codecId||203==e.codecpar.codecId||156==e.codecpar.codecId||127==e.codecpar.codecId;t.writeUint32(0),t.writeUint16(0),t.writeUint16(1),t.writeUint16(i?2:0),t.writeUint16(0),r.isom?(t.writeString("FFMP"),13===e.codecpar.codecId||i?(t.writeUint32(0),t.writeUint32(1024)):(t.writeUint32(512),t.writeUint32(512))):(t.writeUint32(0),t.writeUint32(0),t.writeUint32(0)),t.writeUint16(e.codecpar.width),t.writeUint16(e.codecpar.height),t.writeUint32(4718592),t.writeUint32(4718592),t.writeUint32(0),t.writeUint16(1);let s=e.metadata.compressorName||"";if(s=s.slice(0,31),t.writeUint8(s.length),t.writeString(s),s.length<31){let e=31-s.length;for(;e>0;)t.writeUint8(0),e--}r.isom&&e.codecpar.bitsPerCodedSample?t.writeUint16(e.codecpar.bitsPerCodedSample):t.writeUint16(24),t.writeUint16(65535)}function P(t,e,r){"mp4v"===w(e.codecpar)?(0,h.A)(t,e,r):27===e.codecpar.codecId?(0,i.A)(t,e,r):173===e.codecpar.codecId?(0,s.A)(t,e,r):196===e.codecpar.codecId?(0,a.A)(t,e,r):167===e.codecpar.codecId?(0,n.A)(t,e,r):225===e.codecpar.codecId&&(0,o.A)(t,e,r)}function S(t,e,r){const i=t.getPos();t.writeUint32(0),t.writeString("stsd");const s=e.privData,a=r.cencs&&r.cencs[s.trackId]&&(1===e.codecpar.codecType||0===e.codecpar.codecType)&&!r.ignoreEncryption;t.writeUint8(0),t.writeUint24(0),t.writeUint32(a?2:1),1===e.codecpar.codecType?(a&&function(t,e,r){const i=t.getPos();t.writeUint32(0),t.writeString("enca"),x(t,e,r),k(t,e,r),I(t,e,r),r.boxsPositionInfo.push({pos:i,type:"enca",size:Number(t.getPos()-i)})}(t,e,r),function(t,e,r){const i=t.getPos(),s=w(e.codecpar);t.writeUint32(0),t.writeString(s),x(t,e,r),I(t,e,r),r.isom||(0,f.A)(t,e,r),r.boxsPositionInfo.push({pos:i,type:s,size:Number(t.getPos()-i)})}(t,e,r)):0===e.codecpar.codecType?(a&&function(t,e,r){const i=t.getPos();t.writeUint32(0),t.writeString("encv"),T(t,e,r),k(t,e,r),P(t,e,r),r.boxsPositionInfo.push({pos:i,type:"encv",size:Number(t.getPos()-i)})}(t,e,r),function(t,e,r){const i=t.getPos(),s=w(e.codecpar);t.writeUint32(0),t.writeString(s),T(t,e,r),P(t,e,r),(0,l.A)(t,e,r),(0,u.A)(t,e,r),r.isom||(0,f.A)(t,e,r),r.boxsPositionInfo.push({pos:i,type:s,size:Number(t.getPos()-i)})}(t,e,r)):3===e.codecpar.codecType&&function(t,e,r){const i=t.getPos(),s=w(e.codecpar);t.writeUint32(0),t.writeString(s),t.writeUint32(0),t.writeUint16(0),t.writeUint16(1),94208===e.codecpar.codecId?(0,h.A)(t,e,r):e.codecpar.extradata&&t.writeBuffer((0,v.s3)(e.codecpar.extradata,e.codecpar.extradataSize)),r.isom||(0,f.A)(t,e,r),r.boxsPositionInfo.push({pos:i,type:s,size:Number(t.getPos()-i)})}(t,e,r),r.boxsPositionInfo.push({pos:i,type:"esds",size:Number(t.getPos()-i)})}},20184:(t,e,r)=>{"use strict";function i(t,e,r){const i=e.privData.stssSampleNumbers;t.writeUint32(16+4*i.length),t.writeString("stss"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(i.length);for(let e=0;e<i.length;e++)t.writeUint32(i[e])}r.d(e,{A:()=>i})},57247:(t,e,r)=>{"use strict";function i(t,e,r){const i=e.privData.sampleSizes;t.writeUint32(20+4*i.length),t.writeString("stsz"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(0),t.writeUint32(i.length);for(let e=0;e<i.length;e++)t.writeUint32(i[e])}r.d(e,{A:()=>i})},86051:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(4624);const s="src\\avformat\\formats\\mov\\writing\\stts.ts";function a(t,e,r){const a=e.privData,n=a.sttsSampleCounts||[],o=a.sttsSampleDeltas||[];n.length!==o.length&&i.R8("stts sampleCounts's length is not match sampleDeltas's length",s,39);const c=Math.min(n.length,o.length);t.writeUint32(16+8*c),t.writeString("stts"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(c);for(let e=0;e<c;e++)t.writeUint32(n[e]),t.writeInt32(o[e])}},11251:(t,e,r)=>{"use strict";function i(t,e,r){const i=r.currentFragment.tracks.find((t=>t.trackId===e.privData.trackId)),s=i?i.baseMediaDecodeTime:BigInt(0);t.writeUint32(20),t.writeString("tfdt"),t.writeUint8(1),t.writeUint24(0),t.writeUint64(s)}r.d(e,{A:()=>i})},11903:(t,e,r)=>{"use strict";function i(t,e,r){const i=r.currentFragment.tracks.find((t=>t.trackId===e.privData.trackId));let s=57;i.baseIsMoof&&(s&=-2,s|=131072);const a=t.getPos();t.writeUint32(0),t.writeString("tfhd"),t.writeUint8(0),t.writeUint24(s),t.writeUint32(i.trackId),1&s&&t.writeUint64(i.baseDataOffset),8&s&&t.writeUint32(i.defaultSampleDuration),16&s&&t.writeUint32(i.defaultSampleSize),32&s&&t.writeUint32(i.defaultSampleFlags),r.boxsPositionInfo.push({pos:a,type:"tfhd",size:Number(t.getPos()-a)})}r.d(e,{A:()=>i})},59868:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(77231),s=r(87384),a=r(44328),n=r(14041);function o(t,e,r){const o=e.privData,c=(0,a.k)((0,n.A)(o),e.timeBase,{den:r.timescale,num:1}),d=e.metadata.creationTime||0,h=e.metadata.modificationTime||0,l=o.layer||0,u=o.alternateGroup||0;let f=e.codecpar.width>0?e.codecpar.width:0,p=e.codecpar.height>0?e.codecpar.height:0;const m=(0,a.lb)(e.codecpar.sampleAspectRatio);0!==m&&m!==1/0&&(f=Math.floor(f*m)),f<i.zg&&(f<<=16),p<i.zg&&(p<<=16);let g=c<BigInt(i.f7)?0:1;g=d<i.f7?0:1,g=h<i.f7?0:1;let v=2;1&o.flags&&(v|=1),t.writeUint32(1===g?100:92),t.writeString("tkhd"),t.writeUint8(g),t.writeUint24(v),1===g?(t.writeUint64(d),t.writeUint64(h)):(t.writeUint32(Number(d)),t.writeUint32(Number(h))),t.writeUint32(o.trackId),t.writeUint32(0),1===g?t.writeUint64(c):t.writeUint32(Number(c)),t.writeUint32(0),t.writeUint32(0),t.writeInt16(l),t.writeInt16(o.perStreamGrouping?u:e.codecpar.codecType),1===e.codecpar.codecType?t.writeInt16(256):t.writeInt16(0),t.writeInt16(0);const A=e.metadata.matrix;A?(0,s.A)(t,A[0],A[1],A[3],A[4],A[6],A[7]):(0,s.A)(t,1,0,0,1,0,0),t.writeUint32(f),t.writeUint32(p)}},35010:(t,e,r)=>{"use strict";function i(t,e,r){var i,s,a;const n=r.currentFragment.tracks.find((t=>t.trackId===e.privData.trackId)),o=r.trexs.find((t=>{t.trackId,e.privData.trackId})),c=null!==(i=null==o?void 0:o.duration)&&void 0!==i?i:0,d=null!==(s=null==o?void 0:o.size)&&void 0!==s?s:0,h=null!==(a=null==o?void 0:o.flags)&&void 0!==a?a:0;t.writeUint32(32),t.writeString("trex"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(n.trackId),t.writeUint32(1),t.writeUint32(c),t.writeUint32(d),t.writeUint32(h)}r.d(e,{A:()=>i})},48516:(t,e,r)=>{"use strict";function i(t,e,r){const i=e.privData,s=r.currentFragment.tracks.find((t=>t.trackId===i.trackId)),a=s.firstSampleFlags||0,n=s.dataOffset||0,o=s.sampleDurations,c=s.sampleSizes,d=s.sampleFlags,h=s.sampleCompositionTimeOffset,l=s.sampleCount,u=o.length>0,f=c.length>0,p=d.length>0,m=h.length>0,g=0!==a;let v=1;g&&(v|=4),u&&(v|=256),f&&(v|=512),p&&(v|=1024),m&&(v|=2048);const A=t.getPos();t.writeUint32(0),t.writeString("trun"),t.writeUint8(1),t.writeUint24(v),t.writeUint32(l),s.dataOffsetPos=t.getPos(),t.writeInt32(n),g&&t.writeUint32(a);for(let e=0;e<l;e++)u&&t.writeUint32(o[e]||0),f&&t.writeUint32(c[e]||0),p&&t.writeUint32(d[e]||0),m&&t.writeInt32(h[e]||0);r.boxsPositionInfo.push({pos:A,type:"trun",size:Number(t.getPos()-A)})}r.d(e,{A:()=>i})},54012:(t,e,r)=>{"use strict";function i(t,e,r){t.writeUint32(20),t.writeString("vmhd"),t.writeUint8(0),t.writeUint24(1),t.writeUint64(BigInt(0))}r.d(e,{A:()=>i})},99193:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(14686);function s(t,e,r){var s;t.writeUint32(12+(null!==(s=e.codecpar.extradataSize)&&void 0!==s?s:0)),t.writeString("vpcC"),t.writeUint8(1),t.writeUint24(0),r.fragment&&e.sideData[1]?(t.writeBuffer(e.sideData[1]),delete e.sideData[1]):e.codecpar.extradata&&t.writeBuffer((0,i.s3)(e.codecpar.extradata,e.codecpar.extradataSize))}},1263:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(14686),s=r(60264),a=r(59166);function n(t,e,r){let n;r.fragment&&e.sideData[1]?(n=e.sideData[1],delete e.sideData[1]):e.codecpar.extradata&&(n=(0,i.s3)(e.codecpar.extradata,e.codecpar.extradataSize)),n&&s.Bs(n)&&(n=a.S1(n)),t.writeUint32(12+(n?n.length:0)),t.writeString("vvcC"),t.writeUint8(0),t.writeUint24(0),n&&t.writeBuffer(n)}},57756:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(14686),s=r(4652);function a(t,e,r){const a=t.getPos();t.writeUint32(0),t.writeString("wave"),86035!==e.codecpar.codecId&&(t.writeUint32(12),t.writeString("frma"),t.writeUint32(e.codecpar.codecTag)),86018===e.codecpar.codecId?(t.writeUint32(12),t.writeString("mp4a"),t.writeUint32(0),(0,s.A)(t,e,r)):r.fragment&&e.sideData[1]?(t.writeBuffer(e.sideData[1]),delete e.sideData[1]):e.codecpar.extradata&&t.writeBuffer((0,i.s3)(e.codecpar.extradata,e.codecpar.extradataSize)),t.writeUint32(8),t.writeUint32(0),r.boxsPositionInfo.push({pos:a,type:"wave",size:Number(t.getPos()-a)})}},80025:(t,e,r)=>{"use strict";r.d(e,{A:()=>_});var i=r(86051),s=r(18387),a=r(20184),n=r(57247),o=r(84360),c=r(2204),d=r(34445),h=r(6e3),l=r(7114),u=r(59868),f=r(17923),p=r(69301),m=r(54012),g=r(44473),v=r(11573),A=r(12412),y=r(35010),b=r(31130),w=r(11903),k=r(11251),x=r(48516),I=r(48669),T=r(32366),P=r(37241),S=r(90842);const _={stts:i.A,ctts:s.A,stss:a.A,stsz:n.A,stsc:o.A,stco:c.A,co64:d.A,mdhd:h.A,mvhd:l.A,tkhd:u.A,hdlr:f.A,stsd:p.A,vmhd:m.A,edts:g.A,smhd:v.A,dref:A.A,trex:y.A,mfhd:b.A,tfhd:w.A,tfdt:k.A,trun:x.A,minf_hdlr:I.A,saio:P.A,saiz:T.A,senc:S.A}},59989:(t,e,r)=>{"use strict";function i(t,e=0){if(!t)return!1;if(t.length<2)return!0;let r=t[e],i=e+1;for(;i<t.length&&r===t[i];i++);return i===t.length}r.d(e,{A:()=>i})},31425:(t,e,r)=>{"use strict";r.d(e,{$:()=>n});var i=r(77231),s=r(72739),a=r(44328);function n(t){let e=!0;return s.__(t.streams,(t=>{switch(t.codecpar.codecType){case 1:t.codecpar.chLayout.nbChannels!==i.N_&&t.codecpar.sampleRate!==i.N_&&t.codecpar.frameSize!==i.N_&&t.codecpar.bitrate!==BigInt(0)||(e=!1);break;case 0:0!==(0,a.lb)(t.codecpar.framerate)&&t.codecpar.width!==i.N_&&t.codecpar.height!==i.N_&&t.codecpar.bitrate!==BigInt(0)||(e=!1),27!==t.codecpar.codecId&&173!==t.codecpar.codecId&&196!==t.codecpar.codecId&&12!==t.codecpar.codecId||t.codecpar.profile!==i.N_&&t.codecpar.level!==i.N_||(e=!1)}})),e}},61619:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(67672);function s(t,e=4){let r="";for(let s=0;s<e;s++)i.ai(t)?(r=String.fromCharCode(255&t)+r,t>>>=8):(r=String.fromCharCode(Number(t&BigInt(255)))+r,t>>=BigInt(8));return r}},55680:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(72739);function s(t){if(t.length<2)return 0;const e=t.slice().sort(((t,e)=>t>e?1:-1));let r=0,s=0,a=[];for(let n=0;n<t.length;n++){for(i._(a,t[n],(e=>e<t[n]?1:-1));a.length&&a[0]===e[s];)a.shift(),s++;r=Math.max(r,a.length)}return r}},89478:(t,e,r)=>{"use strict";function i(t,e){if(e.length<t)return e.slice().sort(((t,e)=>t>e?1:-1));const r=[],i=e.slice().sort(((t,e)=>t>e?1:-1));if(t){const e=i[i.length-1]-i[i.length-2];for(let s=t;s>0;s--)r.push((r.length?r[r.length-1]:BigInt(0))+(s>=i.length?e:i[s]-i[s-1]));r.reverse()}const s=[];for(let e=0;e<t;e++)s.push(i[0]-r[e]);return s.concat(i)}r.d(e,{A:()=>i})},65977:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(4624);const s="src\\avformat\\function\\mktag.ts";function a(t){4!==t.length&&i.R8(`tag length is not 4, tag: ${t}`,s,30);let e=0;for(let r=0;r<4;r++)e=e<<8|t.charCodeAt(r);return e}},20841:(t,e,r)=>{"use strict";function i(t,e,r,i){const s=t.getPos(),a=t.getPointer(),n=s-BigInt(Math.floor(a));let o=!1;switch(e<s&&e>=n?(t.seekInline(a+Number(e-s)),o=!0):t.seek(e),i){case"uint8":t.writeUint8(255&r);break;case"int8":t.writeInt8(r);break;case"uint16":t.writeUint16(65535&r);break;case"int16":t.writeInt16(r);break;case"uint32":t.writeUint32(r>>>0);break;case"int32":t.writeInt32(r);break;case"uint64":t.writeUint64(BigInt.asUintN(64,r));break;case"int64":t.writeInt64(r);break;case"float":t.writeFloat(r);break;case"double":t.writeDouble(r)}o?t.seekInline(a):t.seek(s)}r.d(e,{A:()=>i})},31633:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(44328);const s=399;function a(t){return t<360?1001*(t+1):(t-=360)<30?1001*(t+31)*12:(t-=30)<3?1001*[80,120,240][t]*12:1e3*[24,30,60,12,15,48][t-=3]*12}function n(t){let e=0,r=.01;for(let n=0;n<s;n++){const s=Math.abs((0,i.lb)(t)/(0,i.lb)({num:a(n),den:12012})-1);s<r&&(r=s,e=a(n))}if(e){const r={num:e,den:12012};(0,i.iU)(r),t.num=r.num,t.den=r.den}}},92174:(t,e,r)=>{"use strict";r.d(e,{XA:()=>y,bX:()=>w,bx:()=>A,dJ:()=>b,ho:()=>v});var i=r(80662),s=r.n(i),a=r(63939),n=r(50932),o=r(95335),c=r(4624),d=r(51597),h=r(72739),l=r(9705),u=r(548),f=r(77231),p=r(43607);const m="src\\avformat\\mux.ts",g={zeroStart:!1,nonnegative:!1};function v(t,e={}){const r=o.X$({},g,e);t.ioWriter||c.h2("need ioWriter",m,58),t.oformat||c.h2("need oformat",m,61),t.options=r,t.privateData2={firstPts:new(s()),firstDts:new(s()),dtsPtsDelta:new(s())};let i=d.E[t.oformat.type];if(i)for(let e=0;e<t.streams.length;e++){const r=t.streams[e].codecpar.codecId,s=t.streams[e].codecpar.codecType;if(16===t.oformat.type){if(r<65536||r>69683)return c.z3(`format ${(0,u.L_)(t.oformat.type)} not support codecId ${(0,u.eG)(t.streams[e].codecpar.codecType,r)}`,m,80),l.r8}else if(2!==s&&4!==s&&!h.zy(i,r))return c.z3(`format ${(0,u.L_)(t.oformat.type)} not support codecId ${(0,u.eG)(t.streams[e].codecpar.codecType,r)}`,m,88),l.r8}return t.oformat.init(t)}function A(t){return t.oformat.writeHeader(t),0}function y(t,e){const r=t.privateData2;return r.firstDts.has(a.f[15](e+32))||r.firstDts.set(a.f[15](e+32),a.f[17](e+16)===f.Dh?BigInt(0):a.f[17](e+16)),r.firstPts.has(a.f[15](e+32))||(r.firstPts.set(a.f[15](e+32),a.f[17](e+8)===f.Dh?BigInt(0):a.f[17](e+8)),r.dtsPtsDelta.set(a.f[15](e+32),p.jk(r.firstDts.get(a.f[15](e+32)),r.firstPts.get(a.f[15](e+32))))),(t.options.zeroStart||t.options.nonnegative&&(r.firstDts.get(a.f[15](e+32))<0||r.firstPts.get(a.f[15](e+32))<0))&&(n.M[17](e+16,a.f[17](e+16)-r.dtsPtsDelta.get(a.f[15](e+32))),n.M[17](e+8,a.f[17](e+8)-r.dtsPtsDelta.get(a.f[15](e+32)))),t.oformat.writeAVPacket(t,e)}function b(t){return t.oformat.writeTrailer(t),0}function w(t){t.oformat.flush(t)}},49847:(t,e,r)=>{"use strict";r.d(e,{A:()=>i});class i{constructor(){}get ext(){throw new Error("need implemented ext getter")}get flags(){return 0}get name(){return"CustomIOLoader."+Math.random()}get minBuffer(){return 4}write(t){throw new Error("need implemented write function")}}},77580:(t,e,r)=>{"use strict";r.d(e,{A:()=>u});var i=r(134),s=r(29967),a=r.n(s),n=r(13724),o=r(82800),c=r(95335),d=r(4624),h=r(9705);const l="src\\avnetwork\\ioLoader\\FetchIOLoader.ts";class u extends o.A{constructor(t={}){super(t),(0,i.A)(this,"contentLength",void 0),(0,i.A)(this,"receivedLength",void 0),(0,i.A)(this,"info",void 0),(0,i.A)(this,"range",void 0),(0,i.A)(this,"startBytes",void 0),(0,i.A)(this,"endBytes",void 0),(0,i.A)(this,"eofIndex",void 0),(0,i.A)(this,"abortController",void 0),(0,i.A)(this,"reader",void 0),(0,i.A)(this,"buffers",void 0),(0,i.A)(this,"supportRange",void 0),(0,i.A)(this,"abortSleep_",void 0),(0,i.A)(this,"aborted",void 0)}async getTotalSize(t,e={}){var r,i,s;const n={method:t,headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};null!==(r=this.info.httpOptions)&&void 0!==r&&r.headers&&c.__(this.info.httpOptions.headers,((t,e)=>{n.headers[e]=t})),c.__(e,((t,e)=>{n.headers[e]=t})),null!==(i=this.info.httpOptions)&&void 0!==i&&i.credentials&&(n.credentials=this.info.httpOptions.credentials),null!==(s=this.info.httpOptions)&&void 0!==s&&s.referrerPolicy&&(n.referrerPolicy=this.info.httpOptions.referrerPolicy),"function"==typeof AbortController&&(this.abortController=new AbortController,n.signal=this.abortController.signal);try{const t=await fetch(this.info.url,n);if(t.ok&&t.status>=200&&t.status<=299){this.abortController&&(this.abortController.abort(),this.abortController=null);const e=t.headers.get("Accept-Ranges");e&&-1===e.indexOf("bytes")&&(this.supportRange=!1);const r=t.headers.get("Content-Range");if(r){const t=r.split("/")[1];if(t)return a()(t)}const i=t.headers.get("X-Content-Length")||t.headers.get("Content-Length");if(null!=i)return a()(i)}}catch(t){}return 0}async open(t,e={from:0,to:-1}){var r;if(this.info=t,this.range=e,this.range.to||(this.range.to=-1),this.range.from=Math.max(this.range.from,0),this.eofIndex<0&&(this.eofIndex=e.to),this.startBytes=0,this.endBytes=-1,this.receivedLength=0,this.buffers=[],this.supportRange=!0,this.aborted=!1,this.range&&!this.options.isLive&&(this.startBytes=null!==(r=this.range.from)&&void 0!==r?r:0),this.status=1,!this.options.isLive&&!this.options.disableSegment){let t=await this.getTotalSize("HEAD");t||(t=await this.getTotalSize("Get",{range:"bytes=0-1"})),t<=2&&(t=0),t?(this.contentLength=t,this.range.to<0&&(this.eofIndex=this.contentLength+this.range.to),this.supportRange&&(this.endBytes=Math.min(this.startBytes+this.options.preload-1,this.eofIndex))):this.endBytes=-1}return this.status=2,0}async openReader(){var t,e,r;const i={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};null!==(t=this.info.httpOptions)&&void 0!==t&&t.headers&&c.__(this.info.httpOptions.headers,((t,e)=>{i.headers[e]=t})),this.options.isLive||this.options.disableSegment||(i.headers.range=`bytes=${this.startBytes}-${this.endBytes>0?this.endBytes:""}`),null!==(e=this.info.httpOptions)&&void 0!==e&&e.credentials&&(i.credentials=this.info.httpOptions.credentials),null!==(r=this.info.httpOptions)&&void 0!==r&&r.referrerPolicy&&(i.referrerPolicy=this.info.httpOptions.referrerPolicy),this.abortController&&this.abortController.abort(),"function"==typeof AbortController&&(this.abortController=new AbortController,i.signal=this.abortController.signal);try{const t=await fetch(this.info.url,i);t.ok&&t.status>=200&&t.status<=299?this.reader=t.body.getReader():(this.status=3,d.h2(`FetchStreamLoader: Http code invalid, ${t.status} ${t.statusText}`,l,238))}catch(t){if(this.retryCount<this.options.retryCount&&(!this.options.isLive||!this.receivedLength)){if(this.retryCount++,this.status=1,this.abortSleep_=new n.A(this.options.retryInterval),await this.abortSleep_,this.abortSleep_=null,this.aborted)return;return this.openReader()}d.h2(`FetchStreamLoader: exception ${t.message}`,l,255)}}async readInterval(t,e=0){let r=0;for(;this.buffers.length&&r<t.length;){const e=this.buffers.shift();e.length>t.length-r?(t.set(e.subarray(0,t.length-r),r),this.buffers.unshift(e.subarray(t.length-r)),r=t.length):(t.set(e,r),r+=e.length)}if(r>=t.length)return t.length+e;if(4===this.status)return r>0?r+e:e>0?e:-1048576;if(!this.reader&&(await this.openReader(),this.aborted))return-1048576;const{value:i,done:s}=await this.reader.read();return s?null!==this.contentLength&&this.receivedLength+this.range.from<this.endBytes+1?(this.status=3,void d.h2("Fetch stream meet Early-EOF",l,297)):this.options.isLive||this.options.disableSegment||this.receivedLength+this.range.from>=this.eofIndex?(this.status=4,this.startBytes=0,r>0?r+e:e>0?e:-1048576):(await this.reader.cancel(),this.abortController&&(this.abortController.abort(),this.abortController=null),this.reader=null,this.startBytes=this.endBytes+1,this.endBytes=Math.min(this.startBytes+this.options.preload-1,this.eofIndex),this.readInterval(t.subarray(r,void 0,!0),r)):(this.receivedLength+=i.length,i.length>t.length-r?(t.set(i.subarray(0,t.length-r),r),this.buffers.push(i.subarray(t.length-r)),t.length+e):(t.set(i,r),r+=i.length,r+e))}async read(t){return this.readInterval(t)}async seek(t){return this.supportRange?(await this.abort(),this.aborted=!1,this.receivedLength=Number(t)-this.range.from,this.startBytes=Number(t),this.options.disableSegment||(this.endBytes=Math.min(this.startBytes+this.options.preload,this.eofIndex)),this.buffers.length=0,4===this.status&&(this.status=2),0):h.NU}async size(){return this.options.isLive?BigInt(0):BigInt(Math.floor(this.contentLength||0))}abortSleep(){this.aborted=!0,this.abortSleep_&&(this.abortSleep_.stop(),this.abortSleep_=null)}async abort(){this.abortSleep(),this.reader&&(await this.reader.cancel(),this.abortController&&(this.abortController.abort(),this.abortController=null),this.reader=null)}async stop(){this.status=0,await this.abort()}getUrl(){var t;return null===(t=this.info)||void 0===t?void 0:t.url}}},79686:(t,e,r)=>{"use strict";r.d(e,{A:()=>d});var i=r(134),s=r(54001),a=r.n(s),n=r(82800);const o=r(67672).Pc(Blob.prototype.arrayBuffer),c="function"==typeof FileReaderSync;class d extends n.A{constructor(...t){super(...t),(0,i.A)(this,"info",void 0),(0,i.A)(this,"range",void 0),(0,i.A)(this,"readPos",void 0),(0,i.A)(this,"endPos",void 0),(0,i.A)(this,"reader",void 0),(0,i.A)(this,"readerResolve",void 0)}async open(t,e={from:0,to:-1}){return this.info=t,this.range=e,this.readPos=0,this.endPos=this.info.file.size,e.from>0&&(this.readPos=e.from),e.to>0&&(this.endPos=e.to),this.status=2,0}readBufferByReaderSync(t){return this.reader||(this.reader=new FileReaderSync),this.reader.readAsArrayBuffer(this.info.file.slice(this.readPos,this.readPos+t))}async readBufferByReader(t){return this.reader||(this.reader=new FileReader,this.reader.onloadend=t=>{this.readerResolve&&this.readerResolve(t.target.result)}),new(a())((e=>{this.readerResolve=e,this.reader.readAsArrayBuffer(this.info.file.slice(this.readPos,this.readPos+t))}))}async read(t){if(this.readPos>=this.endPos)return this.status=4,-1048576;const e=Math.min(t.length,this.endPos-this.readPos);return c?t.set(new Uint8Array(this.readBufferByReaderSync(e)),0):o?t.set(new Uint8Array(await this.info.file.slice(this.readPos,this.readPos+e).arrayBuffer()),0):t.set(new Uint8Array(await this.readBufferByReader(e)),0),this.readPos+=e,this.readPos>=this.endPos&&(this.status=4),e}async seek(t){return this.readPos=Number(t),4===this.status&&(this.status=2),0}async size(){return BigInt(Math.floor(this.info.file.size))}async stop(){this.status=0}}},82800:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(134),s=r(95335);const a={isLive:!1,preload:5242880,retryCount:20,retryInterval:1};class n{constructor(t={}){(0,i.A)(this,"options",void 0),(0,i.A)(this,"status",void 0),(0,i.A)(this,"retryCount",void 0),(0,i.A)(this,"retryTimeout",void 0),this.options=t,this.status=0,this.retryCount=0,this.options=s.X$({},a),s.X$(this.options,t)}write(t){throw new Error("need implemented write function")}}},36773:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(54001),a=r.n(s),n=r(82800);class o extends n.A{constructor(t={}){super(t),(0,i.A)(this,"readQueue",void 0),(0,i.A)(this,"consume",void 0),this.readQueue=[]}async readInterval(t,e=0){let r=0;for(;this.readQueue.length&&r<t.length;){const e=this.readQueue.shift();e.length>t.length-r?(t.set(e.subarray(0,t.length-r),r),this.readQueue.unshift(e.subarray(t.length-r)),r=t.length):(t.set(e,r),r+=e.length)}return r>0||e?r+e:4===this.status||0===this.status?r>0?r+e:e>0?e:-1048576:3===this.status?r>0?r+e:e>0?e:-1048573:(await new(a())((t=>{this.consume=t})),this.consume=null,this.readInterval(t,e))}async read(t){return this.readInterval(t)}async write(t){return this.send(t)}}},14619:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(54001),a=r.n(s),n=r(36773);class o extends n.A{constructor(...t){super(...t),(0,i.A)(this,"info",void 0),(0,i.A)(this,"socket",void 0)}async send(t){return this.socket?(this.socket.send(t.slice()),0):-1048574}open(t){return this.info=t,this.status=1,new(a())((e=>{var r;this.socket=new WebSocket(t.url,null===(r=t.websocketOptions)||void 0===r?void 0:r.protocols),this.socket.binaryType="arraybuffer",this.socket.onopen=()=>{this.status=2,e(0)},this.socket.onerror=()=>{this.status=3,e(-1048573),this.consume&&this.consume()},this.socket.onmessage=t=>{let e=t.data;this.readQueue.push(new Uint8Array(e)),this.consume&&this.consume()}}))}seek(t,e){throw new Error("Method not implemented.")}size(){throw new Error("Method not implemented.")}async stop(){this.socket&&(this.socket.close(),this.socket=null),this.status=4,this.consume&&this.consume()}}},42383:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(54001),a=r.n(s),n=r(36773);class o extends n.A{constructor(...t){super(...t),(0,i.A)(this,"info",void 0),(0,i.A)(this,"transport",void 0),(0,i.A)(this,"datagramReader",void 0),(0,i.A)(this,"reader",void 0),(0,i.A)(this,"datagramWriter",void 0),(0,i.A)(this,"writer",void 0),(0,i.A)(this,"stream",void 0),(0,i.A)(this,"readPacketQueue",void 0),(0,i.A)(this,"consumePacket",void 0)}async send(t){return this.writer?(this.writer.write(t.slice()),0):-1048574}async handleRead(){let t=!1;for(;;)try{const{value:e,done:r}=await this.reader.read();if(r){t=r;break}this.readQueue.push(e)}catch(e){t||(this.status=3,this.consume&&this.consume());break}}async readDatagram(){let t=!1;for(;;)try{const{value:e,done:r}=await this.datagramReader.read();if(r){t=!0;break}this.readPacketQueue.push(e)}catch(e){t||(this.status=3,this.consumePacket&&this.consumePacket());break}}async open(t){return this.info=t,this.transport=new WebTransport(t.url,t.webtransportOptions),this.readPacketQueue=[],this.status=1,await this.transport.ready,this.transport.closed.then((()=>{this.transport?this.status=3:this.status=4})),this.status=2,this.stream=await this.transport.createBidirectionalStream(),this.reader=this.stream.readable.getReader(),this.writer=this.stream.writable.getWriter(),this.datagramReader=this.transport.datagrams.readable.getReader(),this.datagramWriter=this.transport.datagrams.writable.getWriter(),this.handleRead(),this.readDatagram(),0}async readPacket(t){for(;;){if(this.readPacketQueue.length){const e=this.readPacketQueue.shift();return t.set(e,0),e.length}if(4===this.status||0===this.status)return-1048576;if(3===this.status)return-1048573;await new(a())((t=>{this.consumePacket=t})),this.consumePacket=null}}async writePacket(t){return this.datagramWriter?(this.datagramWriter.write(t.slice()),0):-1048574}seek(t,e){throw new Error("Method not implemented.")}size(){throw new Error("Method not implemented.")}async stop(){this.transport&&(this.transport.close(),this.transport=null),this.status=4,this.consume&&this.consume()}}},18667:(t,e,r)=>{"use strict";r.d(e,{A:()=>S});var i=r(54001),s=r.n(i),a=r(63939),n=r(50932),o=r(12264),c=r(29170),d=r(44527),h=r(9705),l=r(84149),u=r(75742),f=r(4624),p=r(16041),m=(r(77162),r(77104)),g=r(84290),v=r(72739),A=r(86932),y=r(36204),b=r(94561),w=r(72703),k=r(71762),x=r(37837),I=r(71766),T=r(67672);const P="src\\avpipeline\\AudioDecodePipeline.ts";class S extends d.A{constructor(){super()}createWebcodecDecoder(t){return new m.A({onError:e=>{f.z3(`audio decode error, taskId: ${t.taskId}, error: ${e}`,P,91)},onReceiveAudioData(e){const r=(0,y.t)(e,t.avframePool.alloc());t.frameCaches.push(r),n.M[17](t.stats+56,a.f[17](t.stats+56)+BigInt(1)),n.M[15](t.stats+248,Math.max((0,A.A)()-t.lastDecodeTimestamp,a.f[15](t.stats+248))),e.close()}})}createWasmcodecDecoder(t,e){return new u.A({resource:e,onReceiveAVFrame(e){t.frameCaches.push(e),n.M[17](t.stats+56,a.f[17](t.stats+56)+BigInt(1)),n.M[15](t.stats+248,Math.max((0,A.A)()-t.lastDecodeTimestamp,a.f[15](t.stats+248)))},avframePool:t.avframePool})}async pullAVPacketInternal(t,e){const r=await e.request("pull");if(T.ai(r)||(0,w.A)(r))return r;{const e=t.avpacketPool.alloc();return(0,k.r0)(r,e),e}}async createTask(t){const e=new l.Ay(t.leftPort),r=new l.Ay(t.rightPort),i=[],s=new p.A((0,c.A)(t.avframeList,o.A),t.avframeListMutex),d={...t,resource:await(0,b.A)(t.resource),frameCaches:i,inputEnd:!1,decoder:null,parameters:0,lastDecodeTimestamp:0,avframePool:s,avpacketPool:new g.A((0,c.A)(t.avpacketList,o.A),t.avpacketListMutex)};return d.resource?d.decoder=this.createWasmcodecDecoder(d,d.resource):d.decoder=this.createWebcodecDecoder(d),this.tasks.set(t.taskId,d),r.on(l.S3,(async s=>{switch(s.method){case"pull":if(i.length){const t=i.shift();r.reply(s,t);break}if(!d.inputEnd){for(;;){if(i.length){const t=i.shift();r.reply(s,t);break}d.pending&&await d.pending,d.lastDecodeTimestamp=(0,A.A)();const o=await this.pullAVPacketInternal(d,e);if(-1048576===o){if(await d.decoder.flush(),d.inputEnd=!0,i.length){const t=i.shift();r.reply(s,t);break}f.pq(`audio decoder ended, taskId: ${d.taskId}`,P,198),r.reply(s,-1048576);break}if(!(o>0)){f.z3(`audio decode pull avpacket error, taskId: ${t.taskId}, ret: ${o}`,P,216),r.reply(s,o);break}{const e=d.decoder.decode(o);d.avpacketPool.release(o),e<0&&(n.M[15](d.stats+48,a.f[15](d.stats+48)+1),f.z3(`audio decode error, taskId: ${t.taskId}, ret: ${e}`,P,211))}}break}r.reply(s,-1048576)}})),0}async open(t,e,r={}){const i=this.tasks.get(t);if(i){i.wasmDecoderOptions=r;const t=(0,x.Gy)(168);return(0,w.A)(e)?(0,I.Yi)(t,e):(0,k.T8)(e,t),i.parameters&&(0,I.dn)(i.parameters),i.parameters=t,new(s())((async(e,r)=>{const s=await i.decoder.open(t,i.wasmDecoderOptions);if(s)return f.z3(`open audio decoder failed, error: ${s}`,P,250),void e(h.r8);e(0)}))}f.h2("task not found",P,257)}async beforeReopenDecoder(t){const e=this.tasks.get(t);e?e.pending=new(s())((t=>{e.pendingResolve=t})):f.h2("task not found",P,268)}async reopenDecoder(t,e,r,i){const a=this.tasks.get(t);if(a){i&&(a.wasmDecoderOptions=i);const t=(0,x.Gy)(168);let n;return(0,w.A)(e)?(0,I.Yi)(t,e):(0,k.T8)(e,t),a.parameters&&(0,I.dn)(a.parameters),a.parameters=t,r?(r=await(0,b.A)(r),n=this.createWasmcodecDecoder(a,r)):n=this.createWebcodecDecoder(a),new(s())((async(e,i)=>{const s=await n.open(t);if(s)return f.z3(`reopen audio decoder failed, error: ${s}`,P,305),void e(h.r8);r&&(a.resource=r),a.decoder.close(),a.decoder=n,f.Yz(`reopen audio decoder, taskId: ${a.taskId}`,P,315),e(0),a.pendingResolve&&(a.pendingResolve(),a.pending=null)}))}f.h2("task not found",P,323)}async resetTask(t){const e=this.tasks.get(t);e&&(e.decoder&&await e.decoder.flush(),v.__(e.frameCaches,(t=>{e.avframePool.release(t)})),e.frameCaches.length=0,e.inputEnd=!1,e.lastDecodeTimestamp=(0,A.A)(),f.pq(`reset audio decoder, taskId: ${e.taskId}`,P,339))}async registerTask(t){return this.tasks.has(t.taskId)?h.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);e&&(e.rightPort.close(),e.leftPort.close(),e.decoder.close(),e.frameCaches.forEach((t=>{e.avframePool.release(t)})),e.parameters&&(0,I.dn)(e.parameters),this.tasks.delete(t),f.Yz(`unregisterTask task, taskId: ${t}`,P,363))}}},59377:(t,e,r)=>{"use strict";r.d(e,{A:()=>F});var i=r(134),s=r(80662),a=r.n(s),n=r(54001),o=r.n(n),c=r(61499),d=r(12264),h=r(74503),l=r(73783),u=r(29170),f=r(63939),p=(r(9599),r(50932)),m=r(94300),g=r(10278),v=r(44527),A=r(9705),y=r(84149),b=r(4624),w=r(16041),k=r(92246),x=r(47442),I=r(37837),T=r(70089),P=r(14686),S=r(44328),_=r(77231),M=r(86932),C=r(13724),B=r(43607),R=r(94561),D=r(47222),U=r(39638),E=r(74936);const L="src\\avpipeline\\AudioRenderPipeline.ts",$=BigInt(400);class F extends v.A{constructor(){super(),(0,i.A)(this,"avPCMBufferPool",void 0),(0,i.A)(this,"avPCMBufferList",void 0),(0,i.A)(this,"avPCMBufferListMutex",void 0),this.avPCMBufferList=(0,h.A)(d.A),this.avPCMBufferListMutex=(0,h.A)(l.eu),this.avPCMBufferPool=new x.A(this.avPCMBufferList,this.avPCMBufferListMutex[c.o9])}async createTask(t){const e=new y.Ay(t.leftPort),r=new y.Ay(t.rightPort),i=new y.Ay(t.controlPort),s={...t,leftIPCPort:e,rightIPCPort:r,controlIPCPort:i,resamplerResource:await(0,R.A)(t.resamplerResource),stretchpitcherResource:await(0,R.A)(t.stretchpitcherResource),resampler:null,stretchpitcher:new(a()),outPCMBuffer:null,waitPCMBuffer:0,waitAVFrame:0,waitPCMBufferPos:0,ended:!1,stretchpitcherEnded:!1,playRate:1,playTempo:1,playPitch:1,useStretchpitcher:!1,lastNotifyPTS:BigInt(0),currentPTS:_.Dh,lastMasterPts:_.Dh,masterTimer:new E.A,firstPlayed:!1,seeking:!1,pausing:!1,stopping:!1,seekSync:null,receivePCMSync:null,paddingAVFrame:0,fakePlayStartTimestamp:0,fakePlaySamples:BigInt(0),fakePlayTimer:null,fakePlayWorkerTimer:null,fakePlay:!1,lastRenderTimestamp:0,avframePool:new w.A((0,u.A)(t.avframeList,d.A),t.avframeListMutex)};for(let e=0;e<t.playChannels;e++){const r=new T.A({resource:s.stretchpitcherResource});s.stretchpitcher.set(e,r),await r.open({sampleRate:t.playSampleRate,channels:1}),r.setTempo(s.playTempo),r.setPitch(s.playPitch),r.setRate(s.playRate)}const n=async()=>{let t;if(s.paddingAVFrame?(t=s.paddingAVFrame,s.paddingAVFrame=0):t=await s.leftIPCPort.request("pull"),-1048576===t){for(let t=0;t<s.playChannels;t++)s.stretchpitcher.get(t).flush();return b.pq(`audio render ended, taskId: ${s.taskId}`,L,215),-1048576}if(t<0)return b.z3(`pull audio frame failed, taskId: ${s.taskId}`,L,219),t;{if(1!==s.playRate||1!==s.playTempo||1!==s.playPitch||s.enableJitterBuffer?s.useStretchpitcher=!0:s.useStretchpitcher=!1,!s.firstPlayed){const e=(0,S.Mr)(f.f[17](t+104),t+120,_.i0);s.firstPlayed=!0,b.Yz(`got first audio frame, pts: ${f.f[17](t+104)}(${e}ms), taskId: ${s.taskId}`,L,241)}const e=(0,S.Mr)(f.f[17](t+104),t+120,_.i0);(e>BigInt(0)&&s.masterTimer.getMasterTime()-e>$||s.isLive&&e-s.currentPTS>BigInt(4e3))&&s.masterTimer.setMasterTime(e),s.currentPTS=e,p.M[17](s.stats+72,f.f[17](s.stats+72)+BigInt(1)),p.M[17](s.stats+344,e),s.lastRenderTimestamp&&p.M[15](s.stats+252,Math.max((0,M.A)()-s.lastRenderTimestamp,f.f[15](s.stats+252))),s.lastRenderTimestamp=(0,M.A)();let r=!0;if(f.f[15](t+152)!==s.playSampleRate||f.f[15](t+80)!==s.playFormat||f.f[15](t+292)!==s.playChannels){if(s.resampler){const e=s.resampler.getInputPCMParameters();e.format===f.f[15](t+80)&&e.sampleRate===f.f[15](t+152)&&e.channels===f.f[15](t+292)||(s.resampler.close(),s.resampler=null)}s.resampler||(s.resampler=new k.A({resource:s.resamplerResource}),await s.resampler.open({sampleRate:f.f[15](t+152),format:f.f[15](t+80),channels:f.f[15](t+292)},{sampleRate:s.playSampleRate,format:s.playFormat,channels:s.playChannels}));let e=this.avPCMBufferPool.alloc(),r=s.resampler.resample(f.f[20](t+64),e,f.f[15](t+76));if(r<0)return b.z3(`resample error, ret: ${r}, taskId: ${s.taskId}`,L,301),this.avPCMBufferPool.release(e),r;if(s.useStretchpitcher){for(let t=0;t<s.playChannels;t++)s.stretchpitcher.get(t).sendSamples(f.f[20](f.f[20](e)+4*t),f.f[15](e+8));this.avPCMBufferPool.release(e)}else s.waitPCMBuffer=e,s.waitPCMBufferPos=0}else if(s.useStretchpitcher)for(let e=0;e<s.playChannels;e++)s.stretchpitcher.get(e).sendSamples(f.f[20](f.f[20](t+64)+4*e),f.f[15](t+76));else{let e=this.avPCMBufferPool.alloc();f.f[20](e)&&((0,I.aI)(f.f[20](e)),(0,I.aI)(e)),p.M[15](e+8,f.f[15](t+76)),p.M[15](e+12,f.f[15](t+76)),p.M[15](e+20,f.f[15](t+152)),p.M[15](e+16,f.f[15](t+292)),p.M[20](e,f.f[20](t+64)),s.waitAVFrame=t,s.waitPCMBuffer=e,s.waitPCMBufferPos=0,r=!1}p.M[15](s.stats+4,f.f[15](t+152)),p.M[15](s.stats,f.f[15](t+292)),p.M[15](s.stats+8,f.f[15](t+76)),r&&s.avframePool.release(t)}return 0},l=async t=>{let e=0;if(s.seeking&&(await new(o())((t=>{s.receivePCMSync=t})),s.stopping))return-1048576;if(s.enableJitterBuffer&&f.f[15](s.stats+32)/f.f[15](s.stats+244)*1e3<=f.f[15](s.stats+280)&&this.setPlayRate(s.taskId,1),s.ended&&s.useStretchpitcher){let r=0;for(let i=0;i<s.playChannels;i++){const a=s.stretchpitcher.get(i);f.f[20](f.f[20](t)+4*i)&&(r=a.receiveSamples(f.f[20](f.f[20](t)+4*i)+4*e,f.f[15](t+12)-e))}if(e+r<f.f[15](t+12)){s.stretchpitcherEnded=!0;for(let r=0;r<s.playChannels;r++)(0,P.sO)(f.f[20](f.f[20](t)+4*r)+e,0,4*(f.f[15](t+12)-e))}return p.M[15](t+8,e),0}for(;e<f.f[15](t+12);){let r=0;if(s.useStretchpitcher)for(let i=0;i<s.playChannels;i++){const a=s.stretchpitcher.get(i);f.f[20](f.f[20](t)+4*i)&&(r=a.receiveSamples(f.f[20](f.f[20](t)+4*i)+4*e,f.f[15](t+12)-e))}else if(s.waitPCMBuffer){if(r=Math.min(f.f[15](s.waitPCMBuffer+8)-s.waitPCMBufferPos,f.f[15](t+12)-e),r){for(let i=0;i<s.playChannels;i++)(0,P.Mr)(f.f[20](f.f[20](t)+4*i)+4*e,f.f[20](f.f[20](s.waitPCMBuffer)+4*i)+4*s.waitPCMBufferPos,4*r);s.waitPCMBufferPos+=r}f.f[15](s.waitPCMBuffer+8)===s.waitPCMBufferPos&&(s.waitAVFrame&&(p.M[20](s.waitPCMBuffer,0),p.M[15](s.waitPCMBuffer+12,0),s.avframePool.release(s.waitAVFrame),s.waitAVFrame=0),this.avPCMBufferPool.release(s.waitPCMBuffer),s.waitPCMBuffer=0)}if(e+=r,e<f.f[15](t+12)){let r=await n();if(-1048576===r){if(s.ended=!0,s.useStretchpitcher){for(let i=0;i<s.playChannels;i++){const a=s.stretchpitcher.get(i);f.f[20](f.f[20](t)+4*i)&&(a.flush(),r=a.receiveSamples(f.f[20](f.f[20](t)+4*i)+4*e,f.f[15](t+12)-e))}if(e+r<f.f[15](t+12)){s.stretchpitcherEnded=!0;for(let r=0;r<s.playChannels;r++)(0,P.sO)(f.f[20](f.f[20](t)+4*r)+e,0,4*(f.f[15](t+12)-e))}e+=r}break}if(r<0)return r}}return p.M[15](t+8,e),s.seekSync&&(s.seekSync(),s.seekSync=null),0};return r.on(y.S3,(async t=>{switch(t.method){case"pull":{if(s.fakePlay&&(s.fakePlay=!1,this.clearFakePlayTimer(s),s.fakePlaySamples=BigInt(0),s.fakePlayStartTimestamp=0),s.ended&&(s.stretchpitcherEnded||!s.useStretchpitcher))return void r.reply(t,-1048576);const e=t.params.buffer;if(!s.firstPlayed){s.masterTimer.setMasterTime(s.lastMasterPts===_.Dh?s.startPTS:s.lastMasterPts),s.lastMasterPts=_.Dh;let e=await n();if(e<0){r.reply(t,e);break}}if(s.currentPTS-s.masterTimer.getMasterTime()>$&&!s.audioMasterForce){(0,P.sO)(f.f[20](f.f[20](e)),0,4*f.f[15](e+12)*f.f[15](e+16)),r.reply(t,0),this.fakeSyncPts(s);break}this.syncPts(s,f.f[15](e+12));const i=await l(e);r.reply(t,i);break}case"pullBuffer":{if(s.fakePlay&&(s.fakePlay=!1,this.clearFakePlayTimer(s),s.fakePlaySamples=BigInt(0),s.fakePlayStartTimestamp=0),s.ended&&(s.stretchpitcherEnded||!s.useStretchpitcher))return void r.reply(t,-1048576);const e=t.params.nbSamples;if(!s.outPCMBuffer||s.outPCMBuffer.maxnbSamples!==e){s.outPCMBuffer&&((0,I.aI)(s.outPCMBuffer.data),(0,I.aI)(s.outPCMBuffer[c.o9]),(0,m.A)(s.outPCMBuffer)),s.outPCMBuffer=(0,h.A)(g.A),s.outPCMBuffer.data=(0,I.sY)(4*s.playChannels);const t=(0,I.Gy)(4*e*s.playChannels);for(let r=0;r<s.playChannels;r++)p.M[20](s.outPCMBuffer.data+4*r,t+4*e*r);s.outPCMBuffer.maxnbSamples=e}if(!s.firstPlayed){s.masterTimer.setMasterTime(s.lastMasterPts===_.Dh?s.startPTS:s.lastMasterPts),s.lastMasterPts=_.Dh;let e=await n();if(e<0){r.reply(t,e);break}}if(s.currentPTS-s.masterTimer.getMasterTime()>$&&!s.audioMasterForce){const e=new Uint8Array(4*s.outPCMBuffer.nbSamples*s.playChannels);r.reply(t,e.buffer,null,[e.buffer]),this.fakeSyncPts(s);break}this.syncPts(s,s.outPCMBuffer.maxnbSamples);const i=await l(s.outPCMBuffer[c.o9]);if(i<0)return void r.reply(t,i);const a=(0,P.s3)(f.f[20](s.outPCMBuffer.data),4*s.outPCMBuffer.nbSamples*s.playChannels).slice();r.reply(t,a.buffer,null,[a.buffer]);break}}})),this.tasks.set(t.taskId,s),0}checkUseStretchpitcher(t){const e=1!==t.playRate||1!==t.playTempo||1!==t.playPitch||t.enableJitterBuffer;if(t.useStretchpitcher&&!e)for(let e=0;e<t.playChannels;e++)t.stretchpitcher.get(e).flush()}setPlayRate(t,e){const r=this.tasks.get(t);if(r){r.enableJitterBuffer&&f.f[15](r.stats+32)/f.f[15](r.stats+244)*1e3<=f.f[15](r.stats+280)&&(e=1),r.playRate=e;for(let t=0;t<r.playChannels;t++)r.stretchpitcher.get(t).setRate(e);this.checkUseStretchpitcher(r),r.masterTimer.setRate(r.playRate*r.playTempo),r.fakePlay&&(r.fakePlayStartTimestamp=(0,M.A)(),r.fakePlaySamples=BigInt(0))}}async setPlayTempo(t,e){const r=this.tasks.get(t);if(r){r.playTempo=e;for(let t=0;t<r.playChannels;t++)r.stretchpitcher.get(t).setTempo(e);this.checkUseStretchpitcher(r),r.masterTimer.setRate(r.playRate*r.playTempo),r.fakePlay&&(r.fakePlayStartTimestamp=(0,M.A)(),r.fakePlaySamples=BigInt(0))}}setPlayPitch(t,e){const r=this.tasks.get(t);if(r){r.playPitch=e;for(let t=0;t<r.playChannels;t++)r.stretchpitcher.get(t).setPitch(e);this.checkUseStretchpitcher(r)}}async beforeSeek(t){const e=this.tasks.get(t);if(e){if(e.fakePlay||e.pausing?this.clearFakePlayTimer(e):(b.Yz(`wait current pull front frame before seek, taskId: ${e.taskId}`,L,677),await new(o())((t=>{e.seekSync=t}))),e.seeking=!0,e.stretchpitcher.size)for(const t of e.stretchpitcher.keys())e.stretchpitcher.get(t).clear();e.waitPCMBuffer&&(e.waitAVFrame&&(p.M[20](e.waitPCMBuffer,0),p.M[15](e.waitPCMBuffer+12,0),e.avframePool.release(e.waitAVFrame),e.waitAVFrame=0),this.avPCMBufferPool.release(e.waitPCMBuffer),e.waitPCMBuffer=0),b.Yz(`before seek end, taskId: ${e.taskId}`,L,705)}}async syncSeekTime(t,e,r){const i=this.tasks.get(t);if(i){let s=!1;for(;;){if(!i.leftIPCPort)return i.ended=!0,void b.R8(`pull audio frame end after unregisterTask, taskId: ${t}`,L,719);let a=(0,M.A)(),n=f.f[15](i.stats+120);for(;!s&&r&&f.f[15](i.stats+120)>r;)await new C.A(0),(0,M.A)()-a>200&&n===f.f[15](i.stats+120)&&(s=!0),n!==f.f[15](i.stats+120)&&(n=f.f[15](i.stats+120),a=(0,M.A)());let o=await i.leftIPCPort.request("pull");if(o<0){b.R8(`pull audio frame end after seek, taskId: ${t}`,L,741),i.ended=!0;break}if(e<BigInt(0)){b.pq(`use the first audio frame because of the seek time${e} < 0`,L,747);break}const c=(0,S.Mr)(f.f[17](o+104),o+120,_.i0);if(c>=e){i.paddingAVFrame=o,i.ended=!1,i.lastNotifyPTS=c,p.M[17](i.stats+328,c),i.currentPTS=c,i.masterTimer.setMasterTime(e),i.lastMasterPts=e;break}i.avframePool.release(o)}b.Yz(`sync seek time end, taskId: ${i.taskId}`,L,775)}}async afterSeek(t,e){const r=this.tasks.get(t);r&&(r.seeking=!1,r.receivePCMSync&&(r.receivePCMSync(),r.receivePCMSync=null),r.pausing||(r.fakePlay&&(r.fakePlayStartTimestamp=(0,M.A)(),r.fakePlaySamples=BigInt(0),this.fakePlayNext(r)),r.lastRenderTimestamp=(0,M.A)()),b.Yz(`after seek end, taskId: ${r.taskId}`,L,797))}async restart(t){const e=this.tasks.get(t);if(e){var r;if(e.lastNotifyPTS=BigInt(0),e.ended=!1,e.firstPlayed=!1,e.stretchpitcherEnded=!1,null!==(r=e.stretchpitcher)&&void 0!==r&&r.size)for(let t=0;t<e.playChannels;t++){var i;null===(i=e.stretchpitcher.get(t))||void 0===i||i.clear()}this.clearFakePlayTimer(e),e.fakePlaySamples=BigInt(0),e.fakePlayStartTimestamp=0,e.lastRenderTimestamp=(0,M.A)(),e.masterTimer.setMasterTime(e.startPTS),b.Yz(`restart task, taskId: ${e.taskId}`,L,819)}}async setMasterTime(t,e){const r=this.tasks.get(t);r&&r.masterTimer.setMasterTime(e)}fakeSyncPts(t){const e=t.masterTimer.getMasterTime();e-t.lastNotifyPTS>=BigInt(1e3)&&(t.lastNotifyPTS=e,p.M[17](t.stats+328,e),t.controlIPCPort.notify("syncPts",{pts:e}))}syncPts(t,e){const r=((t.useStretchpitcher?t.stretchpitcher.get(0).getLatency():0)+(3*e>>>1))/t.playSampleRate*1e3>>>0,i=B.T9(t.currentPTS-BigInt(Math.floor(r)),BigInt(0));p.M[17](t.stats+328,i),t.currentPTS-t.lastNotifyPTS>=BigInt(1e3)&&(t.lastNotifyPTS=t.currentPTS,t.controlIPCPort.notify("syncPts",{pts:i}))}clearFakePlayTimer(t){t.fakePlayTimer&&(t.fakePlayWorkerTimer?(t.fakePlayWorkerTimer.clearTimeout(t.fakePlayTimer),t.fakePlayWorkerTimer.destroy(),t.fakePlayWorkerTimer=null):clearTimeout(t.fakePlayTimer),t.fakePlayTimer=null)}setFakePlayTimer(t,e,r){return(0,U.A)()?setTimeout(e,r):(t.fakePlayWorkerTimer||(t.fakePlayWorkerTimer=new D.A),t.fakePlayWorkerTimer.setTimeout(e,r))}async fakePlayNext(t){const e=t.paddingAVFrame||await t.leftIPCPort.request("pull");if(t.paddingAVFrame=0,e<0)return t.ended=!0,b.pq(`audio fake render ended, taskId: ${t.taskId}`,L,890),void t.controlIPCPort.notify("ended");if(!t.fakePlay||t.pausing)return void t.avframePool.release(e);let r=f.f[15](e+76)/f.f[15](e+152)*1e3>>>0;r/=t.playRate*t.playTempo;const i=(0,S.Mr)(f.f[17](e+104),e+120,_.i0);if((i>BigInt(0)&&t.masterTimer.getMasterTime()-i>$||t.isLive&&i-t.currentPTS>BigInt(4e3))&&t.masterTimer.setMasterTime(i),t.currentPTS=i,t.currentPTS-t.masterTimer.getMasterTime()>$)return t.paddingAVFrame=e,this.fakeSyncPts(t),void(t.fakePlayTimer=this.setFakePlayTimer(t,(()=>{t.fakePlayTimer=null,this.fakePlayNext(t)}),r));this.syncPts(t,0);let s=BigInt(Math.floor((0,M.A)()-t.fakePlayStartTimestamp))*BigInt(0|f.f[15](e+152))/BigInt(1e3);s=s*BigInt(Math.floor(t.playRate*t.playTempo*100))/BigInt(100),r-=Number(s-t.fakePlaySamples)/f.f[15](e+152)*1e3>>>0,t.fakePlaySamples+=BigInt(0|f.f[15](e+76)),t.avframePool.release(e),t.currentPTS-t.lastNotifyPTS>=BigInt(1e3)&&(t.lastNotifyPTS=t.currentPTS,p.M[17](t.stats+328,t.currentPTS),t.controlIPCPort.notify("syncPts",{pts:t.currentPTS})),t.fakePlayTimer=this.setFakePlayTimer(t,(()=>{t.fakePlayTimer=null,this.fakePlayNext(t)}),r)}async fakePlay(t){const e=this.tasks.get(t);e&&(e.fakePlayStartTimestamp=(0,M.A)(),e.fakePlay=!0,e.fakePlaySamples=BigInt(0),this.fakePlayNext(e),b.pq(`start fake play, taskId: ${e.taskId}`,L,960))}async pause(t){const e=this.tasks.get(t);e&&(e.pausing=!0,e.lastMasterPts=e.masterTimer.getMasterTime(),e.fakePlay&&this.clearFakePlayTimer(e),b.pq(`task paused, taskId: ${e.taskId}`,L,973))}async unpause(t){const e=this.tasks.get(t);e&&(e.pausing=!1,e.masterTimer.setMasterTime(e.lastMasterPts),e.lastMasterPts=_.Dh,e.fakePlay&&(e.fakePlayStartTimestamp=(0,M.A)(),e.fakePlaySamples=BigInt(0),e.lastRenderTimestamp=(0,M.A)(),this.fakePlayNext(e)),b.pq(`task unpaused, taskId: ${e.taskId}`,L,990))}async stop(t){const e=this.tasks.get(t);e&&(e.stopping=!0,e.receivePCMSync&&(e.receivePCMSync(),e.receivePCMSync=null),b.pq(`task stopping, taskId: ${e.taskId}`,L,1002))}async registerTask(t){return this.tasks.has(t.taskId)?A.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);if(e){if(this.clearFakePlayTimer(e),e.resampler&&e.resampler.close(),e.stretchpitcher.size){for(const t of e.stretchpitcher.keys())e.stretchpitcher.get(t).close();e.stretchpitcher.clear()}e.outPCMBuffer&&((0,I.aI)(e.outPCMBuffer.data),(0,I.aI)(e.outPCMBuffer[c.o9]),(0,m.A)(e.outPCMBuffer)),e.waitPCMBuffer&&(e.waitAVFrame&&(p.M[20](e.waitPCMBuffer,0),p.M[15](e.waitPCMBuffer+12,0),e.avframePool.release(e.waitAVFrame),e.waitAVFrame=0),this.avPCMBufferPool.release(e.waitPCMBuffer),e.waitPCMBuffer=0),e.paddingAVFrame&&e.avframePool.release(e.paddingAVFrame),e.leftIPCPort&&(e.leftIPCPort.destroy(),e.leftIPCPort=null),e.rightIPCPort&&(e.rightIPCPort.destroy(),e.rightIPCPort=null),e.controlIPCPort&&(e.controlIPCPort.destroy(),e.controlIPCPort=null),this.tasks.delete(t),b.Yz(`unregisterTask task, taskId: ${t}`,L,1059)}}async clear(){await super.clear(),this.avPCMBufferList.clear((t=>{f.f[20](t)&&((0,I.aI)(f.f[20](t)),(0,I.aI)(t))}),20),(0,m.A)(this.avPCMBufferList),(0,m.A)(this.avPCMBufferListMutex)}}},72480:(t,e,r)=>{"use strict";r.d(e,{A:()=>N});var i=r(80662),s=r.n(i),a=r(61499),n=r(12264),o=r(29170),c=r(63939),d=r(50932),h=(r(9599),r(44527)),l=r(9705),u=r(84149),f=r(44315),p=r(24175),m=r(34531),g=r(75),v=r(37837),A=r(79630),y=r(4624),b=r(84290),w=r(39148),k=r(72739),x=r(44328),I=r(77231),T=r(43607),P=r(71517),S=r(14686),_=r(49032),M=r(94561),C=r(39638),B=r(26429),R=r(71762),D=r(72703),U=r(67672),E=r(62815),L=r(67659),$=r(59166),F=r(95797);const O="src\\avpipeline\\DemuxPipeline.ts",z=-1;class N extends h.A{constructor(){super()}createTask(t){let e,r;if(t.mainTaskId){const i=this.tasks.get(t.mainTaskId);e=i.leftIPCPort,r=i.controlIPCPort}else e=new u.Ay(t.leftPort),t.controlPort&&(r=new u.Ay(t.controlPort));const i=t.bufferLength||1048576,a=(0,v.sY)(i);if(!a)return l.gR;const c=(0,v.sY)(i);if(!c)return l.gR;const d=new A.A(a,i),h=new p.A(i,!0,d),g=new A.A(c,i),y=new m.A(i,!0,g);t.isLive||(h.flags|=1),t.flags&&(h.flags|=t.flags),h.onFlush=async r=>{const i={pointer:r.byteOffset,length:r.length};t.ioloaderOptions&&(i.ioloaderOptions=t.ioloaderOptions);try{const t=await e.request("read",i);return U.ai(t)?t:((0,S.lW)(i.pointer,t.length,t),t.length)}catch(t){return-1048574}},h.onSeek=async r=>{try{const i={pos:r};return t.ioloaderOptions&&(i.ioloaderOptions=t.ioloaderOptions),e.request("seek",i)}catch(t){return-1048574}},h.onSize=async()=>{try{return e.request("size")}catch(t){return BigInt(-1048574)}},y.onFlush=async t=>{const r={pointer:t.byteOffset,length:t.length};try{return await e.request("write",r)}catch(t){return-1048574}};const w=(0,f.Xv)();return w.ioReader=h,w.ioWriter=y,F.A.wasmBaseSupported&&(w.getDecoderResource=async(t,e)=>{if(!r)return;const i=await r.request("getDecoderResource",{codecId:e,mediaType:t});return(0,M.A)(i,0===t)}),this.tasks.set(t.taskId,{...t,leftIPCPort:e,rightIPCPorts:new(s()),controlIPCPort:r,formatContext:w,ioReader:h,iBuffer:a,oBuffer:c,cacheAVPackets:new(s()),cacheRequests:new(s()),streamIndexFlush:new(s()),pendingAVPackets:new(s()),realFormat:-1,demuxEnded:!1,loop:null,gopCounter:0,lastKeyFramePts:BigInt(0),lastAudioDts:BigInt(0),lastVideoDts:BigInt(0),avpacketPool:new b.A((0,o.A)(t.avpacketList,n.A),t.avpacketListMutex)}),0}async openStream(t,e=3e3){const i=this.tasks.get(t);if(i){let t,s,a=await i.leftIPCPort.request("open");if(a<0)return y.z3(`open ioloader failed, ret: ${a}`,O,300),a;try{6!==i.format?(t=await(0,_.A)(i.ioReader,i.format),i.format=t):t=i.format}catch(t){return l.LR}switch(t){case 0:s=new((await Promise.all([r.e(171),r.e(969)]).then(r.bind(r,28773))).default)(i.formatOptions);break;case 1:s=new((await r.e(531).then(r.bind(r,92047))).default)(i.formatOptions);break;case 2:s=new((await Promise.all([r.e(217),r.e(331)]).then(r.bind(r,59331))).default);break;case 3:s=new((await Promise.all([r.e(217),r.e(855)]).then(r.bind(r,83855))).default);break;case 5:s=new((await r.e(634).then(r.bind(r,16634))).default);break;case 4:s=new((await Promise.all([r.e(904),r.e(118)]).then(r.bind(r,29118))).default);break;case 14:s=new((await r.e(839).then(r.bind(r,6839))).default);break;case 8:case 9:s=new((await r.e(941).then(r.bind(r,34577))).default);break;case 15:s=new((await r.e(94).then(r.bind(r,47094))).default);break;case 17:s=new((await Promise.all([r.e(904),r.e(453)]).then(r.bind(r,18453))).default);break;case 16:s=new((await Promise.all([r.e(897),r.e(791)]).then(r.bind(r,3791))).default);break;case 18:s=new((await r.e(611).then(r.bind(r,85611))).default);break;case 19:s=new((await r.e(70).then(r.bind(r,78070))).default);break;case 20:s=new((await r.e(344).then(r.bind(r,47344))).default);break;case 21:s=new((await r.e(854).then(r.bind(r,98854))).default);break;case 11:s=new((await r.e(299).then(r.bind(r,5299))).default)(i.formatOptions);break;case 12:s=new((await r.e(487).then(r.bind(r,85487))).default)(i.formatOptions);break;case 13:s=new((await r.e(808).then(r.bind(r,95808))).default)(i.formatOptions);break;case 6:s=new((await r.e(522).then(r.bind(r,50522))).default)(i.formatOptions);break;case 10:s=new((await Promise.all([r.e(897),r.e(527)]).then(r.bind(r,96635))).default)(i.formatOptions);break;default:return y.z3("format not support",O,503),l.E$}return i.realFormat=t,i.formatContext.iformat=s,g.ho(i.formatContext,{maxAnalyzeDuration:e,fastOpen:i.isLive})}y.h2("task not found",O,518)}async getFormat(t){const e=this.tasks.get(t);if(e)return e.realFormat;y.h2("task not found",O,528)}async analyzeStreams(t){const e=this.tasks.get(t);if(e){let t=await g.Ib(e.formatContext);if(t)return t;const r=[];for(let t=0;t<e.formatContext.streams.length;t++){const i=e.formatContext.streams[t];r.push({index:i.index,id:i.id,codecpar:i.codecpar[a.o9],nbFrames:i.nbFrames,metadata:i.metadata,duration:i.duration,startTime:i.startTime,disposition:i.disposition,timeBase:{den:i.timeBase.den,num:i.timeBase.num}})}return{metadata:e.formatContext.metadata,format:e.realFormat,chapters:e.formatContext.chapters,streams:r}}y.h2("task not found",O,568)}replyAVPacket(t,e,r,i){if((0,C.A)()&&!B.USE_THREADS&&(0,D.A)(i)){const s=(0,R.wm)(i),a=[s.data.buffer];return s.sideData.length&&s.sideData.forEach((t=>{a.push(t.data.buffer)})),e.reply(r,s,null,a),void t.avpacketPool.release(i)}e.reply(r,i)}async connectStreamTask(t,e,r){const i=this.tasks.get(t);if(i){const t=new u.Ay(r);i.cacheAVPackets.set(e,[]),t.streamIndex=e,t.on(u.S3,(async e=>{switch(e.method){case"pull":{const r=i.cacheAVPackets.get(t.streamIndex);if(r.length){const s=r.shift();0!==i.stats&&(1===i.formatContext.streams[c.f[15](s+32)].codecpar.codecType?d.M[15](i.stats+32,c.f[15](i.stats+32)-1):0===i.formatContext.streams[c.f[15](s+32)].codecpar.codecType&&d.M[15](i.stats+120,c.f[15](i.stats+120)-1)),this.replyAVPacket(i,t,e,s)}else i.demuxEnded?t.reply(e,-1048576):(i.cacheRequests.set(t.streamIndex,e),i.loop&&i.loop.isStarted()&&i.loop.resetInterval());break}}})),i.rightIPCPorts.set(e,t),y.Yz(`connect stream ${e}, taskId: ${i.taskId}`,O,629)}else y.h2("task not found",O,632)}async addPendingStream(t,e){const r=this.tasks.get(t);r?r.pendingAVPackets.set(e,[]):y.h2("task not found",O,642)}async changeConnectStream(t,e,r,i=!0,s=!1){const a=this.tasks.get(t);if(a){if(e===r)return;let t=a.cacheAVPackets.get(r);const n=a.rightIPCPorts.get(r),o=a.cacheRequests.get(r);t||y.R8(`oldStreamIndex ${r} not found`,O,659),await a.loop.stopBeforeNextTick(),i?a.pendingAVPackets.has(e)||(k.__(t,(t=>{a.avpacketPool.release(t)})),t.length=0):a.streamIndexFlush.set(e,!0),a.pendingAVPackets.has(e)&&(a.pendingAVPackets.set(r,t),t=a.pendingAVPackets.get(e),a.pendingAVPackets.delete(e)),1===a.formatContext.streams[e].codecpar.codecType?d.M[15](a.stats+32,t.length):0===a.formatContext.streams[e].codecpar.codecType&&d.M[15](a.stats+120,t.length),n.streamIndex=e,a.cacheAVPackets.set(e,t),a.rightIPCPorts.set(e,n),a.cacheAVPackets.delete(r),a.rightIPCPorts.delete(r),o&&(a.cacheRequests.set(e,o),a.cacheRequests.delete(r)),i&&!s||a.loop.start(),y.Yz(`changed connect stream, new ${e}, old: ${r}, force: ${i}, taskId: ${a.taskId}`,O,705)}else y.h2("task not found",O,708)}async doDemux(t,e){const r=t.avpacketPool.alloc();let i=await g.Cj(t.formatContext,r);if(i){t.avpacketPool.release(r),-1048576!==i&&-1048572!==i&&y.z3(`demux error, ret: ${i}, taskId: ${t.taskId}`,O,865);for(let e of t.cacheRequests.keys())t.cacheAVPackets.get(e).length||(t.rightIPCPorts.get(e).reply(t.cacheRequests.get(e),-1048576),t.cacheRequests.delete(e))}else{const i=c.f[15](r+32);if(0!==t.stats)if(1===t.formatContext.streams[i].codecpar.codecType&&t.cacheAVPackets.has(i)){if(d.M[17](t.stats+24,c.f[17](t.stats+24)+BigInt(1)),d.M[17](t.stats+16,c.f[17](t.stats+16)+BigInt(0|c.f[15](r+28))),c.f[17](t.stats+24)>1&&c.f[17](r+16)>t.lastAudioDts){const e=t.cacheAVPackets.get(i);e&&e.length?d.M[15](t.stats+244,Math.round(c.f[15](r+76)/c.f[15](r+72)/(Number(BigInt.asIntN(32,c.f[17](r+16)-c.f[17](e[0]+16)))/e.length))):d.M[15](t.stats+244,Math.round(c.f[15](r+76)/c.f[15](r+72)/Number(BigInt.asIntN(32,c.f[17](r+16)-t.lastAudioDts))))}t.lastAudioDts=c.f[17](r+16)}else if(0===t.formatContext.streams[i].codecpar.codecType&&t.cacheAVPackets.has(i)){if(d.M[17](t.stats+112,c.f[17](t.stats+112)+BigInt(1)),d.M[17](t.stats+104,c.f[17](t.stats+104)+BigInt(0|c.f[15](r+28))),1&c.f[15](r+36)?(d.M[17](t.stats+176,c.f[17](t.stats+176)+BigInt(1)),c.f[17](t.stats+176)>1&&c.f[17](r+8)>t.lastKeyFramePts&&(d.M[15](t.stats+96,t.gopCounter),t.gopCounter=1,d.M[15](t.stats+92,Number(BigInt.asIntN(32,(0,x.Mr)(c.f[17](r+8)-t.lastKeyFramePts,r+72,I.i0))))),t.lastKeyFramePts=c.f[17](r+8)):t.gopCounter++,c.f[17](t.stats+112)>1&&c.f[17](r+16)>t.lastVideoDts){const e=t.cacheAVPackets.get(i);e&&e.length?d.M[15](t.stats+232,Math.round(c.f[15](r+76)/c.f[15](r+72)/(Number(BigInt.asIntN(32,c.f[17](r+16)-c.f[17](e[0]+16)))/e.length))):d.M[15](t.stats+232,Math.round(c.f[15](r+76)/c.f[15](r+72)/Number(BigInt.asIntN(32,c.f[17](r+16)-t.lastVideoDts))))}t.lastVideoDts=c.f[17](r+16)}if(t.streamIndexFlush.get(i)){const e=t.formatContext.streams.find((t=>t.index===i));if(!(0,P.rU)(r,1)&&e&&e.codecpar.extradataSize){const t=(0,v.sY)(e.codecpar.extradataSize);(0,S.Mr)(t,e.codecpar.extradata,e.codecpar.extradataSize),(0,P.Ow)(r,1,t,e.codecpar.extradataSize)}t.streamIndexFlush.set(i,!1)}if(t.cacheRequests.has(i))this.replyAVPacket(t,t.rightIPCPorts.get(i),t.cacheRequests.get(i),r),t.cacheRequests.delete(i);else if(t.cacheAVPackets.has(i))t.cacheAVPackets.get(i).push(r),0!==t.stats&&(1===t.formatContext.streams[i].codecpar.codecType?d.M[15](t.stats+32,c.f[15](t.stats+32)+1):0===t.formatContext.streams[i].codecpar.codecType&&d.M[15](t.stats+120,c.f[15](t.stats+120)+1)),3===t.formatContext.streams[i].codecpar.codecType&&t.cacheAVPackets.get(i).length>e&&t.avpacketPool.release(t.cacheAVPackets.get(i).shift());else if(t.pendingAVPackets.has(i)){const s=t.pendingAVPackets.get(i);if(s.push(r),0!==t.stats){const r=t.formatContext.streams[i].codecpar.codecType;for(;s.length;){const i=s[0],a=(0,x.Mr)(c.f[17](i+8),i+72,I.i0),n=T.T9(c.f[17](t.stats+328),c.f[17](t.stats+336));if(1===r&&a>=n||0===r&&a>=n||1!==r&&0!==r&&s.length<=e)break;t.avpacketPool.release(s.shift())}}else s.length>e&&t.avpacketPool.release(s.shift())}else t.rightIPCPorts.has(z)?t.cacheRequests.has(z)?(this.replyAVPacket(t,t.rightIPCPorts.get(z),t.cacheRequests.get(z),r),t.cacheRequests.delete(z)):t.cacheAVPackets.get(z).push(r):t.avpacketPool.release(r)}return i}async startDemux(t,e,r){const i=this.tasks.get(t);if(i){if(r=Math.max(r,2===i.format?20:10),i.loop&&i.loop.destroy(),i.loop=new w.A((async()=>{if(!e){let t=!1,e=!1;if(i.cacheAVPackets.forEach(((s,a)=>{const n=i.formatContext.streams.find((t=>t.index===a));s.length<r&&(3!==n.codecpar.codecType||1===i.cacheAVPackets.size)&&(t=!0),s.length>Math.max(2*r,5e3)&&(e=!0)})),!t||e)return void i.loop.emptyTask()}await this.doDemux(i,r)&&(i.demuxEnded=!0,y.pq(`demuxer ended, taskId: ${i.taskId}`,O,916),i.loop.stop())}),0,0,!0,!1),e&&i.cacheAVPackets.size)for(;;){let t=!1;if(i.cacheAVPackets.forEach(((e,i)=>{e.length>=r&&(t=!0)})),t)break;if(await this.doDemux(i,r))return void(i.demuxEnded=!0)}i.loop.start(),y.Yz(`start demux loop, taskId: ${i.taskId}`,O,944)}else y.h2("task not found",O,947)}async seek(t,e,r,i=-1){const s=this.tasks.get(t);if(s){if(s.loop){await s.loop.stopBeforeNextTick();let a=await g.jF(s.formatContext,i,e,r);if(a>=BigInt(0)){function n(t){k.__(t,(t=>{if(2&s.formatContext.ioReader.flags){const e=(0,P.rU)(t,1),r=s.formatContext.streams[c.f[15](t+32)];!r.sideData[1]&&e&&(r.sideData[1]=(0,S.s3)(c.f[20](e),c.f[25](e+4)).slice())}s.avpacketPool.release(t)})),t.length=0}s.cacheAVPackets.forEach(n),s.pendingAVPackets.forEach(n),0!==s.stats&&s.cacheAVPackets.forEach(((t,e)=>{const r=s.formatContext.streams.find((t=>t.index===e));1===r.codecpar.codecType?d.M[15](s.stats+32,0):0===r.codecpar.codecType&&d.M[15](s.stats+120,0)}));const o=s.avpacketPool.alloc();for(;a=await g.Cj(s.formatContext,o),!(a<0||s.cacheAVPackets.has(c.f[15](o+32))););if(a>=0){s.demuxEnded=!1;const h=c.f[15](o+32);return s.cacheAVPackets.get(h).push(o),0!==s.stats&&(1===s.formatContext.streams[c.f[15](o+32)].codecpar.codecType?d.M[15](s.stats+32,c.f[15](s.stats+32)+1):0===s.formatContext.streams[c.f[15](o+32)].codecpar.codecType&&d.M[15](s.stats+120,c.f[15](s.stats+120)+1)),s.loop.start(),(0,x.Mr)(T.T9(c.f[17](o+8),BigInt(0)),o+72,I.i0)}return y.R8(`got first packet failed after seek, taskId: ${s.taskId}`,O,1018),s.avpacketPool.release(o),s.demuxEnded=!0,e}return a}{y.pq("seek before demux loop start",O,1029);let l=await g.jF(s.formatContext,-1,e,r);return l<0?l:e}}}async croppingAVPacketQueue(t,e){const r=this.tasks.get(t);if(r){let i=e;const a=new(s());function n(t,e){if(!(1&c.f[15](t+36)))return!1;let r=0!==(0,P.rU)(t,1);return!r&&64&c.f[15](t+36)&&(27===e?r=!!E.sL((0,P.iI)(t)):173===e?r=!!L.sL((0,P.iI)(t)):196===e&&(r=!!$.sL((0,P.iI)(t)))),r}const o=new(s());r.cacheAVPackets.forEach(((t,e)=>{o.set(e,t)})),r.pendingAVPackets.forEach(((t,e)=>{o.set(e,t)})),o.forEach(((t,s)=>{const o=r.formatContext.streams[s].codecpar.codecType,d=r.formatContext.streams[s].codecpar.codecId;if(0===o){const r=c.f[17](t[t.length-1]+16);let o=t.length-2;for(o=t.length-2;o>=0;o--)if(1&c.f[15](t[o]+36)&&(0,x.Mr)(r-c.f[17](t[o]+16),t[o]+72,I.i0)>=e){i=T.T9(i,(0,x.Mr)(r-c.f[17](t[o]+16),t[o]+72,I.i0));break}if((27===d||173===d||196===d)&&o>0&&!n(t[o],d))for(let e=o-1;e>0;e--)if(1&c.f[15](t[e]+36)&&n(t[e],d)){i=T.T9(i,(0,x.Mr)(r-c.f[17](t[e]+16),t[e]+72,I.i0)),o=e;break}o>0&&a.set(s,o)}})),o.forEach(((t,e)=>{if(0!==r.formatContext.streams[e].codecpar.codecType){const r=c.f[17](t[t.length-1]+16);let s=t.length-2;for(s=t.length-2;s>=0&&!((0,x.Mr)(r-c.f[17](t[s]+16),t[s]+72,I.i0)>=i);s--);s>=0&&a.set(e,s)}})),a.size===o.size&&a.forEach(((t,e)=>{const i=o.get(e);i.splice(0,t).forEach((t=>{r.avpacketPool.release(t)}));const s=r.formatContext.streams[e].codecpar.codecType;0!==r.stats&&(1===s?d.M[15](r.stats+32,i.length):0===s&&d.M[15](r.stats+120,i.length))}))}}async stop(t){const e=this.tasks.get(t);e&&(e.formatContext.ioReader.flags|=8)}async registerTask(t){return this.tasks.has(t.taskId)?l.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);e&&(e.ioReader&&4&e.ioReader.flags&&e.ioReader.abort(),e.loop&&(await e.loop.stopBeforeNextTick(),e.loop.destroy()),e.cacheAVPackets.forEach((t=>{t.forEach((t=>{e.avpacketPool.release(t)}))})),e.pendingAVPackets.forEach((t=>{t.forEach((t=>{e.avpacketPool.release(t)}))})),e.cacheRequests.forEach(((t,r)=>{e.rightIPCPorts.get(r).reply(t,-1048576)})),e.cacheRequests.clear(),await e.formatContext.destroy(),e.mainTaskId||(e.leftIPCPort.destroy(),e.controlIPCPort&&e.controlIPCPort.destroy()),e.rightIPCPorts.forEach((t=>{t.destroy()})),e.rightIPCPorts.clear(),e.iBuffer&&((0,v.Eb)(e.iBuffer),e.iBuffer=0),e.oBuffer&&((0,v.Eb)(e.oBuffer),e.oBuffer=0),this.tasks.delete(t),y.Yz(`unregisterTask task, taskId: ${t}`,O,1223))}}},87243:(t,e,r)=>{"use strict";r.d(e,{A:()=>m});var i=r(63939),s=r(50932),a=r(44527),n=r(77580),o=r(9705),c=r(84149),d=r(14686),h=r(79686),l=r(4624),u=r(14619),f=r(42383);const p="src\\avpipeline\\IOPipeline.ts";class m extends a.A{constructor(){super()}async createTask(t){let e;switch(t.type){case 0:e=new n.A(t.options);break;case 1:e=new h.A(t.options);break;case 2:e=new u.A(t.options);break;case 3:e=new f.A(t.options);break;case 4:e=new((await r.e(433).then(r.bind(r,15433))).default)(t.options);break;case 5:e=new((await r.e(576).then(r.bind(r,41576))).default)(t.options);break;case 6:e=new((await Promise.all([r.e(171),r.e(543)]).then(r.bind(r,67543))).default)(t.options)}if(!e)return o.UY;const a=new c.Ay(t.rightPort),m={...t,ioLoader:e,ipcPort:a};return a.on(c.S3,(async r=>{switch(r.method){case"open":try{const i=await e.open(t.info,t.range);if(i<0){l.z3(`loader open error, ${i}, taskId: ${t.taskId}`,p,128),a.reply(r,null,i);break}a.reply(r,i)}catch(e){l.z3(`loader open error, ${e}, taskId: ${t.taskId}`,p,135),a.reply(r,null,e)}break;case"read":{const n=r.params.pointer,c=r.params.length,h=r.params.ioloaderOptions,u=(0,d.JW)(n,c);try{const t=await e.read(u,h);s.M[17](m.stats+192,i.f[17](m.stats+192)+BigInt(0|t)),a.reply(r,t)}catch(e){if(!this.tasks.has(t.taskId))return;l.z3(`loader read error, ${e}, taskId: ${t.taskId}`,p,159),a.reply(r,o.LR)}break}case"write":{const n=r.params.pointer,c=r.params.length,h=(0,d.JW)(n,c);try{const t=await e.write(h);s.M[17](m.stats+200,i.f[17](m.stats+200)+BigInt(0|c)),a.reply(r,t)}catch(e){l.z3(`loader write error, ${e}, taskId: ${t.taskId}`,p,181),a.reply(r,o.LR)}break}case"seek":{const i=r.params.pos,s=r.params.ioloaderOptions;try{const n=await e.seek(i,s);if(n<0){l.z3(`loader seek error, ${n}, taskId: ${t.taskId}`,p,197),a.reply(r,null,n);break}a.reply(r,n)}catch(e){l.z3(`loader seek error, ${e}, taskId: ${t.taskId}`,p,204),a.reply(r,null,e)}break}case"size":a.reply(r,await e.size())}})),this.tasks.set(t.taskId,m),0}async open(t){const e=this.tasks.get(t);if(e)return await e.ioLoader.open(e.info,e.range),0}async getDuration(t){const e=this.tasks.get(t);if(e)return 4===e.type||5===e.type?e.ioLoader.getDuration():0}async hasAudio(t){const e=this.tasks.get(t);if(e){if(5===e.type)return e.ioLoader.hasAudio();if(4===e.type)return e.ioLoader.hasAudio()}return!1}async hasVideo(t){const e=this.tasks.get(t);if(e){if(5===e.type)return e.ioLoader.hasVideo();if(4===e.type)return e.ioLoader.hasVideo()}return!1}async hasSubtitle(t){const e=this.tasks.get(t);if(e){if(5===e.type)return e.ioLoader.hasSubtitle();if(4===e.type)return e.ioLoader.hasSubtitle()}return!1}async getVideoList(t){const e=this.tasks.get(t);if(e){if(5===e.type)return e.ioLoader.getVideoList();if(4===e.type)return e.ioLoader.getVideoList()}return{list:[],selectedIndex:0}}async getAudioList(t){const e=this.tasks.get(t);if(e){if(5===e.type)return e.ioLoader.getAudioList();if(4===e.type)return e.ioLoader.getAudioList()}return{list:[],selectedIndex:0}}async getSubtitleList(t){const e=this.tasks.get(t);if(e){if(5===e.type)return e.ioLoader.getSubtitleList();if(4===e.type)return e.ioLoader.getSubtitleList()}return{list:[],selectedIndex:0}}async selectVideo(t,e){const r=this.tasks.get(t);if(r){if(5===r.type)return r.ioLoader.selectVideo(e);if(4===r.type)return r.ioLoader.selectVideo(e)}}async selectAudio(t,e){const r=this.tasks.get(t);if(r){if(5===r.type)return r.ioLoader.selectAudio(e);if(4===r.type)return r.ioLoader.selectAudio(e)}}async selectSubtitle(t,e){const r=this.tasks.get(t);if(r){if(5===r.type)return r.ioLoader.selectSubtitle(e);if(4===r.type)return r.ioLoader.selectSubtitle(e)}}async getCurrentProtection(t,e){const r=this.tasks.get(t);if(r&&5===r.type)return r.ioLoader.getCurrentProtection(e)}async getMinBuffer(t){const e=this.tasks.get(t);if(e){if(5===e.type)return e.ioLoader.getMinBuffer();if(4===e.type)return e.ioLoader.getMinBuffer()}return 0}async registerTask(t){return this.tasks.has(t.taskId)?o.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);e&&(await e.ioLoader.stop().catch((t=>{l.R8(`stop ioloader error: ${t}, we will ignore it`,p,422)})),e.ipcPort.destroy(),this.tasks.delete(t),l.Yz(`unregisterTask task, taskId: ${t}`,p,426))}}},44527:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(80662),a=r.n(s),n=r(4624);class o{constructor(){(0,i.A)(this,"tasks",void 0),this.tasks=new(a())}async clear(){if(this.tasks.size)for(const t of this.tasks.keys())await this.unregisterTask(t)}async setLogLevel(t){n.V$(t)}async getTaskCount(){return this.tasks.size}}},31138:(t,e,r)=>{"use strict";r.d(e,{A:()=>F});var i=r(54001),s=r.n(i),a=r(63939),n=r(50932),o=r(12264),c=r(29170),d=r(9599),h=r(44527),l=r(9705),u=r(84149),f=r(40417),p=r(71039),m=r(4624),g=r(16041),v=r(67672),A=r(72739),y=r(13724),b=(r(77162),r(84290)),w=r(39638),k=r(44328),x=r(86932),I=r(77231),T=r(95797),P=r(72703),S=r(94561),_=r(71762),M=r(37837),C=r(71766),B=r(71517),R=r(14686),D=r(62815),U=r(67659),E=r(59166),L=r(39381);const $="src\\avpipeline\\VideoDecodePipeline.ts";class F extends h.A{constructor(){super()}createWebCodecDecoder(t,e=!0){return new p.A({onError:e=>{t.hardwareRetryCount>3||!t.firstDecoded?t.targetDecoder===t.hardwareDecoder&&(t.targetDecoder=t.softwareDecoder,t.hardwareDecoder.close(),t.hardwareDecoder=null,t.decoderFallbackReady=this.openSoftwareDecoder(t),m.R8(`video decode error by hardware decoder(${t.hardwareRetryCount}), taskId: ${t.taskId}, error: ${e}, try to fallback to software decoder`,$,132)):(t.hardwareRetryCount++,m.pq(`retry open hardware decoder(${t.hardwareRetryCount}), taskId: ${t.taskId}`,$,137),t.decoderFallbackReady=t.hardwareDecoder.open(t.parameters)),t.needKeyFrame=!0,t.leftIPCPort.request("requestKeyframe")},onReceiveVideoFrame(e){t.firstDecoded=!0,t.frameCaches.push(e),n.M[17](t.stats+144,a.f[17](t.stats+144)+BigInt(1)),t.lastDecodeTimestamp!==I.N_&&(n.M[15](t.stats+256,Math.max((0,x.A)()-t.lastDecodeTimestamp,a.f[15](t.stats+256))),t.lastDecodeTimestamp=I.N_)},enableHardwareAcceleration:e})}createWasmcodecDecoder(t,e){return new f.A({resource:e,onReceiveAVFrame(e){t.firstDecoded=!0,t.frameCaches.push(e),n.M[17](t.stats+144,a.f[17](t.stats+144)+BigInt(1)),t.lastDecodeTimestamp!==I.N_&&(n.M[15](t.stats+256,Math.max((0,x.A)()-t.lastDecodeTimestamp,a.f[15](t.stats+256))),t.lastDecodeTimestamp=I.N_)},avframePool:t.avframePool})}async pullAVPacketInternal(t,e){const r=await e.request("pull");if(v.ai(r)||(0,P.A)(r))return r;{const e=t.avpacketPool.alloc();return(0,_.r0)(r,e),e}}async createTask(t){const e=new u.Ay(t.leftPort),r=new u.Ay(t.rightPort),i=[],d=new g.A((0,c.A)(t.avframeList,o.A),t.avframeListMutex),h={...t,resource:await(0,S.A)(t.resource,!0),leftIPCPort:e,rightIPCPort:r,softwareDecoder:null,hardwareDecoder:null,frameCaches:i,inputEnd:!1,targetDecoder:null,needKeyFrame:!0,parameters:0,hardwareRetryCount:0,lastDecodeTimestamp:0,firstDecoded:!1,decoderFallbackReady:null,softwareDecoderOpened:!1,discard:0,playRate:1,avframePool:d,avpacketPool:new b.A((0,c.A)(t.avpacketList,o.A),t.avpacketListMutex)};return h.softwareDecoder=h.resource?this.createWasmcodecDecoder(h,h.resource):T.A.videoDecoder?this.createWebCodecDecoder(h,!1):null,h.softwareDecoder?(T.A.videoDecoder&&t.enableHardware&&(h.hardwareDecoder=this.createWebCodecDecoder(h)),h.targetDecoder=h.hardwareDecoder||h.softwareDecoder,this.tasks.set(t.taskId,h),r.on(u.S3,(async o=>{switch(o.method){case"pull":if(i.length){const t=i.shift();r.reply(o,t,null,(0,P.A)(t)||v.ai(t)?null:[t]);break}if(!h.inputEnd){for(;;){if(i.length){const t=i.shift();r.reply(o,t,null,(0,P.A)(t)||v.ai(t)?null:[t]);break}if(h.decoderFallbackReady){let t=await h.decoderFallbackReady;if(t&&(h.targetDecoder===h.hardwareDecoder&&(h.targetDecoder=h.softwareDecoder,h.hardwareDecoder.close(),h.hardwareDecoder=null,m.R8(`video decode error by hardware decoder(${h.hardwareRetryCount}), taskId: ${h.taskId}, error: ${t}, try to fallback to software decoder`,$,265),t=await this.openSoftwareDecoder(h)),t)){m.pq(`video decoder open error, taskId: ${h.taskId}`,$,269),r.reply(o,l.r8);break}h.decoderFallbackReady=null}h.lastDecodeTimestamp===I.N_&&(h.lastDecodeTimestamp=(0,x.A)());const c=await this.pullAVPacketInternal(h,e);if(-1048576===c){if(h.targetDecoder===h.hardwareDecoder?await s().race([new y.A(2),h.targetDecoder.flush()])&&m.R8(`video hardware decoder flush failed, ignore it, taskId: ${h.taskId}`,$,289):await h.targetDecoder.flush(),h.inputEnd=!0,h.targetDecoder===h.hardwareDecoder&&await new y.A(0),i.length){const t=i.shift();r.reply(o,t,null,h.targetDecoder===h.hardwareDecoder?[t]:null);break}m.pq(`video decoder ended, taskId: ${h.taskId}`,$,306),r.reply(o,-1048576);break}if(!(c>0)){m.z3(`video decode pull avpacket error, taskId: ${t.taskId}, ret: ${c}`,$,450),r.reply(o,c);break}{if(h.needKeyFrame){if(!(1&a.f[15](c+36)&&27!==a.f[15](h.parameters+4)||27===a.f[15](h.parameters+4)&&D.KD(c,a.f[20](h.parameters+12)?1+(3&L.r8(a.f[20](h.parameters+12)+4)):4)||173===a.f[15](h.parameters+4)&&U.KD(c,a.f[20](h.parameters+12)?1+(3&L.r8(a.f[20](h.parameters+12)+21)):4)||196===a.f[15](h.parameters+4)&&E.KD(c,a.f[20](h.parameters+12)?1+(L.r8(a.f[20](h.parameters+12))>>>1&3):4))){h.avpacketPool.release(c);continue}h.needKeyFrame=!1,n.M[15](c+36,1|a.f[15](c+36))}let e=h.targetDecoder.decode(c);if(1&a.f[15](c+36)){const t=(0,B.rU)(c,1);0!==t&&(a.f[20](h.parameters+12)&&(0,M.Eb)(a.f[20](h.parameters+12)),n.M[15](h.parameters+16,0|a.f[25](t+4)),n.M[20](h.parameters+12,(0,M.sY)(a.f[25](t+4))),(0,R.Mr)(a.f[20](h.parameters+12),a.f[20](t),a.f[25](t+4)))}if(e<0){if(n.M[15](h.stats+136,a.f[15](h.stats+136)+1),h.targetDecoder instanceof p.A&&h.softwareDecoder){if(m.R8(`video decode error from hardware, taskId: ${h.taskId}, error: ${e}, try to fallback to software decoder`,$,371),h.targetDecoder===h.hardwareDecoder)h.hardwareDecoder.close(),h.hardwareDecoder=null;else{if(!h.resource){m.z3(`cannot fallback to wasm video decoder because of resource not found , taskId: ${t.taskId}`,$,383),r.reply(o,l.r8);break}h.softwareDecoder.close(),h.softwareDecoder=this.createWasmcodecDecoder(h,h.resource),h.softwareDecoderOpened=!1}try{await this.openSoftwareDecoder(h),h.targetDecoder=h.softwareDecoder}catch(e){m.z3(`video software decoder open error, taskId: ${t.taskId}`,$,393),r.reply(o,l.r8);break}if(!(1&a.f[15](c+36))){h.avpacketPool.release(c),h.needKeyFrame=!0,h.leftIPCPort.request("requestKeyframe");continue}if(e=h.targetDecoder.decode(c),e>=0){h.avpacketPool.release(c);continue}if(h.targetDecoder instanceof p.A&&h.resource){m.R8(`video decode error by webcodecs soft decoder, taskId: ${h.taskId}, error: ${e}, try to fallback to wasm software decoder`,$,407),h.softwareDecoder.close(),h.softwareDecoder=this.createWasmcodecDecoder(h,h.resource),h.softwareDecoderOpened=!1;try{await this.openSoftwareDecoder(h),h.targetDecoder=h.softwareDecoder}catch(e){m.z3(`video wasm software decoder open error, taskId: ${t.taskId}`,$,417),r.reply(o,l.r8);break}if(e=h.targetDecoder.decode(c),e>=0){h.avpacketPool.release(c);continue}}}h.avpacketPool.release(c),m.z3(`video decode error, taskId: ${t.taskId}, ret: ${e}`,$,436),r.reply(o,e);break}for(h.avpacketPool.release(c);h.targetDecoder instanceof p.A&&h.targetDecoder.getQueueLength()>20;)await new y.A(0)}}break}m.pq(`video decoder ended, taskId: ${h.taskId}`,$,457),r.reply(o,-1048576)}})),0):(m.z3("software decoder not support",$,230),l.lh)}async openSoftwareDecoder(t){if(t.softwareDecoder&&!t.softwareDecoderOpened){const e=t.parameters;let r=1;if((0,w.A)()){let t=a.f[15](e+56)*a.f[15](e+60),i=(0,k.lb)((0,c.A)(e+72,d.P));t>=2073600&&t<=2211840?(173!==a.f[15](e+4)&&196!==a.f[15](e+4)&&225!==a.f[15](e+4)||(r=2),i>30?(r=2,173!==a.f[15](e+4)&&196!==a.f[15](e+4)&&225!==a.f[15](e+4)||(r=4)):i>60&&(r=4,173!==a.f[15](e+4)&&196!==a.f[15](e+4)&&225!==a.f[15](e+4)||(r=6))):t>2211840&&t<=8294400?(r=4,173!==a.f[15](e+4)&&196!==a.f[15](e+4)&&225!==a.f[15](e+4)||(r=6)):t>8294400&&(r=6,173!==a.f[15](e+4)&&196!==a.f[15](e+4)&&225!==a.f[15](e+4)||(r=8)),r=Math.min(r,navigator.hardwareConcurrency)}m.Yz(`open software(${t.softwareDecoder instanceof p.A?"webcodecs":"wasm"}) decoder`,$,522);let i=await t.softwareDecoder.open(e,r,t.wasmDecoderOptions);if(i){if(!(t.softwareDecoder instanceof p.A&&t.resource))return i;if(m.R8(`webcodecs software decoder open failed, ${i}, try to fallback to wasm software decoder`,$,528),t.softwareDecoder.close(),t.softwareDecoder=this.createWasmcodecDecoder(t,t.resource),i=await t.softwareDecoder.open(e,r),i)return i;t.targetDecoder=t.softwareDecoder}t.softwareDecoderOpened=!0}return 0}async reopenDecoder(t,e,r,i){const a=this.tasks.get(t);if(a){const t=(0,M.Gy)(168);let n;(0,P.A)(e)?(0,C.Yi)(t,e):(0,_.T8)(e,t),a.parameters&&(0,C.dn)(a.parameters),a.parameters=t,i&&(a.wasmDecoderOptions=i),r&&(r=await(0,S.A)(r,!0)),n=a.preferWebCodecs&&T.A.videoDecoder&&p.A.isSupported(t,!1)?this.createWebCodecDecoder(a,!1):r?this.createWasmcodecDecoder(a,r):T.A.videoDecoder?this.createWebCodecDecoder(a,!1):null;let o=T.A.videoDecoder&&a.enableHardware?this.createWebCodecDecoder(a,!0):null;return new(s())((async(e,i)=>{if(a.softwareDecoder&&a.softwareDecoder.close(),a.hardwareDecoder&&a.hardwareDecoder.close(),a.softwareDecoder=n,a.hardwareDecoder=o,a.targetDecoder=a.hardwareDecoder||a.softwareDecoder,a.hardwareRetryCount=0,a.hardwareDecoder){const e=await a.hardwareDecoder.open(t);e?(m.z3(`cannot reopen hardware decoder, ${e}, taskId: ${a.taskId}`,$,604),a.hardwareDecoder.close(),a.hardwareDecoder=null,a.targetDecoder=a.softwareDecoder):m.Yz(`reopen video hardware decoder, taskId: ${a.taskId}`,$,610)}if(r&&(a.resource=r),a.targetDecoder===a.softwareDecoder){const t=await this.openSoftwareDecoder(a);if(t){if(m.z3(`reopen video software decoder failed, error: ${t}`,$,621),!a.hardwareDecoder)return void e(l.r8)}else m.Yz(`reopen video soft decoder, taskId: ${a.taskId}`,$,628)}e(0)}))}m.h2("task not found",$,634)}async open(t,e,r={}){const i=this.tasks.get(t);if(i){i.wasmDecoderOptions=r;const t=(0,M.Gy)(168);if((0,P.A)(e)?(0,C.Yi)(t,e):(0,_.T8)(e,t),i.parameters&&(0,C.dn)(i.parameters),i.parameters=t,i.preferWebCodecs&&T.A.videoDecoder&&p.A.isSupported(t,!1)&&i.softwareDecoder instanceof f.A){i.softwareDecoder.close();const t=this.createWebCodecDecoder(i,!1);i.softwareDecoder===i.targetDecoder&&(i.targetDecoder=t),i.softwareDecoder=t}return new(s())((async(e,r)=>{if(i.hardwareDecoder){m.Yz("open hardware decoder",$,669);const e=await i.hardwareDecoder.open(t);e&&(m.R8(`cannot open hardware decoder, ${e}, try to open software decoder`,$,672),i.hardwareDecoder.close(),i.hardwareDecoder=null,i.targetDecoder=i.softwareDecoder)}if(i.targetDecoder===i.softwareDecoder){const t=await this.openSoftwareDecoder(i);if(t&&(m.z3(`open video software decoder failed, error: ${t}`,$,682),!i.hardwareDecoder))return void e(l.r8)}e(0)}))}m.h2("task not found",$,692)}async setPlayRate(t,e){const r=this.tasks.get(t);if(r&&r.softwareDecoder){let t=0,i=(0,k.lb)((0,c.A)(r.parameters+72,d.P));t=i>=120?e<=1?0:e<1.5||e<3?8:32:i>=60?e<1.5?0:e<3?8:e<8?24:32:e>=8?32:e>=4?24:0,r.softwareDecoder.setSkipFrameDiscard(t),r.playRate<e?r.discard=t:r.discard=Math.max(r.discard,t),r.playRate=e}}async setNextDiscard(t){const e=this.tasks.get(t);e&&e.softwareDecoder&&e.discard<32&&(e.discard+=8,e.softwareDecoder.setSkipFrameDiscard(e.discard),m.pq(`set next discard, taskId: ${e.taskId}, discard: ${e.discard}`,$,759))}async setPrevDiscard(t){const e=this.tasks.get(t);e&&e.softwareDecoder&&e.discard>0&&(e.discard-=8,e.softwareDecoder.setSkipFrameDiscard(e.discard),m.pq(`set prev discard, taskId: ${e.taskId}, discard: ${e.discard}`,$,771))}async resetTask(t){const e=this.tasks.get(t);e&&(e.targetDecoder===e.softwareDecoder?await e.targetDecoder.flush():e.targetDecoder===e.hardwareDecoder&&(e.hardwareDecoder.close(),e.hardwareDecoder=this.createWebCodecDecoder(e),await e.hardwareDecoder.open(e.parameters)&&m.h2("reopen hardware decoder failed",$,788),e.targetDecoder=e.hardwareDecoder),A.__(e.frameCaches,(t=>{(0,P.A)(t)?e.avframePool.release(t):t.close()})),e.frameCaches.length=0,e.needKeyFrame=!0,e.inputEnd=!1,e.lastDecodeTimestamp=(0,x.A)(),m.pq(`reset video decoder, taskId: ${e.taskId}`,$,805))}async registerTask(t){return this.tasks.has(t.taskId)?l.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);e&&(e.rightPort.close(),e.leftPort.close(),e.softwareDecoder&&e.softwareDecoder.close(),e.hardwareDecoder&&e.hardwareDecoder.close(),e.frameCaches.forEach((t=>{(0,P.A)(t)?e.avframePool.release(t):t.close()})),e.parameters&&(0,C.dn)(e.parameters),this.tasks.delete(t),m.Yz(`unregisterTask task, taskId: ${t}`,$,839))}async getTasksInfo(){const t=[];return this.tasks.forEach((e=>{t.push({codecId:a.f[15](e.parameters+4),width:a.f[15](e.parameters+56),height:a.f[15](e.parameters+60),framerate:(0,k.lb)((0,c.A)(e.parameters+72,d.P)),hardware:e.targetDecoder===e.hardwareDecoder})})),t}}},33968:(t,e,r)=>{"use strict";r.d(e,{A:()=>V});var i=r(54001),s=r.n(i),a=r(12264),n=r(29170),o=r(63939),c=(r(9599),r(50932)),d=r(44527),h=r(9705),l=r(84149),u=r(67672),f=r(72739),p=r(16041),m=r(95797),g=r(39148),v=r(86932),A=r(44328),y=r(77231),b=r(86834),w=r(4624),k=r(43607),x=r(15045),I=r(88103),T=r(54750),P=r(69047),S=r(3016),_=r(38222),M=r(87623),C=r(63849),B=r(39638),R=r(7972),D=r(72703),U=r(44690),E=r(74936);const L="src\\avpipeline\\VideoRenderPipeline.ts",$=[_.A];$.push(M.A);const F=[P.A];var O;F.push(S.A),function(t){t[t.None=0]="None",t[t.Accelerate=1]="Accelerate",t[t.Decelerate=2]="Decelerate"}(O||(O={}));let z=!1;const N=["bt2020","bt2100","st2048","p3-dcl","hlg"];class V extends d.A{constructor(){super()}async createTask(t){const e=new l.Ay(t.leftPort),r=new l.Ay(t.controlPort),i={...t,leftIPCPort:e,controlIPCPort:r,render:null,frontFrame:null,backFrame:null,renderFrame:null,renderFrameCount:BigInt(0),loop:null,renderRedyed:!1,currentPTS:y.Dh,adjust:O.None,adjustDiff:BigInt(0),lastAdjustTimestamp:BigInt(0),lastMasterPts:y.Dh,masterTimer:new E.A,lastNotifyPTS:BigInt(0),playRate:BigInt(100),firstRendered:!1,canvasUpdated:!1,renderCreating:!1,renderRecreateCount:0,skipRender:!1,isSupport:()=>!1,frontBuffered:!1,ended:!1,seeking:!1,seekSync:null,afterPullResolver:null,pausing:!1,lastRenderTimestamp:0,avframePool:new p.A((0,n.A)(t.avframeList,a.A),t.avframeListMutex)};return r.on(l.Wo,(async t=>{switch(t.method){case"syncPts":{const e=t.params.pts,r=i.masterTimer.getMasterTime(),s=Math.abs(Number(e-r));s>100&&i.currentPTS>BigInt(0)&&(e>r?(i.adjust=O.Accelerate,w.Yz(`video render sync master time accelerate, targetMaster: ${e}, currentMaster: ${r}, diff: ${s}, taskId: ${i.taskId}`,L,225)):(i.adjust=O.Decelerate,w.Yz(`video render sync master time decelerate, targetMaster: ${e}, currentMaster: ${r}, diff: ${s} taskId: ${i.taskId}`,L,229)),i.adjustDiff=BigInt(Math.floor(s)));break}case"skipRender":i.skipRender=t.params.skipRender}})),this.tasks.set(t.taskId,i),0}swap(t){if(!t.seeking){if(t.backFrame&&((0,D.A)(t.backFrame)?t.avframePool.release(t.backFrame):t.backFrame.close()),t.backFrame=null,!t.frontBuffered)return!1;if(t.backFrame=t.frontFrame,t.frontFrame=null,c.M[17](t.stats+352,(0,D.A)(t.backFrame)?(0,A.Mr)(o.f[17](t.backFrame+104),t.backFrame+120,y.i0):(0,A.k)(BigInt(t.backFrame.timestamp),y.KR,y.i0)),!t.ended)return t.frontBuffered=!1,t.leftIPCPort.request("pull").then((e=>(t.afterPullResolver&&t.afterPullResolver(),u.ai(e)&&e<0?(t.ended=!0,void(t.frontFrame=null)):(t.frontFrame=e,t.frontBuffered=!0,t.seekSync?(t.seekSync(),void(t.seekSync=null)):void(t.backFrame||this.swap(t)))))),!0}}fakeSyncPts(t){const e=t.masterTimer.getMasterTime();e-t.lastNotifyPTS>=BigInt(1e3)&&(t.lastNotifyPTS=e,c.M[17](t.stats+336,e),t.controlIPCPort.notify("syncPts",{pts:e}))}async createRender(t,e,r=!1){if(!t.renderCreating){var i;if(t.renderCreating=!0,t.renderRedyed=!1,t.render&&t.render.destroy(),"function"==typeof WritableStream&&t.canvas instanceof WritableStream?(t.render=new C.A(t.canvas),t.isSupport=C.A.isSupport):(0,D.A)(e)?(t.enableWebGPU&&m.A.webgpu&&!z&&f.__($,(r=>{if(r.isSupport(e))return t.render=new r(t.canvas,{sar:t.sar,devicePixelRatio:t.devicePixelRatio,renderMode:t.renderMode,onRenderContextLost:()=>{t.canvasUpdated=!1,t.renderRedyed=!1,w.R8("render context lost",L,397),t.controlIPCPort.notify("updateCanvas")}}),t.isSupport=r.isSupport,!1})),t.render||f.__(F,(r=>{if(r.isSupport(e))return t.render=new r(t.canvas,{sar:t.sar,devicePixelRatio:t.devicePixelRatio,renderMode:t.renderMode,onRenderContextLost:()=>{t.canvasUpdated=!1,t.renderRedyed=!1,w.R8("render context lost",L,416),t.controlIPCPort.notify("updateCanvas")}}),t.isSupport=r.isSupport,!1}))):t.enableWebGPU&&m.A.webgpu&&!z&&((b.A.chrome||b.A.newEdge)&&b.A.checkVersion(b.A.majorVersion,"116",!0)||b.A.safari&&b.A.checkVersion(b.A.majorVersion,"17.4",!0)||U.A.ios&&b.A.checkVersion(U.A.version,"17.4",!0)||b.A.firefox&&b.A.checkVersion(b.A.majorVersion,"129",!0))&&(i=e.colorSpace.primaries,!f.zy(N,i))?(t.render=new T.A(t.canvas,{sar:t.sar,devicePixelRatio:t.devicePixelRatio,renderMode:t.renderMode,onRenderContextLost:()=>{t.canvasUpdated=!1,t.renderRedyed=!1,w.R8("render context lost",L,357),t.controlIPCPort.notify("updateCanvas")}}),t.isSupport=T.A.isSupport):(t.render=new I.A(t.canvas,{sar:t.sar,devicePixelRatio:t.devicePixelRatio,renderMode:t.renderMode,colorSpace:"pq"===e.colorSpace.transfer?"rec2100-pq":"hlg"===e.colorSpace.transfer?"rec2100-hlg":void 0}),t.isSupport=I.A.isSupport),!t.render)return w.z3(`not found format ${e.format} render`,L,428),void(t.renderCreating=!1);try{var s,a,n;await t.render.init(),t.render.viewport(t.viewportWidth,t.viewportHeight),t.render.setRotate(null!==(s=t.renderRotate)&&void 0!==s?s:0,!1),t.render.enableHorizontalFlip(null!==(a=t.flipHorizontal)&&void 0!==a&&a),t.render.enableVerticalFlip(null!==(n=t.flipVertical)&&void 0!==n&&n),t.render.render(e),t.render.clear()}catch(i){if(t.render instanceof x.A&&!r)return z=!0,t.renderCreating=!1,w.R8("not support webgpu render, try to fallback to webgl render",L,447),this.createRender(t,e,!0);if(r){if(t.renderCreating=!1,w.R8("canvas context lost after fallback, wait for recreate canvas",L,452),t.renderRecreateCount<3)return t.renderRecreateCount++,void t.controlIPCPort.notify("updateCanvas");throw i}}t.renderRedyed=!0,t.renderCreating=!1,t.renderRecreateCount=0}}async play(t){const e=this.tasks.get(t);if(e){if(e.loop&&w.h2("task has already call play",L,474),e.backFrame=await e.leftIPCPort.request("pull"),u.ai(e.backFrame)&&e.backFrame<0)return e.backFrame=0,w.pq(`video render ended, taskId: ${e.taskId}`,L,481),void e.controlIPCPort.notify("ended");e.frontFrame=await e.leftIPCPort.request("pull"),e.frontBuffered=!0,e.ended=!1,u.ai(e.frontFrame)&&e.frontFrame<0&&(e.ended=!0,e.frontBuffered=!1,e.frontFrame=0),await this.createRender(e,e.backFrame),e.currentPTS=(0,D.A)(e.backFrame)?(0,A.Mr)(o.f[17](e.backFrame+104),e.backFrame+120,y.i0):(0,A.k)(BigInt(e.backFrame.timestamp),y.KR,y.i0),w.Yz(`got first video frame, pts: ${(0,D.A)(e.backFrame)?o.f[17](e.backFrame+104):BigInt(e.backFrame.timestamp)}(${e.currentPTS}ms), taskId: ${e.taskId}`,L,511),e.masterTimer.setMasterTime(e.lastMasterPts===y.Dh?e.startPTS:e.lastMasterPts),e.lastMasterPts=y.Dh,c.M[17](e.stats+352,e.currentPTS);const t=(0,B.A)(),r=t&&m.A.shareArrayBuffer?0:10;e.loop=new g.A((()=>{if(!e.backFrame)return void(e.ended?(e.loop.stop(),e.adjust=O.None,w.pq(`video render ended, taskId: ${e.taskId}`,L,532),e.controlIPCPort.notify("ended")):e.loop.emptyTask());if(!e.isSupport(e.backFrame)){if(e.render){if(!e.renderRedyed)return;return e.renderRedyed=!1,e.renderFrame=e.backFrame,void e.controlIPCPort.notify("updateCanvas")}this.createRender(e,e.backFrame)}const r=(0,D.A)(e.backFrame)?(0,A.Mr)(o.f[17](e.backFrame+104),e.backFrame+120,y.i0):(0,A.k)(BigInt(e.backFrame.timestamp),y.KR,y.i0);if(r<e.currentPTS){if(!(e.currentPTS-r>BigInt(5e3)))return w.R8(`dropping frame with pts ${r}, which is earlier then the last rendered frame(${e.currentPTS}), taskId: ${e.taskId}`,L,571),void this.swap(e);e.masterTimer.setMasterTime(r)}else r-e.currentPTS>BigInt(4e3)&&e.isLive&&e.masterTimer.setMasterTime(r);if(e.adjust===O.Accelerate){if(e.adjustDiff<=0)e.adjust=O.None,e.lastAdjustTimestamp=BigInt(0);else if(BigInt(Math.floor((0,v.A)()))-e.lastAdjustTimestamp>=BigInt(100)){const t=k.jk(e.adjustDiff,BigInt(100));e.masterTimer.setMasterTime(e.masterTimer.getMasterTime()+t),e.adjustDiff-=t,w.Yz(`video render accelerate master time add: ${t}, taskId: ${e.taskId}`,L,593),e.lastAdjustTimestamp=BigInt(Math.floor((0,v.A)()))}}else if(e.adjust===O.Decelerate)if(e.adjustDiff<=0)e.adjust=O.None,e.lastAdjustTimestamp=BigInt(0);else if(BigInt(Math.floor((0,v.A)()))-e.lastAdjustTimestamp>=BigInt(300)){const t=k.jk(e.adjustDiff,BigInt(50));e.masterTimer.setMasterTime(e.masterTimer.getMasterTime()-t),e.adjustDiff-=t,w.Yz(`video render decelerate master time sub: ${t}, taskId: ${e.taskId}`,L,611),e.lastAdjustTimestamp=BigInt(Math.floor((0,v.A)()))}e.enableJitterBuffer&&o.f[15](e.stats+120)/o.f[15](e.stats+232)*1e3<=o.f[15](e.stats+280)&&this.setPlayRate(e.taskId,1);const i=r-e.masterTimer.getMasterTime();i<=0?(e.renderRedyed&&!e.skipRender&&(t||-i<BigInt(100)||e.renderFrameCount&BigInt(1))?(e.render.render(e.backFrame),c.M[17](e.stats+160,o.f[17](e.stats+160)+BigInt(1)),e.lastRenderTimestamp&&c.M[15](e.stats+260,Math.max((0,v.A)()-e.lastRenderTimestamp,o.f[15](e.stats+260))),e.lastRenderTimestamp=(0,v.A)()):c.M[15](e.stats+168,o.f[15](e.stats+168)+1),c.M[17](e.stats+336,r),e.renderFrameCount++,(0,D.A)(e.backFrame)?(c.M[15](e.stats+84,o.f[15](e.backFrame+68)),c.M[15](e.stats+88,o.f[15](e.backFrame+72))):(c.M[15](e.stats+84,e.backFrame.displayWidth),c.M[15](e.stats+88,e.backFrame.displayHeight)),e.firstRendered||(e.controlIPCPort.notify(e.canvasUpdated?"firstRenderedAfterUpdateCanvas":"firstRendered"),e.firstRendered=!0,e.canvasUpdated=!1),e.currentPTS=r,r-e.lastNotifyPTS>=BigInt(1e3)&&(e.lastNotifyPTS=r,e.controlIPCPort.notify("syncPts",{pts:r})),this.swap(e),e.masterTimer.getMasterTime()-r>=BigInt(2e3)&&e.masterTimer.setMasterTime(r)):(this.fakeSyncPts(e),e.loop.emptyTask())}),0,r),e.loop.start()}else w.h2("task not found",L,683)}async restart(t){const e=this.tasks.get(t);e&&(e.loop||w.h2("task has not played",L,691),e.loop.isStarted()&&w.h2("task has already run",L,695),e.backFrame||(e.backFrame=await e.leftIPCPort.request("pull")),e.frontFrame||(e.frontFrame=await e.leftIPCPort.request("pull")),e.frontBuffered=!0,e.ended=!1,e.adjust=O.None,e.lastNotifyPTS=y.Dh,e.firstRendered=!1,e.pausing=!1,e.seeking=!1,(!e.frontFrame||u.ai(e.frontFrame)&&e.frontFrame<0)&&(e.frontBuffered=!1,e.ended=!0),e.currentPTS=(0,D.A)(e.backFrame)?(0,A.Mr)(o.f[17](e.backFrame+104),e.backFrame+120,y.i0):(0,A.k)(BigInt(e.backFrame.timestamp),y.KR,y.i0),e.masterTimer.setMasterTime(k.T9(e.startPTS,e.currentPTS)),e.loop.start())}async pause(t){const e=this.tasks.get(t);e&&(e.loop||w.h2("task has not played",L,740),e.loop.stop(),e.pausing=!0,e.lastMasterPts=e.masterTimer.getMasterTime(),w.pq(`task paused, taskId: ${e.taskId}`,L,746))}async unpause(t){const e=this.tasks.get(t);if(e){if(e.seeking)return;e.loop||w.h2("task has not played",L,757),e.masterTimer.setMasterTime(e.lastMasterPts),e.lastMasterPts=y.Dh,e.seeking||e.loop.start(),e.pausing=!1,e.lastRenderTimestamp=(0,v.A)(),w.pq(`task unpaused, taskId: ${e.taskId}`,L,767)}}async updateCanvas(t,e){const r=this.tasks.get(t);r?(r.canvas=e,r.render&&(r.render.destroy(),r.render=null),r.isSupport=()=>!1,r.canvasUpdated=!0,r.firstRendered=!1,r.renderRedyed=!1):w.h2("task not found",L,785)}async setPlayRate(t,e){const r=this.tasks.get(t);r&&(r.enableJitterBuffer&&o.f[15](r.stats+120)/o.f[15](r.stats+232)*1e3<=o.f[15](r.stats+280)&&(e=1),r.masterTimer.setRate(e),r.playRate=BigInt(Math.floor(Math.floor(100*e))))}async setRenderMode(t,e){const r=this.tasks.get(t);r&&r.render&&(r.renderMode=e,r.render.setRenderMode(e),(0,R.A)((()=>{r.pausing&&r.backFrame&&r.render&&r.render.render(r.backFrame)})))}async setRenderRotate(t,e){const r=this.tasks.get(t);r&&r.render&&(r.renderRotate=e,r.render.setRotate(e),(0,R.A)((()=>{r.pausing&&r.backFrame&&r.render&&r.render.render(r.backFrame)})))}async enableHorizontalFlip(t,e){const r=this.tasks.get(t);r&&r.render&&(r.flipHorizontal=e,r.render.enableHorizontalFlip(e),(0,R.A)((()=>{r.pausing&&r.backFrame&&r.render&&r.render.render(r.backFrame)})))}async enableVerticalFlip(t,e){const r=this.tasks.get(t);r&&r.render&&(r.flipVertical=e,r.render.enableVerticalFlip(e),(0,R.A)((()=>{r.pausing&&r.backFrame&&r.render&&r.render.render(r.backFrame)})))}async resize(t,e,r){const i=this.tasks.get(t);i&&i.render&&(i.render.viewport(e,r),(0,R.A)((()=>{i.pausing&&i.backFrame&&i.render&&i.render.render(i.backFrame)})))}async setSkipRender(t,e){const r=this.tasks.get(t);r&&(r.skipRender=e,c.M[15](r.stats+260,0),r.lastRenderTimestamp=(0,v.A)())}async setMasterTime(t,e){const r=this.tasks.get(t);r&&r.masterTimer.setMasterTime(e)}async beforeSeek(t){const e=this.tasks.get(t);e&&(e.ended||e.frontBuffered||(w.Yz(`wait current pull front frame before seek, taskId: ${e.taskId}`,L,898),await new(s())((t=>{e.seekSync=t}))),e.seeking=!0,e.loop.stop(),e.backFrame&&((0,D.A)(e.backFrame)?e.avframePool.release(e.backFrame):e.backFrame.close()),e.frontFrame&&((0,D.A)(e.frontFrame)?e.avframePool.release(e.frontFrame):e.frontFrame.close()),e.frontFrame=null,e.backFrame=null,e.currentPTS=y.Dh,w.Yz(`before seek end, taskId: ${e.taskId}`,L,926))}async syncSeekTime(t,e,r){const i=this.tasks.get(t);if(i){for(;;){if(i.afterPullResolver)return i.ended=!0,i.adjust=O.None,i.backFrame=null,void w.R8(`pull video frame end after unregisterTask, taskId: ${t}`,L,939);if(i.backFrame=await i.leftIPCPort.request("pull"),u.ai(i.backFrame)&&i.backFrame<0)return i.ended=!0,i.adjust=O.None,i.backFrame=null,void w.R8(`pull video frame end after seek, taskId: ${t}`,L,949);if(e<BigInt(0)){w.pq(`use the first video frame because of the seek time${e} < 0`,L,954);break}const r=(0,D.A)(i.backFrame)?(0,A.Mr)(o.f[17](i.backFrame+104),i.backFrame+120,y.i0):(0,A.k)(BigInt(i.backFrame.timestamp),y.KR,y.i0);if(r>=e){i.ended=!1,c.M[17](i.stats+336,r),i.lastNotifyPTS=r,i.currentPTS=r,i.masterTimer.setMasterTime(e),i.lastMasterPts=e,w.Yz(`got first video frame after syncSeekTime, pts: ${(0,D.A)(i.backFrame)?o.f[17](i.backFrame+104):BigInt(i.backFrame.timestamp)}(${i.currentPTS}ms), taskId: ${i.taskId}`,L,977);break}(0,D.A)(i.backFrame)?i.avframePool.release(i.backFrame):i.backFrame.close()}w.Yz(`sync seek time end, taskId: ${i.taskId}`,L,997)}}async afterSeek(t,e){const r=this.tasks.get(t);if(r){if(r.ended)return r.seeking=!1,r.controlIPCPort.notify("ended"),r.afterPullResolver&&(r.afterPullResolver(),r.afterPullResolver=null),void w.Yz(`after seek end with task ended, taskId: ${r.taskId}`,L,1012);if(r.frontFrame=await r.leftIPCPort.request("pull"),u.ai(r.frontFrame)&&r.frontFrame<0?(r.frontFrame=null,r.frontBuffered=!1,r.ended=!0):(r.frontBuffered=!0,r.ended=!1),r.afterPullResolver)return r.backFrame&&((0,D.A)(r.backFrame)?r.avframePool.release(r.backFrame):r.backFrame.close(),r.backFrame=null),r.frontFrame&&((0,D.A)(r.frontFrame)?r.avframePool.release(r.frontFrame):r.frontFrame.close(),r.frontFrame=null),r.seeking=!1,r.ended=!0,r.afterPullResolver(),r.afterPullResolver=null,void w.Yz(`after seek end with unregisterTask call, taskId: ${r.taskId}`,L,1051);r.adjust=O.None,r.lastRenderTimestamp=(0,v.A)(),r.currentPTS=(0,D.A)(r.backFrame)?(0,A.Mr)(o.f[17](r.backFrame+104),r.backFrame+120,y.i0):(0,A.k)(BigInt(r.backFrame.timestamp),y.KR,y.i0),c.M[17](r.stats+336,r.currentPTS),r.seeking=!1,r.pausing?r.backFrame&&r.render.render(r.backFrame):r.loop.start(),w.Yz(`after seek end, taskId: ${r.taskId}`,L,1079)}}async renderNextFrame(t){const e=this.tasks.get(t);if(e&&e.backFrame){const t=(0,D.A)(e.backFrame)?(0,A.Mr)(o.f[17](e.backFrame+104),e.backFrame+120,y.i0):(0,A.k)(BigInt(e.backFrame.timestamp),y.KR,y.i0);e.render.render(e.backFrame),c.M[17](e.stats+336,t),c.M[17](e.stats+160,o.f[17](e.stats+160)+BigInt(1)),e.currentPTS=t,e.lastMasterPts=t,this.swap(e)}}async registerTask(t){return this.tasks.has(t.taskId)?h.lh:await this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);if(e){const r=!!e.loop;e.loop&&(await e.loop.stopBeforeNextTick(),e.loop.destroy(),e.loop=null),!r||e.ended||e.frontFrame||await new(s())((t=>{e.afterPullResolver=t})),e.render&&(e.renderRedyed&&e.render.clear(),e.render.destroy(),e.render=null),e.backFrame&&((0,D.A)(e.backFrame)&&e.backFrame>0?e.avframePool.release(e.backFrame):e.backFrame.close(),e.backFrame=null),e.frontFrame&&((0,D.A)(e.frontFrame)&&e.frontFrame>0?e.avframePool.release(e.frontFrame):e.frontFrame.close(),e.frontFrame=null),e.leftIPCPort.destroy(),e.controlIPCPort.destroy(),this.tasks.delete(t),w.Yz(`unregisterTask task, taskId: ${t}`,L,1158)}}}},30128:(t,e,r)=>{"use strict";r.d(e,{A:()=>l});var i,s,a=r(134),n=r(80662),o=r.n(n),c=r(61499),d=r(12085);class h{constructor(){(0,a.A)(this,"min",void 0),(0,a.A)(this,"max",void 0)}}i=h.prototype,(s=new(o())).set("min",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("max",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,d.A)(i,c.Og,!0),(0,d.A)(i,c.dc,4),(0,d.A)(i,c.g7,8),(0,d.A)(i,c.JY,s);class l{constructor(){(0,a.A)(this,"channels",void 0),(0,a.A)(this,"sampleRate",void 0),(0,a.A)(this,"audioFrameSize",void 0),(0,a.A)(this,"audioPacketBytes",void 0),(0,a.A)(this,"audioPacketCount",void 0),(0,a.A)(this,"audioPacketQueueLength",void 0),(0,a.A)(this,"audioDropPacketCount",void 0),(0,a.A)(this,"audioDecodeErrorPacketCount",void 0),(0,a.A)(this,"audioEncodeErrorFrameCount",void 0),(0,a.A)(this,"audioFrameDecodeCount",void 0),(0,a.A)(this,"audioPacketEncodeCount",void 0),(0,a.A)(this,"audioFrameRenderCount",void 0),(0,a.A)(this,"audioFrameDropCount",void 0),(0,a.A)(this,"width",void 0),(0,a.A)(this,"height",void 0),(0,a.A)(this,"keyFrameInterval",void 0),(0,a.A)(this,"gop",void 0),(0,a.A)(this,"videoPacketBytes",void 0),(0,a.A)(this,"videoPacketCount",void 0),(0,a.A)(this,"videoPacketQueueLength",void 0),(0,a.A)(this,"videoDropPacketCount",void 0),(0,a.A)(this,"videoDecodeErrorPacketCount",void 0),(0,a.A)(this,"videoEncodeErrorFrameCount",void 0),(0,a.A)(this,"videoFrameDecodeCount",void 0),(0,a.A)(this,"videoPacketEncodeCount",void 0),(0,a.A)(this,"videoFrameRenderCount",void 0),(0,a.A)(this,"videoFrameDropCount",void 0),(0,a.A)(this,"keyFrameCount",void 0),(0,a.A)(this,"bufferDropBytes",void 0),(0,a.A)(this,"bufferReceiveBytes",void 0),(0,a.A)(this,"bufferSendBytes",void 0),(0,a.A)(this,"bufferOutputBytes",void 0),(0,a.A)(this,"audioBitrate",void 0),(0,a.A)(this,"videoBitrate",void 0),(0,a.A)(this,"videoDecodeFramerate",void 0),(0,a.A)(this,"videoRenderFramerate",void 0),(0,a.A)(this,"videoEncodeFramerate",void 0),(0,a.A)(this,"audioDecodeFramerate",void 0),(0,a.A)(this,"audioRenderFramerate",void 0),(0,a.A)(this,"audioEncodeFramerate",void 0),(0,a.A)(this,"audioFrameDecodeIntervalMax",void 0),(0,a.A)(this,"audioFrameRenderIntervalMax",void 0),(0,a.A)(this,"videoFrameDecodeIntervalMax",void 0),(0,a.A)(this,"videoFrameRenderIntervalMax",void 0),(0,a.A)(this,"bandwidth",void 0),(0,a.A)(this,"jitter",void 0),(0,a.A)(this,"jitterBuffer",void 0),(0,a.A)(this,"audioStutter",void 0),(0,a.A)(this,"videoStutter",void 0),(0,a.A)(this,"audiocodec",void 0),(0,a.A)(this,"videocodec",void 0),(0,a.A)(this,"firstAudioMuxDts",void 0),(0,a.A)(this,"lastAudioMuxDts",void 0),(0,a.A)(this,"firstVideoMuxDts",void 0),(0,a.A)(this,"lastVideoMuxDts",void 0),(0,a.A)(this,"audioCurrentTime",void 0),(0,a.A)(this,"videoCurrentTime",void 0),(0,a.A)(this,"audioNextTime",void 0),(0,a.A)(this,"videoNextTime",void 0)}}!function(t){var e=new(o());e.set("channels",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("audioFrameSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),e.set("audioPacketBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),e.set("audioPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),e.set("audioPacketQueueLength",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),e.set("audioDropPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:40,8:0}),e.set("audioDecodeErrorPacketCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),e.set("audioEncodeErrorFrameCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:52,8:0}),e.set("audioFrameDecodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:56,8:0}),e.set("audioPacketEncodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:64,8:0}),e.set("audioFrameRenderCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),e.set("audioFrameDropCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),e.set("width",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),e.set("height",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),e.set("keyFrameInterval",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:92,8:0}),e.set("gop",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:96,8:0}),e.set("videoPacketBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:104,8:0}),e.set("videoPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:112,8:0}),e.set("videoPacketQueueLength",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:120,8:0}),e.set("videoDropPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:128,8:0}),e.set("videoDecodeErrorPacketCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:136,8:0}),e.set("videoEncodeErrorFrameCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:140,8:0}),e.set("videoFrameDecodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:144,8:0}),e.set("videoPacketEncodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:152,8:0}),e.set("videoFrameRenderCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:160,8:0}),e.set("videoFrameDropCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:168,8:0}),e.set("keyFrameCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:176,8:0}),e.set("bufferDropBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:184,8:0}),e.set("bufferReceiveBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:192,8:0}),e.set("bufferSendBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:200,8:0}),e.set("bufferOutputBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:208,8:0}),e.set("audioBitrate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:216,8:0}),e.set("videoBitrate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:220,8:0}),e.set("videoDecodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:224,8:0}),e.set("videoRenderFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:228,8:0}),e.set("videoEncodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:232,8:0}),e.set("audioDecodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:236,8:0}),e.set("audioRenderFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:240,8:0}),e.set("audioEncodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:244,8:0}),e.set("audioFrameDecodeIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:248,8:0}),e.set("audioFrameRenderIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:252,8:0}),e.set("videoFrameDecodeIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:256,8:0}),e.set("videoFrameRenderIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:260,8:0}),e.set("bandwidth",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:264,8:0}),e.set("jitter",{0:19,1:0,2:0,3:0,4:0,5:0,6:0,7:272,8:0}),e.set("jitterBuffer",{0:h,1:0,2:0,3:0,4:0,5:0,6:0,7:280,8:0}),e.set("audioStutter",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:288,8:0}),e.set("videoStutter",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:292,8:0}),e.set("firstAudioMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:296,8:0}),e.set("lastAudioMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:304,8:0}),e.set("firstVideoMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:312,8:0}),e.set("lastVideoMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:320,8:0}),e.set("audioCurrentTime",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:328,8:0}),e.set("videoCurrentTime",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:336,8:0}),e.set("audioNextTime",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:344,8:0}),e.set("videoNextTime",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:352,8:0}),(0,d.A)(t,c.Og,!0),(0,d.A)(t,c.dc,8),(0,d.A)(t,c.g7,360),(0,d.A)(t,c.JY,e)}(l.prototype)},61634:(t,e,r)=>{"use strict";r.d(e,{default:()=>Gt});var i=r(134),s=r(66681),a=r.n(s),n=r(73146),o=r.n(n),c=r(54001),d=r.n(c),h=r(80662),l=r.n(h),u=r(61499),f=r(52277),p=r(74503),m=r(63939),g=r(9599),v=r(29170),A=r(77162),y=r(94300),b=r(87243),w=r(72480),k=r(31138),x=r(18667),I=r(88506),T=r(96172),P=r(8284),S=r(67672),_=r(95335),M=r(76045),C=r(56024),B=r(71517),R=r(59377),D=r(33968),U=r(8507),E=r(26429),L=r(41324),$=r(88397),F=r(11473),O=r(11628),z=r(28090),N=r(47595),V=r(4624),W=r(95797),G=r(48641),q=r(36),H=r(86834),j=r(44328),Y=r(77231),Q=(r(30128),r(14686)),K=r(67593),X=r(28875),J=r(10333),Z=r(85224),tt=r(25115),et=r(39365),rt=r(13724),it=r(78201),st=r(73783),at=r(43607),nt=r(76750),ot=r(2368),ct=r(79756),dt=r(62751),ht=r(548),lt=r(72739),ut=r(24310),ft=r(93147),pt=r(40031),mt=r(94561),gt=r(44690),vt=r(84149),At=r(9705),yt=r(77580),bt=r(79686),wt=r(49847),kt=r(71762),xt=r(29998),It=r(40097),Tt=r(21678),Pt=r(21862),St=r(364),_t=r(14619),Mt=r(36773),Ct=r(42383),Bt=r(67603),Rt=r(50315),Dt=r(3680),Ut=r(61619),Et=r(37837),Lt=r(80089),$t=r(30691),Ft=r(50011);const Ot="src\\avplayer\\AVPlayer.ts",zt={1:"cover",0:"contain"},Nt=[27,173,12,196,225,139,167,30,2,1,3,4,20,19,14,15,16,5,6,68,69,17,18,71,7,86018,86017,86076,86028,86051,86021,86019,86056,86020,86023,86024,86052,86054,86053,86036,86057,86073,94226,94225,94230,94212,94232,94213,94210],Vt=[27,173,225,139,167,86018,86017,86076,86028,86021],Wt={enableHardware:!0,enableWebGPU:!0,enableWorker:!0,enableWebCodecs:!0,loop:!1,enableJitterBuffer:!0,jitterBufferMax:4,jitterBufferMin:1,lowLatency:!1,preLoadTime:4};class Gt extends T.A{constructor(t){super(!0),(0,i.A)(this,"VideoDecoderThread",void 0),(0,i.A)(this,"VideoRenderThread",void 0),(0,i.A)(this,"VideoPipelineProxy",void 0),(0,i.A)(this,"GlobalData",void 0),(0,i.A)(this,"taskId",void 0),(0,i.A)(this,"subTaskId",void 0),(0,i.A)(this,"subtitleTaskId",void 0),(0,i.A)(this,"ext",void 0),(0,i.A)(this,"source",void 0),(0,i.A)(this,"ioIPCPort",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"ioloader2DemuxerChannel",void 0),(0,i.A)(this,"demuxer2VideoDecoderChannel",void 0),(0,i.A)(this,"demuxer2AudioDecoderChannel",void 0),(0,i.A)(this,"videoDecoder2VideoRenderChannel",void 0),(0,i.A)(this,"audioDecoder2AudioRenderChannel",void 0),(0,i.A)(this,"audioRender2AudioWorkletChannel",void 0),(0,i.A)(this,"audioSourceNode",void 0),(0,i.A)(this,"gainNode",void 0),(0,i.A)(this,"formatContext",void 0),(0,i.A)(this,"canvas",void 0),(0,i.A)(this,"updateCanvas",void 0),(0,i.A)(this,"video",void 0),(0,i.A)(this,"audio",void 0),(0,i.A)(this,"controller",void 0),(0,i.A)(this,"volume",void 0),(0,i.A)(this,"playRate",void 0),(0,i.A)(this,"renderMode",void 0),(0,i.A)(this,"renderRotate",void 0),(0,i.A)(this,"flipHorizontal",void 0),(0,i.A)(this,"flipVertical",void 0),(0,i.A)(this,"useMSE",void 0),(0,i.A)(this,"audioEnded",void 0),(0,i.A)(this,"videoEnded",void 0),(0,i.A)(this,"status",void 0),(0,i.A)(this,"lastStatus",void 0),(0,i.A)(this,"playChannels",void 0),(0,i.A)(this,"seekedTimestamp",void 0),(0,i.A)(this,"isLive_",void 0),(0,i.A)(this,"drmSystemKey",void 0),(0,i.A)(this,"drmSession",void 0),(0,i.A)(this,"stopPending",void 0),(0,i.A)(this,"statsController",void 0),(0,i.A)(this,"jitterBufferController",void 0),(0,i.A)(this,"selectedVideoStream",void 0),(0,i.A)(this,"selectedAudioStream",void 0),(0,i.A)(this,"selectedSubtitleStream",void 0),(0,i.A)(this,"lastSelectedInnerSubtitleStreamIndex",void 0),(0,i.A)(this,"subtitleRender",void 0),(0,i.A)(this,"externalSubtitleTasks",void 0),this.options=_.X$({},Wt,t),this.taskId=(0,P.A)(),this.status=0,this.volume=1,this.playRate=1,this.renderMode=0,this.renderRotate=0,this.flipHorizontal=!1,this.flipVertical=!1,this.seekedTimestamp=Y.Dh,this.isLive_=!!t.isLive,this.GlobalData=(0,p.A)(f.M),this.statsController=new it.A(this.GlobalData[u.o9]+32,!(E.USE_THREADS||!W.A.worker||!this.options.enableWorker),this),this.externalSubtitleTasks=[],this.lastSelectedInnerSubtitleStreamIndex=-1,st.Ts(this.GlobalData[u.o9]+24),st.Ts(this.GlobalData[u.o9]+28),Gt.Instances.push(this),V.pq(`create player, taskId: ${this.taskId}`,Ot,622)}get currentTime(){var t;return this.useMSE?BigInt(Math.floor(1e3*((null===(t=this.video||this.audio)||void 0===t?void 0:t.currentTime)||0))):this.selectedAudioStream&&this.selectedVideoStream?at.T9(this.GlobalData.stats.audioCurrentTime,this.GlobalData.stats.videoCurrentTime):this.selectedAudioStream?this.GlobalData.stats.audioCurrentTime:this.selectedVideoStream?this.GlobalData.stats.videoCurrentTime:BigInt(0)}isCodecIdSupported(t,e,r=!1){return t>65536&&t<=65572||t>=69632&&t<=69683||lt.zy(!r||1!==e&&0!==e?Nt:Vt,t)}findBestStream(t,e,r=!1){if(this.options.findBestStream)return this.options.findBestStream(t,e);const i=t.filter((t=>m.f[15](t.codecpar)===e));if(i.length){if(1===i.length)return i[0];const t=i.find((t=>!!(1&t.disposition)));return t&&this.isCodecIdSupported(m.f[15](t.codecpar+4),m.f[15](t.codecpar),r)?t:i.find((t=>this.isCodecIdSupported(m.f[15](t.codecpar+4),m.f[15](t.codecpar),r)))||i[0]}}async checkUseMSE(t){{if(!W.A.mse)return V.R8("disable mse because of not support mse",Ot,686),!1;if(!W.A.wasmPlayerSupported)return V.R8("use mse because of not support wasm",Ot,692),!0;const e=this.findBestStream(this.formatContext.streams,0,!0),r=this.findBestStream(this.formatContext.streams,1,!0);if(t.video&&e&&!(0,nt.A)().isTypeSupported((0,J.A)(e.codecpar)))return V.R8(`can not support mse for codec: ${(0,J.A)(e.codecpar)}, taskId: ${this.taskId}`,Ot,701),!1;if(t.audio&&r&&!(0,nt.A)().isTypeSupported((0,Z.A)(r.codecpar)))return V.R8(`can not support mse for codec: ${(0,Z.A)(r.codecpar)}, taskId: ${this.taskId}`,Ot,705),!1;if(t.video&&e&&e.metadata.encryption||t.audio&&r&&r.metadata.encryption)return!0;if(10===this.formatContext.format)return!1;if(this.options.checkUseMES)return this.options.checkUseMES(this.formatContext.streams);if(e&&t.video){if((0,ut.A)(e.codecpar))return V.R8("use mse because of hdr",Ot,729),!0;if(this.isMediaStreamMode()&&!W.A.trackGenerator){if(H.A.firefox&&(0,N.A)()&&(E.USE_THREADS||W.A.worker&&this.options.enableWorker))return V.R8("use mse because of cannot use captureStream in OffscreenCanvas on firefox",Ot,744),!0;if(H.A.safari||gt.A.ios)return V.R8("disable mse because of cannot use captureStream in HTMLMediaElement on safari",Ot,749),!1}if(m.f[15](e.codecpar+56)*m.f[15](e.codecpar+60)>2073600){if(!W.A.videoDecoder)return V.R8("use mse because of cannot use webcodec VideoDecoder with resolution more then 1080p",Ot,758),!0;if(this.isMediaStreamMode()&&!W.A.trackGenerator)return V.R8("use mse because of cannot use MediaStreamTrackGenerator with resolution more then 1080p in MediaStream mode",Ot,763),!0;let t=null;0!==m.f[20](e.codecpar+12)&&(t=(0,Q.s3)(m.f[20](e.codecpar+12),m.f[15](e.codecpar+16)));try{const r={codec:(0,X.A)(e.codecpar),codedWidth:m.f[15](e.codecpar+56),codedHeight:m.f[15](e.codecpar+60),description:1&m.f[15](e.codecpar+160)?void 0:t,hardwareAcceleration:(0,et.C)(!0)};if(r.description||delete r.description,!(await VideoDecoder.isConfigSupported(r)).supported)return V.R8("use mse because of cannot use webcodec hardwareAcceleration VideoDecoder with resolution more then 1080p",Ot,787),!0}catch(t){}}else if(m.f[15](e.codecpar+56)*m.f[15](e.codecpar+60)==2073600&&(H.A.safari&&!H.A.checkVersion(H.A.version,"16.1",!0)||gt.A.ios&&!H.A.checkVersion(gt.A.version,"16.1",!0))&&(0,j.lb)((0,v.A)(e.codecpar+72,g.P))>30)return!0}}return!1}createCanvas(){const t=document.createElement("canvas");return t.id="avplayer-canvas-"+(0,P.A)(),t.className="avplayer-canvas",t.style.cssText="\n      width: 100%;\n      height: 100%;\n    ",t.ondragstart=()=>!1,a()(t,"currentTime",{enumerable:!0,configurable:!1,get:()=>Number(this.currentTime)/1e3,set:t=>{this.seek(BigInt(Math.floor(Math.floor(1e3*t))))}}),t}createVideo(){this.video&&!this.isMediaStreamMode()&&this.options.container.removeChild(this.video);const t=document.createElement("video");t.autoplay=!0,t.className="avplayer-video",t.style.cssText="\n      width: 100%;\n      height: 100%;\n    ",this.isMediaStreamMode()||this.options.container.appendChild(t),this.video=t}createAudio(){this.audio&&!this.isMediaStreamMode()&&this.options.container.removeChild(this.audio);const t=document.createElement("audio");t.autoplay=!0,t.className="avplayer-audio",this.isMediaStreamMode()||this.options.container.appendChild(t),this.audio=t}handleTimeupdate(t){let e=0;t.ontimeupdate=()=>{const r=t.currentTime;Math.abs(r-e)>=1&&(6===this.status&&(this.fire(z.E9,[this.currentTime]),Gt.MSEThread.setCurrentTime(this.taskId,r)),e=r)},t.onended=()=>{this.audioEnded=!0,this.videoEnded=!0,this.handleEnded()},t.onwaiting=()=>{this.audio===t?this.GlobalData.stats.audioStutter++:(this.GlobalData.stats.audioStutter++,this.GlobalData.stats.videoStutter++)},t.oncanplay=()=>{6===this.status&&t.play()},t.onencrypted=async e=>{if(this.drmSession)return;this.drmSession=t.mediaKeys.createSession(),this.drmSession.onmessage=async t=>{var e;let r,i;if(this.isDash()){if(this.hasVideo()){const t=await Gt.IOThread.getCurrentProtection(this.taskId,0);null!=t&&t.url&&(r=t.url)}if(!r&&this.hasAudio()){const t=await Gt.IOThread.getCurrentProtection(this.taskId,1);null!=t&&t.url&&(r=t.url)}}if(null!==(e=this.options.drmSystemOptions)&&void 0!==e&&e.onRequest)i=await this.options.drmSystemOptions.onRequest(this.drmSystemKey,t.messageType,t.message,r);else if(this.options.drmSystemOptions.requestUrl){var s,a,n;i=await fetch(this.options.drmSystemOptions.requestUrl,{method:null!==(s=null===(a=this.options.drmSystemOptions)||void 0===a?void 0:a.method)&&void 0!==s?s:"POST",headers:null===(n=this.options.drmSystemOptions)||void 0===n?void 0:n.header,body:t.message}).then((t=>t.arrayBuffer()))}else if(r){var o,c,d,h;i=await fetch(r,{method:null!==(o=null===(c=this.options.drmSystemOptions)||void 0===c?void 0:c.method)&&void 0!==o?o:"POST",headers:null!==(d=null===(h=this.options.drmSystemOptions)||void 0===h?void 0:h.header)&&void 0!==d?d:{"Content-Type":"application/json"},body:t.message}).then((t=>t.arrayBuffer()))}i&&await this.drmSession.update(i)};let r=e.initDataType,i=e.initData;if(this.drmSystemKey===Lt.s.CLEARKEY){const t=[];if(this.selectedAudioStream){const e=this.selectedAudioStream.metadata.encryption;null!=e&&e.kid&&t.push((0,$t.A)(e.kid))}if(this.selectedVideoStream){const e=this.selectedVideoStream.metadata.encryption;if(null!=e&&e.kid){const r=(0,$t.A)(e.kid);r!==t[0]&&t.push(r)}}r="keyids",i=Ft.encode(o()({kids:t})).buffer}await this.drmSession.generateRequest(r,i)}}async replayTo(t){let e=-BigInt(1);this.isDash()||this.isHls()?(e=await Gt.DemuxerThread.seek(this.taskId,t,16),this.subTaskId&&await Gt.DemuxerThread.seek(this.subTaskId,t,16),this.subtitleTaskId&&await Gt.DemuxerThread.seek(this.subtitleTaskId,t,16)):e=await Gt.DemuxerThread.seek(this.taskId,t,8);for(let e=0;e<this.externalSubtitleTasks.length;e++)await Gt.DemuxerThread.seek(this.externalSubtitleTasks[0].taskId,t,8);if(this.fire(z.E9,[t]),this.useMSE){var r;null!==(r=this.video||this.audio)&&void 0!==r&&r.src&&URL.revokeObjectURL((this.video||this.audio).src),await Gt.MSEThread.restart(this.taskId);const e=await Gt.MSEThread.getMediaSource(this.taskId);var i,s;e&&(W.A.workerMSE&&e instanceof MediaSourceHandle?(this.video||this.audio).srcObject=e:(this.video||this.audio).src=URL.createObjectURL(e),this.video?(this.video.currentTime=Number(t)/1e3,this.video.playbackRate=this.playRate):this.audio&&(this.audio.currentTime=Number(t)/1e3,this.audio.playbackRate=this.playRate),await d().all([null===(i=this.video)||void 0===i?void 0:i.play(),null===(s=this.audio)||void 0===s?void 0:s.play()]))}else{let r=20;this.formatContext.streams.forEach((t=>{0===m.f[15](t.codecpar)&&(r=Math.max(Math.ceil((0,j.lb)((0,v.A)(t.codecpar+72,g.P))),r))})),this.audioDecoder2AudioRenderChannel&&(await Gt.AudioDecoderThread.resetTask(this.taskId),await Gt.AudioRenderThread.syncSeekTime(this.taskId,e>=0?e>t?e:t:Y.Dh,r),await Gt.AudioRenderThread.restart(this.taskId),this.controller.setTimeUpdateListenType(1)),this.audioSourceNode&&(await this.audioSourceNode.request("restart"),"suspended"===Gt.audioContext.state&&await Gt.AudioRenderThread.fakePlay(this.taskId),this.audioEnded=!1),this.videoDecoder2VideoRenderChannel&&(await this.VideoDecoderThread.resetTask(this.taskId),await this.VideoRenderThread.beforeSeek(this.taskId),await this.VideoRenderThread.syncSeekTime(this.taskId,e>=0?e>t?e:t:Y.Dh,r),await this.VideoRenderThread.restart(this.taskId),this.videoEnded=!1)}this.subtitleRender&&(this.subtitleRender.reset(),this.subtitleRender.start())}async handleEnded(){this.audioEnded&&this.videoEnded&&(V.pq(`player ended, taskId: ${this.taskId}`,Ot,1069),this.options.loop&&!this.isLive_?(V.pq(`loop play, taskId: ${this.taskId}`,Ot,1073),await this.replayTo(BigInt(0))):(this.status=7,this.fire(z.hV)))}isHls(){return"m3u8"===this.ext||"m3u"===this.ext}isDash(){return"mpd"===this.ext}getMinStartPTS(){let t=Y.Dh;for(const e of this.formatContext.streams)e.startTime!==Y.Dh&&(t=t===Y.Dh?(0,j.k)(e.startTime,e.timeBase,Y.i0):at.jk(t,(0,j.k)(e.startTime,e.timeBase,Y.i0)));return t<BigInt(1e3)?BigInt(0):t}async getResource(t,e,r){var i;const s=null!=e?`${t}-${e}`:t;if(Gt.Resource.has(s))return Gt.Resource.get(s);const a=this.options.getWasm?this.options.getWasm(t,e,r):(0,Bt.A)(null!==(i=this.options.wasmBaseUrl)&&void 0!==i?i:`https://cdn.jsdelivr.net/gh/zhaohappy/libmedia@${"v0.9.0-29-gc2ccb944".split("-")[0].replace(/^[v|n]/,"")}/dist`,t,e);if(a){let t;if((H.A.safari&&!H.A.checkVersion(H.A.version,"16.4",!0)||gt.A.ios&&!H.A.checkVersion(gt.A.version,"16.4",!0))&&(S.Yj(a)||S.sv(a)))if(S.Yj(a)){const e={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"},r=await fetch(a,e);t=await r.arrayBuffer()}else t=a;else t=await(0,mt.A)(a,0===r);return Gt.Resource.set(s,t),t}}createSubtitleRender(t,e){var r,i,s,a;this.isMediaStreamMode()||(this.subtitleRender=new pt.A({dom:this.canvas||this.video||this.options.container,getCurrentTime:()=>this.currentTime,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,codecpar:t.codecpar,container:this.options.container,videoWidth:null!==(r=m.f[15]((null===(i=this.selectedVideoStream)||void 0===i?void 0:i.codecpar)+56))&&void 0!==r?r:0,videoHeight:null!==(s=m.f[15]((null===(a=this.selectedVideoStream)||void 0===a?void 0:a.codecpar)+60))&&void 0!==s?s:0}),this.subtitleRender.setDemuxTask(e),this.selectedSubtitleStream=t,e===this.taskId&&(this.lastSelectedInnerSubtitleStreamIndex=t.index),Gt.DemuxerThread.connectStreamTask.transfer(this.subtitleRender.getDemuxerPort(e)).invoke(e,t.index,this.subtitleRender.getDemuxerPort(e)))}async loadExternalSubtitle(t){if(1!==this.status&&2!==this.status||V.h2("player has already destroyed",Ot,1211),t.source||V.h2("external subtitle must has source",Ot,1215),this.externalSubtitleTasks.some((e=>e.source===t.source)))return void V.R8("external subtitle has already loaded",Ot,1219);const e=(0,P.A)(),r=(0,K.A)(this.options.enableWorker),i=_.X$({taskId:e,streamId:-1,ioloader2DemuxerChannel:r},t);let s="",a=0,n=0;S.Yj(t.source)?(n|=4,s=U.qg(t.source).file.split(".").pop(),a=await Gt.IOThread.registerTask.transfer(r.port1).invoke({type:0,info:{url:t.source},range:{from:-1,to:-1},taskId:e,options:{isLive:this.isLive_},rightPort:r.port1,stats:this.GlobalData[u.o9]+32})):(s=t.source.name.split(".").pop(),a=await Gt.IOThread.registerTask.transfer(r.port1).invoke({type:1,info:{file:t.source},range:{from:-1,to:-1},taskId:e,options:{isLive:this.isLive_},rightPort:r.port1,stats:this.GlobalData[u.o9]+32})),a<0&&V.h2(`register io task failed, ret: ${a}, taskId: ${this.taskId}`,Ot,1283),await Gt.DemuxerThread.registerTask.transfer(r.port2).invoke({taskId:e,leftPort:r.port2,format:dt.HR[s],stats:0,isLive:!1,flags:n,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24}),a=await Gt.DemuxerThread.openStream(e),a<0&&V.h2(`open external subtitle failed, ret: ${a}, taskId: ${e}`,Ot,1300);let o=await Gt.DemuxerThread.analyzeStreams(e);if(S.ai(o))return void V.h2(`analyze stream failed, ret: ${o}`,Ot,1304);o.streams.length||V.h2("not found any stream",Ot,1308);const c=o.streams[0];this.formatContext.streams.push(c),i.streamId=c.id,t.lang&&(c.metadata.language=t.lang),t.title&&(c.metadata.title=t.title);const d=8===this.status||6===this.status||9===this.status||10===this.status;return d&&await Gt.DemuxerThread.seek(e,this.currentTime,8),d&&!this.subtitleRender?(this.createSubtitleRender(c,e),this.subtitleRender.start()):this.subtitleRender&&await Gt.DemuxerThread.connectStreamTask.transfer(this.subtitleRender.getDemuxerPort(e)).invoke(e,c.index,this.subtitleRender.getDemuxerPort(e)),await Gt.DemuxerThread.startDemux(e,!1,10),this.externalSubtitleTasks.push(i),this.fire(z.xv),0}async load(t,e={}){7===this.status&&await this.stop(!0),V.pq(`call load, taskId: ${this.taskId}`,Ot,1364),this.status=3,this.fire(z.F5),S.zM(e.isLive)?this.isLive_=e.isLive:this.isLive_=!!this.options.isLive,this.controller=new O.A(this,this.options.enableWorker),this.ioloader2DemuxerChannel=(0,K.A)(this.options.enableWorker),(0,Q.sO)(this.GlobalData[u.o9]+32,0,360),this.externalSubtitleTasks.length=0,await Gt.startDemuxPipeline(this.options.enableWorker);let r=0,i=0;if(S.Yj(t)){r|=4;let{info:s,type:a,ext:n}=await(0,St.A)(t,e.ext,e.http);this.ext=n,i=await Gt.IOThread.registerTask.transfer(this.ioloader2DemuxerChannel.port1).invoke({type:a,info:{...s,httpOptions:e.http,webtransportOptions:e.webtransport,websocketOptions:e.websocket,uri:e.uri},range:{from:-1,to:-1},taskId:this.taskId,options:{isLive:this.isLive_},rightPort:this.ioloader2DemuxerChannel.port1,stats:this.GlobalData[u.o9]+32})}else t instanceof File?(this.isLive_=!1,this.ext=t.name.split(".").pop(),i=await Gt.IOThread.registerTask.transfer(this.ioloader2DemuxerChannel.port1).invoke({type:1,info:{file:t},range:{from:-1,to:-1},taskId:this.taskId,options:{isLive:!1},rightPort:this.ioloader2DemuxerChannel.port1,stats:this.GlobalData[u.o9]+32})):t instanceof wt.A?(r|=t.flags||0,this.ext=t.ext,this.ioIPCPort=new vt.Ay(this.ioloader2DemuxerChannel.port1),this.ioIPCPort.on(vt.S3,(async e=>{switch(e.method){case"open":try{const r=await t.open();if(r<0){V.z3(`custom loader open error, ${r}, taskId: ${this.taskId}`,Ot,1449),this.ioIPCPort.reply(e,null,r);break}this.ioIPCPort.reply(e,r)}catch(t){V.z3(`loader open error, ${t}, taskId: ${this.taskId}`,Ot,1456),this.ioIPCPort.reply(e,null,t)}break;case"read":{const r=e.params.pointer,i=e.params.length,s=e.params.ioloaderOptions,a=Gt.IODemuxProxy?new Uint8Array(i):(0,Q.JW)(r,i);try{const r=await t.read(a,s);r<0?this.ioIPCPort.reply(e,r,null):(this.GlobalData.stats.bufferReceiveBytes+=BigInt(0|r),this.ioIPCPort.reply(e,Gt.IODemuxProxy?a.subarray(0,r):r,null,Gt.IODemuxProxy?[a.buffer]:null))}catch(t){V.z3(`loader read error, ${t}, taskId: ${this.taskId}`,Ot,1479),this.ioIPCPort.reply(e,At.LR)}break}case"write":{const r=e.params.pointer,i=e.params.length,s=(0,Q.JW)(r,i);try{const r=await t.write(s);this.GlobalData.stats.bufferSendBytes+=i,this.ioIPCPort.reply(e,r)}catch(t){V.z3(`loader write error, ${t}, taskId: ${this.taskId}`,Ot,1501),this.ioIPCPort.reply(e,At.LR)}break}case"seek":{const r=e.params.pos,i=e.params.ioloaderOptions;try{const s=await t.seek(r,i);if(s<0){V.z3(`custom loader seek error, ${s}, taskId: ${this.taskId}`,Ot,1517),this.ioIPCPort.reply(e,null,s);break}this.ioIPCPort.reply(e,s)}catch(t){V.z3(`loader seek error, ${t}, taskId: ${this.taskId}`,Ot,1524),this.ioIPCPort.reply(e,null,t)}break}case"size":this.ioIPCPort.reply(e,await t.size())}}))):V.h2("invalid source",Ot,1538);i<0&&V.h2(`register io task failed, ret: ${i}, taskId: ${this.taskId}`,Ot,1542),(this.isDash()||this.isHls())&&(r|=2);const s=_.X$({},e.formatOptions||{});if(this.isDash()||this.isHls()){await Gt.IOThread.open(this.taskId);const t=await Gt.IOThread.hasAudio(this.taskId),e=await Gt.IOThread.hasVideo(this.taskId);t&&e?(this.subTaskId=(0,P.A)(),await Gt.DemuxerThread.registerTask.transfer(this.ioloader2DemuxerChannel.port2,this.controller.getDemuxerControlPort()).invoke({taskId:this.taskId,leftPort:this.ioloader2DemuxerChannel.port2,controlPort:this.controller.getDemuxerControlPort(),format:dt.HR[this.ext],stats:this.GlobalData[u.o9]+32,isLive:this.isLive_,flags:r,ioloaderOptions:{mediaType:1},formatOptions:s,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24}),await Gt.DemuxerThread.registerTask({taskId:this.subTaskId,mainTaskId:this.taskId,flags:r,format:dt.HR[this.ext],stats:this.GlobalData[u.o9]+32,isLive:this.isLive_,ioloaderOptions:{mediaType:0},formatOptions:s,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24})):(t||e)&&await Gt.DemuxerThread.registerTask.transfer(this.ioloader2DemuxerChannel.port2,this.controller.getDemuxerControlPort()).invoke({taskId:this.taskId,leftPort:this.ioloader2DemuxerChannel.port2,controlPort:this.controller.getDemuxerControlPort(),format:dt.HR[this.ext],stats:this.GlobalData[u.o9]+32,isLive:this.isLive_,flags:r,ioloaderOptions:{mediaType:t?1:0},formatOptions:s,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24})}else"rtsp"!==this.ext&&"rtmp"!==this.ext||(s.uri=e.uri||t.replace(/^\S+:\/\//,this.ext+"://")),await Gt.DemuxerThread.registerTask.transfer(this.ioloader2DemuxerChannel.port2,this.controller.getDemuxerControlPort()).invoke({taskId:this.taskId,leftPort:this.ioloader2DemuxerChannel.port2,controlPort:this.controller.getDemuxerControlPort(),format:dt.HR[this.ext],formatOptions:s,stats:this.GlobalData[u.o9]+32,isLive:this.isLive_,flags:r,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24});(this.isDash()||this.isHls())&&await Gt.IOThread.hasSubtitle(this.taskId)&&(this.subtitleTaskId=(0,P.A)(),await Gt.DemuxerThread.registerTask({taskId:this.subtitleTaskId,mainTaskId:this.taskId,flags:r,format:dt.HR[this.ext],stats:this.GlobalData[u.o9]+32,isLive:this.isLive_,ioloaderOptions:{mediaType:3},avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24})),this.fire(z.Gd,[0]),i=await Gt.DemuxerThread.openStream(this.taskId),i<0&&V.h2(`open stream failed, ret: ${i}, taskId: ${this.taskId}`,Ot,1660),this.fire(z.Gd,[1,this.ext]);let a=await Gt.DemuxerThread.analyzeStreams(this.taskId);if(S.ai(a))V.h2(`analyze stream failed, ret: ${a}`,Ot,1667);else{if(a.streams.length||V.h2("not found any stream",Ot,1671),this.subTaskId){i=await Gt.DemuxerThread.openStream(this.subTaskId),i<0&&V.h2(`open stream failed, ret: ${i}, taskId: ${this.subTaskId}`,Ot,1677);const t=await Gt.DemuxerThread.analyzeStreams(this.subTaskId);if(S.ai(t))return void V.h2(`analyze stream failed, ret: ${t}`,Ot,1681);t.streams.length||V.h2("not found any stream",Ot,1685),a.streams=a.streams.concat(t.streams)}if(this.subtitleTaskId){i=await Gt.DemuxerThread.openStream(this.subtitleTaskId),i<0&&V.h2(`open subtitle stream failed, ret: ${i}, taskId: ${this.subtitleTaskId}`,Ot,1693);const t=await Gt.DemuxerThread.analyzeStreams(this.subtitleTaskId);if(S.ai(t))return void V.h2(`analyze subtitle stream failed, ret: ${t}`,Ot,1697);t.streams.length||V.h2("not found any stream",Ot,1701),a.streams=a.streams.concat(t.streams)}if(this.formatContext=a,this.source=t,e.externalSubtitles)for(let t=0;t<e.externalSubtitles.length;t++)await this.loadExternalSubtitle(e.externalSubtitles[t]);if(a.streams.forEach((t=>{1===m.f[15](t.codecpar)?this.GlobalData.stats.audiocodec=(0,ct.A)(t.codecpar):0===m.f[15](t.codecpar)&&(this.GlobalData.stats.videocodec=(0,X.A)(t.codecpar))})),this.isHls()||this.isDash()){const t=1e3*await Gt.IOThread.getDuration(this.taskId);if(t>0)for(let e=0;e<this.formatContext.streams.length;e++)this.formatContext.streams[e].duration=(0,j.k)(BigInt(Math.floor(t)),Y.i0,this.formatContext.streams[e].timeBase)}if(this.isLive_&&this.options.enableJitterBuffer){const t=Math.max(this.source instanceof wt.A?this.source.minBuffer:await Gt.IOThread.getMinBuffer(this.taskId),this.options.jitterBufferMin);let e=this.options.jitterBufferMax;e<=t&&(e=t+(this.isHls()||this.isDash()?t:1)),this.jitterBufferController=new ot.A({stats:this.GlobalData[u.o9]+32,jitterBuffer:this.GlobalData.stats[u.o9]+280,lowLatencyStart:!(this.isHls()||this.isDash()),lowLatency:this.options.lowLatency,useMse:this.useMSE,max:e,min:t,observer:{onCroppingBuffer:t=>{var e;V.Yz(`cropping buffer by jitter buffer, max: ${t}, taskId: ${this.taskId}`,Ot,1761),null===(e=Gt.DemuxerThread)||void 0===e||e.croppingAVPacketQueue(this.taskId,BigInt(0|t))},onSetPlayRate:t=>{V.Yz(`set play rate by jitter buffer, rate: ${t}, taskId: ${this.taskId}`,Ot,1765),this.useMSE?(Gt.MSEThread.setPlayRate(this.taskId,t),this.video?this.video.playbackRate=t:this.audio&&(this.audio.playbackRate=t)):(this.audioDecoder2AudioRenderChannel&&Gt.AudioRenderThread.setPlayTempo(this.taskId,t),this.videoDecoder2VideoRenderChannel&&this.VideoRenderThread.setPlayRate(this.taskId,t))}}})}if(V.pq(`taskId: ${this.taskId}\nAVPlayer version v0.9.0-29-gc2ccb944 Copyright (c) 2024-present the libmedia developers\n`+(0,ht.Ay)([a],[{from:S.Yj(t)?t:t.name,tag:"Input",isLive:this.isLive_}]),Ot,1788),!this.isLive_){let t=Y.Dh;a.streams.forEach((e=>{const r=(0,j.k)(e.startTime,e.timeBase,Y.i0);1!==m.f[15](e.codecpar)&&0!==m.f[15](e.codecpar)||(r<t||t===-BigInt(1))&&(t=r)})),t<BigInt(0)&&t!==Y.Dh&&await this.seek(BigInt(0))}this.status=4,this.fire(z.S2)}}async playUseMSE(t){{await Gt.startMSEPipeline(this.options.enableWorker);const r=this.findBestStream(this.formatContext.streams,0,!0),i=this.findBestStream(this.formatContext.streams,1,!0);let s=!1,a="",n=[];const o=async t=>{const e=(0,B.Un)(t.codecpar+20,t.codecpar+24,24);let r;if(e)r=(0,Rt.ZK)((0,Q.s3)(m.f[20](e),m.f[25](e+4)));else if(this.isDash()){const e=await Gt.IOThread.getCurrentProtection(this.taskId,m.f[15](t.codecpar));if(e){r=[{systemId:e.systemId,keyIds:[e.kid],data:new Uint8Array(0)}];const i=(0,Rt.bE)(r),s=(0,Et.sY)(i.length);(0,Q.lW)(s,i.length,i),(0,B.$W)(t.codecpar+20,t.codecpar+24,24,s,i.length)}}const i=t.metadata.encryption;if(r&&i){for(let e=0;e<r.length;e++){const o=(0,Dt.A)(r[e].systemId);if((!a||a===o)&&o)try{const e=[{initDataTypes:["keyids","cenc"]}];var s;if(0===m.f[15](t.codecpar))e[0].videoCapabilities=[{contentType:(0,J.A)(t.codecpar),encryptionScheme:(0,Ut.A)(i.schemeType),robustness:null===(s=this.options.drmSystemOptions)||void 0===s?void 0:s.videoRobustness}];else if(1===m.f[15](t.codecpar)){var n;e[0].audioCapabilities=[{contentType:(0,Z.A)(t.codecpar),robustness:null===(n=this.options.drmSystemOptions)||void 0===n?void 0:n.audioRobustness}]}return await navigator.requestMediaKeySystemAccess(o,e),{key:o,config:e}}catch(t){V.R8(`drm system ${o} error ${t}`,Ot,1891)}}a&&V.h2("audio and video has different drm system key",Ot,1896)}};if(await Gt.MSEThread.registerTask.transfer(this.controller.getMuxerControlPort()).invoke({taskId:this.taskId,stats:this.GlobalData[u.o9]+32,controlPort:this.controller.getMuxerControlPort(),isLive:this.isLive_,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,enableJitterBuffer:!!this.jitterBufferController},this.seekedTimestamp>=BigInt(0)?this.seekedTimestamp:Y.Dh),r&&t.video){this.fire(z.Gd,[3,r]),s=!0,this.selectedVideoStream=r,this.videoEnded=!1,this.demuxer2VideoDecoderChannel=(0,K.A)(this.options.enableWorker);const t=await o(r);t&&(a=t.key,n.push(...t.config)),await Gt.DemuxerThread.connectStreamTask.transfer(this.demuxer2VideoDecoderChannel.port1).invoke(this.subTaskId||this.taskId,r.index,this.demuxer2VideoDecoderChannel.port1),await Gt.MSEThread.addStream.transfer(this.demuxer2VideoDecoderChannel.port2).invoke(this.taskId,r.index,(0,kt.Wu)(r.codecpar),r.timeBase,r.metadata,r.startTime,this.demuxer2VideoDecoderChannel.port2)}if(i&&t.audio){this.fire(z.Gd,[2,i]),this.selectedAudioStream=i,this.audioEnded=!1,this.demuxer2AudioDecoderChannel=(0,K.A)(this.options.enableWorker);const t=await o(i);t&&(a=t.key,n.push(...t.config)),await Gt.DemuxerThread.connectStreamTask.transfer(this.demuxer2AudioDecoderChannel.port1).invoke(this.taskId,i.index,this.demuxer2AudioDecoderChannel.port1),await Gt.MSEThread.addStream.transfer(this.demuxer2AudioDecoderChannel.port2).invoke(this.taskId,i.index,(0,kt.Wu)(i.codecpar),i.timeBase,i.metadata,i.startTime,this.demuxer2AudioDecoderChannel.port2)}if(s?this.createVideo():this.createAudio(),a){var e;const t=await navigator.requestMediaKeySystemAccess(a,n),r=await t.createMediaKeys();null!==(e=this.options.drmSystemOptions)&&void 0!==e&&e.certificate&&await r.setServerCertificate(this.options.drmSystemOptions.certificate).catch((t=>{V.z3(`setServerCertificate failed, ${t}`,Ot,1979)})),await(this.video||this.audio).setMediaKeys(r),this.drmSystemKey=a}Gt.MSEThread.setPlayRate(this.taskId,this.playRate);const c=await Gt.MSEThread.getMediaSource(this.taskId);c&&(W.A.workerMSE&&c instanceof MediaSourceHandle?(this.video||this.audio).srcObject=c:(this.video||this.audio).src=URL.createObjectURL(c),this.handleTimeupdate(this.video||this.audio)),this.video&&!this.selectedAudioStream&&(this.video.muted=!0),(this.video||this.audio).playbackRate=this.playRate}}async playUseDecoder(t){let e=BigInt(0),r=BigInt(0);const i=this.findBestStream(this.formatContext.streams,0),s=this.findBestStream(this.formatContext.streams,1);if(i&&t.video){this.fire(z.Gd,[3,i]),this.selectedVideoStream=i,await Gt.startVideoRenderPipeline(this.options.enableWorker),await this.createVideoDecoderThread(this.options.enableWorker),r=(0,j.k)(i.startTime,i.timeBase,Y.i0),this.demuxer2VideoDecoderChannel=(0,K.A)(this.options.enableWorker),this.videoDecoder2VideoRenderChannel=(0,K.A)(this.options.enableWorker);let t=await this.getResource("decoder",m.f[15](i.codecpar+4),m.f[15](i.codecpar));t||(W.A.videoDecoder?(await VideoDecoder.isConfigSupported({codec:(0,X.A)(i.codecpar)})).supported||V.h2(`${(0,ht.eG)(m.f[15](i.codecpar),m.f[15](i.codecpar+4))} codecId ${m.f[15](i.codecpar+4)} not support`,Ot,2034):V.h2(`${(0,ht.eG)(m.f[15](i.codecpar),m.f[15](i.codecpar+4))} codecId ${m.f[15](i.codecpar+4)} not support`,Ot,2038)),await this.VideoDecoderThread.registerTask.transfer(this.demuxer2VideoDecoderChannel.port2,this.videoDecoder2VideoRenderChannel.port1).invoke({taskId:this.taskId,resource:t,leftPort:this.demuxer2VideoDecoderChannel.port2,rightPort:this.videoDecoder2VideoRenderChannel.port1,stats:this.GlobalData[u.o9]+32,enableHardware:this.options.enableHardware&&this.options.enableWebCodecs,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28,preferWebCodecs:!(0,ut.A)(i.codecpar)&&!(0,ft.A)(i.codecpar)&&!!this.options.enableWebCodecs}),await this.VideoDecoderThread.open(this.taskId,(0,kt.Wu)(i.codecpar))<0&&V.h2(`cannot open video ${(0,ht.eG)(m.f[15](i.codecpar),m.f[15](i.codecpar+4))} decoder`,Ot,2061),await Gt.DemuxerThread.connectStreamTask.transfer(this.demuxer2VideoDecoderChannel.port1).invoke(this.subTaskId||this.taskId,i.index,this.demuxer2VideoDecoderChannel.port1),this.VideoDecoderThread.setPlayRate(this.taskId,this.playRate)}if(s&&t.audio){this.fire(z.Gd,[2,s]),this.selectedAudioStream=s,await Gt.startAudioPipeline(this.options.enableWorker),"suspended"===Gt.audioContext.state&&await d().race([Gt.audioContext.resume(),new rt.A(.1)]),e=(0,j.k)(s.startTime,s.timeBase,Y.i0),this.demuxer2AudioDecoderChannel=(0,K.A)(this.options.enableWorker),this.audioDecoder2AudioRenderChannel=(0,K.A)(this.options.enableWorker);let t=await this.getResource("decoder",m.f[15](s.codecpar+4),m.f[15](s.codecpar));t||(W.A.audioDecoder?(await AudioDecoder.isConfigSupported({codec:(0,ct.A)(s.codecpar),sampleRate:m.f[15](s.codecpar+136),numberOfChannels:m.f[15](s.codecpar+116)})).supported||V.h2(`${(0,ht.eG)(m.f[15](s.codecpar),m.f[15](s.codecpar+4))} codecId ${m.f[15](s.codecpar+4)} not support`,Ot,2097):V.h2(`${(0,ht.eG)(m.f[15](s.codecpar),m.f[15](s.codecpar+4))} codecId ${m.f[15](s.codecpar+4)} not support`,Ot,2101)),await Gt.AudioDecoderThread.registerTask.transfer(this.demuxer2AudioDecoderChannel.port2,this.audioDecoder2AudioRenderChannel.port1).invoke({taskId:this.taskId,resource:t,leftPort:this.demuxer2AudioDecoderChannel.port2,rightPort:this.audioDecoder2AudioRenderChannel.port1,stats:this.GlobalData[u.o9]+32,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28}),await Gt.AudioDecoderThread.open(this.taskId,(0,kt.Wu)(s.codecpar))<0&&V.h2(`cannot open audio ${(0,ht.eG)(m.f[15](s.codecpar),m.f[15](s.codecpar+4))} decoder`,Ot,2122),await Gt.DemuxerThread.connectStreamTask.transfer(this.demuxer2AudioDecoderChannel.port1).invoke(this.taskId,s.index,this.demuxer2AudioDecoderChannel.port1);const r=this.formatContext.streams.filter((t=>1===m.f[15](t.codecpar)));if(r.length>1)for(let t=0;t<r.length;t++)r[t]!==s&&await Gt.DemuxerThread.addPendingStream(this.taskId,r[t].index)}if(this.videoDecoder2VideoRenderChannel){let t;if(this.isMediaStreamMode())if(W.A.trackGenerator){const e=new MediaStreamTrackGenerator({kind:"video"});t=e.writable;const r=this.options.container,i=r.getVideoTracks()[0];i&&r.removeTrack(i),r.addTrack(e)}else{this.canvas=this.createCanvas(),this.canvas.width=m.f[15](i.codecpar+56),this.canvas.height=m.f[15](i.codecpar+60),t=(0,N.A)()&&(E.USE_THREADS||W.A.worker&&this.options.enableWorker)?this.canvas.transferControlToOffscreen():this.canvas;const e=this.canvas.captureStream(),r=this.options.container,s=r.getVideoTracks()[0];s&&r.removeTrack(s),r.addTrack(e.getVideoTracks()[0])}else this.canvas=this.createCanvas(),this.canvas.width=this.options.container.offsetWidth*devicePixelRatio,this.canvas.height=this.options.container.offsetHeight*devicePixelRatio,this.options.container.appendChild(this.canvas),t=(0,N.A)()&&(E.USE_THREADS||W.A.worker&&this.options.enableWorker)?this.canvas.transferControlToOffscreen():this.canvas;i.metadata.matrix&&!this.useMSE&&(this.renderRotate=-Math.atan2(i.metadata.matrix[3],i.metadata.matrix[0])*(180/Math.PI)),await this.VideoRenderThread.registerTask.transfer(this.videoDecoder2VideoRenderChannel.port2,this.controller.getVideoRenderControlPort(),t).invoke({taskId:this.taskId,isLive:this.isLive_,leftPort:this.videoDecoder2VideoRenderChannel.port2,controlPort:this.controller.getVideoRenderControlPort(),canvas:t,renderMode:this.renderMode,renderRotate:this.renderRotate,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,viewportWidth:this.isMediaStreamMode()?m.f[15](i.codecpar+56):this.options.container.offsetWidth,viewportHeight:this.isMediaStreamMode()?m.f[15](i.codecpar+60):this.options.container.offsetHeight,devicePixelRatio:this.isMediaStreamMode()?1:devicePixelRatio,stats:this.GlobalData[u.o9]+32,enableWebGPU:this.options.enableWebGPU,startPTS:this.isLive_?(0,j.k)(i.startTime<BigInt(1e3)?BigInt(0):i.startTime,i.timeBase,Y.i0):this.getMinStartPTS(),avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28,enableJitterBuffer:!!this.jitterBufferController&&!this.audioDecoder2AudioRenderChannel,sar:(0,j.lb)((0,v.A)(i.codecpar+64,g.P))}),this.videoEnded=!1,this.VideoRenderThread.setPlayRate(this.taskId,this.playRate)}if(this.audioDecoder2AudioRenderChannel){this.audioRender2AudioWorkletChannel=new MessageChannel,this.isMediaStreamMode()?this.playChannels=2:this.playChannels=Math.min(m.f[15](s.codecpar+116),Gt.audioContext.destination.maxChannelCount||2);let e,r=await this.getResource("resampler"),i=await this.getResource("stretchpitcher");if(r||V.h2("resampler not found",Ot,2250),i||V.h2("stretch pitcher not found",Ot,2253),await Gt.AudioRenderThread.registerTask.transfer(this.audioDecoder2AudioRenderChannel.port2,this.audioRender2AudioWorkletChannel.port1,this.controller.getAudioRenderControlPort()).invoke({taskId:this.taskId,isLive:this.isLive_,leftPort:this.audioDecoder2AudioRenderChannel.port2,rightPort:this.audioRender2AudioWorkletChannel.port1,controlPort:this.controller.getAudioRenderControlPort(),playFormat:8,playSampleRate:Gt.audioContext.sampleRate,playChannels:this.playChannels,resamplerResource:r,stretchpitcherResource:i,stats:this.GlobalData[u.o9]+32,startPTS:this.isLive_?(0,j.k)(s.startTime<BigInt(1e3)?BigInt(0):s.startTime,s.timeBase,Y.i0):this.getMinStartPTS(),avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28,enableJitterBuffer:!!this.jitterBufferController,audioMasterForce:t.audioMasterForce}),e=W.A.audioWorklet?$.A:G.A,this.audioSourceNode=new e(Gt.audioContext,{onEnded:()=>{this.onAudioEnded()},onFirstRendered:()=>{this.onFirstAudioRendered()},onStutter:()=>{this.onAudioStutter()}},{numberOfInputs:1,numberOfOutputs:1,outputChannelCount:[this.playChannels],isMainWorker:!!Gt.AudioPipelineProxy}),await this.audioSourceNode.request("init",{memory:!E.USE_THREADS||H.A.safari&&!H.A.checkVersion(H.A.version,"16.1",!0)||gt.A.ios&&!H.A.checkVersion(gt.A.version,"16.1",!0)?null:F.ce,bufferLength:this.options.audioWorkletBufferLength}),Gt.AudioRenderThread.setPlayTempo(this.taskId,this.playRate),this.gainNode=Gt.audioContext.createGain(),this.audioSourceNode.connect(this.gainNode),this.isMediaStreamMode()){const t=Gt.audioContext.createMediaStreamDestination();this.gainNode.connect(t);const e=this.options.container,r=e.getAudioTracks()[0];r&&e.removeTrack(r),e.addTrack(t.stream.getAudioTracks()[0])}else this.gainNode.connect(Gt.audioContext.destination);this.setVolume(this.volume),this.audioEnded=!1}this.audioDecoder2AudioRenderChannel?this.controller.setTimeUpdateListenType(1):this.videoDecoder2VideoRenderChannel&&this.controller.setTimeUpdateListenType(0),this.videoDecoder2VideoRenderChannel&&this.audioDecoder2AudioRenderChannel&&at.tn(r-e)>BigInt(1e4)&&this.controller.setEnableAudioVideoSync(!1)}async play(t={audio:!0,video:!0,subtitle:!0}){if(V.pq(`call play, options: ${o()(t)}, status: ${this.status} taskId: ${this.taskId}`,Ot,2375),6===this.status)return;t.audio||t.video||(V.R8(`video and audio must play one, ignore options, we will try to play video and audio, taskId: ${this.taskId}`,Ot,2382),t.audio=!0,t.video=!0);const e=[];if(8===this.status)return this.useMSE?(e.push(Gt.MSEThread.unpause(this.taskId)),this.audio?this.audio.play():this.video&&this.video.play()):(this.selectedAudioStream&&this.selectedVideoStream&&this.GlobalData.stats.videoCurrentTime-this.GlobalData.stats.audioCurrentTime>BigInt(400)&&await Gt.AudioRenderThread.syncSeekTime(this.taskId,this.GlobalData.stats.videoCurrentTime),this.audioSourceNode&&(e.push(this.audioSourceNode.request("unpause")),e.push(Gt.AudioRenderThread.unpause(this.taskId))),this.videoDecoder2VideoRenderChannel&&e.push(this.VideoRenderThread.unpause(this.taskId))),d().all(e).then((()=>{this.status=6,this.fire(z.CN),this.jitterBufferController&&this.jitterBufferController.start(),this.subtitleRender&&this.subtitleRender.start()}));this.status=5,this.fire(z.d6),this.useMSE=await this.checkUseMSE(t),this.audioEnded=!0,this.videoEnded=!0,this.useMSE?await this.playUseMSE(t):await this.playUseDecoder(t);{const e=this.findBestStream(this.formatContext.streams,3);if(e&&t.subtitle&&this.isCodecIdSupported(m.f[15](e.codecpar+4),m.f[15](e.codecpar))){const t=this.externalSubtitleTasks.find((t=>t.streamId===e.id));this.createSubtitleRender(e,t?t.taskId:this.subtitleTaskId||this.taskId)}if(this.subtitleRender&&this.externalSubtitleTasks.length)for(let t=0;t<this.externalSubtitleTasks.length;t++){const r=this.formatContext.streams.find((e=>e.id===this.externalSubtitleTasks[t].streamId));r!==e&&await Gt.DemuxerThread.connectStreamTask.transfer(this.subtitleRender.getDemuxerPort(this.externalSubtitleTasks[t].taskId)).invoke(this.externalSubtitleTasks[t].taskId,r.index,this.subtitleRender.getDemuxerPort(this.externalSubtitleTasks[t].taskId))}}let r=10;if(S.Yj(this.source)||this.source instanceof wt.A){let t=this.isLive_?this.options.jitterBufferMin:this.options.preLoadTime;this.source instanceof wt.A&&(t=Math.max(t,this.source.minBuffer)),this.formatContext.streams.forEach((e=>{0===m.f[15](e.codecpar)?r=Math.max(Math.ceil((0,j.lb)((0,v.A)(e.codecpar+72,g.P))*t),r):1===m.f[15](e.codecpar)&&m.f[15](e.codecpar+144)&&(r=Math.max(Math.ceil(m.f[15](e.codecpar+136)/m.f[15](e.codecpar+144)*t),r))}))}if(e.push(Gt.DemuxerThread.startDemux(this.taskId,this.isLive_,r)),this.subTaskId&&e.push(Gt.DemuxerThread.startDemux(this.subTaskId,this.isLive_,r)),this.subtitleTaskId&&e.push(Gt.DemuxerThread.startDemux(this.subtitleTaskId,this.isLive_,10)),this.seekedTimestamp>=BigInt(0)){let t=20;this.formatContext.streams.forEach((e=>{0===m.f[15](e.codecpar)&&(t=Math.max(Math.ceil((0,j.lb)((0,v.A)(e.codecpar+72,g.P))),t))})),this.videoDecoder2VideoRenderChannel&&e.push(this.VideoRenderThread.syncSeekTime(this.taskId,this.seekedTimestamp,t)),this.audioDecoder2AudioRenderChannel&&e.push(Gt.AudioRenderThread.syncSeekTime(this.taskId,this.seekedTimestamp,t)),this.seekedTimestamp=Y.Dh}return d().all(e).then((async()=>{if(this.useMSE){var t,e;if(await d().all([null===(t=this.video)||void 0===t?void 0:t.play(),null===(e=this.audio)||void 0===e?void 0:e.play()]).catch((t=>{if(this.fire(z.IY),V.R8("the audioContext was not started. It must be resumed after a user gesture",Ot,2506),this.video)return this.video.muted=!0,this.video.play()})),this.isMediaStreamMode()){H.A.firefox||((this.video||this.audio).muted=!0);const t=this.options.container,e=((this.video||this.audio).captureStream||(this.video||this.audio).mozCaptureStream).bind(this.video||this.audio)(),r=t.getAudioTracks()[0],i=t.getVideoTracks()[0];r&&t.removeTrack(r),i&&t.removeTrack(i);const s=e.getAudioTracks()[0],a=e.getVideoTracks()[0];s&&t.addTrack(s),a&&t.addTrack(a)}}else{const t=[];this.videoDecoder2VideoRenderChannel&&t.push(this.VideoRenderThread.play(this.taskId)),this.audioDecoder2AudioRenderChannel&&t.push(this.audioSourceNode.request("start",{port:this.audioRender2AudioWorkletChannel.port2,channels:this.playChannels},[this.audioRender2AudioWorkletChannel.port2])),await d().all(t),this.audioSourceNode&&"suspended"===Gt.audioContext.state&&("suspended"===Gt.audioContext.state&&(this.fire(z.IY),V.R8("the audioContext was not started. It must be resumed after a user gesture",Ot,2553)),this.videoDecoder2VideoRenderChannel&&(await Gt.AudioRenderThread.fakePlay(this.taskId),this.controller.setTimeUpdateListenType(0)))}this.status=6,this.fire(z.CN),this.statsController.start(),this.jitterBufferController&&this.jitterBufferController.start(),this.subtitleRender&&this.subtitleRender.start()}))}async pause(){if(V.pq(`call pause, taskId: ${this.taskId}`,Ot,2578),!this.isLive_){const t=[];return this.useMSE?(this.audio&&this.audio.pause(),this.video&&this.video.pause(),t.push(Gt.MSEThread.pause(this.taskId))):(this.audioSourceNode&&(t.push(this.audioSourceNode.request("pause")),t.push(Gt.AudioRenderThread.pause(this.taskId))),this.videoDecoder2VideoRenderChannel&&t.push(this.VideoRenderThread.pause(this.taskId))),d().all(t).then((()=>{9===this.status?this.lastStatus=8:this.status=8,this.fire(z.NN),this.jitterBufferController&&this.jitterBufferController.stop(),this.subtitleRender&&this.subtitleRender.pause()}))}V.R8(`pause can only used in vod, taskId: ${this.taskId}`,Ot,2618)}async doSeek(t,e,r={}){var i,s;this.useMSE?await Gt.MSEThread.beforeSeek(this.taskId):await d().all([null===(i=Gt.AudioRenderThread)||void 0===i?void 0:i.beforeSeek(this.taskId),null===(s=this.VideoRenderThread)||void 0===s?void 0:s.beforeSeek(this.taskId)]),r.onBeforeSeek&&await r.onBeforeSeek();let a=-BigInt(1);if(this.isDash()||this.isHls()?(a=await Gt.DemuxerThread.seek(this.taskId,t,16),this.subTaskId&&await Gt.DemuxerThread.seek(this.subTaskId,t,16)):a=await Gt.DemuxerThread.seek(this.taskId,t,8,e),this.subtitleTaskId&&await Gt.DemuxerThread.seek(this.subtitleTaskId,t,16),a>=BigInt(0)?V.Yz(`seeked to packet timestamp: ${a}, taskId: ${this.taskId}`,Ot,2659):V.z3(`demuxer seek failed, code: ${a}, taskId: ${this.taskId}`,Ot,2662),this.useMSE)if(a>=BigInt(0)){const e=await Gt.MSEThread.afterSeek(this.taskId,a>t?a:t);this.video?this.video.currentTime=e:this.audio&&(this.audio.currentTime=e)}else await Gt.MSEThread.afterSeek(this.taskId,Y.Dh);else{let e=20;var n,o,c,h,l,u,f,p,A,y;this.formatContext.streams.forEach((t=>{0===m.f[15](t.codecpar)&&(e=Math.max(Math.ceil((0,j.lb)((0,v.A)(t.codecpar+72,g.P))),e))})),a>=BigInt(0)?(await d().all([null===(n=Gt.AudioDecoderThread)||void 0===n?void 0:n.resetTask(this.taskId),null===(o=this.VideoDecoderThread)||void 0===o?void 0:o.resetTask(this.taskId)]),await d().all([null===(c=Gt.AudioRenderThread)||void 0===c?void 0:c.syncSeekTime(this.taskId,a>t?a:t,e),null===(h=this.VideoRenderThread)||void 0===h?void 0:h.syncSeekTime(this.taskId,a>t?a:t,e)]),await d().all([null===(l=Gt.AudioRenderThread)||void 0===l?void 0:l.afterSeek(this.taskId,a>t?a:t),null===(u=this.VideoRenderThread)||void 0===u?void 0:u.afterSeek(this.taskId,a>t?a:t)])):(await d().all([null===(f=Gt.AudioRenderThread)||void 0===f?void 0:f.syncSeekTime(this.taskId,Y.Dh,e),null===(p=this.VideoRenderThread)||void 0===p?void 0:p.syncSeekTime(this.taskId,Y.Dh,e)]),await d().all([null===(A=Gt.AudioRenderThread)||void 0===A?void 0:A.afterSeek(this.taskId,Y.Dh),null===(y=this.VideoRenderThread)||void 0===y?void 0:y.afterSeek(this.taskId,Y.Dh)])),this.jitterBufferController&&this.jitterBufferController.reset()}(4===this.lastStatus||3===this.lastStatus)&&a>=BigInt(0)&&(this.seekedTimestamp=a>t?a:t);for(let t=0;t<this.externalSubtitleTasks.length;t++)await Gt.DemuxerThread.seek(this.externalSubtitleTasks[t].taskId,this.currentTime,8);this.subtitleRender&&(this.subtitleRender.reset(),this.subtitleRender.start())}async seek(t){if(V.pq(`call seek, timestamp: ${t}, taskId: ${this.taskId}`,Ot,2746),this.formatContext.streams.length)if(9!==this.status)if(this.isLive_)V.R8(`seek can only used in vod, taskId: ${this.taskId}`,Ot,2785);else{this.lastStatus=this.status,this.status=9,this.fire(z.Nz);let e=-1;this.selectedVideoStream?e=this.selectedVideoStream.index:this.selectedAudioStream&&(e=this.selectedAudioStream.index),7===this.lastStatus?(await this.replayTo(t),this.status=6,this.fire(z.mQ),this.fire(z.CN)):(await this.doSeek(t,e),this.status=this.lastStatus,this.fire(z.mQ))}else V.R8(`player is seeking now, taskId: ${this.taskId}`,Ot,2754);else V.z3(`cannot found any stream to seek, taskId: ${this.taskId}`,Ot,2749)}getStreams(){return this.formatContext.streams.map((t=>({...t,mediaType:(0,ht.yl)(dt.Mb,m.f[15](t.codecpar)),codecparProxy:(0,v.A)(t.codecpar,A.A)})))}getSelectedVideoStreamId(){return this.selectedVideoStream?this.selectedVideoStream.id:-1}getSelectedAudioStreamId(){return this.selectedAudioStream?this.selectedAudioStream.id:-1}getSelectedSubtitleStreamId(){return this.selectedSubtitleStream?this.selectedSubtitleStream.id:-1}getChapters(){return this.formatContext.chapters}getDuration(){if(!this.isLive_){let t=BigInt(0);return this.formatContext.streams.forEach((e=>{if(1===m.f[15](e.codecpar)||0===m.f[15](e.codecpar)){const r=(0,j.k)(e.duration,{den:e.timeBase.den,num:e.timeBase.num},Y.i0);r>t&&(t=r)}})),t}return BigInt(0)}async stop(t=!1){var e;if(V.pq(`call stop, taskId: ${this.taskId}`,Ot,2889),0===this.status)return void V.pq(`player has already stopped, taskId: ${this.taskId}`,Ot,2892);if(this.stopPending)return this.stopPending;let r;this.stopPending=new(d())((t=>{r=t})),this.audioSourceNode&&(9===this.status&&await Gt.AudioRenderThread.stop(this.taskId),await this.audioSourceNode.request("stop"),this.audioSourceNode.disconnect(),this.audioSourceNode=null),9===this.status&&Gt.DemuxerThread&&(await Gt.DemuxerThread.stop(this.taskId),this.subTaskId&&await Gt.DemuxerThread.stop(this.subTaskId),this.subtitleTaskId&&await Gt.DemuxerThread.stop(this.subtitleTaskId)),this.VideoRenderThread&&await this.VideoRenderThread.unregisterTask(this.taskId),Gt.AudioRenderThread&&await Gt.AudioRenderThread.unregisterTask(this.taskId),this.VideoDecoderThread&&await this.VideoDecoderThread.unregisterTask(this.taskId),Gt.AudioDecoderThread&&await Gt.AudioDecoderThread.unregisterTask(this.taskId),Gt.MSEThread&&await Gt.MSEThread.unregisterTask(this.taskId),Gt.DemuxerThread&&(this.subTaskId&&await Gt.DemuxerThread.unregisterTask(this.subTaskId),this.subtitleTaskId&&await Gt.DemuxerThread.unregisterTask(this.subtitleTaskId),await Gt.DemuxerThread.unregisterTask(this.taskId)),Gt.IOThread&&await Gt.IOThread.unregisterTask(this.taskId),this.ioIPCPort&&(await this.source.stop().catch((t=>{V.z3(`stop custom ioloader error, ${t}`,Ot,2954)})),this.ioIPCPort.destroy(),this.ioIPCPort=null);for(let t=0;t<this.externalSubtitleTasks.length;t++)await Gt.DemuxerThread.unregisterTask(this.externalSubtitleTasks[t].taskId),await Gt.IOThread.unregisterTask(this.externalSubtitleTasks[t].taskId);if(this.subtitleRender&&(this.subtitleRender.destroy(),this.subtitleRender=null),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=null),this.controller&&this.controller.destroy(),this.drmSession&&(await this.drmSession.close(),this.drmSession=null),null!==(e=this.video||this.audio)&&void 0!==e&&e.src&&URL.revokeObjectURL((this.video||this.audio).src),!this.isMediaStreamMode()){const t=this.options.container;this.video&&(t.removeChild(this.video),this.video=null),this.audio&&(t.removeChild(this.audio),this.audio=null),this.canvas&&(t.removeChild(this.canvas),this.canvas=null)}this.ioloader2DemuxerChannel=null,this.demuxer2VideoDecoderChannel=null,this.demuxer2AudioDecoderChannel=null,this.videoDecoder2VideoRenderChannel=null,this.audioDecoder2AudioRenderChannel=null,this.audioRender2AudioWorkletChannel=null,this.selectedAudioStream=null,this.selectedVideoStream=null,this.selectedSubtitleStream=null,this.lastSelectedInnerSubtitleStreamIndex=-1,this.source=null,this.ext="",this.subTaskId="",this.subtitleTaskId="",this.seekedTimestamp=Y.Dh,this.statsController.stop(),this.jitterBufferController&&(this.jitterBufferController.stop(),this.jitterBufferController=null),this.status=0,r(),this.stopPending=null,t||this.fire(z.yd),V.pq(`avplayer stopped, task: ${this.taskId}`,Ot,3032)}setPlaybackRate(t){var e,r,i,s;this.isLive_?V.R8(`setPlaybackRate can only used in playback, taskId: ${this.taskId}`,Ot,3060):(this.playRate=(0,q.A)(t,.5,2),this.useMSE?(null===(e=Gt.MSEThread)||void 0===e||e.setPlayRate(this.taskId,this.playRate),this.video?this.video.playbackRate=this.playRate:this.audio&&(this.audio.playbackRate=this.playRate)):(null===(r=Gt.AudioRenderThread)||void 0===r||r.setPlayTempo(this.taskId,this.playRate),null===(i=this.VideoRenderThread)||void 0===i||i.setPlayRate(this.taskId,this.playRate),null===(s=this.VideoDecoderThread)||void 0===s||s.setPlayRate(this.taskId,this.playRate)),V.pq(`player call setPlaybackRate, set ${this.playRate}, taskId: ${this.taskId}`,Ot,3057))}getPlaybackRate(){return this.playRate}async resume(){var t,e;"suspended"!==(null===(t=Gt.audioContext)||void 0===t?void 0:t.state)&&"interrupted"!==(null===(e=Gt.audioContext)||void 0===e?void 0:e.state)||(await d().race([Gt.audioContext.resume(),new rt.A(.1)]),"suspended"===Gt.audioContext.state?V.R8("the audioContext was not allowed to start. It must be resumed after a user gesture",Ot,3086):(this.audioSourceNode&&this.controller.setTimeUpdateListenType(1),this.fire(z.dQ))),this.video?(this.video.muted=!1,this.video.paused&&await this.video.play()):this.audio&&(this.audio.muted=!1,this.audio.paused&&await this.audio.play()),V.pq(`call resume, taskId: ${this.taskId}`,Ot,3108)}isSuspended(){var t;return"suspended"===(null===(t=Gt.audioContext)||void 0===t?void 0:t.state)}getVolume(){return this.volume}setVolume(t,e=!1){this.volume=this.useMSE?(0,q.A)(t,0,1):(0,q.A)(t,0,3),this.gainNode&&Gt.audioContext?(this.gainNode.gain.cancelScheduledValues(Gt.audioContext.currentTime),H.A.firefox&&!e?this.gainNode.gain.setValueAtTime(this.volume,Gt.audioContext.currentTime+1):0===this.gainNode.gain.value||0===this.volume||e?this.gainNode.gain.value=this.volume:this.gainNode.gain.exponentialRampToValueAtTime(this.volume,Gt.audioContext.currentTime+1)):this.video?this.video.volume=this.volume:this.audio&&(this.audio.volume=this.volume),this.fire(z.Wu,[this.volume]),V.pq(`player call setVolume, set ${t}, used ${this.volume}, taskId: ${this.taskId}`,Ot,3158)}getRenderMode(){return this.renderMode}setRenderMode(t){var e;this.renderMode=t,this.useMSE&&this.video?this.video.style["object-fit"]=zt[this.renderMode]:null===(e=this.VideoRenderThread)||void 0===e||e.setRenderMode(this.taskId,t),V.pq(`player call setRenderMode, mode: ${t}, taskId: ${this.taskId}`,Ot,3188)}getVideoTransformContext(){let t="";return 0!==this.renderRotate&&(t+=`rotateZ(${this.renderRotate}deg)`),this.flipHorizontal&&(t+=(t.length?" ":"")+"scaleX(-1)"),this.flipVertical&&(t+=(t.length?" ":"")+"scaleY(-1)"),t}setRotate(t){var e;this.renderRotate=t,this.useMSE&&this.video?this.video.style.transform=this.getVideoTransformContext():null===(e=this.VideoRenderThread)||void 0===e||e.setRenderRotate(this.taskId,t),V.pq(`player call setRotate, angle: ${t}, taskId: ${this.taskId}`,Ot,3218)}enableHorizontalFlip(t){var e;this.flipHorizontal=t,this.useMSE&&this.video?this.video.style.transform=this.getVideoTransformContext():null===(e=this.VideoRenderThread)||void 0===e||e.enableHorizontalFlip(this.taskId,t),V.pq(`player call enableHorizontalFlip, enable: ${t}, taskId: ${this.taskId}`,Ot,3229)}enableVerticalFlip(t){var e;this.flipVertical=t,this.useMSE&&this.video?this.video.style.transform=this.getVideoTransformContext():null===(e=this.VideoRenderThread)||void 0===e||e.enableVerticalFlip(this.taskId,t),V.pq(`player call enableVerticalFlip, enable: ${t}, taskId: ${this.taskId}`,Ot,3240)}setLoop(t){this.options.loop=t,V.pq(`call setLoop, enable: ${t}, taskId: ${this.taskId}`,Ot,3252)}setSubtitleDelay(t){this.subtitleRender&&this.getSubtitleDelay()!==t&&(this.subtitleRender.setDelay(BigInt(0|t)),V.pq(`set subtitle delay ${t}`,Ot,3265),this.fire(z.W1,[t]))}getSubtitleDelay(){return this.subtitleRender?Number(BigInt.asIntN(32,this.subtitleRender.getDelay())):0}setSubtitleEnable(t){if(this.subtitleRender&&this.selectedSubtitleStream)if(t){const t=this.externalSubtitleTasks.find((t=>t.streamId===this.selectedSubtitleStream.id));t&&Gt.DemuxerThread.seek(t.taskId,this.currentTime,8),this.subtitleRender.reset(),this.subtitleRender.start()}else this.subtitleRender.stop()}resize(t,e){var r;this.useMSE||null===(r=this.VideoRenderThread)||void 0===r||r.resize(this.taskId,t,e),V.pq(`player call resize, width: ${t}, height: ${e}, taskId: ${this.taskId}`,Ot,3316)}isMSE(){return this.useMSE}isMediaStreamMode(){return"function"==typeof MediaStream&&this.options.container instanceof MediaStream}isLive(){return this.isLive_}async getVideoList(){var t;return null===(t=Gt.IOThread)||void 0===t?void 0:t.getVideoList(this.taskId)}async getAudioList(){var t;return null===(t=Gt.IOThread)||void 0===t?void 0:t.getAudioList(this.taskId)}async getSubtitleList(){var t;return null===(t=Gt.IOThread)||void 0===t?void 0:t.getSubtitleList(this.taskId)}getStatus(){return this.status}hasAudio(){return!!this.selectedAudioStream}hasVideo(){return!!this.selectedVideoStream}hasSubtitle(){return!!this.selectedSubtitleStream}getSource(){return this.source}getFormatContext(){return this.formatContext}getExternalSubtitle(){return this.externalSubtitleTasks.map((t=>({source:t.source,lang:t.lang,title:t.title})))}getOptions(){return this.options}getAudioOutputNode(){return this.gainNode}isPictureInPicture(){return this.useMSE?this.video&&document.pictureInPictureElement===this.video:!(!this.canvas||"object"!=typeof documentPictureInPicture)&&documentPictureInPicture.window&&documentPictureInPicture.window.document.body.querySelector("#"+this.canvas.id)===this.canvas}async selectVideo(t){var e;if(this.isHls()||this.isDash())return V.pq(`call IOThread selectVideo, index: ${t}, taskId: ${this.taskId}`,Ot,3480),null===(e=Gt.IOThread)||void 0===e?void 0:e.selectVideo(this.taskId,t);{const e=this.formatContext.streams.find((e=>e.id===t));if(this.selectedVideoStream&&e&&0===m.f[15](e.codecpar)&&e!==this.selectedVideoStream){if(10===this.status)return void V.R8(`player is changing now, taskId: ${this.taskId}`,Ot,3488);this.lastStatus=this.status,this.status=10,this.fire(z.Wt,[0,e.id,this.selectedVideoStream.id]),this.useMSE?(H.A.safari&&(this.status=this.lastStatus,V.h2("safari not support switch stream in mse, please use chrome",Ot,3498)),(0,nt.A)().isTypeSupported((0,J.A)(e.codecpar))||(this.status=this.lastStatus,V.h2(`select video stream(${e.index}) not support mse`,Ot,3502)),await this.doSeek(this.currentTime,e.index,{onBeforeSeek:async()=>{await Gt.DemuxerThread.changeConnectStream(this.taskId,e.index,this.selectedVideoStream.index),await Gt.MSEThread.reAddStream(this.taskId,e.index,(0,kt.Wu)(e.codecpar),e.timeBase,e.metadata,e.startTime)}})):(lt.zy(Nt,m.f[15](e.codecpar+4))||(this.status=this.lastStatus,V.h2(`select video stream(${e.index}) not support`,Ot,3521)),await this.doSeek(this.currentTime,e.index,{onBeforeSeek:async()=>{await Gt.DemuxerThread.changeConnectStream(this.taskId,e.index,this.selectedVideoStream.index),await this.VideoDecoderThread.reopenDecoder(this.taskId,(0,kt.Wu)(e.codecpar),await this.getResource("decoder",m.f[15](e.codecpar+4),0))}})),V.pq(`changed selected video stream, from ${this.selectedVideoStream.id} to ${e.id}, taskId: ${this.taskId}`,Ot,3535),this.selectedVideoStream=e,this.subtitleRender&&this.subtitleRender.updateVideoResolution(m.f[15](e.codecpar+56),m.f[15](e.codecpar+60)),this.status=this.lastStatus,this.fire(z.Rj,[0,e.id,this.selectedVideoStream.id])}}}async selectAudio(t){var e;if(this.isHls()||this.isDash())return V.pq(`call IOThread selectAudio, index: ${t}, taskId: ${this.taskId}`,Ot,3556),null===(e=Gt.IOThread)||void 0===e?void 0:e.selectAudio(this.taskId,t);{const e=this.formatContext.streams.find((e=>e.id===t));if(this.selectedAudioStream&&e&&1===m.f[15](e.codecpar)&&e!==this.selectedAudioStream){if(10===this.status)return void V.R8(`player is changing now, taskId: ${this.taskId}`,Ot,3563);if(this.lastStatus=this.status,this.status=10,this.fire(z.Wt,[1,e.id,this.selectedAudioStream.id]),m.f[15](e.codecpar+4)!==m.f[15](this.selectedAudioStream.codecpar+4)||m.f[15](e.codecpar+136)!==m.f[15](this.selectedAudioStream.codecpar+136)||m.f[15](e.codecpar+116)!==m.f[15](this.selectedAudioStream.codecpar+116)||m.f[15](e.codecpar+48)!==m.f[15](this.selectedAudioStream.codecpar+48))if(this.useMSE){H.A.safari&&(this.status=this.lastStatus,V.h2("safari not support switch stream in mse, please use chrome",Ot,3578));let t=e.index;this.selectedVideoStream&&(t=this.selectedVideoStream.index),(0,nt.A)().isTypeSupported((0,Z.A)(e.codecpar))||(this.status=this.lastStatus,V.h2(`select audio stream(${e.index}) not support mse`,Ot,3586)),await this.doSeek(this.currentTime,t,{onBeforeSeek:async()=>{await Gt.DemuxerThread.changeConnectStream(this.taskId,e.index,this.selectedAudioStream.index),await Gt.MSEThread.reAddStream(this.taskId,e.index,(0,kt.Wu)(e.codecpar),e.timeBase,e.metadata,e.startTime)}})}else lt.zy(Nt,m.f[15](e.codecpar+4))||(this.status=this.lastStatus,V.h2(`select audio stream(${e.index}) not support`,Ot,3598)),await Gt.AudioDecoderThread.beforeReopenDecoder(this.taskId),await Gt.DemuxerThread.changeConnectStream(this.taskId,e.index,this.selectedAudioStream.index,!0,!0),await Gt.AudioDecoderThread.reopenDecoder(this.taskId,(0,kt.Wu)(e.codecpar),await this.getResource("decoder",m.f[15](e.codecpar+4),1)),this.audioEnded&&(this.audioDecoder2AudioRenderChannel&&(await Gt.AudioDecoderThread.resetTask(this.taskId),await Gt.AudioRenderThread.restart(this.taskId),await Gt.AudioRenderThread.syncSeekTime(this.taskId,this.currentTime),this.controller.setTimeUpdateListenType(1)),this.audioSourceNode&&(await this.audioSourceNode.request("restart"),"suspended"===Gt.audioContext.state&&await Gt.AudioRenderThread.fakePlay(this.taskId)),this.audioEnded=!1);else await Gt.DemuxerThread.changeConnectStream(this.taskId,e.index,this.selectedAudioStream.index,!1);V.pq(`changed selected audio stream, from ${this.selectedAudioStream.id} to ${e.id}, taskId: ${this.taskId}`,Ot,3628),this.selectedAudioStream=e,this.status=this.lastStatus,this.fire(z.Rj,[1,e.id,this.selectedAudioStream.id])}}}async selectSubtitle(t){if(this.isHls()||this.isDash()){var e;V.pq(`call IOThread selectSubtitle, index: ${t}, taskId: ${this.taskId}`,Ot,3647),await(null===(e=Gt.IOThread)||void 0===e?void 0:e.selectSubtitle(this.taskId,t)),this.subtitleTaskId&&await Gt.DemuxerThread.seek(this.subtitleTaskId,this.currentTime,16),this.subtitleRender&&(this.subtitleRender.reset(),this.subtitleRender.start())}else{const e=this.formatContext.streams.find((e=>e.id===t));if(this.selectedSubtitleStream&&e&&3===m.f[15](e.codecpar)&&e!==this.selectedSubtitleStream){if(10===this.status)return void V.R8(`player is changing now, taskId: ${this.taskId}`,Ot,3661);this.lastStatus=this.status,this.status=10,this.fire(z.Wt,[3,e.id,this.selectedSubtitleStream.id]),this.subtitleRender.reopenDecoder(e.codecpar);const t=this.externalSubtitleTasks.find((t=>t.streamId===e.id));t?(this.subtitleRender.setDemuxTask(t.taskId),this.subtitleRender.reset(),await Gt.DemuxerThread.seek(t.taskId,this.currentTime,8,e.index)):(this.subtitleRender.setDemuxTask(this.taskId),-1===this.lastSelectedInnerSubtitleStreamIndex?await Gt.DemuxerThread.connectStreamTask.transfer(this.subtitleRender.getDemuxerPort(this.taskId)).invoke(this.taskId,e.index,this.subtitleRender.getDemuxerPort(this.taskId)):await Gt.DemuxerThread.changeConnectStream(this.taskId,e.index,this.lastSelectedInnerSubtitleStreamIndex,!1),this.externalSubtitleTasks.find((t=>t.streamId===this.selectedSubtitleStream.id))&&this.subtitleRender.reset(),this.lastSelectedInnerSubtitleStreamIndex=e.index),this.subtitleRender&&this.subtitleRender.start(),V.pq(`changed selected subtitle stream, from ${this.selectedSubtitleStream.id} to ${e.id}, taskId: ${this.taskId}`,Ot,3700),this.selectedSubtitleStream=e,this.status=this.lastStatus,this.fire(z.Rj,[3,e.id,this.selectedSubtitleStream.id])}else V.z3(`call selectSubtitle failed, id: ${t}, taskId: ${this.taskId}`,Ot,3708)}}async playNextFrame(){!this.useMSE&&8===this.status&&this.selectedVideoStream&&await this.VideoRenderThread.renderNextFrame(this.taskId)}enterFullscreen(){if(this.isMediaStreamMode())return;const t=this.options.container;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),V.pq(`player call enterFullscreen, taskId: ${this.taskId}`,Ot,3743)}exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozExitFullScreen?document.mozExitFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),V.pq(`player call exitFullscreen, taskId: ${this.taskId}`,Ot,3759)}snapshot(t="png",e=1){if(this.useMSE&&this.video){const r=document.createElement("canvas");return r.width=this.video.videoWidth,r.height=this.video.videoHeight,r.getContext("2d").drawImage(this.video,0,0),r.toDataURL(`image/${t}`,e)}if(this.canvas)return this.canvas.toDataURL(`image/${t}`,e)}getStats(){return this.GlobalData.stats}async destroy(){V.pq(`call destroy, taskId: ${this.taskId}`,Ot,3798),2!==this.status?(await this.stop(),this.VideoPipelineProxy&&(await this.VideoDecoderThread.clear(),await this.VideoRenderThread.clear(),await this.VideoPipelineProxy.destroy(),this.VideoDecoderThread=null,this.VideoPipelineProxy=null),this.VideoDecoderThread&&(await this.VideoDecoderThread.clear(),(0,I.nE)(this.VideoDecoderThread),this.VideoDecoderThread=null),this.VideoRenderThread=null,this.GlobalData&&(this.GlobalData.avframeList.clear((t=>{(0,C.to)(t)}),20),this.GlobalData.avpacketList.clear((t=>{(0,B.Up)(t)}),20),st.zr(this.GlobalData[u.o9]+24),st.zr(this.GlobalData[u.o9]+28),(0,y.A)(this.GlobalData),this.GlobalData=null),lt.TF(Gt.Instances,this),this.status=2):V.R8(`player has already destroyed, taskId: ${this.taskId}`,Ot,3801)}onVideoEnded(){this.videoEnded=!0,this.handleEnded()}onAudioEnded(){this.audioEnded=!0,this.selectedVideoStream&&this.controller.setTimeUpdateListenType(0),this.handleEnded()}onCanvasUpdated(){this.updateCanvas=this.createCanvas(),this.updateCanvas.width=this.options.container.offsetWidth*devicePixelRatio,this.updateCanvas.height=this.options.container.offsetHeight*devicePixelRatio;const t=(0,N.A)()&&(E.USE_THREADS||W.A.worker&&this.options.enableWorker)?this.updateCanvas.transferControlToOffscreen():this.updateCanvas;this.VideoRenderThread.updateCanvas.transfer(t).invoke(this.taskId,t)}async onGetDecoderResource(t,e){return this.getResource("decoder",e,t)}onFirstVideoRendered(){V.pq(`first video frame rendered, taskId: ${this.taskId}`,Ot,3894),this.fire(z.NX)}onFirstAudioRendered(){V.pq(`first audio frame rendered, taskId: ${this.taskId}`,Ot,3902),this.fire(z.Sw)}onAudioStutter(){6===this.status&&this.GlobalData.stats.audioStutter++}onVideoStutter(){6===this.status&&this.GlobalData.stats.videoStutter++}onVideoDiscard(){6===this.status&&this.VideoDecoderThread.setNextDiscard(this.taskId)}onFirstVideoRenderedAfterUpdateCanvas(){if(this.updateCanvas&&!this.isMediaStreamMode()){const t=this.options.container;this.canvas&&t.removeChild(this.canvas),this.canvas=this.updateCanvas,t.appendChild(this.canvas),this.updateCanvas=null}}onTimeUpdate(t){this.fire(z.E9,[this.currentTime])}onMSESeek(t){const e=this.audio||this.video;e.buffered.length?e.currentTime=t:setTimeout((()=>{e.currentTime=t}),500)}onMasterTimerUpdate(t){var e,r;null===(e=Gt.AudioRenderThread)||void 0===e||e.setMasterTime(this.taskId,t),null===(r=Gt.VideoRenderThread)||void 0===r||r.setMasterTime(this.taskId,t)}onAudioContextStateChange(){"interrupted"!==Gt.audioContext.state&&"suspended"!==Gt.audioContext.state||6!==this.status&&8!==this.status||(V.R8(`the audioContext state changed to ${Gt.audioContext.state}. It may be resumed after a user gesture`,Ot,3984),Gt.AudioRenderThread.fakePlay(this.taskId),this.fire(z.IY))}async createVideoDecoderThread(t=!0){this.VideoDecoderThread||(!E.USE_THREADS&&W.A.worker&&t&&(0,N.A)()?(this.VideoPipelineProxy=new Tt.A,await this.VideoPipelineProxy.run(),this.VideoPipelineProxy.setLogLevel(Gt.level),this.VideoDecoderThread=this.VideoPipelineProxy.VideoDecodePipeline,this.VideoRenderThread=this.VideoPipelineProxy.VideoRenderPipeline):(this.VideoDecoderThread=await(0,I.pt)(k.A,{name:"VideoDecoderThread"},31138).run(),this.VideoDecoderThread.setLogLevel(Gt.level),this.VideoRenderThread=Gt.VideoRenderThread))}static async startDemuxPipeline(t=!0){return Gt.DemuxThreadReady?Gt.DemuxThreadReady:Gt.DemuxThreadReady=new(d())((async e=>{!E.USE_THREADS&&W.A.worker&&t?(Gt.IODemuxProxy=new xt.A,await Gt.IODemuxProxy.run(),Gt.IODemuxProxy.setLogLevel(Gt.level),Gt.IOThread=Gt.IODemuxProxy.IOPipeline,Gt.DemuxerThread=Gt.IODemuxProxy.DemuxPipeline):(Gt.IOThread=await(0,I.pt)(b.A,{name:"IOThread"},87243).run(),Gt.IOThread.setLogLevel(Gt.level),Gt.DemuxerThread=await(0,I.pt)(w.A,{name:"DemuxerThread"},72480).run(),Gt.DemuxerThread.setLogLevel(Gt.level)),e()}))}static async startAudioPipeline(t=!0){return Gt.AudioThreadReady?Gt.AudioThreadReady:Gt.AudioThreadReady=new(d())((async e=>{Gt.audioContext||(Gt.audioContext=new(AudioContext||webkitAudioContext)),Gt.audioContext.addEventListener("statechange",(()=>{lt.__(Gt.Instances,(t=>{t.onAudioContextStateChange()}))})),W.A.audioWorklet&&await(0,L.A)(Gt.audioContext,!E.USE_THREADS||H.A.safari&&!H.A.checkVersion(H.A.version,"16.1",!0)||gt.A.ios&&!H.A.checkVersion(gt.A.version,"16.1",!0)?34268:5676),!E.USE_THREADS&&W.A.worker&&t?(Gt.AudioPipelineProxy=new It.A,await Gt.AudioPipelineProxy.run(),Gt.AudioPipelineProxy.setLogLevel(Gt.level),Gt.AudioDecoderThread=Gt.AudioPipelineProxy.AudioDecodePipeline,Gt.AudioRenderThread=Gt.AudioPipelineProxy.AudioRenderPipeline):(Gt.AudioDecoderThread=await(0,I.pt)(x.A,{name:"AudioDecoderThread"},18667).run(),Gt.AudioDecoderThread.setLogLevel(Gt.level),Gt.AudioRenderThread=await(0,I.pt)(R.A,{name:"AudioRenderThread"},59377).run(),Gt.AudioRenderThread.setLogLevel(Gt.level)),e()}))}static async startVideoRenderPipeline(t=!0){return Gt.VideoThreadReady?Gt.VideoThreadReady:Gt.VideoThreadReady=new(d())((async e=>{!E.USE_THREADS&&W.A.worker&&t&&(0,N.A)()||(Gt.VideoRenderThread=await(0,I.pt)(D.A,{name:"VideoRenderThread",disableWorker:!(0,N.A)()},33968).run(),Gt.VideoRenderThread.setLogLevel(Gt.level)),e()}))}static async startMSEPipeline(t=!0){return Gt.MSEThreadReady?Gt.MSEThreadReady:Gt.MSEThreadReady=new(d())((async e=>{!E.USE_THREADS&&W.A.worker&&t&&W.A.workerMSE?(Gt.MSEPipelineProxy=new Pt.A,await Gt.MSEPipelineProxy.run(),Gt.MSEPipelineProxy.setLogLevel(Gt.level),Gt.MSEThread=Gt.MSEPipelineProxy.MSEPipeline):(Gt.MSEThread=await(0,I.pt)(tt.A,{name:"MSEThread",disableWorker:!W.A.workerMSE},25115).run(),Gt.MSEThread.setLogLevel(Gt.level)),e()}))}static async startPipelines(t=!0){await Gt.startDemuxPipeline(t),await Gt.startAudioPipeline(t),await Gt.startVideoRenderPipeline(t),await Gt.startMSEPipeline(t),V.pq("AVPlayer pipelines started",Ot,4167)}static async stopPipelines(){Gt.VideoRenderThread&&(await Gt.VideoRenderThread.clear(),(0,I.nE)(Gt.VideoRenderThread)),Gt.AudioPipelineProxy&&(await Gt.AudioRenderThread.clear(),await Gt.AudioDecoderThread.clear(),await Gt.AudioPipelineProxy.destroy(),Gt.AudioRenderThread=null,Gt.AudioDecoderThread=null),Gt.AudioRenderThread&&(await Gt.AudioRenderThread.clear(),(0,I.nE)(Gt.AudioRenderThread)),Gt.AudioDecoderThread&&(await Gt.AudioDecoderThread.clear(),(0,I.nE)(Gt.AudioDecoderThread)),Gt.IODemuxProxy&&(await Gt.DemuxerThread.clear(),await Gt.IOThread.clear(),await Gt.IODemuxProxy.destroy(),Gt.DemuxerThread=null,Gt.IOThread=null),Gt.DemuxerThread&&(await Gt.DemuxerThread.clear(),(0,I.nE)(Gt.DemuxerThread)),Gt.IOThread&&(await Gt.IOThread.clear(),(0,I.nE)(Gt.IOThread)),Gt.MSEPipelineProxy&&(await Gt.MSEThread.clear(),Gt.MSEPipelineProxy.destroy(),Gt.MSEThread=null),Gt.MSEThread&&(await Gt.MSEThread.clear(),(0,I.nE)(Gt.MSEThread)),Gt.AudioPipelineProxy=null,Gt.AudioDecoderThread=null,Gt.IODemuxProxy=null,Gt.DemuxerThread=null,Gt.IOThread=null,Gt.audioContext=null,Gt.MSEThread=null,V.pq("AVPlayer pipelines stopped",Ot,4231)}static setLogLevel(t){Gt.level=t,V.V$(t),Gt.IOThread&&Gt.IOThread.setLogLevel(t),Gt.DemuxerThread&&Gt.DemuxerThread.setLogLevel(t),Gt.AudioDecoderThread&&Gt.AudioDecoderThread.setLogLevel(t),Gt.AudioRenderThread&&Gt.AudioRenderThread.setLogLevel(t),Gt.VideoRenderThread&&Gt.VideoRenderThread.setLogLevel(t),Gt.MSEThread&&Gt.MSEThread.setLogLevel(t),V.pq(`set log level: ${t}`,Ot,4263)}on(t,e,r={}){return super.on(t,_.X$({fn:e},r)),this}one(t,e,r={}){return super.on(t,_.X$({fn:e,max:1},r)),this}}(0,i.A)(Gt,"Instances",[]),(0,i.A)(Gt,"Util",{compile:M.A,browser:H.A,os:gt.A}),(0,i.A)(Gt,"IOLoader",{CustomIOLoader:wt.A,FetchIOLoader:yt.A,FileIOLoader:bt.A,WebSocketIOLoader:_t.A,SocketIOLoader:Mt.A,WebTransportIOLoader:Ct.A}),(0,i.A)(Gt,"level",V.rD),(0,i.A)(Gt,"DemuxThreadReady",void 0),(0,i.A)(Gt,"AudioThreadReady",void 0),(0,i.A)(Gt,"VideoThreadReady",void 0),(0,i.A)(Gt,"MSEThreadReady",void 0),(0,i.A)(Gt,"IODemuxProxy",void 0),(0,i.A)(Gt,"AudioPipelineProxy",void 0),(0,i.A)(Gt,"MSEPipelineProxy",void 0),(0,i.A)(Gt,"IOThread",void 0),(0,i.A)(Gt,"DemuxerThread",void 0),(0,i.A)(Gt,"AudioDecoderThread",void 0),(0,i.A)(Gt,"AudioRenderThread",void 0),(0,i.A)(Gt,"VideoRenderThread",void 0),(0,i.A)(Gt,"MSEThread",void 0),(0,i.A)(Gt,"audioContext",void 0),(0,i.A)(Gt,"Resource",new(l()))},11628:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(134),s=r(84149),a=r(67593);class n{constructor(t,e){(0,i.A)(this,"videoRenderControlChannel",void 0),(0,i.A)(this,"audioRenderControlChannel",void 0),(0,i.A)(this,"muxerControlChannel",void 0),(0,i.A)(this,"demuxerControlChannel",void 0),(0,i.A)(this,"videoRenderControlIPCPort",void 0),(0,i.A)(this,"audioRenderControlIPCPort",void 0),(0,i.A)(this,"muxerControlIPCPort",void 0),(0,i.A)(this,"demuxerControlIPCPort",void 0),(0,i.A)(this,"observer",void 0),(0,i.A)(this,"visibilityHidden",void 0),(0,i.A)(this,"onVisibilityChange",void 0),(0,i.A)(this,"timeUpdateListenType",void 0),(0,i.A)(this,"enableAudioVideoSync",void 0),this.observer=t,this.videoRenderControlChannel=(0,a.A)(e),this.audioRenderControlChannel=(0,a.A)(e),this.muxerControlChannel=(0,a.A)(e),this.demuxerControlChannel=(0,a.A)(e),this.videoRenderControlIPCPort=new s.Ay(this.videoRenderControlChannel.port2),this.audioRenderControlIPCPort=new s.Ay(this.audioRenderControlChannel.port2),this.muxerControlIPCPort=new s.Ay(this.muxerControlChannel.port2),this.demuxerControlIPCPort=new s.Ay(this.demuxerControlChannel.port2),this.enableAudioVideoSync=!0,this.videoRenderControlIPCPort.on(s.Wo,(t=>{switch(t.method){case"ended":this.observer.onVideoEnded();break;case"updateCanvas":this.observer.onCanvasUpdated();break;case"firstRendered":this.observer.onFirstVideoRendered();break;case"firstRenderedAfterUpdateCanvas":this.observer.onFirstVideoRenderedAfterUpdateCanvas();break;case"syncPts":0===this.timeUpdateListenType&&this.observer.onTimeUpdate(t.params.pts)}})),this.audioRenderControlIPCPort.on(s.Wo,(t=>{switch(t.method){case"syncPts":this.enableAudioVideoSync&&this.videoRenderControlIPCPort.notify("syncPts",t.params),1===this.timeUpdateListenType&&this.observer.onTimeUpdate(t.params.pts);break;case"ended":this.observer.onAudioEnded(),this.timeUpdateListenType=0}})),this.muxerControlIPCPort.on(s.Wo,(t=>{"seek"===t.method&&this.observer.onMSESeek(t.params.time)})),this.demuxerControlIPCPort.on(s.S3,(async t=>{"getDecoderResource"===t.method&&this.demuxerControlIPCPort.reply(t,await this.observer.onGetDecoderResource(t.params.mediaType,t.params.codecId))})),this.onVisibilityChange=e=>{this.visibilityHidden="hidden"===document.visibilityState&&!this.observer.isPictureInPicture(),t.isMediaStreamMode()||this.videoRenderControlIPCPort.notify("skipRender",{skipRender:this.visibilityHidden}),this.muxerControlIPCPort.notify("visibilitychange",{visibilityHidden:this.visibilityHidden})},this.visibilityHidden="hidden"===document.visibilityState&&!this.observer.isPictureInPicture(),document.addEventListener("visibilitychange",this.onVisibilityChange),this.muxerControlIPCPort.notify("visibilitychange",{visibilityHidden:this.visibilityHidden})}getVideoRenderControlPort(){return this.videoRenderControlChannel.port1}getAudioRenderControlPort(){return this.audioRenderControlChannel.port1}getMuxerControlPort(){return this.muxerControlChannel.port1}getDemuxerControlPort(){return this.demuxerControlChannel.port1}setTimeUpdateListenType(t){this.timeUpdateListenType=t}setEnableAudioVideoSync(t){this.enableAudioVideoSync=t}destroy(){this.videoRenderControlIPCPort&&this.videoRenderControlIPCPort.destroy(),this.audioRenderControlIPCPort&&this.audioRenderControlIPCPort.destroy(),this.muxerControlIPCPort&&this.muxerControlIPCPort.destroy(),this.demuxerControlIPCPort&&this.demuxerControlIPCPort.destroy(),this.onVisibilityChange&&(document.removeEventListener("visibilitychange",this.onVisibilityChange),this.onVisibilityChange=null),this.videoRenderControlIPCPort=this.audioRenderControlIPCPort=this.muxerControlIPCPort=this.videoRenderControlChannel=this.audioRenderControlChannel=this.demuxerControlChannel=this.muxerControlChannel=null}}},2368:(t,e,r)=>{"use strict";r.d(e,{A:()=>d});var i=r(134),s=r(63939),a=r(50932),n=r(54058),o=r(38724);const c=500;class d{constructor(t){(0,i.A)(this,"timer",void 0),(0,i.A)(this,"interval",void 0),(0,i.A)(this,"data",void 0),(0,i.A)(this,"lastIncomingPacketCount",void 0),(0,i.A)(this,"shutterCount",void 0),(0,i.A)(this,"lastShutterCount",void 0),(0,i.A)(this,"isFirst",void 0),(0,i.A)(this,"max",void 0),(0,i.A)(this,"min",void 0),(0,i.A)(this,"targetPlaybackRate",void 0),(0,i.A)(this,"currentPlaybackRate",void 0),(0,i.A)(this,"playbackRateTimer",void 0),(0,i.A)(this,"options",void 0),this.options=t,this.interval=1e3,this.isFirst=!0,this.data=[],this.lastIncomingPacketCount=BigInt(0),this.shutterCount=0,this.lastShutterCount=0,this.max=1e3*t.max>>>0,this.min=1e3*t.min>>>0,a.M[15](this.options.jitterBuffer,this.min),a.M[15](this.options.jitterBuffer+4,this.max),t.lowLatencyStart&&a.M[15](this.options.jitterBuffer+4,this.min+c),this.targetPlaybackRate=1,this.currentPlaybackRate=1,this.playbackRateTimer=new n.A((()=>{if(this.currentPlaybackRate>this.targetPlaybackRate){const t=Math.max(this.targetPlaybackRate,this.currentPlaybackRate-.01);this.options.observer.onSetPlayRate(t),this.currentPlaybackRate=t}else if(this.currentPlaybackRate<this.targetPlaybackRate){const t=Math.min(this.targetPlaybackRate,this.currentPlaybackRate+.01);this.options.observer.onSetPlayRate(t),this.currentPlaybackRate=t}else this.playbackRateTimer.stop()}),0,200),this.timer=new o.A(this.onTimer.bind(this),1e3,this.interval)}start(){this.timer.start(),this.isFirst=!0,this.lastIncomingPacketCount=s.f[17](this.options.stats+24)+s.f[17](this.options.stats+112),this.shutterCount=0,this.lastShutterCount=s.f[15](this.options.stats+292)+s.f[15](this.options.stats+288),this.computePlayRate()}stop(){this.timer.stop(),this.data.length=0,this.isFirst=!0,this.playbackRateTimer.isStarted()&&(this.playbackRateTimer.stop(),this.targetPlaybackRate=this.currentPlaybackRate=1,this.options.observer.onSetPlayRate(1))}reset(){this.data.length=0,this.isFirst=!0,this.lastIncomingPacketCount=s.f[17](this.options.stats+24)+s.f[17](this.options.stats+112),this.shutterCount=0,this.lastShutterCount=s.f[15](this.options.stats+292)+s.f[15](this.options.stats+288),this.targetPlaybackRate=this.currentPlaybackRate=1}setPlayRate(t){this.targetPlaybackRate=t,this.options.useMse?(this.options.observer.onSetPlayRate(this.targetPlaybackRate),this.currentPlaybackRate=this.targetPlaybackRate):this.currentPlaybackRate===t||this.playbackRateTimer.isStarted()||this.playbackRateTimer.start()}computePlayRate(){let t=s.f[15](this.options.stats+244)?s.f[15](this.options.stats+32)/s.f[15](this.options.stats+244)*1e3:s.f[15](this.options.stats+232)?s.f[15](this.options.stats+120)/s.f[15](this.options.stats+232)*1e3:s.f[15](this.options.jitterBuffer);const e=(s.f[15](this.options.jitterBuffer)+s.f[15](this.options.jitterBuffer+4))/2;t<s.f[15](this.options.jitterBuffer)>>1&&t<2e3?this.setPlayRate(.9):t<s.f[15](this.options.jitterBuffer)-c&&t<2e3?this.setPlayRate(.95):t>s.f[15](this.options.jitterBuffer+4)+c?this.setPlayRate(1.05):(this.currentPlaybackRate<1&&t>=e||this.currentPlaybackRate>1&&t<=e)&&this.setPlayRate(1),t>2e3&&this.max>2e3&&t>this.max<<1&&this.options.observer.onCroppingBuffer(s.f[15](this.options.jitterBuffer+4))}process(){const t=this.data.reduce(((t,e,r)=>t+e*(r+1)),0)/55,e=this.data.reduce(((e,r)=>e+Math.pow(r-t,2)),0)/this.data.length,r=Math.sqrt(e);if(this.options.lowLatency){const e=Math.round(t/(this.interval/1e3)),i=s.f[15](this.options.stats+232)+s.f[15](this.options.stats+244);e<i>>1||this.shutterCount>3?(a.M[15](this.options.jitterBuffer,Math.min(2*s.f[15](this.options.jitterBuffer),this.max-c)),a.M[15](this.options.jitterBuffer+4,Math.min(2*s.f[15](this.options.jitterBuffer+4),this.max))):e>=i&&r<50?(a.M[15](this.options.jitterBuffer,Math.max(s.f[15](this.options.jitterBuffer)-c,this.min)),a.M[15](this.options.jitterBuffer+4,Math.max(s.f[15](this.options.jitterBuffer+4)-c,this.min+c))):r>100?(a.M[15](this.options.jitterBuffer,Math.min(s.f[15](this.options.jitterBuffer)+c,this.max-c)),a.M[15](this.options.jitterBuffer+4,Math.min(s.f[15](this.options.jitterBuffer+4)+c,this.max))):r<20?s.f[15](this.options.jitterBuffer)===this.min?a.M[15](this.options.jitterBuffer+4,Math.max(s.f[15](this.options.jitterBuffer+4)-c,this.min+c)):a.M[15](this.options.jitterBuffer,Math.max(s.f[15](this.options.jitterBuffer)-c,this.min)):s.f[15](this.options.jitterBuffer+4)===this.max?a.M[15](this.options.jitterBuffer,Math.min(s.f[15](this.options.jitterBuffer)+c,this.max-c)):a.M[15](this.options.jitterBuffer+4,Math.min(s.f[15](this.options.jitterBuffer+4)+c,this.max))}this.computePlayRate(),a.M[19](this.options.stats+272,r)}onTimer(){const t=s.f[17](this.options.stats+24)+s.f[17](this.options.stats+112);this.isFirst?this.isFirst=!1:this.data.push(Number(BigInt.asIntN(32,t-this.lastIncomingPacketCount))),this.lastIncomingPacketCount=t,s.f[15](this.options.stats+292)+s.f[15](this.options.stats+288)>this.lastShutterCount?this.shutterCount++:this.shutterCount=0,this.lastShutterCount=s.f[15](this.options.stats+292)+s.f[15](this.options.stats+288),this.data.length>10&&this.data.shift(),10===this.data.length&&this.process()}}},78201:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(134),s=r(63939),a=r(50932),n=r(54058),o=r(43607);class c{constructor(t,e,r){(0,i.A)(this,"stats",void 0),(0,i.A)(this,"timer",void 0),(0,i.A)(this,"videoFrameRenderCount",void 0),(0,i.A)(this,"videoFrameDecodeCount",void 0),(0,i.A)(this,"audioFrameRenderCount",void 0),(0,i.A)(this,"audioFrameDecodeCount",void 0),(0,i.A)(this,"videoPacketBytes",void 0),(0,i.A)(this,"audioPacketBytes",void 0),(0,i.A)(this,"bufferReceiveBytes",void 0),(0,i.A)(this,"observer",void 0),(0,i.A)(this,"isWorkerMain",void 0),(0,i.A)(this,"videoDecodeMaxIntervalCounter",void 0),(0,i.A)(this,"lastAudioStutterCount",void 0),(0,i.A)(this,"lastAVDelta",void 0),this.stats=t,this.observer=r,this.isWorkerMain=e,this.timer=new n.A(this.onTimer.bind(this),1e3,1e3)}reset(){this.videoFrameRenderCount=s.f[17](this.stats+160),this.videoFrameDecodeCount=s.f[17](this.stats+144),this.audioFrameRenderCount=s.f[17](this.stats+72),this.audioFrameDecodeCount=s.f[17](this.stats+56),this.videoPacketBytes=s.f[17](this.stats+104),this.audioPacketBytes=s.f[17](this.stats+16),this.bufferReceiveBytes=s.f[17](this.stats+192),this.isWorkerMain||(a.M[15](this.stats+248,0),a.M[15](this.stats+252,0),a.M[15](this.stats+256,0),a.M[15](this.stats+260,0))}start(){this.reset(),this.videoDecodeMaxIntervalCounter=0,this.lastAudioStutterCount=0,this.lastAVDelta=BigInt(0),this.timer.start()}stop(){this.timer.stop()}onTimer(){a.M[15](this.stats+228,Number(BigInt.asIntN(32,s.f[17](this.stats+160)-this.videoFrameRenderCount))),a.M[15](this.stats+224,Number(BigInt.asIntN(32,s.f[17](this.stats+144)-this.videoFrameDecodeCount))),a.M[15](this.stats+240,Number(BigInt.asIntN(32,s.f[17](this.stats+72)-this.audioFrameRenderCount))),a.M[15](this.stats+236,Number(BigInt.asIntN(32,s.f[17](this.stats+56)-this.audioFrameDecodeCount))),a.M[15](this.stats+220,Number(BigInt.asIntN(32,s.f[17](this.stats+104)-this.videoPacketBytes))),a.M[15](this.stats+216,Number(BigInt.asIntN(32,s.f[17](this.stats+16)-this.audioPacketBytes))),a.M[15](this.stats+264,Number(BigInt.asIntN(32,s.f[17](this.stats+192)-this.bufferReceiveBytes))),"visible"===document.visibilityState&&(s.f[15](this.stats+228)<.5*s.f[15](this.stats+232)||s.f[15](this.stats+260)>6e3/s.f[15](this.stats+232))&&this.observer.onVideoStutter(),s.f[15](this.stats+256)>1e3/s.f[15](this.stats+232)&&s.f[15](this.stats+224)<.9*s.f[15](this.stats+232)&&(s.f[17](this.stats+328)>0&&s.f[17](this.stats+336)>0&&s.f[17](this.stats+328)-s.f[17](this.stats+336)>BigInt(1e3)&&s.f[17](this.stats+328)-s.f[17](this.stats+336)>this.lastAVDelta||s.f[15](this.stats+288)>this.lastAudioStutterCount)?this.videoDecodeMaxIntervalCounter++:this.videoDecodeMaxIntervalCounter=0,this.videoDecodeMaxIntervalCounter>5&&(this.observer.onVideoDiscard(),this.videoDecodeMaxIntervalCounter=0),this.lastAudioStutterCount=s.f[15](this.stats+288),this.lastAVDelta=s.f[17](this.stats+328)-s.f[17](this.stats+336),this.reset();const t=s.f[17](this.stats+344),e=s.f[17](this.stats+352),r=s.f[17](this.stats+328),i=s.f[17](this.stats+336);if(t&&e&&t-r>2e3&&e-i>2e3||t&&!e&&t-r>2e3||e&&!t&&e-i>2e3){const r=t&&e?o.jk(t,e):t||e;this.observer.onMasterTimerUpdate(r)}}}},80089:(t,e,r)=>{"use strict";var i;r.d(e,{s:()=>i}),function(t){t.WIDEVINE="com.widevine.alpha",t.PLAYREADY="com.microsoft.playready",t.CLEARKEY="org.w3.clearkey",t.FAIRPLAY="com.apple.fps.1_0"}(i||(i={}))},3680:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(80089);function s(t){const e={edef8ba979d64acea3c827dcd51d21ed:i.s.WIDEVINE,"9a04f07998404286ab92e65be0885f95":i.s.PLAYREADY,e2719d58a985b3c9781ab030af78d30e:i.s.CLEARKEY,"94ce86fb07ff4f43adb893d2fa968ca2":i.s.FAIRPLAY};let r="";return t.forEach((t=>{let e=t.toString(16);1===e.length&&(e="0"+e),r+=e})),e[r]}},30691:(t,e,r)=>{"use strict";function i(t){let e="";return t.forEach((t=>{e+=String.fromCharCode(t)})),e=btoa(e),e.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}r.d(e,{A:()=>i})},28090:(t,e,r)=>{"use strict";r.d(e,{CN:()=>n,E9:()=>p,F5:()=>i,Gd:()=>b,IY:()=>m,NN:()=>o,NX:()=>A,Nz:()=>h,Rj:()=>f,S2:()=>s,Sw:()=>v,W1:()=>k,Wt:()=>u,Wu:()=>w,d6:()=>a,dQ:()=>g,hV:()=>d,mQ:()=>l,xv:()=>y,yd:()=>c});const i="loading",s="loaded",a="playing",n="played",o="paused",c="stopped",d="ended",h="seeking",l="seeked",u="changing",f="changed",p="time",m="resume",g="audioContextRunning",v="firstAudioRendered",A="firstVideoRendered",y="streamUpdate",b="progress",w="volumeChange",k="subtitleDelayChange"},67593:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(26429),s=r(42577),a=r(95797);function n(t){return i.USE_THREADS||a.A.worker&&t?new MessageChannel:new s.A}},76750:(t,e,r)=>{"use strict";function i(){if("function"==typeof MediaSource)return MediaSource;if("function"==typeof ManagedMediaSource)return ManagedMediaSource;throw new Error("not support mse")}r.d(e,{A:()=>i})},47595:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(95797),s=r(86834),a=r(44690);function n(){let t=i.A.offscreenCanvas;return(s.A.safari&&!s.A.checkVersion(s.A.version,"17",!0)||a.A.ios&&!s.A.checkVersion(a.A.version,"17",!0))&&(t=!1),t}},25115:(t,e,r)=>{"use strict";r.d(e,{A:()=>Y});var i=r(54001),s=r.n(i),a=r(14686),n=r(61499),o=r(63939),c=r(9599),d=r(29170),h=r(50932),l=r(12264),u=r(44315),f=r(44527),p=r(9705),m=r(84149),g=r(4624),v=r(35336),A=r(92174),y=r(69765),b=(r(77162),r(71766)),w=r(39148),k=r(60120),x=r(84290),I=r(77231),T=r(44328),P=r(86932),S=r(85224),_=r(10333),M=r(22343),C=r(71517),B=r(37837),R=r(86834),D=r(85103),U=r(13724),E=r(43607),L=r(65977),$=r(76750),F=r(39381),O=r(62815),z=r(67659),N=r(71762),V=r(72703),W=r(67672),G=r(44690),q=r(38724);const H="src\\avplayer\\mse\\MSEPipeline.ts";function j(t,e,r,i){if(e!==i)return!0;let s=!1;for(let i=0;i<e;i++)if(o.f[2](t+i)!==o.f[2](r+i)){s=!0;break}return s}class Y extends f.A{constructor(){super()}async syncToKeyframe(t){let e=!0;if(t.video)for(;;){if(t.video.backPacket=await this.pullAVPacket(t.video,t),t.video.backPacket<0){t.video.packetEnded=!0,t.video.backPacket=0;break}if(t.audio&&!t.audio.packetEnded&&(!t.audio.backPacket||(0,T.Mr)(o.f[17](t.audio.backPacket+8),t.audio.backPacket+72,I.i0)<(0,T.Mr)(o.f[17](t.video.backPacket+8),t.video.backPacket+72,I.i0)))for(;;){if(t.audio.backPacket>0&&t.avpacketPool.release(t.audio.backPacket),t.audio.backPacket=await this.pullAVPacket(t.audio,t),t.audio.backPacket<0){t.audio.packetEnded=!0,t.audio.backPacket=0;break}if((0,T.Mr)(o.f[17](t.audio.backPacket+8),t.audio.backPacket+72,I.i0)>(0,T.Mr)(o.f[17](t.video.backPacket+8),t.video.backPacket+72,I.i0))break}if(1&o.f[15](t.video.backPacket+36)||27===o.f[15](t.video.codecpar+4)&&O.KD(t.video.backPacket,o.f[20](t.video.codecpar+12)?1+(3&F.r8(o.f[20](t.video.codecpar+12)+4)):4)||173===o.f[15](t.video.codecpar+4)&&z.KD(t.video.backPacket,o.f[20](t.video.codecpar+12)?1+(3&F.r8(o.f[20](t.video.codecpar+12)+21)):4))break;e=!1,t.avpacketPool.release(t.video.backPacket)}return e}getSourceOpenHandler(t,e=BigInt(0)){return async()=>{var r,i;await this.syncToKeyframe(t);let l=e,u=e;if(!t.audio||t.audio.backPacket||t.audio.packetEnded||(t.audio.backPacket=await this.pullAVPacket(t.audio,t),t.audio.backPacket<0&&(t.audio.packetEnded=!0,t.audio.backPacket=0)),t.video&&!t.video.backPacket&&t.video.packetEnded&&(t.video.backPacket=await this.pullAVPacket(t.video,t),t.video.backPacket<0&&(t.video.packetEnded=!0,t.video.backPacket=0)),(null===(r=t.audio)||void 0===r?void 0:r.backPacket)>0&&(l=E.T9(l,(0,T.Mr)(o.f[17](t.audio.backPacket+16),t.audio.backPacket+72,I.i0))),(null===(i=t.video)||void 0===i?void 0:i.backPacket)>0&&(u=E.T9(u,(0,T.Mr)(o.f[17](t.video.backPacket+16),t.video.backPacket+72,I.i0))),t.audio&&t.video&&E.tn(l-u)>1e3)if(u>l){const e=(0,T.k)(l,I.i0,(0,d.A)(t.video.backPacket+72,c.P));h.M[17](t.video.backPacket+48,o.f[17](t.video.backPacket+16)-e),h.M[17](t.video.backPacket+16,e),h.M[17](t.video.backPacket+8,e),u=l}else if(l>u&&86018===t.audio.oformatContext.streams[0].codecpar.codecId&&2===t.audio.oformatContext.streams[0].codecpar.profile&&t.audio.oformatContext.streams[0].codecpar.chLayout.nbChannels<3){const e=t.avpacketPool.alloc();(0,C.rN)(e,t.audio.backPacket);const r=1===t.audio.oformatContext.streams[0].codecpar.chLayout.nbChannels?new Uint8Array([0,200,0,128,35,128]):new Uint8Array([33,0,73,144,2,25,0,35,128]),i=(0,B.sY)(r.length);(0,a.lW)(i,r.length,r),(0,C.NX)(e,i,r.length),h.M[17](e+16,(0,T.k)(u,I.i0,(0,d.A)(e+72,c.P))),h.M[17](e+8,(0,T.k)(u,I.i0,(0,d.A)(e+72,c.P)));const s=BigInt(1024e3)/BigInt(0|t.audio.oformatContext.streams[0].codecpar.sampleRate),n=Number(BigInt.asIntN(32,(l-u)/s));let f=o.f[17](e+16)+(0,T.k)(s,I.i0,(0,d.A)(t.audio.backPacket+72,c.P));for(let r=0;r<n-1;r++){const r=t.avpacketPool.alloc();(0,C.rN)(r,e),h.M[17](r+16,f),h.M[17](r+8,f),t.audio.pullQueue.queue.push(r),f+=(0,T.k)(s,I.i0,(0,d.A)(t.audio.backPacket+72,c.P))}t.audio.pullQueue.queue.push(t.audio.backPacket),t.audio.backPacket=e,l=u}const f=[];t.audio&&(t.audio.track.setSourceBuffer(this.createSourceBuffer(t.mediaSource,t.audio.oformatContext.streams[0].codecpar[n.o9])),t.audio.enableRawMpeg||(A.ho(t.audio.oformatContext),A.bx(t.audio.oformatContext)),f.push(this.startMux(t.audio,t,E.T9(l,u)))),t.video&&(t.video.track.setSourceBuffer(this.createSourceBuffer(t.mediaSource,t.video.oformatContext.streams[0].codecpar[n.o9])),t.video.enableRawMpeg||(A.ho(t.video.oformatContext),A.bx(t.video.oformatContext)),f.push(this.startMux(t.video,t,E.T9(l,u)))),await s().all(f);let p=!1,m=!1;t.audio&&(t.audio.backPacket=await this.pullAVPacket(t.audio,t),t.audio.backPacket>0?(p=!0,t.audio.frontPacket=await this.pullAVPacket(t.audio,t),t.audio.frontPacket>0?t.audio.frontBuffered=!0:(t.audio.frontPacket=0,t.audio.packetEnded=!0)):t.audio.packetEnded=!0,t.audio.enableRawMpeg||t.audio.oformatContext.ioWriter.flush(),t.audio.track.addBuffer(t.audio.bufferQueue.flush())),t.video&&(t.video.backPacket=await this.pullAVPacket(t.video,t),t.video.backPacket>0?(m=!0,t.video.frontPacket=await this.pullAVPacket(t.video,t),t.video.frontPacket>0?t.video.frontBuffered=!0:(t.video.frontPacket=0,t.video.packetEnded=!0)):t.video.packetEnded=!0,t.video.enableRawMpeg||t.video.oformatContext.ioWriter.flush(),t.video.track.addBuffer(t.video.bufferQueue.flush())),t.audio&&(p?(this.createLoop(t.audio,t),t.audio.loop.start()):t.audio.track.end()),t.video&&(m?(this.createLoop(t.video,t),t.video.loop.start()):t.video.track.end()),await new U.A(.1);let g=0;t.audio?g=t.video?Math.max(t.audio.track.getBufferedStart(),t.video.track.getBufferedStart()):t.audio.track.getBufferedStart():t.video&&(g=t.video.track.getBufferedStart()),t.currentTimeNTP=(0,P.A)(),e>BigInt(0)?(t.currentTime=(0,D.yw)(e),t.controlIPCPort.notify("seek",{time:t.currentTime})):(R.A.safari||G.A.ios||g>.1||t.playRate>BigInt(100))&&(t.currentTime=g,t.currentTimeNTP=(0,P.A)(),t.controlIPCPort.notify("seek",{time:g}))}}getMimeType(t){let e="";return 1===o.f[15](t)?e=(0,S.A)(t):0===o.f[15](t)&&(e=(0,_.A)(t)),e||g.h2("invalid stream",H,445),e}createSourceBuffer(t,e){return t.addSourceBuffer(this.getMimeType(e))}mixExtradata(t,e,r){const i=t.oformatContext.streams[0].codecpar;i.extradata&&(0,B.Eb)(i.extradata),i.extradata=(0,B.sY)(r),(0,a.Mr)(i.extradata,e,r),i.extradataSize=r,t.track.changeMimeType(this.getMimeType(i[n.o9]),t.enableRawMpeg?"sequence":"segments");const s=new y.A({fragmentMode:1,fragment:!0,fastOpen:!0,movMode:0,defaultBaseIsMoof:!0,reverseSpsInAvcc:!0,hasTfra:!1});t.oformatContext.oformat=s,t.timestampOffsetUpdated=!1,t.enableRawMpeg||(A.ho(t.oformatContext),A.bx(t.oformatContext))}checkEnableEncryption(t,e){if(t.oformatContext.streams[0].metadata.encryption){const r=(0,C.fQ)(e,25);if(!r&&!t.ignoreEncryption||r&&t.ignoreEncryption){t.track.changeMimeType(this.getMimeType(t.oformatContext.streams[0].codecpar[n.o9]),t.enableRawMpeg?"sequence":"segments");const e=new y.A({fragmentMode:1,fragment:!0,fastOpen:!0,movMode:0,defaultBaseIsMoof:!0,reverseSpsInAvcc:!0,ignoreEncryption:!r,hasTfra:!1});t.ignoreEncryption=!r,t.oformatContext.oformat=e,t.timestampOffsetUpdated=!1,t.enableRawMpeg||(A.ho(t.oformatContext),A.bx(t.oformatContext))}}}async pullAVPacketInternal(t,e){const r=await e.request("pull");if(W.ai(r)||(0,V.A)(r))return r;{const e=t.avpacketPool.alloc();return(0,N.r0)(r,e),e}}async pullAVPacket(t,e){const r=t.pullQueue;if(r.ended&&!r.queue.length)return-1048576;const i=r.queue.length?r.queue.shift():await this.pullAVPacketInternal(e,t.pullIPC);if(i<0)return r.ended=!0,-1048576;if(o.f[17](i+16)<BigInt(0))return i;if(o.f[17](i+16)<r.lastDTS&&g.R8(`got packet with dts ${o.f[17](i+16)}, which is earlier then the last packet(${r.lastDTS})`,H,550),h.M[17](i+48,I.Dh),"audio"===t.type&&o.f[17](i+16)>0)h.M[17](i+8,o.f[17](i+16));else if("video"===t.type&&!e.isLive)if(1&o.f[15](i+36)&&(27===o.f[15](e.video.codecpar+4)&&O.KD(i,o.f[20](e.video.codecpar+12)?1+(3&F.r8(o.f[20](e.video.codecpar+12)+4)):4)||173===o.f[15](e.video.codecpar+4)&&z.KD(i,o.f[20](e.video.codecpar+12)?1+(3&F.r8(o.f[20](e.video.codecpar+12)+21)):4)))if(o.f[17](i+8)<r.lastPTS){g.R8(`got video packet with pts ${o.f[17](i+8)}, which is earlier then the last packet(${r.lastPTS}), try to fix it!`,H,587),h.M[17](i+8,r.lastPTS+(o.f[17](i+16)-r.lastDTS));const s=await this.pullAVPacketInternal(e,t.pullIPC);if(s<0)r.ended=!0;else{r.queue.push(s);let a=o.f[17](s+8);const n=o.f[17](s+8);for(;;){const i=await this.pullAVPacketInternal(e,t.pullIPC);if(i<0){r.ended=!0;break}if(r.queue.push(i),o.f[17](i+8)>n)break;a=E.jk(a,o.f[17](i+8))}a<o.f[17](i+8)&&(r.diff=o.f[17](i+16)-r.lastDTS)}}else r.diff=BigInt(0);else h.M[17](i+8,o.f[17](i+8)+r.diff);return o.f[17](i+8)>r.lastPTS&&(r.lastPTS=o.f[17](i+8)),r.lastDTS=o.f[17](i+16),"audio"===t.type&&r.useSampleRateTimeBase&&(r.frameCount===I.Dh?(r.frameCount=(0,T.Mr)(o.f[17](i+16),i+72,t.oformatContext.streams[0].timeBase),h.M[17](i+16,r.frameCount),h.M[17](i+8,r.frameCount)):(r.frameCount=r.frameCount+BigInt(0|o.f[15](t.codecpar+144)),h.M[17](i+16,r.frameCount),h.M[17](i+8,r.frameCount)),(0,a.Mr)(i+72,t.oformatContext.streams[0].timeBase[n.o9],8)),i}writeAVPacket(t,e,r=!1){if(e.enableRawMpeg){if(!e.timestampOffsetUpdated){const r=(0,T.Mr)(o.f[17](t+8),t+72,I.i0);e.track.updateTimestampOffset(Number(BigInt.asIntN(32,r))/1e3),e.timestampOffsetUpdated=!0}e.bufferQueue.write((0,a.s3)(o.f[20](t+24),o.f[15](t+28)).slice())}else this.checkEnableEncryption(e,t),A.XA(e.oformatContext,t),r&&e.oformatContext.ioWriter.flush()}swap(t,e){if(t.backPacket&&e.avpacketPool.release(t.backPacket),t.backPacket=0,!t.frontBuffered)return!1;t.backPacket=t.frontPacket,t.frontPacket=0,t.frontBuffered=!1;const r=(0,P.A)();return this.pullAVPacket(t,e).then((i=>{if(i<0)return t.packetEnded=!0,void(t.frontPacket=0);const s=(0,P.A)()-r;s>5&&(t.startTimestamp+=BigInt(Math.floor(s))),t.frontPacket=i,t.frontBuffered=!0,t.seekSync&&(t.seekSync(),t.seekSync=null),t.backPacket||this.swap(t,e)})),!0}createLoop(t,e){t.loop=new w.A((()=>{const r=t.track.getBufferedDuration(e.currentTime+((0,P.A)()-e.currentTimeNTP)/1e3);if(r>e.maxBuffer*(e.playRate>BigInt(100)?Number(e.playRate)/100:1))return t.loop.emptyTask(),void this.checkWaiting(e);if(!t.backPacket)return void(t.packetEnded&&!t.frontPacket?(t.ended=!0,t.loop.stop(),t.enableRawMpeg||(A.dJ(t.oformatContext),A.bX(t.oformatContext)),t.bufferQueue.size&&t.track.addBuffer(t.bufferQueue.flush()),t.track.end()):t.loop.emptyTask());let i=t.backPacket;const s=(0,T.Mr)(o.f[17](i+16),i+72,I.i0);if(t.lastDTS!==I.Dh&&s-t.lastDTS>1e3&&(A.bX(t.oformatContext),t.startTimestamp-=s-t.lastDTS),t.lastDTS=s,e.enableJitterBuffer&&(o.f[15](e.stats+244)?o.f[15](e.stats+32)/o.f[15](e.stats+244)*1e3:o.f[15](e.stats+232)?o.f[15](e.stats+120)/o.f[15](e.stats+232)*1e3:0)<=o.f[15](e.stats+280)&&this.setPlayRate(e.taskId,1),s*BigInt(100)/e.playRate+t.startTimestamp-BigInt(Math.floor((0,P.A)()))<=0||r<e.minBuffer*(e.playRate>BigInt(100)?Number(e.playRate)/100:1)){t.track.isPaused()&&t.track.enqueue(),h.M[15](i+32,t.oformatContext.streams[0].index);const r=(0,C.rU)(i,1);r&&j(t.oformatContext.streams[0].codecpar.extradata,t.oformatContext.streams[0].codecpar.extradataSize,o.f[20](r),0|o.f[25](r+4))&&this.mixExtradata(t,o.f[20](r),0|o.f[25](r+4)),this.writeAVPacket(i,t,!0),t.track.addBuffer(t.bufferQueue.flush());const a=t.oformatContext.streams[0].codecpar.codecType;if(0===a?(h.M[17](e.stats+144,o.f[17](e.stats+144)+BigInt(1)),h.M[17](e.stats+160,o.f[17](e.stats+160)+BigInt(1))):1===a&&(h.M[17](e.stats+56,o.f[17](e.stats+56)+BigInt(1)),h.M[17](e.stats+72,o.f[17](e.stats+72)+BigInt(1))),e.playRate!==e.targetRate&&(t.startTimestamp=BigInt(Math.floor((0,P.A)()))-s*BigInt(100)/e.targetRate,e.playRate=e.targetRate),t.packetEnded&&!t.frontPacket)return t.ended=!0,t.loop.stop(),t.enableRawMpeg||(A.dJ(t.oformatContext),A.bX(t.oformatContext)),t.bufferQueue.size&&t.track.addBuffer(t.bufferQueue.flush()),void t.track.end();this.swap(t,e)}else t.loop.emptyTask()}),0,0)}async startMux(t,e,r=BigInt(0)){let i,s=I.Dh,a=I.Dh,n=BigInt(0),c=e.cacheDuration;const d=t.oformatContext.streams[0].timeBase;for(t.backPacket>0&&(s=o.f[17](t.backPacket+16),a=o.f[17](t.backPacket+8),r>a&&(c+=r-(0,T.k)(s,d,I.i0)),h.M[15](t.backPacket+32,t.oformatContext.streams[0].index),this.writeAVPacket(t.backPacket,t),e.avpacketPool.release(t.backPacket),t.backPacket=0);s===I.Dh||(0,T.k)(n-s,d,I.i0)<c;){if(i=await this.pullAVPacket(t,e),i<0){t.packetEnded=!0;break}if(n=o.f[17](i+16),s===I.Dh&&(s=n,a=o.f[17](i+8)),o.f[17](i+8)<a&&(a=o.f[17](i+8)),e.video&&e.video.streamIndex===o.f[15](i+32)){const e=(0,C.rU)(i,1);e&&j(t.oformatContext.streams[0].codecpar.extradata,t.oformatContext.streams[0].codecpar.extradataSize,o.f[20](e),0|o.f[25](e+4))&&this.mixExtradata(t,o.f[20](e),0|o.f[25](e+4))}h.M[15](i+32,t.oformatContext.streams[0].index),this.writeAVPacket(i,t),e.avpacketPool.release(i)}a!==I.Dh&&t.startPTS<=BigInt(0)&&(t.startPTS=a),t.pullQueue.diff=BigInt(0),e.currentTimeNTP=(0,P.A)(),e.currentTime=0,t.startTimestamp=BigInt(Math.floor((0,P.A)()))-(0,T.k)(n,d,I.i0)*BigInt(100)/e.playRate}resetResource(t,e){t.bufferQueue.flush(),t.oformatContext.oformat.destroy(t.oformatContext);const r=new y.A({fragmentMode:1,fragment:!0,fastOpen:!0,movMode:0,defaultBaseIsMoof:!0,reverseSpsInAvcc:!0,hasTfra:!1});t.oformatContext.oformat=r;const i=new k.A;i.onQuotaExceededError=()=>{t.startTimestamp-=BigInt(100)},i.onEnded=()=>{e.audio&&!e.audio.ended||e.video&&!e.video.ended||(e.mediaSource.endOfStream(),g.pq(`muxer ended, taskId: ${e.taskId}`,H,925))},t.track=i,t.packetEnded=!1,t.ended=!1,t.startTimestamp=BigInt(0),t.frontBuffered=!1,t.seekSync=null,t.loop&&(t.loop.destroy(),t.loop=null),t.frontPacket&&(e.avpacketPool.release(t.frontPacket),t.frontPacket=0),t.backPacket&&(e.avpacketPool.release(t.backPacket),t.backPacket=0),t.pullQueue.ended=!1,t.pullQueue.index=0,t.pullQueue.frameCount=I.Dh,t.pullQueue.lastPTS=BigInt(0),t.pullQueue.lastDTS=BigInt(0),t.pullQueue.diff=BigInt(0),t.lastDTS=I.Dh}async addStream(t,e,r,i,s,a,c){const d=this.tasks.get(t);if(d){const l=(0,B.Gy)(168);(0,V.A)(r)?(0,b.Yi)(l,r):(0,N.T8)(r,l);const f=new v.A(1048576),A=(0,u.fG)(),w=new y.A({fragmentMode:1,fragment:!0,fastOpen:!0,movMode:0,defaultBaseIsMoof:!0,reverseSpsInAvcc:!0,hasTfra:!1}),x=new M.A;f.onFlush=t=>(x.write(t.slice()),0),f.onSeek=t=>x.seek(t)?0:p.lh;const P=A.createStream();(0,b.Yi)(P.codecpar[n.o9],l),P.metadata=s,86017===o.f[15](l+4)&&(P.codecpar.codecTag=(0,L.A)(".mp3"));const S=1===o.f[15](l)&&o.f[15](l+144)&&!d.isLive&&(0,T.lb)(i)>(0,T.lb)({num:1,den:o.f[15](l+136)});S?(P.timeBase.den=o.f[15](l+136),P.timeBase.num=1):(P.timeBase.den=i.den,P.timeBase.num=i.num),A.oformat=w,A.ioWriter=f;const _=new k.A,C={type:"audio",codecpar:l,ioWriter:f,oformatContext:A,oformat:w,track:_,bufferQueue:x,streamIndex:e,pullIPC:new m.Ay(c),loop:null,frontPacket:0,backPacket:0,frontBuffered:!1,startTimestamp:BigInt(0),packetEnded:!1,ended:!1,seekSync:null,startPTS:a,lastDTS:I.Dh,pullQueue:{queue:[],index:0,frameCount:I.Dh,diff:BigInt(0),lastPTS:BigInt(0),lastDTS:BigInt(0),ended:!1,useSampleRateTimeBase:S},enableRawMpeg:86017===o.f[15](l+4)&&!R.A.firefox,timestampOffsetUpdated:!1,ignoreEncryption:!1};_.onQuotaExceededError=()=>{C.startTimestamp-=BigInt(100)},_.onEnded=()=>{d.audio&&!d.audio.ended||d.video&&!d.video.ended||(d.mediaSource.endOfStream(),g.pq(`muxer ended, taskId: ${d.taskId}`,H,1073))},1===o.f[15](l)?(d.audio=C,h.M[15](d.stats+4,o.f[15](l+136)),h.M[15](d.stats,o.f[15](l+116))):0===o.f[15](l)&&(C.type="video",d.video=C,h.M[15](d.stats+84,o.f[15](l+56)),h.M[15](d.stats+88,o.f[15](l+60)),o.f[15](d.stats+84)*o.f[15](d.stats+88)>8294400&&(R.A.safari||G.A.ios)&&(d.cacheDuration=E.T9(BigInt(3e3),d.cacheDuration))),g.Yz(`add stream ${e}, taskId: ${t}`,H,1093)}else g.h2("task not found",H,1096)}async reAddStream(t,e,r,i,a,c){const d=this.tasks.get(t);if(d){const h=(0,B.Gy)(168);(0,V.A)(r)?(0,b.Yi)(h,r):(0,N.T8)(r,h);const l=1===o.f[15](h)?d.audio:d.video;if(l){l.bufferQueue.flush(),await new(s())((t=>{l.track.removeAllBuffer((()=>{t()}))})),l.track.reset();const t=new y.A({fragmentMode:1,fragment:!0,fastOpen:!0,movMode:0,defaultBaseIsMoof:!0,reverseSpsInAvcc:!0,hasTfra:!1});l.oformatContext.oformat=t,l.codecpar&&(0,b.dn)(l.codecpar),l.codecpar=h,l.streamIndex=e,l.startPTS=c;const r=l.oformatContext.streams[0];(0,b.Yi)(r.codecpar[n.o9],h),r.metadata=a,86017===o.f[15](h+4)&&(r.codecpar.codecTag=(0,L.A)(".mp3"));const u=1===o.f[15](h)&&o.f[15](h+144)&&!d.isLive&&(0,T.lb)(i)>(0,T.lb)({num:1,den:o.f[15](h+136)});u?(r.timeBase.den=o.f[15](h+136),r.timeBase.num=1):(r.timeBase.den=i.den,r.timeBase.num=i.num),l.enableRawMpeg=86017===o.f[15](h+4)&&!R.A.firefox,l.timestampOffsetUpdated=!1,l.pullQueue.useSampleRateTimeBase=u;try{l.track.changeMimeType(this.getMimeType(r.codecpar[n.o9]),l.enableRawMpeg?"sequence":"segments")}catch(t){if(!R.A.firefox||t.message.indexOf("An attempt was made to use an object that is not")<0)throw t}l.enableRawMpeg||(A.ho(l.oformatContext),A.bx(l.oformatContext))}else(0,b.dn)(h);g.Yz(`readd stream ${e}, taskId: ${t}`,H,1199)}else g.h2("task not found",H,1202)}async pause(t){const e=this.tasks.get(t);var r,i,s,a;e?(null!==(r=e.audio)&&void 0!==r&&r.loop||null!==(i=e.video)&&void 0!==i&&i.loop||g.h2("task has not played",H,1210),e.pausing=!0,e.pauseTimestamp=(0,P.A)(),null===(s=e.audio)||void 0===s||s.loop.stop(),null===(a=e.video)||void 0===a||a.loop.stop(),e.fakePlayTimer&&e.fakePlayTimer.stop(),g.Yz(`pause taskId: ${t}`,H,1220)):g.h2("task not found",H,1223)}async unpause(t){const e=this.tasks.get(t);var r,i;e?(null!==(r=e.audio)&&void 0!==r&&r.loop||null!==(i=e.video)&&void 0!==i&&i.loop||g.h2("task has not played",H,1231),e.pausing=!1,e.seeking||(e.audio&&(e.audio.startTimestamp+=BigInt(Math.floor((0,P.A)()-e.pauseTimestamp)),e.audio.loop.start()),e.video&&(e.video.startTimestamp+=BigInt(Math.floor((0,P.A)()-e.pauseTimestamp)),e.video.loop.start())),e.fakePlayTimer&&e.fakePlayTimer.start(),g.Yz(`unpause taskId: ${t}`,H,1249)):g.h2("task not found",H,1252)}async beforeSeek(t){const e=this.tasks.get(t);if(e){var r,i;const a=[];e.audio&&(e.audio.ended||e.audio.frontBuffered||a.push(new(s())((t=>{e.audio.seekSync=t})))),e.video&&(e.video.ended||e.video.frontBuffered||a.push(new(s())((t=>{e.video.seekSync=t})))),await s().all(a),e.seeking=!0,null===(r=e.audio)||void 0===r||r.loop.stop(),null===(i=e.video)||void 0===i||i.loop.stop(),e.audio&&(e.audio.enableRawMpeg||A.bX(e.audio.oformatContext),e.audio.bufferQueue.flush(),(R.A.safari||G.A.ios)&&await new(s())((t=>{e.audio.track.removeAllBuffer((()=>{t()}))})),e.audio.track.reset(),e.audio.packetEnded=!1,e.audio.timestampOffsetUpdated=!1,e.audio.backPacket&&(e.avpacketPool.release(e.audio.backPacket),e.audio.backPacket=0),e.audio.frontPacket&&(e.avpacketPool.release(e.audio.frontPacket),e.audio.frontPacket=0),e.audio.pullQueue.queue.length&&e.audio.pullQueue.queue.forEach((t=>{e.avpacketPool.release(t)})),e.audio.pullQueue.queue.length=0,e.audio.pullQueue.ended=!1,e.audio.pullQueue.index=0,e.audio.pullQueue.lastPTS=BigInt(0),e.audio.pullQueue.lastDTS=BigInt(0),e.audio.pullQueue.diff=BigInt(0),e.audio.pullQueue.frameCount=I.Dh,e.audio.lastDTS=I.Dh),e.video&&(e.video.enableRawMpeg||A.bX(e.video.oformatContext),e.video.bufferQueue.flush(),(R.A.safari||G.A.ios)&&await new(s())((t=>{e.video.track.removeAllBuffer((()=>{t()}))})),e.video.track.reset(),e.video.packetEnded=!1,e.video.timestampOffsetUpdated=!1,e.video.backPacket&&(e.avpacketPool.release(e.video.backPacket),e.video.backPacket=0),e.video.frontPacket&&(e.avpacketPool.release(e.video.frontPacket),e.video.frontPacket=0),e.video.pullQueue.queue.length&&e.video.pullQueue.queue.forEach((t=>{e.avpacketPool.release(t)})),e.video.pullQueue.queue.length=0,e.video.pullQueue.ended=!1,e.video.pullQueue.index=0,e.video.pullQueue.diff=BigInt(0),e.video.pullQueue.lastPTS=BigInt(0),e.video.pullQueue.lastDTS=BigInt(0),e.video.lastDTS=I.Dh),g.Yz(`before seek end taskId: ${t}`,H,1363)}}async afterSeek(t,e){const r=this.tasks.get(t);if(r){let i=e,a=e,n=await this.syncToKeyframe(r);r.audio&&r.audio.backPacket>0&&((!n||e<BigInt(0))&&(i=(0,T.Mr)(o.f[17](r.audio.backPacket+8),r.audio.backPacket+72,I.i0)),h.M[15](r.audio.backPacket+32,r.audio.oformatContext.streams[0].index),this.writeAVPacket(r.audio.backPacket,r.audio),r.avpacketPool.release(r.audio.backPacket),r.audio.backPacket=0),r.video&&r.video.backPacket>0&&((!n||e<BigInt(0))&&(a=(0,T.Mr)(o.f[17](r.video.backPacket+8),r.video.backPacket+72,I.i0)),h.M[15](r.video.backPacket+32,r.video.oformatContext.streams[0].index),this.writeAVPacket(r.video.backPacket,r.video),r.avpacketPool.release(r.video.backPacket),r.video.backPacket=0);const c=E.T9(i,a);for(;;){if(r.audio&&!r.audio.packetEnded){if(r.audio.backPacket=await this.pullAVPacket(r.audio,r),r.audio.backPacket<0&&(r.audio.packetEnded=!0,r.audio.backPacket=0,!r.video||r.video.packetEnded))break;if(i<BigInt(0)&&(i=(0,T.Mr)(o.f[17](r.audio.backPacket+8),r.audio.backPacket+72,I.i0)),!((0,T.Mr)(o.f[17](r.audio.backPacket+8),r.audio.backPacket+72,I.i0)<c+r.cacheDuration))break;h.M[15](r.audio.backPacket+32,r.audio.oformatContext.streams[0].index),this.writeAVPacket(r.audio.backPacket,r.audio),r.audio.enableRawMpeg||A.bX(r.audio.oformatContext),r.audio.track.addBuffer(r.audio.bufferQueue.flush()),r.avpacketPool.release(r.audio.backPacket),r.audio.backPacket=0}if(r.video&&!r.video.packetEnded){if(r.video.backPacket=await this.pullAVPacket(r.video,r),r.video.backPacket<0&&(r.video.packetEnded=!0,r.video.backPacket=0,!r.audio||r.audio.packetEnded))break;if(!((0,T.Mr)(o.f[17](r.video.backPacket+8),r.video.backPacket+72,I.i0)<c+r.cacheDuration))break;h.M[15](r.video.backPacket+32,r.video.oformatContext.streams[0].index),this.writeAVPacket(r.video.backPacket,r.video),r.video.enableRawMpeg||A.bX(r.video.oformatContext),r.video.track.addBuffer(r.video.bufferQueue.flush()),r.avpacketPool.release(r.video.backPacket),r.video.backPacket=0}}const d=[];r.audio&&(r.audio.enableRawMpeg||A.bX(r.audio.oformatContext),d.push(new(s())((t=>{r.audio.track.addBuffer(r.audio.bufferQueue.flush(),(()=>{t()}))})))),r.video&&(r.video.enableRawMpeg||A.bX(r.video.oformatContext),d.push(new(s())((t=>{r.video.track.addBuffer(r.video.bufferQueue.flush(),(()=>{t()}))})))),await s().all(d),r.audio&&!r.audio.packetEnded&&(r.audio.backPacket<=0&&(r.audio.backPacket=await this.pullAVPacket(r.audio,r),r.audio.backPacket<0&&(r.audio.packetEnded=!0,r.audio.backPacket=0)),r.audio.packetEnded||(r.audio.frontPacket=await this.pullAVPacket(r.audio,r),r.audio.frontPacket<0?(r.audio.frontPacket=0,r.audio.packetEnded=!0,r.audio.frontBuffered=!1):(r.audio.packetEnded=!1,r.audio.frontBuffered=!0),r.audio.startTimestamp=BigInt(Math.floor((0,P.A)()))-(i+r.cacheDuration+(0,T.k)(r.audio.startPTS,r.audio.oformatContext.streams[0].timeBase,I.i0))*BigInt(100)/r.playRate,r.pausing?r.pauseTimestamp=(0,P.A)():r.audio.loop.start())),r.video&&!r.video.packetEnded&&(r.video.backPacket<=0&&(r.video.backPacket=await this.pullAVPacket(r.video,r),r.video.backPacket<0&&(r.video.packetEnded=!0,r.video.backPacket=0)),r.video.packetEnded||(r.video.frontPacket=await this.pullAVPacket(r.video,r),r.video.frontPacket<0?(r.video.packetEnded=!0,r.video.frontBuffered=!1,r.video.frontPacket=0):(r.video.packetEnded=!1,r.video.frontBuffered=!0),r.video.startTimestamp=BigInt(Math.floor((0,P.A)()))-(a+r.cacheDuration+(0,T.k)(r.video.startPTS,r.video.oformatContext.streams[0].timeBase,I.i0))*BigInt(100)/r.playRate,r.pausing?r.pauseTimestamp=(0,P.A)():r.video.loop.start())),await s().all([new(s())((t=>{r.audio?r.audio.track.insertEnqueueCallback(t):t()})),new(s())((t=>{r.video?r.video.track.insertEnqueueCallback(t):t()}))]);let l=0,u=0;r.audio?r.video?(l=Math.max(r.audio.track.getBufferedStart(),r.video.track.getBufferedStart()),u=Math.min(r.audio.track.getBufferedEnd(),r.video.track.getBufferedEnd())):(l=r.audio.track.getBufferedStart(),u=r.audio.track.getBufferedEnd()):r.video&&(l=r.video.track.getBufferedStart(),u=r.video.track.getBufferedEnd());let f=(0,D.yw)(c);return f>=l&&f<=u||(f=Math.abs(f-l)>Math.abs(f-u)?u:l),r.currentTimeNTP=(0,P.A)(),r.currentTime=f,r.seeking=!1,g.Yz(`after seek end, seekTime: ${f} taskId: ${t}`,H,1601),f}return 0}async setPlayRate(t,e){const r=this.tasks.get(t);if(r){if(r.enableJitterBuffer){let t=o.f[15](r.stats+244)?o.f[15](r.stats+32)/o.f[15](r.stats+244)*1e3:o.f[15](r.stats+232)?o.f[15](r.stats+120)/o.f[15](r.stats+232)*1e3:0;t&&t<=o.f[15](r.stats+280)&&(e=1)}r.targetRate=BigInt(Math.floor(Math.floor(100*e))),r.enableJitterBuffer||(r.audio&&r.audio.loop&&r.audio.loop.resetInterval(),r.video&&r.video.loop&&r.video.loop.resetInterval())}}async restart(t){const e=this.tasks.get(t);if(e){e.audio&&this.resetResource(e.audio,e),e.video&&this.resetResource(e.video,e);const t=new((0,$.A)());t.onsourceopen=this.getSourceOpenHandler(e),e.mediaSource=t}}async setCurrentTime(t,e){const r=this.tasks.get(t);r?(r.audio&&r.audio.track.removeBuffer(e),r.video&&o.f[15](r.stats+92)>0&&(r.video.track.setMediaBufferMax(Math.max(r.video.track.getMediaBufferMax(),Math.ceil(o.f[15](r.stats+92)/1e3*1.5),10)),r.video.track.removeBuffer(e)),r.currentTime=e,r.currentTimeNTP=(0,P.A)()):g.h2("task not found",H,1674)}async checkWaiting(t){let e=-1,r=-1;const i=t.currentTime+((0,P.A)()-t.currentTimeNTP)/1e3;if(t.audio){const r=t.audio.track.getSourceBuffer();r&&2===r.buffered.length&&r.buffered.end(1)-r.buffered.start(1)>=t.maxBuffer&&r.buffered.end(0)<i&&t.currentTime<r.buffered.start(1)&&(e=r.buffered.start(1))}if(t.video){const e=t.video.track.getSourceBuffer();e&&2===e.buffered.length&&e.buffered.end(1)-e.buffered.start(1)>=t.maxBuffer&&e.buffered.end(0)<i&&t.currentTime<e.buffered.start(1)&&(r=e.buffered.start(1))}if(t.audio&&t.video){if(e>0&&r>0){const i=Math.min(e,r);t.currentTime=i,t.controlIPCPort.notify("seek",{time:i})}}else e>0?(t.currentTime=e,t.controlIPCPort.notify("seek",{time:e})):r>0&&(t.currentTime=r,t.controlIPCPort.notify("seek",{time:r}))}async getMediaSource(t){const e=this.tasks.get(t);if(e)return e.mediaSource.handle?(this.getMediaSource.transfer.push(e.mediaSource.handle),e.mediaSource.handle):e.mediaSource;g.h2("task not found",H,1739)}createTask(t,e){const r=new m.Ay(t.controlPort),i=new((0,$.A)()),s={...t,mediaSource:i,audio:null,video:null,playRate:BigInt(100),targetRate:BigInt(100),pauseTimestamp:0,seeking:!1,pausing:!1,controlIPCPort:r,currentTime:0,currentTimeNTP:0,cacheDuration:BigInt(Math.floor(500)),avpacketPool:new x.A((0,d.A)(t.avpacketList,l.A),t.avpacketListMutex),maxBuffer:t.isLive?1:4,minBuffer:t.isLive?.5:2,visibilityHidden:!1,fakePlayTimer:null};return this.tasks.set(t.taskId,s),i.onsourceopen=this.getSourceOpenHandler(s,e),r.on(m.Wo,(e=>{"visibilitychange"===e.method&&this.setVisibilityHidden(t.taskId,e.params.visibilityHidden)})),0}async setVisibilityHidden(t,e){const r=this.tasks.get(t);r&&(r.visibilityHidden=e,e?r.isLive&&r.video&&!r.audio&&(r.fakePlayTimer&&r.fakePlayTimer.destroy(),r.fakePlayTimer=new q.A((()=>{this.setCurrentTime(r.taskId,r.currentTime+((0,P.A)()-r.currentTimeNTP)/1e3)}),0,1e3),r.fakePlayTimer.start()):r.fakePlayTimer&&(r.fakePlayTimer.destroy(),r.fakePlayTimer=null,r.video.track.getBufferedTime()>(r.isLive?2:4)&&(this.setCurrentTime(r.taskId,Math.max(r.video.track.getBufferedEnd()-(r.isLive?1:4),r.video.track.getBufferedStart())),r.controlIPCPort.notify("seek",{time:r.currentTime}))))}async registerTask(t,e=BigInt(0)){return this.tasks.has(t.taskId)?p.lh:this.createTask(t,e)}async unregisterTask(t){const e=this.tasks.get(t);e&&(e.audio&&(e.audio.loop&&(await e.audio.oformatContext.destroy(),e.audio.loop.destroy()),e.audio.pullIPC&&e.audio.pullIPC.destroy(),e.audio.pullQueue.queue.length&&(e.audio.pullQueue.queue.forEach((t=>{e.avpacketPool.release(t)})),e.audio.pullQueue.queue.length=0),e.audio.codecpar&&(0,b.dn)(e.audio.codecpar)),e.video&&(e.video.loop&&(await e.video.oformatContext.destroy(),e.video.loop.destroy()),e.video.pullIPC&&e.video.pullIPC.destroy(),e.video.pullQueue.queue.length&&(e.video.pullQueue.queue.forEach((t=>{e.avpacketPool.release(t)})),e.video.pullQueue.queue.length=0),e.video.codecpar&&(0,b.dn)(e.video.codecpar)),e.controlIPCPort&&e.controlIPCPort.destroy(),this.tasks.delete(t))}}},52277:(t,e,r)=>{"use strict";r.d(e,{M:()=>f});var i,s,a=r(134),n=r(80662),o=r.n(n),c=r(61499),d=r(12085),h=r(12264),l=r(73783),u=r(30128);class f{constructor(){(0,a.A)(this,"avpacketList",void 0),(0,a.A)(this,"avframeList",void 0),(0,a.A)(this,"avpacketListMutex",void 0),(0,a.A)(this,"avframeListMutex",void 0),(0,a.A)(this,"stats",void 0)}}i=f.prototype,(s=new(o())).set("avpacketList",{0:h.A,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("avframeList",{0:h.A,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),s.set("avpacketListMutex",{0:l.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),s.set("avframeListMutex",{0:l.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),s.set("stats",{0:u.A,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),(0,d.A)(i,c.Og,!0),(0,d.A)(i,c.dc,8),(0,d.A)(i,c.g7,392),(0,d.A)(i,c.JY,s)},57038:(t,e,r)=>{"use strict";r.d(e,{A:()=>m});var i=r(134),s=r(77658),a=r(21194),n=r(77334),o=r(8284),c=r(65749),d=r(49963),h=r(78040),l=r(47924),u=r(95335);const f='.ASS-box{font-family:Arial;overflow:hidden;pointer-events:none;position:absolute}.ASS-dialogue{font-size:0;width:max-content;position:absolute;z-index:0;transform:translate(calc(var(--ass-align-h)*-1),calc(var(--ass-align-v)*-1));span{display:inline-block}[data-text]{display:inline-block;color:var(--ass-fill-color);font-size:calc(var(--ass-scale)*var(--ass-real-fs)*1px);line-height:calc(var(--ass-scale)*var(--ass-tag-fs)*1px);letter-spacing:calc(var(--ass-scale)*var(--ass-tag-fsp)*1px);filter:blur(calc(var(--ass-scale-stroke)*var(--ass-tag-blur)*(1-round(up,sin(var(--ass-tag-xbord))*sin(var(--ass-tag-xbord))))*(1-round(up,sin(var(--ass-tag-ybord))*sin(var(--ass-tag-ybord))))*1px))}[data-is="br"]+[data-is="br"]{height:calc(var(--ass-scale)*var(--ass-tag-fs)*1px/2)}}.ASS-dialogue[data-wrap-style="0"],.ASS-dialogue[data-wrap-style="3"]{text-wrap:balance;white-space:pre-wrap}.ASS-dialogue[data-wrap-style="1"]{word-break:break-word;white-space:pre-wrap}.ASS-dialogue[data-wrap-style="2"]{word-break:normal;white-space:pre}.ASS-dialogue[data-border-style="1"]{position:relative;&::before,&::after{content:attr(data-text);position:absolute;top:0;left:0;z-index:-1;filter:blur(calc(var(--ass-scale-stroke)*var(--ass-tag-blur)*1px))}&::before{color:var(--ass-shadow-color);-webkit-text-stroke:calc(var(--ass-scale-stroke)*var(--ass-border-width)*1px) var(--ass-shadow-color);transform:translate(calc(var(--ass-scale-stroke)*var(--ass-tag-xshad)*1px),calc(var(--ass-scale-stroke)*var(--ass-tag-yshad)*1px))}&::after{color:var(--ass-border-color);-webkit-text-stroke:calc(var(--ass-scale-stroke)*var(--ass-border-width)*1px) var(--ass-border-color)}&[data-stroke="svg"]{color:#000;&::before,&::after{opacity:0}}}@container style(--ass-tag-xbord:0) and style(--ass-tag-ybord:0){.ASS-dialogue[data-border-style="1"]::after{display:none}}@container style(--ass-tag-xshad:0) and style(--ass-tag-yshad:0){.ASS-dialogue[data-border-style="1"]::before{display:none}}.ASS-dialogue[data-border-style="3"]{padding:calc(var(--ass-scale-stroke)*var(--ass-tag-xbord)*1px)calc(var(--ass-scale-stroke)*var(--ass-tag-ybord)*1px);position:relative;filter:blur(calc(var(--ass-scale-stroke)*var(--ass-tag-blur)*1px));&::before,&::after{content:"";width:100%;height:100%;position:absolute;z-index:-1}&::before{background-color:var(--ass-shadow-color);left:calc(var(--ass-scale-stroke)*var(--ass-tag-xshad)*1px);top:calc(var(--ass-scale-stroke)*var(--ass-tag-yshad)*1px)}&::after{background-color:var(--ass-border-color);left:0;top:0}}@container style(--ass-tag-xbord:0) and style(--ass-tag-ybord:0){.ASS-dialogue [data-border-style="3"]::after{background-color:transparent}}@container style(--ass-tag-xshad:0) and style(--ass-tag-yshad:0){.ASS-dialogue [data-border-style="3"]::before{background-color:transparent}}.ASS-dialogue[data-rotate]{transform:perspective(312.5px) rotateY(calc(var(--ass-tag-fry) * 1deg)) rotateX(calc(var(--ass-tag-frx) * 1deg)) rotateZ(calc(var(--ass-tag-frz) * -1deg));&[data-text]{transform-style:preserve-3d;word-break:normal;white-space:nowrap}}.ASS-dialogue[data-scale],.ASS-dialogue[data-skew]{display:inline-block;transform:scale(var(--ass-tag-fscx), var(--ass-tag-fscy)) skew(calc(var(--ass-tag-fax)*1rad),calc(var(--ass-tag-fay) * 1rad));transform-origin:var(--ass-align-h) var(--ass-align-v)}.ASS-fix-font-size{font-family:Arial;line-height:normal;width:0;height:0;position:absolute;visibility:hidden;overflow:hidden;span{position:absolute}}.ASS-clip-area{width:100%;height:100%;position:absolute;top:0;left:0}.ASS-effect-area{position:absolute;display:flex;width:100%;height:fit-content;overflow:hidden;mask-composite:intersect;&[data-effect="banner"]{flex-direction:column;height:100%}.ASS-dialogue{position:static;transform:none}}',p={Name:"Default",Fontname:"Arial",Fontsize:"16",PrimaryColour:"&Hffffff",SecondaryColour:"&Hffffff",OutlineColour:"&H0",BackColour:"&H0",Bold:"0",Italic:"0",Underline:"0",StrikeOut:"0",ScaleX:"100",ScaleY:"100",Spacing:"0",Angle:"0",BorderStyle:"1",Outline:"1",Shadow:"0",Alignment:"2",MarginL:"10",MarginR:"10",MarginV:"10",Encoding:"0"};class m{constructor(t,e={container:t.parentNode}){if((0,i.A)(this,"store",void 0),(0,i.A)(this,"resampling_","video_height"),(0,i.A)(this,"resize_",void 0),(0,i.A)(this,"options",void 0),this.options=u.X$({},e),this.store={video:t,box:document.createElement("div"),svg:(0,n.An)("svg"),defs:(0,n.An)("defs"),observer:null,scale:1,width:0,height:0,scriptRes:{width:e.videoWidth||t.clientWidth,height:e.videoHeight||t.clientHeight},layoutRes:{width:e.videoWidth||t.clientWidth,height:e.videoHeight||t.clientHeight},resampledRes:{width:0,height:0},sbas:!0,styles:null,space:[],actives:[],delay:0,index:0,dialogues:[]},null==e.videoWidth&&(t.videoWidth=e.videoWidth),null==e.videoHeight&&(t.videoHeight=e.videoHeight),!e.container)throw new Error("Missing container.");this.resize_=(0,a.By)(this,this.store),this.updateHeader(e.header),s.Y&&e.container.append(s.Y);const{svg:r,defs:o,scriptRes:c,box:d}=this.store;r.setAttributeNS(null,"viewBox",`0 0 ${c.width} ${c.height}`),r.append(o),e.container.append(r),d.className="ASS-box",e.container.append(d),function(t){const e=t.getRootNode()||document;let r=e instanceof Document;!r&&"object"==typeof documentPictureInPicture&&documentPictureInPicture.window&&(r=e===documentPictureInPicture.window.document);const i=r?e.head:e;let s=i.querySelector("#ASS-global-style");s||(s=document.createElement("style"),s.type="text/css",s.id="ASS-global-style",s.append(document.createTextNode(f)),i.append(s)),document.head.querySelector("#ASS-global-style")||(s=document.createElement("style"),s.type="text/css",s.id="ASS-global-style",s.append(document.createTextNode(f)),document.head.append(s))}(e.container),this.resampling_=e.resampling||"video_height";const h=new ResizeObserver(this.resize.bind(this));return h.observe(t),this.store.observer=h,this}framing(t){const e=(0,l.U)(t,this.store);e.animations&&e.animations.forEach((t=>{t.currentTime=Number(this.store.video.currentTime)-1e3*e.start})),(0,n.MA)(e,"play"),e.__dialogue=t,this.store.actives.push(e)}updateHeader(t){if(t){const{info:e,width:r,height:i,styles:s}=(0,c.wE)(t,{defaultStyle:p});this.store.sbas=/yes/i.test(e.ScaledBorderAndShadow),this.store.layoutRes={width:+e.LayoutResX||this.options.videoWidth||this.store.video.clientWidth,height:+e.LayoutResY||this.options.videoHeight||this.store.video.clientHeight},this.store.scriptRes={width:r||this.store.layoutRes.width,height:i||this.store.layoutRes.height},this.store.styles=s}else this.store.styles=(0,h.W)({info:{WrapStyle:""},style:[],defaultStyle:p}),this.store.scriptRes={width:384,height:288};this.resize_(),this.options.header=t}updateVideoResolution(t,e){if(this.options.header){const{info:r,width:i,height:s}=(0,c.wE)(this.options.header,{defaultStyle:p});this.store.layoutRes={width:+r.LayoutResX||t||this.store.video.clientWidth,height:+r.LayoutResY||e||this.store.video.clientHeight},this.store.scriptRes={width:i||this.store.layoutRes.width,height:s||this.store.layoutRes.height}}else this.store.layoutRes={width:t,height:e}}render(t){if(1===t.type){var e;t.Start=Number(t.Start)/1e3,t.End=Number(t.End)/1e3;const r=(0,d.b)({styles:this.store.styles,dialogues:[t]})[0];u.X$(r,{effect:["banner","scroll up","scroll down"].includes(null===(e=r.effect)||void 0===e?void 0:e.name)?r.effect:null,d:`ASS-${(0,o.A)()}`,align:{h:(r.alignment+2)%3,v:Math.trunc((r.alignment-1)/3)}}),this.framing(r)}}clear(t){const e=Number(t)/1e3;for(let t=this.store.actives.length-1;t>=0;t-=1){const r=this.store.actives[t],{end:i}=r;i<e&&(r.$div.remove(),this.store.actives.splice(t,1))}}clearAll(){for(let t=this.store.actives.length-1;t>=0;t-=1)this.store.actives[t].$div.remove();this.store.actives.length=0,this.store.space.length=0}resize(){const t=this.store.actives.slice();this.resize_();for(let e=0;e<t.length;e++)this.framing(t[e].__dialogue)}destroy(){const{video:t,box:e,svg:r,observer:i}=this.store;return(0,a.IU)(this.store),s.Y&&s.Y.remove(),r.remove(),e.remove(),i.unobserve(t),this.store.styles={},this}show(){return this.store.box.style.visibility="visible",this}hide(){return this.store.box.style.visibility="hidden",this}get resampling(){return this.resampling_}set resampling(t){t!==this.resampling_&&/^(video|script)_(width|height)$/.test(t)&&(this.resampling_=t,this.resize())}}},40031:(t,e,r)=>{"use strict";r.d(e,{A:()=>T});var i=r(134),s=r(80662),a=r.n(s),n=r(12264),o=r(29170),c=r(63939),d=(r(9599),r(50932)),h=r(53616),l=r(84149),u=r(39148),f=r(4624),p=r(57038),m=r(50011),g=r(14686),v=r(51785),A=r(84290),y=r(44328),b=r(77231),w=r(95335),k=r(71517);const x="src\\avplayer\\subtitle\\SubtitleRender.ts",I=[{reg:/<i>/g,value:"{\\i1}"},{reg:/<\/i>/g,value:"{\\i0}"},{reg:/<b>/g,value:"{\\b1}"},{reg:/<\/b>/g,value:"{\\b0}"},{reg:/<u>/g,value:"{\\u1}"},{reg:/<\/u>/g,value:"{\\u0}"},{reg:/{/g,value:"\\{"},{reg:/}/g,value:"\\}"},{reg:/&gt;/g,value:">"},{reg:/&lt;/g,value:"<"},{reg:/&lrm;/g,value:""},{reg:/&rlm;/g,value:""},{reg:/&amp;/g,value:"&"},{reg:/&nbsp;/g,value:"\\h"},{reg:/(<br\s*\/?>)|\n>/g,value:"\\N"}];class T{constructor(t){(0,i.A)(this,"decoder",void 0),(0,i.A)(this,"loop",void 0),(0,i.A)(this,"demuxer2SubtitleRenderChannels",void 0),(0,i.A)(this,"leftPorts",void 0),(0,i.A)(this,"currentPort",void 0),(0,i.A)(this,"render",void 0),(0,i.A)(this,"queue",void 0),(0,i.A)(this,"ended",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"pulling",void 0),(0,i.A)(this,"formats",void 0),(0,i.A)(this,"avpacketPool",void 0),(0,i.A)(this,"delay",void 0),(0,i.A)(this,"enable",void 0),this.options=w.X$({},t),this.ended=!1,this.pulling=!1,this.queue=[],this.delay=BigInt(0),this.demuxer2SubtitleRenderChannels=new(a()),this.leftPorts=new(a()),t.avpacketList&&(this.avpacketPool=new A.A((0,o.A)(t.avpacketList,n.A),t.avpacketListMutex)),this.createDecoder(),this.render=new p.A(this.options.dom,{header:this.getAssHeader(this.options.codecpar),container:this.options.container,videoWidth:this.options.videoWidth,videoHeight:this.options.videoHeight}),this.loop=new u.A((()=>{!this.queue.length&&this.ended&&this.loop.stop(),this.queue.length<6&&!this.ended&&this.pull();const t=this.options.getCurrentTime()-this.delay;for(this.render.clear(t);this.queue.length;){const e=this.queue[0];if(e.Start>t)break;e.End>t&&this.render.render(e),this.queue.shift()}}),0,50,!1)}getAssHeader(t){let e="";if(94230===c.f[15](t+4)&&c.f[15](t+16)){e=m.decode((0,g.s3)(c.f[20](t+12),c.f[15](t+16)));const r=e.split(/\r?\n/);let i=!1;for(let t=0;t<r.length;t++){const e=r[t].trim();"[Events]"===e&&(i=!0),/^Format:/.test(e)&&i&&(this.formats=v.Bp(e.trim()))}}return e}createDecoder(){this.decoder&&this.decoder.close(),this.decoder=new h.A({onReceiveSubtitle:t=>{for(let e=0;e<t.rects.length;e++){const r=t.rects[e];if(3===r.type){const e=v.wj(this.formats,r.text);null==e.Start&&(e.Start=t.pts),null==e.End&&(e.End=t.pts+t.duration),this.queue.push(e)}else 2===r.type?this.queue.push(this.webvtt2AssEvent(r.text,t.pts,t.pts+t.duration)):this.queue.push(this.text2AssEvent(r.text,t.pts,t.pts+t.duration))}}}),this.decoder.open(this.options.codecpar)}text2AssEvent(t,e,r){return{type:1,ReadOrder:0,Layer:0,Start:e,End:r,Style:"Default",Name:"",MarginL:0,MarginR:0,MarginV:0,Text:{raw:t,combined:t,parsed:[{tags:[],text:t,drawing:[]}]}}}webvtt2AssEvent(t,e,r){for(let e=0;e<I.length;e++)t=t.replace(I[e].reg,I[e].value);return this.text2AssEvent(t,e,r)}async pull(){if(this.pulling&&!this.ended)return;this.pulling=!0;const t=this.currentPort,e=await this.leftPorts.get(this.currentPort).request("pull");var r;if(-1048576===e)f.Yz("SubtitleRender end",x,290),null===(r=this.decoder)||void 0===r||r.flush(),this.ended=!0;else if(e<0)f.Yz(`SubtitleRender pull avpacket error, ret: ${e}`,x,295),this.ended=!0;else if(this.loop&&t===this.currentPort){d.M[17](e+8,(0,y.Mr)(c.f[17](e+8),e+72,b.i0)),d.M[17](e+48,(0,y.Mr)(c.f[17](e+48),e+72,b.i0));const t=this.decoder.decode(e);this.avpacketPool?this.avpacketPool.release(e):(0,k.Qe)(e),t<0&&(f.Yz(`SubtitleRender decode avpacket error, ret: ${e}`,x,309),this.ended=!0)}else this.avpacketPool?this.avpacketPool.release(e):(0,k.Qe)(e);this.pulling=!1}getDemuxerPort(t){if(this.demuxer2SubtitleRenderChannels.has(t))return this.demuxer2SubtitleRenderChannels.get(t).port1;const e=new MessageChannel,r=new l.Ay(e.port2);return this.demuxer2SubtitleRenderChannels.set(t,e),this.leftPorts.set(t,r),e.port1}start(){this.loop.isStarted()||this.loop.start(),this.ended=!1}stop(){this.loop.stop(),this.render.clearAll()}pause(){this.loop.stop()}reset(){this.queue.length=0,this.render.clearAll()}reopenDecoder(t){this.options.codecpar=t,this.createDecoder(),this.render.updateHeader(this.getAssHeader(t))}updateVideoResolution(t,e){t===this.options.videoWidth&&e===this.options.videoHeight||(this.render.updateVideoResolution(t,e),this.options.videoWidth=t,this.options.videoHeight=e)}setDemuxTask(t){this.currentPort!==t&&(this.pulling=!1),this.currentPort=t}destroy(){this.loop.destroy(),this.loop=null,this.leftPorts.clear(),this.demuxer2SubtitleRenderChannels.clear(),this.queue.length=0,this.render.destroy(),this.render=null,this.decoder.close(),this.decoder=null}setDelay(t){this.delay=t}getDelay(){return this.delay}}},27089:(t,e,r)=>{"use strict";r.d(e,{A:()=>w});var i=r(134),s=r(80662),a=r.n(s),n=r(61499),o=r(52277),c=r(74503),d=r(94300),h=r(67672),l=r(4624),u=r(18667),f=r(59377),p=r(56024),m=r(71517),g=r(73783),v=r(84149),A=r(54058),y=r(95335);const b="src\\avplayer\\worker\\AudioPipeline.ts";class w{constructor(){(0,i.A)(this,"decoder",void 0),(0,i.A)(this,"render",void 0),(0,i.A)(this,"globalDataMap",void 0),(0,i.A)(this,"controlPort",void 0),(0,i.A)(this,"timer",void 0),this.decoder=new u.A,this.render=new f.A,this.globalDataMap=new(a())}createGlobalData(t){const e=(0,c.A)(o.M);return g.Ts(e[n.o9]+24),g.Ts(e[n.o9]+28),this.globalDataMap.set(t,e),e}releaseGlobalData(t){t.avframeList.clear((t=>{(0,p.to)(t)}),20),t.avpacketList.clear((t=>{(0,m.Up)(t)}),20),g.zr(t[n.o9]+24),g.zr(t[n.o9]+28),(0,d.A)(t)}async init(t){this.controlPort=new v.Ay(t);let e=0;this.timer=new A.A((()=>{e++;const t=[];this.globalDataMap.forEach(((r,i)=>{const s=r.stats;t.push({taskId:i,stats:{audioFrameDecodeCount:s.audioFrameDecodeCount,audioFrameDecodeIntervalMax:s.audioFrameDecodeIntervalMax,audioDecodeErrorPacketCount:s.audioDecodeErrorPacketCount,audioFrameRenderCount:s.audioFrameRenderCount,audioFrameRenderIntervalMax:s.audioFrameRenderIntervalMax,sampleRate:s.sampleRate,channels:s.channels,audioFrameSize:s.audioFrameSize,audioCurrentTime:s.audioCurrentTime}}),2===e&&(s.audioFrameDecodeIntervalMax=0,s.audioFrameRenderIntervalMax=0)})),this.controlPort.notify("stats",{data:t}),2===e&&(e=0)}),0,500),this.controlPort.on(v.Wo,(t=>{if("stats"===t.method){const e=t.params.data;for(let t=0;t<e.length;t++){const r=this.globalDataMap.get(e[t].taskId).stats;r&&(y.__(e[t].stats,((t,e)=>{r[e]=t})),r.jitterBuffer.min=e[t].jitterBuffer.min,r.jitterBuffer.max=e[t].jitterBuffer.max)}}})),this.timer.start()}async invoke(t,e,r){const i=this;function s(t,e,r){if("unregisterTask"===t){const t=i.globalDataMap.get(e[0]);t&&(i.releaseGlobalData(t),i.globalDataMap.delete(e[0]))}else if("clear"===t)i.globalDataMap.forEach((t=>{i.releaseGlobalData(t)})),i.globalDataMap.clear();else if("syncSeekTime"===t){const t=i.globalDataMap.get(e[0]);if(t)return t.stats.audioCurrentTime}return r}if("decoder"===t){if("registerTask"===e){const t=this.globalDataMap.get(r[0].taskId)||this.createGlobalData(r[0].taskId);r[0].stats=t[n.o9]+32,r[0].avpacketList=t[n.o9],r[0].avpacketListMutex=t[n.o9]+24,r[0].avframeList=t[n.o9]+12,r[0].avframeListMutex=t[n.o9]+28}if(h.Pc(this.decoder[e]))return this.decoder[e](...r).then((t=>s(e,r,t)));l.h2(`method ${e} not found`,b,179)}else{if("registerTask"===e){const t=this.globalDataMap.get(r[0].taskId)||this.createGlobalData(r[0].taskId);r[0].stats=t[n.o9]+32,r[0].avframeList=t[n.o9]+12,r[0].avframeListMutex=t[n.o9]+28}if(h.Pc(this.render[e]))return this.render[e](...r).then((t=>s(e,r,t)));l.h2(`method ${e} not found`,b,197)}}async setLogLevel(t){l.V$(t)}}},40097:(t,e,r)=>{"use strict";r.d(e,{A:()=>u});var i=r(134),s=r(80662),a=r.n(s),n=r(30128),o=r(29170),c=r(88506),d=r(27089),h=r(84149),l=r(95335);class u{constructor(){(0,i.A)(this,"thread",void 0),(0,i.A)(this,"controlMessageChannel",void 0),(0,i.A)(this,"controlPort",void 0),(0,i.A)(this,"statsMap",void 0),this.statsMap=new(a())}async run(){this.thread=await(0,c.pt)(d.A,{name:"AudioPipeline",dispatchToWorker:!0},27089).run(),this.controlMessageChannel=new MessageChannel,this.controlPort=new h.Ay(this.controlMessageChannel.port1),this.controlPort.on(h.Wo,(t=>{if("stats"===t.method){const e=t.params.data,r=[];for(let t=0;t<e.length;t++){const i=this.statsMap.get(e[t].taskId);i&&(l.__(e[t].stats,((t,e)=>{i[e]=t})),r.push({taskId:e[t].taskId,stats:{audioPacketQueueLength:i.audioPacketQueueLength,audioEncodeFramerate:i.audioEncodeFramerate,videoPacketQueueLength:i.videoPacketQueueLength},jitterBuffer:{min:i.jitterBuffer.min,max:i.jitterBuffer.max}}))}this.controlPort.notify("stats",{data:{stats:r}})}})),await this.thread.init.transfer(this.controlMessageChannel.port2).invoke(this.controlMessageChannel.port2)}async destroy(){await(0,c.nx)(this.thread),this.thread=null}setLogLevel(t){this.thread.setLogLevel(t)}transformResult(t,e,r){if("unregisterTask"===t)this.statsMap.delete(e[0]);else if("clear"===t)this.statsMap.clear();else if("registerTask"===t)this.statsMap.set(e[0].taskId,(0,o.A)(e[0].stats,n.A));else if("syncSeekTime"===t){const t=this.statsMap.get(e[0]);if(t)return void(t.audioCurrentTime=r)}return r}get AudioDecodePipeline(){const t=this;return new Proxy({},{get(e,r,i){if(e[r])return e[r];const s=async function(...e){return t.thread.invoke("decoder",r,e).then((i=>t.transformResult(r,e,i)))};return s.transfer=function(...e){return{invoke:async function(...i){return t.thread.invoke.transfer(...e).invoke("decoder",r,i).then((e=>t.transformResult(r,i,e)))}}},e[r]=s,e[r]}})}get AudioRenderPipeline(){const t=this;return new Proxy({},{get(e,r,i){if(e[r])return e[r];const s=async function(...e){return t.thread.invoke("render",r,e).then((i=>t.transformResult(r,e,i)))};return s.transfer=function(...e){return{invoke:async function(...i){return t.thread.invoke.transfer(...e).invoke("render",r,i).then((e=>t.transformResult(r,i,e)))}}},e[r]=s,e[r]}})}}},59016:(t,e,r)=>{"use strict";r.d(e,{A:()=>w});var i=r(134),s=r(80662),a=r.n(s),n=r(61499),o=r(52277),c=r(74503),d=r(94300),h=r(87243),l=r(72480),u=r(67672),f=r(4624),p=r(71762),m=r(56024),g=r(71517),v=r(73783),A=r(84149),y=r(54058);const b="src\\avplayer\\worker\\IODemuxPipeline.ts";class w{constructor(){(0,i.A)(this,"ioThread",void 0),(0,i.A)(this,"demuxPipeline",void 0),(0,i.A)(this,"globalDataMap",void 0),(0,i.A)(this,"controlPort",void 0),(0,i.A)(this,"timer",void 0),this.ioThread=new h.A,this.demuxPipeline=new l.A,this.globalDataMap=new(a())}createGlobalData(t){const e=(0,c.A)(o.M);return v.Ts(e[n.o9]+24),v.Ts(e[n.o9]+28),this.globalDataMap.set(t,e),e}releaseGlobalData(t){t.avframeList.clear((t=>{(0,m.to)(t)}),20),t.avpacketList.clear((t=>{(0,g.Up)(t)}),20),v.zr(t[n.o9]+24),v.zr(t[n.o9]+28),(0,d.A)(t)}async init(t){this.controlPort=new A.Ay(t),this.timer=new y.A((()=>{const t=[];this.globalDataMap.forEach(((e,r)=>{const i=e.stats;t.push({taskId:r,stats:{bufferReceiveBytes:i.bufferReceiveBytes,audioPacketQueueLength:i.audioPacketQueueLength,videoPacketQueueLength:i.videoPacketQueueLength,audioPacketCount:i.audioPacketCount,audioPacketBytes:i.audioPacketBytes,audioEncodeFramerate:i.audioEncodeFramerate,videoPacketCount:i.videoPacketCount,videoPacketBytes:i.videoPacketBytes,keyFrameCount:i.keyFrameCount,gop:i.gop,keyFrameInterval:i.keyFrameInterval,videoEncodeFramerate:i.videoEncodeFramerate}})})),this.controlPort.notify("stats",{data:t})}),0,500),this.timer.start()}async invoke(t,e,r){const i=this;function s(t,e,r){if("unregisterTask"===t){const t=i.globalDataMap.get(e[0]);t&&(i.releaseGlobalData(t),i.globalDataMap.delete(e[0]))}else"clear"===t?(i.globalDataMap.forEach((t=>{i.releaseGlobalData(t)})),i.globalDataMap.clear()):"analyzeStreams"!==t||u.ai(r)||r.streams.forEach((t=>{t.codecpar=(0,p.Wu)(t.codecpar)}))}if("io"===t){if("registerTask"===e){const t=this.globalDataMap.get(r[0].taskId)||this.createGlobalData(r[0].taskId);r[0].stats=t[n.o9]+32}if(u.Pc(this.ioThread[e]))return this.ioThread[e](...r).then((t=>(s(e,r,t),t)));f.h2(`method ${e} not found`,b,150)}else{if("registerTask"===e){const t=this.globalDataMap.get(r[0].taskId)||this.createGlobalData(r[0].taskId);r[0].stats=t[n.o9]+32,r[0].avpacketList=t[n.o9],r[0].avpacketListMutex=t[n.o9]+24}if(u.Pc(this.demuxPipeline[e]))return this.demuxPipeline[e](...r).then((t=>(s(e,r,t),t)));f.h2(`method ${e} not found`,b,168)}}async setLogLevel(t){f.V$(t)}}},29998:(t,e,r)=>{"use strict";r.d(e,{A:()=>g});var i=r(134),s=r(80662),a=r.n(s),n=r(30128),o=r(29170),c=r(88506),d=r(59016),h=r(71762),l=r(67672),u=r(72703),f=r(71766),p=r(84149),m=r(95335);class g{constructor(){(0,i.A)(this,"thread",void 0),(0,i.A)(this,"codecparMap",void 0),(0,i.A)(this,"controlMessageChannel",void 0),(0,i.A)(this,"controlPort",void 0),(0,i.A)(this,"statsMap",void 0),this.codecparMap=new(a()),this.statsMap=new(a())}async run(){this.thread=await(0,c.pt)(d.A,{name:"IODemuxPipeline",dispatchToWorker:!0},59016).run(),this.controlMessageChannel=new MessageChannel,this.controlPort=new p.Ay(this.controlMessageChannel.port1),this.controlPort.on(p.Wo,(t=>{if("stats"===t.method){const e=t.params.data;for(let t=0;t<e.length;t++){const r=this.statsMap.get(e[t].taskId);r&&m.__(e[t].stats,((t,e)=>{r[e]=t}))}}})),await this.thread.init.transfer(this.controlMessageChannel.port2).invoke(this.controlMessageChannel.port2)}setLogLevel(t){this.thread.setLogLevel(t)}async destroy(){await(0,c.nx)(this.thread),this.thread=null}get IOPipeline(){const t=this;return new Proxy({},{get(e,r,i){if(e[r])return e[r];const s=async function(...e){return t.thread.invoke("io",r,e)};return s.transfer=function(...e){return{invoke:async function(...i){return t.thread.invoke.transfer(...e).invoke("io",r,i)}}},e[r]=s,e[r]}})}get DemuxPipeline(){const t=this;function e(e,r,i){if("analyzeStreams"!==e||l.ai(i))if("unregisterTask"===e){const e=t.codecparMap.get(r[0]);e&&(e.forEach((t=>{(0,f.dn)(t)})),t.codecparMap.delete(r[0])),t.statsMap.delete(r[0])}else"clear"===e?(t.codecparMap.forEach((t=>{t.forEach((t=>{(0,f.dn)(t)}))})),t.codecparMap.clear(),t.statsMap.clear()):"registerTask"===e&&t.statsMap.set(r[0].taskId,(0,o.A)(r[0].stats,n.A));else{const e=[];i.streams.forEach((i=>{(0,u.A)(i.codecpar)||(i.codecpar=(0,h.T8)(i.codecpar),e.push(i.codecpar)),t.codecparMap.set(r[0],e)}))}}return new Proxy({},{get(r,i,s){if(r[i])return r[i];const a=async function(...r){return t.thread.invoke("demux",i,r).then((t=>(e(i,r,t),t)))};return a.transfer=function(...r){return{invoke:async function(...s){return t.thread.invoke.transfer(...r).invoke("demux",i,s).then((t=>(e(i,s,t),t)))}}},r[i]=a,r[i]}})}}},75392:(t,e,r)=>{"use strict";r.d(e,{A:()=>y});var i=r(134),s=r(80662),a=r.n(s),n=r(61499),o=r(52277),c=r(74503),d=r(94300),h=r(67672),l=r(4624),u=r(56024),f=r(71517),p=r(73783),m=r(84149),g=r(54058),v=r(95335),A=r(25115);class y{constructor(){(0,i.A)(this,"mse",void 0),(0,i.A)(this,"globalDataMap",void 0),(0,i.A)(this,"controlPort",void 0),(0,i.A)(this,"timer",void 0),this.mse=new A.A,this.globalDataMap=new(a())}createGlobalData(t){const e=(0,c.A)(o.M);return p.Ts(e[n.o9]+24),p.Ts(e[n.o9]+28),this.globalDataMap.set(t,e),e}releaseGlobalData(t){t.avframeList.clear((t=>{(0,u.to)(t)}),20),t.avpacketList.clear((t=>{(0,f.Up)(t)}),20),p.zr(t[n.o9]+24),p.zr(t[n.o9]+28),(0,d.A)(t)}async init(t){this.controlPort=new m.Ay(t),this.timer=new g.A((()=>{const t=[];this.globalDataMap.forEach(((e,r)=>{const i=e.stats;t.push({taskId:r,stats:{audioFrameDecodeCount:i.audioFrameDecodeCount,audioFrameRenderCount:i.audioFrameRenderCount,sampleRate:i.sampleRate,channels:i.channels,videoFrameDecodeCount:i.videoFrameDecodeCount,videoFrameRenderCount:i.videoFrameRenderCount,width:i.width,height:i.height}})})),this.controlPort.notify("stats",{data:t})}),0,500),this.controlPort.on(m.Wo,(t=>{if("stats"===t.method){const e=t.params.data;for(let t=0;t<e.length;t++){const r=this.globalDataMap.get(e[t].taskId).stats;r&&(v.__(e[t].stats,((t,e)=>{r[e]=t})),r.jitterBuffer.min=e[t].jitterBuffer.min,r.jitterBuffer.max=e[t].jitterBuffer.max)}}})),this.timer.start()}async invoke(t,e){const r=this;if("registerTask"===t){const t=this.globalDataMap.get(e[0].taskId)||this.createGlobalData(e[0].taskId);e[0].stats=t[n.o9]+32,e[0].avpacketList=t[n.o9],e[0].avpacketListMutex=t[n.o9]+24}if(h.Pc(this.mse[t]))return this.mse[t].transfer||(this.mse[t].transfer=[]),this.mse[t](...e).then((i=>(this.mse[t].transfer.length&&(this.invoke.transfer=this.mse[t].transfer),i=function(t,e,i){if("unregisterTask"===t){const t=r.globalDataMap.get(e[0]);t&&(r.releaseGlobalData(t),r.globalDataMap.delete(e[0]))}else"clear"===t&&(r.globalDataMap.forEach((t=>{r.releaseGlobalData(t)})),r.globalDataMap.clear());return i}(t,e,i),i)));l.h2(`method ${t} not found`,"src\\avplayer\\worker\\MSEPipeline.ts",162)}async setLogLevel(t){l.V$(t)}}},21862:(t,e,r)=>{"use strict";r.d(e,{A:()=>u});var i=r(134),s=r(80662),a=r.n(s),n=r(30128),o=r(29170),c=r(88506),d=r(84149),h=r(95335),l=r(75392);class u{constructor(){(0,i.A)(this,"thread",void 0),(0,i.A)(this,"controlMessageChannel",void 0),(0,i.A)(this,"controlPort",void 0),(0,i.A)(this,"statsMap",void 0),this.statsMap=new(a())}async run(){this.thread=await(0,c.pt)(l.A,{name:"MSEPipeline",dispatchToWorker:!0},75392).run(),this.controlMessageChannel=new MessageChannel,this.controlPort=new d.Ay(this.controlMessageChannel.port1),this.controlPort.on(d.Wo,(t=>{if("stats"===t.method){const e=t.params.data,r=[];for(let t=0;t<e.length;t++){const i=this.statsMap.get(e[t].taskId);i&&(h.__(e[t].stats,((t,e)=>{i[e]=t})),r.push({taskId:e[t].taskId,stats:{videoEncodeFramerate:i.videoEncodeFramerate,videoPacketQueueLength:i.videoPacketQueueLength,audioPacketQueueLength:i.audioPacketQueueLength,audioEncodeFramerate:i.audioEncodeFramerate},jitterBuffer:{min:i.jitterBuffer.min,max:i.jitterBuffer.max}}))}this.controlPort.notify("stats",{data:{stats:r}})}})),await this.thread.init.transfer(this.controlMessageChannel.port2).invoke(this.controlMessageChannel.port2)}setLogLevel(t){this.thread.setLogLevel(t)}async destroy(){await(0,c.nx)(this.thread),this.thread=null}transformResult(t,e,r){return"unregisterTask"===t?this.statsMap.delete(e[0]):"clear"===t?this.statsMap.clear():"registerTask"===t&&this.statsMap.set(e[0].taskId,(0,o.A)(e[0].stats,n.A)),r}get MSEPipeline(){const t=this;return new Proxy({},{get(e,r,i){if(e[r])return e[r];const s=async function(...e){return t.thread.invoke(r,e).then((i=>t.transformResult(r,e,i)))};return s.transfer=function(...e){return{invoke:async function(...i){return t.thread.invoke.transfer(...e).invoke(r,i).then((e=>t.transformResult(r,i,e)))}}},e[r]=s,e[r]}})}}},71272:(t,e,r)=>{"use strict";r.d(e,{A:()=>w});var i=r(134),s=r(80662),a=r.n(s),n=r(61499),o=r(52277),c=r(74503),d=r(94300),h=r(67672),l=r(4624),u=r(31138),f=r(33968),p=r(56024),m=r(71517),g=r(73783),v=r(84149),A=r(54058),y=r(95335);const b="src\\avplayer\\worker\\VideoPipeline.ts";class w{constructor(){(0,i.A)(this,"decoder",void 0),(0,i.A)(this,"render",void 0),(0,i.A)(this,"globalDataMap",void 0),(0,i.A)(this,"controlPort",void 0),(0,i.A)(this,"timer",void 0),this.decoder=new u.A,this.render=new f.A,this.globalDataMap=new(a())}createGlobalData(t){const e=(0,c.A)(o.M);return g.Ts(e[n.o9]+24),g.Ts(e[n.o9]+28),this.globalDataMap.set(t,e),e}releaseGlobalData(t){t.avframeList.clear((t=>{(0,p.to)(t)}),20),t.avpacketList.clear((t=>{(0,m.Up)(t)}),20),g.zr(t[n.o9]+24),g.zr(t[n.o9]+28),(0,d.A)(t)}async init(t){this.controlPort=new v.Ay(t);let e=0;this.timer=new A.A((()=>{e++;const t=[];this.globalDataMap.forEach(((r,i)=>{const s=r.stats;t.push({taskId:i,stats:{videoFrameDecodeCount:s.videoFrameDecodeCount,videoFrameDecodeIntervalMax:s.videoFrameDecodeIntervalMax,videoDecodeErrorPacketCount:s.videoDecodeErrorPacketCount,videoCurrentTime:s.videoCurrentTime,videoFrameRenderCount:s.videoFrameRenderCount,videoFrameRenderIntervalMax:s.videoFrameRenderIntervalMax,videoFrameDropCount:s.videoFrameDropCount,width:s.width,height:s.height}}),2===e&&(s.videoFrameDecodeIntervalMax=0,s.videoFrameRenderIntervalMax=0)})),this.controlPort.notify("stats",{data:t}),2===e&&(e=0)}),0,500),this.controlPort.on(v.Wo,(t=>{if("stats"===t.method){const e=t.params.data;for(let t=0;t<e.length;t++){const r=this.globalDataMap.get(e[t].taskId).stats;r&&(y.__(e[t].stats,((t,e)=>{r[e]=t})),r.jitterBuffer.min=e[t].jitterBuffer.min,r.jitterBuffer.max=e[t].jitterBuffer.max)}}})),this.timer.start()}async invoke(t,e,r){const i=this;function s(t,e,r){if("unregisterTask"===t){const t=i.globalDataMap.get(e[0]);t&&(i.releaseGlobalData(t),i.globalDataMap.delete(e[0]))}else if("clear"===t)i.globalDataMap.forEach((t=>{i.releaseGlobalData(t)})),i.globalDataMap.clear();else if("syncSeekTime"===t){const t=i.globalDataMap.get(e[0]);if(t)return t.stats.videoCurrentTime}return r}if("decoder"===t){if("registerTask"===e){const t=this.globalDataMap.get(r[0].taskId)||this.createGlobalData(r[0].taskId);r[0].stats=t[n.o9]+32,r[0].avpacketList=t[n.o9],r[0].avpacketListMutex=t[n.o9]+24,r[0].avframeList=t[n.o9]+12,r[0].avframeListMutex=t[n.o9]+28}if(h.Pc(this.decoder[e]))return this.decoder[e](...r).then((t=>s(e,r,t)));l.h2(`method ${e} not found`,b,179)}else{if("registerTask"===e){const t=this.globalDataMap.get(r[0].taskId)||this.createGlobalData(r[0].taskId);r[0].stats=t[n.o9]+32,r[0].avframeList=t[n.o9]+12,r[0].avframeListMutex=t[n.o9]+28}if(h.Pc(this.render[e]))return this.render[e](...r).then((t=>s(e,r,t)));l.h2(`method ${e} not found`,b,197)}}async setLogLevel(t){l.V$(t)}}},21678:(t,e,r)=>{"use strict";r.d(e,{A:()=>u});var i=r(134),s=r(80662),a=r.n(s),n=r(30128),o=r(29170),c=r(88506),d=r(71272),h=r(84149),l=r(95335);class u{constructor(){(0,i.A)(this,"thread",void 0),(0,i.A)(this,"controlMessageChannel",void 0),(0,i.A)(this,"controlPort",void 0),(0,i.A)(this,"statsMap",void 0),this.statsMap=new(a())}async run(){this.thread=await(0,c.pt)(d.A,{name:"VideoPipeline",dispatchToWorker:!0},71272).run(),this.controlMessageChannel=new MessageChannel,this.controlPort=new h.Ay(this.controlMessageChannel.port1),this.controlPort.on(h.Wo,(t=>{if("stats"===t.method){const e=t.params.data,r=[];for(let t=0;t<e.length;t++){const i=this.statsMap.get(e[t].taskId);i&&(l.__(e[t].stats,((t,e)=>{i[e]=t})),r.push({taskId:e[t].taskId,stats:{videoEncodeFramerate:i.videoEncodeFramerate,videoPacketQueueLength:i.videoPacketQueueLength},jitterBuffer:{min:i.jitterBuffer.min,max:i.jitterBuffer.max}}))}this.controlPort.notify("stats",{data:{stats:r}})}})),await this.thread.init.transfer(this.controlMessageChannel.port2).invoke(this.controlMessageChannel.port2)}setLogLevel(t){this.thread.setLogLevel(t)}async destroy(){await(0,c.nx)(this.thread),this.thread=null}transformResult(t,e,r){if("unregisterTask"===t)this.statsMap.delete(e[0]);else if("clear"===t)this.statsMap.clear();else if("registerTask"===t)this.statsMap.set(e[0].taskId,(0,o.A)(e[0].stats,n.A));else if("syncSeekTime"===t){const t=this.statsMap.get(e[0]);if(t)return void(t.videoCurrentTime=r)}return r}get VideoDecodePipeline(){const t=this;return new Proxy({},{get(e,r,i){if(e[r])return e[r];const s=async function(...e){return t.thread.invoke("decoder",r,e).then((i=>t.transformResult(r,e,i)))};return s.transfer=function(...e){return{invoke:async function(...i){return t.thread.invoke.transfer(...e).invoke("decoder",r,i).then((e=>t.transformResult(r,i,e)))}}},e[r]=s,e[r]}})}get VideoRenderPipeline(){const t=this;return new Proxy({},{get(e,r,i){if(e[r])return e[r];const s=async function(...e){return t.thread.invoke("render",r,e).then((i=>t.transformResult(r,e,i)))};return s.transfer=function(...e){return{invoke:async function(...i){return t.thread.invoke.transfer(...e).invoke("render",r,i).then((e=>t.transformResult(r,i,e)))}}},e[r]=s,e[r]}})}}},88103:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(134),s=r(43356),a=r(4624);class n extends s.A{constructor(t,e){super(t,e),(0,i.A)(this,"context",void 0),(0,i.A)(this,"paddingLeft",void 0),(0,i.A)(this,"paddingTop",void 0),(0,i.A)(this,"flipX",void 0),(0,i.A)(this,"flipY",void 0),this.paddingLeft=0,this.paddingTop=0,this.flipX=1,this.flipY=1}async init(){if("rec2100-hlg"===this.options.colorSpace||"rec2100-pq"===this.options.colorSpace)try{this.context=this.canvas.getContext("2d",{colorSpace:this.options.colorSpace,pixelFormat:"float16"})}catch(t){a.R8("cannot got hdr context, video rendering colors may not be correct, please use the latest version of chrome then in chrome://flags, set: Experimental Web Platform features: Enabled","src\\avrender\\image\\Canvas2dRender.ts",63)}this.context||(this.context=this.canvas.getContext("2d"))}clear(){const t=this.canvas.width>>1,e=this.canvas.height>>1;this.rotate&&(this.context.translate(t,e),this.context.rotate(-this.rotate*Math.PI/180),this.context.translate(-t,-e)),this.context.clearRect(0,0,this.canvasWidth*this.options.devicePixelRatio,this.canvasHeight*this.options.devicePixelRatio),this.rotate&&(this.context.translate(t,e),this.context.rotate(this.rotate*Math.PI/180),this.context.translate(-t,-e))}checkFrame(t){t.codedWidth===this.textureWidth&&t.codedHeight===this.videoHeight&&t.codedWidth===this.videoWidth||(this.videoWidth=t.codedWidth,this.videoHeight=t.codedHeight,this.textureWidth=t.codedWidth,this.layout())}render(t){this.lost||(this.checkFrame(t),this.context.drawImage(t,this.paddingLeft,this.paddingTop,this.canvasWidth*this.options.devicePixelRatio-2*this.paddingLeft,this.canvasHeight*this.options.devicePixelRatio-2*this.paddingTop))}layout(){let t=this.videoWidth,e=this.videoHeight,r=this.canvasWidth,i=this.canvasHeight;this.options.sar&&1!==this.options.sar&&(t=Math.floor(this.videoWidth*this.options.sar));let s=0,a=0;90!==this.rotate&&270!==this.rotate||(a=Math.floor((i-r)/2),s=Math.floor((r-i)/2),r=this.canvasHeight,i=this.canvasWidth);const n=t/r,o=e/i;let c;if(c=n>1?!(n<o):n>o,1===this.renderMode&&(c=!c),c){const n=(i-e*r/t)/i;this.paddingTop=(Math.floor(n/2*i)+a)*this.options.devicePixelRatio,this.paddingLeft=s*this.options.devicePixelRatio}else{const n=(r-t*i/e)/r;this.paddingLeft=(Math.floor(n/2*r)+s)*this.options.devicePixelRatio,this.paddingTop=a*this.options.devicePixelRatio}if(this.context){let t=1,e=1;this.flipHorizontal&&(t=-1),this.flipVertical&&(e=-1);const r=this.canvas.width>>1,i=this.canvas.height>>1;this.context.translate(r,i),t!==this.flipX&&this.context.scale(-1,1),e!==this.flipY&&this.context.scale(1,-1),this.context.translate(-r,-i),this.flipX=t,this.flipY=e}}setRotate(t,e=!0){if((t%=360)===this.rotate)return;const r=this.canvas.width>>1,i=this.canvas.height>>1;this.rotate&&(this.context.translate(r,i),this.context.rotate(-this.rotate*Math.PI/180),this.context.translate(-r,-i)),e&&this.clear(),this.rotate=t,this.context&&(this.context.translate(r,i),this.context.rotate(this.rotate*Math.PI/180),this.context.translate(-r,-i)),this.layout()}destroy(){this.context=null,super.destroy()}static isSupport(t){return t instanceof VideoFrame||t instanceof ImageBitmap}}},43356:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(6110);class a{constructor(t,e){(0,i.A)(this,"canvas",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"textureWidth",void 0),(0,i.A)(this,"videoWidth",void 0),(0,i.A)(this,"videoHeight",void 0),(0,i.A)(this,"canvasWidth",void 0),(0,i.A)(this,"canvasHeight",void 0),(0,i.A)(this,"rotate",void 0),(0,i.A)(this,"renderMode",void 0),(0,i.A)(this,"format",void 0),(0,i.A)(this,"lost",void 0),(0,i.A)(this,"destroyed",void 0),(0,i.A)(this,"srcColorSpace",void 0),(0,i.A)(this,"dstColorSpace",void 0),(0,i.A)(this,"flipHorizontal",void 0),(0,i.A)(this,"flipVertical",void 0),this.canvas=t,this.options=e,this.canvasWidth=t.width,this.canvasHeight=t.height,this.videoWidth=0,this.videoHeight=0,this.textureWidth=0,this.rotate=0,this.renderMode=e.renderMode,this.flipHorizontal=!1,this.flipVertical=!1,this.lost=!1,this.destroyed=!1,e.dstColorSpace?this.dstColorSpace=e.dstColorSpace:this.dstColorSpace=new s.A(1,1,1,1)}getRotateMatrix(t){t=Math.PI*t/180;const e=Math.sin(t),r=Math.cos(t);return[r,-e,0,0,e,r,0,0,0,0,1,0,0,0,0,1]}setRenderMode(t){this.renderMode!==t&&(this.renderMode=t,this.layout(),this.clear())}enableHorizontalFlip(t){this.flipHorizontal!==t&&(this.flipHorizontal=t,this.layout(),this.clear())}enableVerticalFlip(t){this.flipVertical!==t&&(this.flipVertical=t,this.layout(),this.clear())}viewport(t,e){if(this.canvasWidth!==t||this.canvasHeight!==e){const r=this.options.devicePixelRatio;this.canvasWidth=t,this.canvasHeight=e,this.canvas.width=t*r,this.canvas.height=e*r,this.videoWidth&&this.videoHeight&&this.layout()}}getVideoWidth(){return this.videoWidth}getVideoHeight(){return this.videoHeight}destroy(){this.canvas=null,this.destroyed=!0}setDstColorSpace(t){this.dstColorSpace=t}static isSupport(t){return!1}}},3016:(t,e,r)=>{"use strict";r.d(e,{A:()=>v});var i=r(134),s=r(20088),a=r(74503),n=r(63939),o=r(94300),c=r(14686),d=r(97317),h=r(10243),l=r(25669),u=r(57517),f=r(6110),p=r(56024),m=r(25408),g=r(72703);class v extends h.A{constructor(t,e){super(t,e),(0,i.A)(this,"linesize",void 0),(0,i.A)(this,"hdrMetadata",void 0),this.hdrMetadata=(0,a.A)(s.A),this.hdrMetadata.multiplier=1}async init(){if(await super.init(),!(this.gl instanceof WebGL2RenderingContext))throw new Error("not support webgl2")}generateVertexSource(){return"#version 300 es\n      precision highp float;\n      in vec3 point;\n      in vec4 color;\n      out vec4 v_color;\n      uniform mat4 rotateMatrix;\n      void main(void) {\n        gl_Position = rotateMatrix * vec4(point, 1.0);\n        v_color = color;\n      }\n    "}generateFragmentSource(t,e){e.outputRGB=!0;const r=(0,l.A)(this.srcColorSpace,this.dstColorSpace,e),i=["y","u","v","a"],s=["r","g","b","a"],a=[],n=[],o=[];t.comp.forEach(((t,e)=>{a[e]=t.depth+7>>>3,n[e]=t.shift,o[e]=(1<<t.depth)-1}));let c=`texture(${i[t.comp[0].plane]}_Sampler, v_color.xy).${s[t.comp[0].offset/a[0]]}`,d=t.comp[1]?`texture(${i[t.comp[1].plane]}_Sampler, v_color.xy).${s[t.comp[1].offset/a[1]]}`:32&t.flags?"0.0":"0.5",h=t.comp[2]?`texture(${i[t.comp[2].plane]}_Sampler, v_color.xy).${s[t.comp[2].offset/a[2]]}`:32&t.flags?"0.0":"0.5",u="1.0";function f(t){return/^texture/.test(t)}128&t.flags&&(u=`texture(${i[t.comp[t.comp.length-1].plane]}_Sampler, v_color.xy).${s[t.comp[t.comp.length-1].offset/a[t.comp.length-1]]}`,2===t.comp.length&&(d=32&t.flags?"0.0":"0.5")),this.fragmentSource=`#version 300 es\n      precision highp float;\n      precision highp usampler2D;\n      in vec4 v_color;\n      out vec4 outColor;\n      uniform usampler2D y_Sampler;\n      uniform usampler2D u_Sampler;\n      uniform usampler2D v_Sampler;\n      uniform usampler2D a_Sampler;\n      uniform float offset;\n      uniform float multiplier;\n      uniform float pq_tonemap_a;\n      uniform float pq_tonemap_b;\n      uniform float hlg_ootf_gamma_minus_one;\n      uniform float nits_to_sdr_relative_factor;\n      uniform float sdr_relative_to_nits_factor;\n      ${1&t.flags?"\n        uint swap(uint x) {\n          uint l = x & 0xFFu;\n          uint h = (x >> 8u) & 0xFFu;\n          return (l << 8u) | h;\n        }\n      ":""}\n      void main () {\n        float y = ${f(c)?`float(${1&t.flags?`swap(${c})`:c} >> ${n[0]}) / float(${o[0]})`:c};\n        float u = ${f(d)?`float(${1&t.flags?`swap(${d})`:d} >> ${n[1]}) / float(${o[1]})`:d};\n        float v = ${f(h)?`float(${1&t.flags?`swap(${h})`:h} >> ${n[2]}) / float(${o[2]})`:h};\n        float a = ${f(u)?`float(${1&t.flags?`swap(${u})`:u} >> ${n[t.comp.length-1]}) / float(${o[t.comp.length-1]})`:u};\n        vec4 color = vec4(y, u, v, a);\n        if (color.a > 0.0) {\n          color.r /= color.a;\n          color.g /= color.a;\n          color.b /= color.a;\n        }\n        color.r -= offset;\n        color.g -= offset;\n        color.b -= offset;\n        color.r *= multiplier;\n        color.g *= multiplier;\n        color.b *= multiplier;\n        ${r.reduce(((t,e)=>t+e),"")}\n        color.r *= color.a;\n        color.g *= color.a;\n        color.b *= color.a;\n        outColor = color;\n      }\n    `}checkFrame(t){if(n.f[15](t+32)!==this.linesize||n.f[15](t+72)!==this.videoHeight||n.f[15](t+68)!==this.videoWidth||n.f[15](t+80)!==this.format){const e=(0,d.I)(n.f[15](t+80));this.srcColorSpace=new f.A(n.f[15](t+220),n.f[15](t+212),n.f[15](t+216),n.f[15](t+208));const r={type:0,bitDepth:e.comp[0].depth,toneMapPQAndHlgToDst:!0,metadata:this.hdrMetadata,dstSdrMaxLuminanceNits:u.kH,dstMaxLuminanceRelative:1},i=(0,p.aH)(t,14);if(i){const t=n.f[20](i+4);n.f[8](t)>0&&(r.maxContentLightLevel=n.f[8](t))}if(this.generateFragmentSource(e,r),this.program=new m.A(this.fragmentSource,this.generateVertexSource()),this.useProgram(!0),this.program.setMetaData(this.hdrMetadata),this.yTexture.setFormat(this.gl.RED_INTEGER),this.yTexture.setInternalformat(this.gl.R16UI),this.yTexture.setDataType(this.gl.UNSIGNED_SHORT),this.uTexture.setFormat(this.gl.RED_INTEGER),this.uTexture.setInternalformat(this.gl.R16UI),this.uTexture.setDataType(this.gl.UNSIGNED_SHORT),this.vTexture.setFormat(this.gl.RED_INTEGER),this.vTexture.setInternalformat(this.gl.R16UI),this.vTexture.setDataType(this.gl.UNSIGNED_SHORT),this.aTexture.setFormat(this.gl.RED_INTEGER),this.aTexture.setInternalformat(this.gl.R16UI),this.aTexture.setDataType(this.gl.UNSIGNED_SHORT),16&e.flags){let r=0;if(this.yTexture.setSize(n.f[15](t+32+4*r++)>>>1,n.f[15](t+72)),e.comp.length>2){const i=e.comp[1].plane===e.comp[2].plane;this.uTexture.setSize(n.f[15](t+32+4*r++)>>>(i?2:1),n.f[15](t+72)>>>e.log2ChromaH),i||this.vTexture.setSize(n.f[15](t+32+4*r++)>>>1,n.f[15](t+72)>>>e.log2ChromaH),i&&(this.uTexture.setFormat(this.gl.RG_INTEGER),this.uTexture.setInternalformat(this.gl.RG16UI))}128&e.flags&&this.aTexture.setSize(n.f[15](t+32+4*r++)>>>1,n.f[15](t+72)),this.textureWidth=n.f[15](t+32)>>>1}else{const r=e.comp[0].depth+7>>>3;let i=e.comp[0].step/r;const s=[0,this.gl.RED_INTEGER,this.gl.RG_INTEGER,this.gl.RGB_INTEGER,this.gl.RGBA_INTEGER],a=[0,this.gl.R16UI,this.gl.RG16UI,this.gl.RGB16UI,this.gl.RGBA16UI];this.yTexture.setFormat(s[i]),this.yTexture.setInternalformat(a[i]),this.yTexture.setSize(n.f[15](t+32)/i>>>1,n.f[15](t+72)),this.textureWidth=n.f[15](t+32)/i>>>1}this.linesize=n.f[15](t+32),this.videoWidth=n.f[15](t+68),this.videoHeight=n.f[15](t+72),this.format=n.f[15](t+80),this.layout()}}render(t){if(this.lost)return;let e=(0,d.I)(n.f[15](t+80));if(!e)return;this.checkFrame(t);let r=0;this.yTexture.fill((0,c.bg)(n.f[20](t+4*r),(n.f[15](t+32+4*r++)>>>1)*this.yTexture.height)),16&e.flags&&(e.comp.length>2&&(this.uTexture.fill((0,c.bg)(n.f[20](t+4*r),(n.f[15](t+32+4*r++)>>>1)*this.uTexture.height)),e.comp[1].plane!==e.comp[2].plane&&this.vTexture.fill((0,c.bg)(n.f[20](t+4*r),(n.f[15](t+32+4*r++)>>>1)*this.vTexture.height))),128&e.flags&&this.aTexture.fill((0,c.bg)(n.f[20](t+4*r),(n.f[15](t+32+4*r++)>>>1)*this.aTexture.height))),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}destroy(){this.hdrMetadata&&((0,o.A)(this.hdrMetadata),this.hdrMetadata=null),super.destroy()}static isSupport(t){if((0,g.A)(t)){const e=(0,d.I)(n.f[15](t+80));if(e)return e.comp[0].depth+7>>>3==2}return!1}}},69047:(t,e,r)=>{"use strict";r.d(e,{A:()=>u});var i=r(134),s=r(63939),a=r(14686),n=r(97317),o=r(10243),c=r(18915),d=r(25669),h=r(6110),l=r(72703);class u extends o.A{constructor(t,e){super(t,e),(0,i.A)(this,"linesize",void 0)}async init(){await super.init()}generateFragmentSource(t){const e=(0,d.A)(this.srcColorSpace,this.dstColorSpace,{bitDepth:8,type:0,outputRGB:!0}),r=["y","u","v","a"],i=16&t.flags&&t.comp.length>2&&t.comp[1].plane===t.comp[2].plane?["r","a"]:["r","g","b","a"];let s=`texture2D(${r[t.comp[0].plane]}_Sampler, v_color.xy).${i[t.comp[0].offset]}`,a=t.comp[1]?`texture2D(${r[t.comp[1].plane]}_Sampler, v_color.xy).${i[t.comp[1].offset]}`:32&t.flags?"0.0":"0.5",n=t.comp[2]?`texture2D(${r[t.comp[2].plane]}_Sampler, v_color.xy).${i[t.comp[2].offset]}`:32&t.flags?"0.0":"0.5",o="1.0";128&t.flags&&(o=`texture2D(${r[t.comp[t.comp.length-1].plane]}_Sampler, v_color.xy).${i[t.comp[t.comp.length-1].offset]}`,2===t.comp.length&&(a=32&t.flags?"0.0":"0.5")),this.fragmentSource=`\n      precision highp float;\n      varying vec4 v_color;\n      uniform sampler2D y_Sampler;\n      uniform sampler2D u_Sampler;\n      uniform sampler2D v_Sampler;\n      uniform sampler2D a_Sampler;\n      void main () {\n        float y = ${s};\n        float u = ${a};\n        float v = ${n};\n        float alpha = ${o};\n        vec4 color = vec4(y, u, v, alpha);\n        ${e.reduce(((t,e)=>t+e),"")}\n        gl_FragColor = color;\n      }\n    `}checkFrame(t){if(s.f[15](t+32)!==this.linesize||s.f[15](t+72)!==this.videoHeight||s.f[15](t+68)!==this.videoWidth){const e=(0,n.I)(s.f[15](t+80));if(this.srcColorSpace=new h.A(s.f[15](t+220),s.f[15](t+212),s.f[15](t+216),s.f[15](t+208)),this.generateFragmentSource(e),this.program=new c.A(this.fragmentSource),this.useProgram(),16&e.flags){let r=0;if(this.yTexture.setSize(s.f[15](t+32+4*r++),s.f[15](t+72)),e.comp.length>2){const i=e.comp[1].plane===e.comp[2].plane;this.uTexture.setSize(s.f[15](t+32+4*r++)>>>(i?1:0),s.f[15](t+72)>>>e.log2ChromaH),i||this.vTexture.setSize(s.f[15](t+32+4*r++),s.f[15](t+72)>>>e.log2ChromaH),i&&(this.uTexture.setFormat(this.gl.LUMINANCE_ALPHA),this.uTexture.setInternalformat(this.gl.LUMINANCE_ALPHA))}128&e.flags&&this.aTexture.setSize(s.f[15](t+32+4*r++),s.f[15](t+72)),this.textureWidth=s.f[15](t+32)}else{const r=e.comp[0].depth+7>>>3;let i=e.comp[0].step/r;const a=[0,this.gl.LUMINANCE,this.gl.LUMINANCE_ALPHA,this.gl.RGB,this.gl.RGBA];this.yTexture.setFormat(a[i]),this.yTexture.setInternalformat(a[i]),this.yTexture.setSize(s.f[15](t+32)/i,s.f[15](t+72)),this.textureWidth=s.f[15](t+32)/i}this.linesize=s.f[15](t+32),this.videoWidth=s.f[15](t+68),this.videoHeight=s.f[15](t+72),this.format=s.f[15](t+80),this.layout()}}render(t){if(this.lost)return;let e=(0,n.I)(s.f[15](t+80));if(!e)return;this.checkFrame(t);let r=0;this.yTexture.fill((0,a.s3)(s.f[20](t+4*r),s.f[15](t+32+4*r++)*this.yTexture.height)),16&e.flags&&(e.comp.length>2&&(this.uTexture.fill((0,a.s3)(s.f[20](t+4*r),s.f[15](t+32+4*r++)*this.uTexture.height)),e.comp[1].plane!==e.comp[2].plane&&this.vTexture.fill((0,a.s3)(s.f[20](t+4*r),s.f[15](t+32+4*r++)*this.vTexture.height))),128&e.flags&&this.aTexture.fill((0,a.s3)(s.f[20](t+4*r),s.f[15](t+32+4*r)*this.aTexture.height))),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}static isSupport(t){if((0,l.A)(t)){const e=(0,n.I)(s.f[15](t+80));if(e)return e.comp[0].depth+7>>>3==1}return!1}}},10243:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(134),s=r(18105),a=r(94012);class n extends a.A{constructor(t,e){super(t,e),(0,i.A)(this,"yTexture",void 0),(0,i.A)(this,"uTexture",void 0),(0,i.A)(this,"vTexture",void 0),(0,i.A)(this,"aTexture",void 0)}useProgram(t=!1){super.useProgram(),this.yTexture=new s.A(this.gl),t&&this.yTexture.setFilter(this.gl.NEAREST),this.yTexture.bind(0),this.yTexture.init(),this.program.bindYTexture(0),this.uTexture=new s.A(this.gl),t&&this.uTexture.setFilter(this.gl.NEAREST),this.uTexture.bind(1),this.uTexture.init(),this.program.bindUTexture(1),this.vTexture=new s.A(this.gl),t&&this.vTexture.setFilter(this.gl.NEAREST),this.vTexture.bind(2),this.vTexture.init(),this.program.bindVTexture(2),this.aTexture=new s.A(this.gl),t&&this.aTexture.setFilter(this.gl.NEAREST),this.aTexture.bind(3),this.aTexture.init(),this.program.bindATexture(3)}destroy(){this.yTexture&&(this.yTexture.destroy(),this.yTexture=null),this.uTexture&&(this.uTexture.destroy(),this.uTexture=null),this.vTexture&&(this.vTexture.destroy(),this.vTexture=null),this.aTexture&&(this.aTexture.destroy(),this.aTexture=null),super.destroy()}}},94012:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(134),s=r(4624),a=r(43356),n=r(38469);const o="src\\avrender\\image\\WebGLRender.ts";class c extends a.A{constructor(t,e){super(t,e),(0,i.A)(this,"gl",void 0),(0,i.A)(this,"vbo",void 0),(0,i.A)(this,"program",void 0),(0,i.A)(this,"vertex",void 0),(0,i.A)(this,"webglContextLostTimer",void 0),(0,i.A)(this,"onWebglContextLost",void 0),(0,i.A)(this,"onWebglContextRestored",void 0),(0,i.A)(this,"fragmentSource",void 0),(0,i.A)(this,"vertexSource",void 0)}async init(){this.gl=this.canvas.getContext("webgl2",{alpha:!1,antialias:!1,preserveDrawingBuffer:this.options.preserveDrawingBuffer}),this.gl||(this.gl=this.canvas.getContext("webgl",{alpha:!1,antialias:!1,preserveDrawingBuffer:this.options.preserveDrawingBuffer})),this.gl||(this.gl=this.canvas.getContext("experimental-webgl",{alpha:!1,antialias:!1,preserveDrawingBuffer:this.options.preserveDrawingBuffer})),this.gl||s.h2("can not support webgl, got WebGLRenderingContext failed",o,96),this.vbo=this.gl.createBuffer(),this.vbo||s.h2("create vao buffer failed",o,101),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.enable(this.gl.BLEND),this.gl.clearColor(0,0,0,0),this.gl.clearDepth(1),this.viewport(this.canvasWidth||this.canvas.width,this.canvasHeight||this.canvas.height),this.onWebglContextLost=t=>{this.destroyed||(this.webglContextLostTimer=setTimeout((()=>{this.lost=!0,this.webglContextLostTimer=null,s.z3("webgl context lost",o,118),this.options.onRenderContextLost&&this.options.onRenderContextLost()}),3e3))},this.onWebglContextRestored=t=>{this.webglContextLostTimer&&(clearTimeout(this.webglContextLostTimer),this.webglContextLostTimer=null)},this.canvas.addEventListener("webglcontextlost",this.onWebglContextLost),this.canvas.addEventListener("webglcontextrestored",this.onWebglContextRestored)}viewport(t,e){this.gl.viewport(0,0,t*this.options.devicePixelRatio,e*this.options.devicePixelRatio),super.viewport(t,e)}useProgram(){this.program.link(this.gl),this.program.bind(),this.program.setRotateMatrix(this.getRotateMatrix(this.rotate))}clear(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}layout(){let t=this.videoWidth,e=this.videoHeight,r=this.canvasWidth,i=this.canvasHeight,s=this.textureWidth;this.options.sar&&1!==this.options.sar&&(t=Math.floor(this.videoWidth*this.options.sar),s=Math.floor(this.textureWidth*this.options.sar)),90!==this.rotate&&270!==this.rotate||(r=this.canvasHeight,i=this.canvasWidth);const a=t/r,o=e/i;let c;c=a>1?!(a<o):a>o,1===this.renderMode&&(c=!c);let d=0;if(s!==t&&(d=(s-t)/s),c){const s=(i-e*r/t)/i;this.vertex=[-1,1-s,0,0,0,0,0,-1,-1+s,0,0,1,0,0,1,1-s,0,1-d,0,0,0,1,-1+s,0,1-d,1,0,0]}else{const s=(r-t*i/e)/r;this.vertex=[-1+s,1,0,0,0,0,0,-1+s,-1,0,0,1,0,0,1-s,1,0,1-d,0,0,0,1-s,-1,0,1-d,1,0,0]}(0,n.A)(this.vertex,this.flipHorizontal,this.flipVertical),this.gl&&this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.vertex),this.gl.STATIC_DRAW)}setRotate(t,e=!0){(t%=360)!==this.rotate&&(this.rotate=t,this.gl&&this.program.setRotateMatrix(this.getRotateMatrix(this.rotate)),this.layout(),e&&this.clear())}destroy(){this.vbo&&(this.gl.deleteBuffer(this.vbo),this.vbo=null),this.program&&this.program.stop(),this.gl=null,this.vertex=null,this.onWebglContextLost&&(this.canvas.removeEventListener("webglcontextlost",this.onWebglContextLost),this.onWebglContextLost=null),this.onWebglContextRestored&&(this.canvas.removeEventListener("webglcontextrestored",this.onWebglContextRestored),this.onWebglContextRestored=null),super.destroy()}}},87623:(t,e,r)=>{"use strict";r.d(e,{A:()=>A});var i=r(134),s=r(61499),a=r(20088),n=r(74503),o=r(63939),c=r(94300),d=r(54024),h=r(97317),l=r(14686),u=r(6110),f=r(57517),p=r(25669),m=r(56024),g=r(72703),v=r(11473);class A extends d.A{constructor(t,e){super(t,e),(0,i.A)(this,"linesize",void 0),(0,i.A)(this,"hdrMetadata",void 0),(0,i.A)(this,"hdrMetadataBuffer",void 0),this.hdrMetadata=(0,n.A)(a.A),this.hdrMetadata.multiplier=1}generateFragmentSource(t,e){e.outputRGB=!0;const r=(0,p.A)(this.srcColorSpace,this.dstColorSpace,e),i=["y","u","v","a"],s=["r","g","b","a"],a=[],n=[],o=[];t.comp.forEach(((t,e)=>{a[e]=t.depth+7>>>3,n[e]=t.shift,o[e]=(1<<t.depth)-1}));let c=`textureLoad(${i[t.comp[0].plane]}Texture,\n      vec2<i32>(coord.xy * vec2<f32>(\n        ${this[`${i[t.comp[0].plane]}Texture`].width}.0,\n        ${this[`${i[t.comp[0].plane]}Texture`].height}.0\n      )), 0).${s[t.comp[0].offset/a[0]]}`,d=t.comp[1]?`textureLoad(${i[t.comp[1].plane]}Texture,\n          vec2<i32>(coord.xy * vec2<f32>(\n            ${this[`${i[t.comp[1].plane]}Texture`].width}.0,\n            ${this[`${i[t.comp[1].plane]}Texture`].height}.0\n          )), 0).${s[t.comp[1].offset/a[1]]}`:32&t.flags?"0.0":"0.5",h=t.comp[2]?`textureLoad(${i[t.comp[2].plane]}Texture,\n          vec2<i32>(coord.xy * vec2<f32>(\n            ${this[`${i[t.comp[2].plane]}Texture`].width}.0,\n            ${this[`${i[t.comp[2].plane]}Texture`].height}.0\n          )), 0).${s[t.comp[2].offset/a[2]]}`:32&t.flags?"0.0":"0.5",l="1.0";function u(t){return/^textureLoad/.test(t)}128&t.flags&&(l=`textureLoad(${i[t.comp[t.comp.length-1].plane]}Texture,\n        vec2<i32>(coord.xy * vec2<f32>(\n          ${this[`${i[t.comp[t.comp.length-1].plane]}Texture`].width}.0,\n          ${this[`${i[t.comp[t.comp.length-1].plane]}Texture`].height}.0\n        )), 0).${s[t.comp[t.comp.length-1].offset/a[t.comp.length-1]]}`,2===t.comp.length&&(d=32&t.flags?"0.0":"0.5")),this.fragmentSource=`\n      struct HdrMetadata {\n        offset: f32,\n        multiplier: f32,\n        pqTonemapA: f32,\n        pqTonemapB: f32,\n        hlgOOTFGammaMinusOne: f32,\n        nitsToSdrRelativeFactor: f32,\n        sdrRelativeToNitsFactor: f32\n      };\n      @group(0) @binding(1) var<uniform> hdrMetadata: HdrMetadata;\n      @group(0) @binding(2) var yTexture: texture_2d<u32>;\n      ${this.uTexture?"@group(0) @binding(3) var uTexture: texture_2d<u32>;":""}\n      ${this.vTexture?"@group(0) @binding(4) var vTexture: texture_2d<u32>;":""}\n      ${this.aTexture?"@group(0) @binding(5) var aTexture: texture_2d<u32>;":""}\n      ${1&t.flags?"\n        fn swap(x: u32) -> u32 {\n          var low = x & 0xff;\n          var high = (x >> 8) & 0xff;\n          return (low << 8) | high;\n        }\n      ":""}\n      @fragment\n      fn main(@location(0) coord: vec4<f32>) -> @location(0) vec4<f32> {\n        let offset = hdrMetadata.offset;\n        let multiplier = hdrMetadata.multiplier;\n        let pq_tonemap_a = hdrMetadata.pqTonemapA;\n        let pq_tonemap_b = hdrMetadata.pqTonemapB;\n        let hlg_ootf_gamma_minus_one = hdrMetadata.hlgOOTFGammaMinusOne;\n        let nits_to_sdr_relative_factor = hdrMetadata.nitsToSdrRelativeFactor;\n        let sdr_relative_to_nits_factor = hdrMetadata.sdrRelativeToNitsFactor;\n        let y = ${u(c)?`f32(${1&t.flags?`swap(${c})`:c} >> ${n[0]}) / f32(${o[0]})`:c};\n        let u = ${u(d)?`f32(${1&t.flags?`swap(${d})`:d} >> ${n[1]}) / f32(${o[1]})`:d};\n        let v = ${u(h)?`f32(${1&t.flags?`swap(${h})`:h} >> ${n[2]}) / f32(${o[2]})`:h};\n        let a = ${u(l)?`f32(${1&t.flags?`swap(${l})`:l} >> ${n[t.comp.length-1]}) / f32(${o[t.comp.length-1]})`:l};\n        var color = vec4(y, u, v, a);\n        if (color.a > 0) {\n          color.r /= color.a;\n          color.g /= color.a;\n          color.b /= color.a;\n        }\n        color.r -= offset;\n        color.g -= offset;\n        color.b -= offset;\n        color.r *= multiplier;\n        color.g *= multiplier;\n        color.b *= multiplier;\n        ${r.reduce(((t,e)=>t+e),"")}\n        color.r *= color.a;\n        color.g *= color.a;\n        color.b *= color.a;\n        return color;\n      }\n    `}async init(){await super.init(),this.hdrMetadataBuffer=this.device.createBuffer({size:32,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})}generateBindGroup(){if(!this.yTexture)return;const t=[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"uint"}}];this.uTexture&&t.push({binding:3,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"uint"}}),this.vTexture&&t.push({binding:4,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"uint"}}),this.aTexture&&t.push({binding:5,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"uint"}}),this.bindGroupLayout=this.device.createBindGroupLayout({entries:t});const e=[{binding:0,resource:{buffer:this.rotateMatrixBuffer,size:16*Float32Array.BYTES_PER_ELEMENT}},{binding:1,resource:{buffer:this.hdrMetadataBuffer,size:this.hdrMetadataBuffer.size}},{binding:2,resource:this.yTexture.createView()}];this.uTexture&&e.push({binding:3,resource:this.uTexture.createView()}),this.vTexture&&e.push({binding:4,resource:this.vTexture.createView()}),this.aTexture&&e.push({binding:5,resource:this.aTexture.createView()}),this.bindGroup=this.device.createBindGroup({layout:this.bindGroupLayout,entries:e})}checkFrame(t){if(o.f[15](t+32)!==this.linesize||o.f[15](t+72)!==this.videoHeight||o.f[15](t+68)!==this.videoWidth||o.f[15](t+80)!==this.format){const e=(0,h.I)(o.f[15](t+80));if(this.yTexture&&(this.yTexture.destroy(),this.yTexture=null),this.uTexture&&(this.uTexture.destroy(),this.uTexture=null),this.vTexture&&(this.vTexture.destroy(),this.vTexture=null),this.aTexture&&(this.aTexture.destroy(),this.aTexture=null),16&e.flags){let r=0;if(this.yTexture=this.device.createTexture({size:[o.f[15](t+32+4*r++)>>>1,o.f[15](t+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_DST,format:"r16uint"}),e.comp.length>2){const i=e.comp[1].plane===e.comp[2].plane;this.uTexture=this.device.createTexture({size:[o.f[15](t+32+4*r++)>>>(i?2:1),o.f[15](t+72)>>>e.log2ChromaH],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_DST,format:i?"rg16uint":"r16uint"}),i||(this.vTexture=this.device.createTexture({size:[o.f[15](t+32+4*r++)>>>1,o.f[15](t+72)>>>e.log2ChromaH],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_DST,format:"r16uint"}))}128&e.flags&&(this.aTexture=this.device.createTexture({size:[o.f[15](t+32+4*r++)>>>1,o.f[15](t+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_DST,format:"r16uint"})),this.textureWidth=o.f[15](t+32)>>>1}else{const r=e.comp[0].depth+7>>>3;let i=e.comp[0].step/r;const s=["","r16uint","rg16uint","","rgba16uint"];this.yTexture=this.device.createTexture({size:[o.f[15](t+32)/i>>>1,o.f[15](t+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_DST,format:s[i]}),this.textureWidth=o.f[15](t+32)/i>>>1}this.linesize=o.f[15](t+32),this.srcColorSpace=new u.A(o.f[15](t+220),o.f[15](t+212),o.f[15](t+216),o.f[15](t+208)),this.videoWidth=o.f[15](t+68),this.videoHeight=o.f[15](t+72),this.format=o.f[15](t+80);const r={type:1,bitDepth:e.comp[0].depth,toneMapPQAndHlgToDst:!0,metadata:this.hdrMetadata,dstSdrMaxLuminanceNits:f.kH,dstMaxLuminanceRelative:1},i=(0,m.aH)(t,14);if(i){const t=o.f[20](i+4);o.f[8](t)>0&&(r.maxContentLightLevel=o.f[8](t))}this.generateFragmentSource(e,r),this.layout(),this.generatePipeline(),this.generateRenderBundleEncoder();const a=(0,l.s3)(this.hdrMetadata[s.o9],28).slice();this.device.queue.writeBuffer(this.hdrMetadataBuffer,0,a.buffer,a.byteOffset,a.byteLength)}}render(t){if(this.lost)return;let e=(0,h.I)(o.f[15](t+80));if(!e)return;this.checkFrame(t);const r=this.device.createCommandEncoder();let i=0;this.device.queue.writeTexture({texture:this.yTexture},(0,v.Lv)(),{offset:o.f[20](t+4*i),bytesPerRow:o.f[15](t+32+4*i++),rowsPerImage:this.yTexture.height},{width:this.yTexture.width,height:this.yTexture.height,depthOrArrayLayers:1}),16&e.flags&&(this.uTexture&&this.device.queue.writeTexture({texture:this.uTexture},(0,v.Lv)(),{offset:o.f[20](t+4*i),bytesPerRow:o.f[15](t+32+4*i++),rowsPerImage:this.uTexture.height},{width:this.uTexture.width,height:this.uTexture.height,depthOrArrayLayers:1}),this.vTexture&&this.device.queue.writeTexture({texture:this.vTexture},(0,v.Lv)(),{offset:o.f[20](t+4*i),bytesPerRow:o.f[15](t+32+4*i++),rowsPerImage:this.vTexture.height},{width:this.vTexture.width,height:this.vTexture.height,depthOrArrayLayers:1}),this.aTexture&&this.device.queue.writeTexture({texture:this.aTexture},(0,v.Lv)(),{offset:o.f[20](t+4*i),bytesPerRow:o.f[15](t+32+4*i++),rowsPerImage:this.aTexture.height},{width:this.aTexture.width,height:this.aTexture.height,depthOrArrayLayers:1}));const s=r.beginRenderPass({colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]});s.executeBundles([this.renderBundle]),s.end(),this.device.queue.submit([r.finish()])}destroy(){this.hdrMetadata&&((0,c.A)(this.hdrMetadata),this.hdrMetadata=null),this.hdrMetadataBuffer&&(this.hdrMetadataBuffer.destroy(),this.hdrMetadataBuffer=null),super.destroy()}static isSupport(t){if((0,g.A)(t)){const e=(0,h.I)(o.f[15](t+80));if(e){const t=e.comp[0].depth+7>>>3;if(2!==t)return!1;let r=e.comp[0].step/t;return!!(16&e.flags||3!==r)}}return!1}}},38222:(t,e,r)=>{"use strict";r.d(e,{A:()=>l});var i=r(134),s=r(63939),a=r(54024),n=r(97317),o=r(6110),c=r(25669),d=r(72703),h=r(11473);class l extends a.A{constructor(t,e){super(t,e),(0,i.A)(this,"linesize",void 0)}async init(){await super.init()}generateFragmentSource(t){const e=(0,c.A)(this.srcColorSpace,this.dstColorSpace,{bitDepth:8,type:1,outputRGB:!0}),r=["y","u","v","a"],i=["r","g","b","a"];let s=`textureSample(${r[t.comp[0].plane]}Texture, s, in_texcoord.xy).${i[t.comp[0].offset]}`,a=t.comp[1]?`textureSample(${r[t.comp[1].plane]}Texture, s, in_texcoord.xy).${i[t.comp[1].offset]}`:32&t.flags?"0.0":"0.5",n=t.comp[2]?`textureSample(${r[t.comp[2].plane]}Texture, s, in_texcoord.xy).${i[t.comp[2].offset]}`:32&t.flags?"0.0":"0.5",o="1.0";128&t.flags&&(o=`textureSample(${r[t.comp[t.comp.length-1].plane]}Texture, s, in_texcoord.xy).${i[t.comp[t.comp.length-1].offset]}`,2===t.comp.length&&(a=32&t.flags?"0.0":"0.5")),this.fragmentSource=`\n      @group(0) @binding(1) var s: sampler;\n      @group(0) @binding(2) var yTexture: texture_2d<f32>;\n      ${this.uTexture?"@group(0) @binding(3) var uTexture: texture_2d<f32>;":""}\n      ${this.vTexture?"@group(0) @binding(4) var vTexture: texture_2d<f32>;":""}\n      ${this.aTexture?"@group(0) @binding(5) var aTexture: texture_2d<f32>;":""}\n      \n      @fragment\n      fn main(@location(0) in_texcoord: vec4<f32>) -> @location(0) vec4<f32> {\n        let y = ${s};\n        let u = ${a};\n        let v = ${n};\n        let alpha = ${o};\n        var color = vec4(y, u, v, alpha);\n        ${e.reduce(((t,e)=>t+e),"")}\n        return color;\n      }\n    `}checkFrame(t){if(s.f[15](t+32)!==this.linesize||s.f[15](t+72)!==this.videoHeight||s.f[15](t+68)!==this.videoWidth){const e=(0,n.I)(s.f[15](t+80));if(this.yTexture&&(this.yTexture.destroy(),this.yTexture=null),this.uTexture&&(this.uTexture.destroy(),this.uTexture=null),this.vTexture&&(this.vTexture.destroy(),this.vTexture=null),this.aTexture&&(this.aTexture.destroy(),this.aTexture=null),16&e.flags){let r=0;if(this.yTexture=this.device.createTexture({size:[s.f[15](t+32+4*r++),s.f[15](t+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:"r8unorm"}),e.comp.length>2){const i=e.comp[1].plane===e.comp[2].plane;this.uTexture=this.device.createTexture({size:[s.f[15](t+32+4*r++)>>>(i?1:0),s.f[15](t+72)>>>e.log2ChromaH],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:i?"rg8unorm":"r8unorm"}),i||(this.vTexture=this.device.createTexture({size:[s.f[15](t+32+4*r++),s.f[15](t+72)>>>e.log2ChromaH],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:"r8unorm"}))}128&e.flags&&(this.aTexture=this.device.createTexture({size:[s.f[15](t+32+4*r++),s.f[15](t+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:"r8unorm"})),this.textureWidth=s.f[15](t+32)}else{const r=e.comp[0].depth+7>>>3;let i=e.comp[0].step/r;const a=["","r8unorm","rg8unorm","","rgba8unorm"];this.yTexture=this.device.createTexture({size:[s.f[15](t+32)/i,s.f[15](t+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:a[i]}),this.textureWidth=s.f[15](t+32)/i}this.linesize=s.f[15](t+32),this.srcColorSpace=new o.A(s.f[15](t+220),s.f[15](t+212),s.f[15](t+216),s.f[15](t+208)),this.generateFragmentSource(e),this.videoWidth=s.f[15](t+68),this.videoHeight=s.f[15](t+72),this.format=s.f[15](t+80),this.layout(),this.generatePipeline(),this.generateRenderBundleEncoder()}}render(t){if(this.lost)return;let e=(0,n.I)(s.f[15](t+80));if(!e)return;this.checkFrame(t);let r=0;this.device.queue.writeTexture({texture:this.yTexture},(0,h.Lv)(),{offset:s.f[20](t+4*r),bytesPerRow:s.f[15](t+32+4*r++),rowsPerImage:this.yTexture.height},{width:this.yTexture.width,height:this.yTexture.height,depthOrArrayLayers:1}),16&e.flags&&(this.device.queue.writeTexture({texture:this.uTexture},(0,h.Lv)(),{offset:s.f[20](t+4*r),bytesPerRow:s.f[15](t+32+4*r++),rowsPerImage:this.uTexture.height},{width:this.uTexture.width,height:this.uTexture.height,depthOrArrayLayers:1}),this.vTexture&&this.device.queue.writeTexture({texture:this.vTexture},(0,h.Lv)(),{offset:s.f[20](t+4*r),bytesPerRow:s.f[15](t+32+4*r++),rowsPerImage:this.vTexture.height},{width:this.vTexture.width,height:this.vTexture.height,depthOrArrayLayers:1}),this.aTexture&&this.device.queue.writeTexture({texture:this.aTexture},(0,h.Lv)(),{offset:s.f[20](t+4*r),bytesPerRow:s.f[15](t+32+4*r),rowsPerImage:this.aTexture.height},{width:this.aTexture.width,height:this.aTexture.height,depthOrArrayLayers:1}));const i=this.device.createCommandEncoder(),a=i.beginRenderPass({colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]});a.executeBundles([this.renderBundle]),a.end(),this.device.queue.submit([i.finish()])}static isSupport(t){if((0,d.A)(t)){const e=(0,n.I)(s.f[15](t+80));if(e){const t=e.comp[0].depth+7>>>3;if(1!==t)return!1;let r=e.comp[0].step/t;return!!(16&e.flags||3!==r)}}return!1}}},54024:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(134),s=r(54895),a=r(15045);class n extends a.A{constructor(t,e){super(t,e),(0,i.A)(this,"yTexture",void 0),(0,i.A)(this,"uTexture",void 0),(0,i.A)(this,"vTexture",void 0),(0,i.A)(this,"aTexture",void 0),this.vertexSource=s.A}generateBindGroup(){if(!this.yTexture)return;const t=[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}];this.uTexture&&t.push({binding:3,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}),this.vTexture&&t.push({binding:4,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}),this.aTexture&&t.push({binding:5,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}),this.bindGroupLayout=this.device.createBindGroupLayout({entries:t});const e=[{binding:0,resource:{buffer:this.rotateMatrixBuffer,size:16*Float32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.sampler},{binding:2,resource:this.yTexture.createView()}];this.uTexture&&e.push({binding:3,resource:this.uTexture.createView()}),this.vTexture&&e.push({binding:4,resource:this.vTexture.createView()}),this.aTexture&&e.push({binding:5,resource:this.aTexture.createView()}),this.bindGroup=this.device.createBindGroup({layout:this.bindGroupLayout,entries:e})}destroy(){this.yTexture&&this.yTexture.destroy(),this.uTexture&&this.uTexture.destroy(),this.vTexture&&this.vTexture.destroy(),this.aTexture&&this.aTexture.destroy(),super.destroy()}}},54750:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(54895),s=r(23195),a=r(15045);const n=["bt2020","bt2100","st2048","p3-dcl","hlg"];class o extends a.A{constructor(t,e){super(t,e),this.vertexSource=i.A,this.fragmentSource=s.A}checkFrame(t){t.codedWidth===this.textureWidth&&t.codedHeight===this.videoHeight&&t.codedWidth===this.videoWidth||(this.videoWidth=t.codedWidth,this.videoHeight=t.codedHeight,this.textureWidth=t.codedWidth,this.layout(),this.generatePipeline())}generateBindGroup(){this.bindGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,externalTexture:{}},{binding:2,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}}]})}render(t){if(this.lost)return;this.checkFrame(t);const e=this.device.createBindGroup({layout:this.renderPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.rotateMatrixBuffer,size:16*Float32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.device.importExternalTexture({source:t})},{binding:2,resource:this.sampler}]}),r=this.device.createCommandEncoder(),i={colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]},s=r.beginRenderPass(i);s.setPipeline(this.renderPipeline),s.setBindGroup(0,e),s.setVertexBuffer(0,this.vbo),s.draw(4,4,0,0),s.end(),this.device.queue.submit([r.finish()])}static isSupport(t){return t instanceof VideoFrame&&!n.some((e=>e===t.colorSpace.primaries))}}},15045:(t,e,r)=>{"use strict";r.d(e,{A:()=>d});var i=r(134),s=r(4624),a=r(43356),n=r(72739),o=r(38469);const c="src\\avrender\\image\\WebGPURender.ts";class d extends a.A{constructor(t,e){super(t,e),(0,i.A)(this,"adapter",void 0),(0,i.A)(this,"device",void 0),(0,i.A)(this,"context",void 0),(0,i.A)(this,"vsModule",void 0),(0,i.A)(this,"fsModule",void 0),(0,i.A)(this,"rotateMatrixBuffer",void 0),(0,i.A)(this,"renderPipeline",void 0),(0,i.A)(this,"rotateMatrix",void 0),(0,i.A)(this,"vbo",void 0),(0,i.A)(this,"sampler",void 0),(0,i.A)(this,"vertex",void 0),(0,i.A)(this,"fragmentSource",void 0),(0,i.A)(this,"vertexSource",void 0),(0,i.A)(this,"renderBundleEncoder",void 0),(0,i.A)(this,"renderBundle",void 0),(0,i.A)(this,"bindGroupLayout",void 0),(0,i.A)(this,"bindGroup",void 0),(0,i.A)(this,"pipelineLayout",void 0)}async init(t){var e;this.adapter=await navigator.gpu.requestAdapter({powerPreference:null!==(e=this.options.powerPreference)&&void 0!==e?e:"high-performance"}),this.adapter||s.h2("not support webgpu render",c,86);const r=[];n.__(t,(t=>{this.adapter.features.has(t)&&r.push(t)})),this.device=await this.adapter.requestDevice({requiredFeatures:r.length?r:void 0}),this.device.lost.then((()=>{var t;this.destroyed||(this.lost=!0,s.z3("gpu device lost",c,105),null!==(t=this.options)&&void 0!==t&&t.onRenderContextLost&&this.options.onRenderContextLost())})),this.context=this.canvas.getContext("webgpu"),this.context||s.h2("can not support webgpu, got GPUCanvasContext failed",c,114),this.context.configure({device:this.device,format:navigator.gpu.getPreferredCanvasFormat(),alphaMode:"premultiplied"}),this.sampler=this.device.createSampler({magFilter:"linear",minFilter:"linear"}),this.vbo=this.device.createBuffer({size:28*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST}),this.rotateMatrixBuffer=this.device.createBuffer({size:16*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.setRotateMatrix(this.getRotateMatrix(0))}generatePipeline(){this.generateBindGroup(),this.pipelineLayout=this.device.createPipelineLayout({bindGroupLayouts:[this.bindGroupLayout]}),this.vsModule=this.device.createShaderModule({code:this.vertexSource}),this.fsModule=this.device.createShaderModule({code:this.fragmentSource}),this.renderPipeline=this.device.createRenderPipeline({layout:this.pipelineLayout,vertex:{module:this.vsModule,entryPoint:"main",buffers:[{arrayStride:28,attributes:[{shaderLocation:0,offset:0,format:"float32x3"},{shaderLocation:1,offset:12,format:"float32x4"}]}]},fragment:{module:this.fsModule,entryPoint:"main",targets:[{format:navigator.gpu.getPreferredCanvasFormat()}]},primitive:{topology:"triangle-strip"}})}generateRenderBundleEncoder(){this.renderPipeline&&(this.renderBundleEncoder=this.device.createRenderBundleEncoder({colorFormats:[navigator.gpu.getPreferredCanvasFormat()]}),this.renderBundleEncoder.setPipeline(this.renderPipeline),this.renderBundleEncoder.setBindGroup(0,this.bindGroup),this.renderBundleEncoder.setVertexBuffer(0,this.vbo),this.renderBundleEncoder.draw(4,4,0,0),this.renderBundle=this.renderBundleEncoder.finish())}setRotateMatrix(t){this.rotateMatrix=t;const e=new Float32Array(this.rotateMatrix);this.device.queue.writeBuffer(this.rotateMatrixBuffer,0,e.buffer,e.byteOffset,e.byteLength)}setVertices(){const t=new Float32Array(this.vertex);this.device.queue.writeBuffer(this.vbo,0,t.buffer,t.byteOffset,t.byteLength)}clear(){this.context.getCurrentTexture().destroy()}layout(){let t=this.videoWidth,e=this.videoHeight,r=this.canvasWidth,i=this.canvasHeight,s=this.textureWidth;this.options.sar&&1!==this.options.sar&&(t=Math.floor(this.videoWidth*this.options.sar),s=Math.floor(this.textureWidth*this.options.sar)),90!==this.rotate&&270!==this.rotate||(r=this.canvasHeight,i=this.canvasWidth);const a=t/r,n=e/i;let c;c=a>1?!(a<n):a>n,1===this.renderMode&&(c=!c);let d=0;if(s!==t&&(d=(s-t)/s),c){const s=(i-e*r/t)/i;this.vertex=[-1,1-s,0,0,0,0,0,-1,-1+s,0,0,1,0,0,1,1-s,0,1-d,0,0,0,1,-1+s,0,1-d,1,0,0]}else{const s=(r-t*i/e)/r;this.vertex=[-1+s,1,0,0,0,0,0,-1+s,-1,0,0,1,0,0,1-s,1,0,1-d,0,0,0,1-s,-1,0,1-d,1,0,0]}(0,o.A)(this.vertex,this.flipHorizontal,this.flipVertical),this.setVertices()}viewport(t,e){super.viewport(t,e)}setRotate(t,e=!0){(t%=360)!==this.rotate&&(this.rotate=t,this.setRotateMatrix(this.getRotateMatrix(t)),this.layout(),e&&this.clear())}destroy(){this.sampler=null,this.vbo&&this.vbo.destroy(),this.rotateMatrixBuffer&&this.rotateMatrixBuffer.destroy(),this.bindGroupLayout=null,this.bindGroup=null,this.pipelineLayout=null,this.renderBundle=null,this.renderBundleEncoder=null,this.fsModule=null,this.vsModule=null,this.renderPipeline=null,this.rotateMatrix=null,this.vertex=null,this.context=null,this.options=null,this.destroyed=!0,this.device&&(this.device.destroy(),this.device=null),this.adapter&&(this.adapter=null),super.destroy()}}},63849:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(134),s=r(72703),a=r(43356),n=r(86932),o=r(89188);class c extends a.A{constructor(t){super({width:0,height:0},{devicePixelRatio:1,renderMode:0}),(0,i.A)(this,"writableStream",void 0),(0,i.A)(this,"writer",void 0),this.writableStream=t}async init(){this.writer=this.writableStream.getWriter()}clear(){}render(t){t=t instanceof VideoFrame?new VideoFrame(t,{timestamp:1e3*(0,n.A)(),rotation:(this.rotate+(this.flipVertical?180:0))%360,flip:(this.flipHorizontal||this.flipVertical)&&!(this.flipHorizontal&&this.flipVertical)}):(0,o.pt)(t,BigInt(1e3*(0,n.A)()),{rotation:(this.rotate+(this.flipVertical?180:0))%360,flip:(this.flipHorizontal||this.flipVertical)&&!(this.flipHorizontal&&this.flipVertical)}),this.writer.write(t)}layout(){}setRotate(t,e=!0){(t%=360)!==this.rotate&&(this.rotate=t,e&&this.clear())}static isSupport(t){return t instanceof VideoFrame||(0,s.A)(t)}}},6110:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(134),s=r(12535),a=r(1064),n=r(86141),o=r(91131);class c{constructor(t,e,r,s){(0,i.A)(this,"matrixId",void 0),(0,i.A)(this,"primaryId",void 0),(0,i.A)(this,"transferId",void 0),(0,i.A)(this,"rangeId",void 0),this.matrixId=t,this.primaryId=e,this.transferId=r,this.rangeId=s}getMatrixId(){return this.matrixId}getPrimaryId(){return this.primaryId}getTransferId(){return this.transferId}getRangeId(){return this.rangeId}isWide(){return 9===this.primaryId||11===this.primaryId||12===this.primaryId}isHDR(){return 18===this.transferId||16===this.transferId}isToneMappedByDefault(){return 18===this.transferId||16===this.transferId}isAffectedBySDRWhiteLevel(){return 18===this.transferId||16===this.transferId}fullRangeEncodedValues(){return 12===this.transferId||11===this.transferId}getTransformMatrix(t){const e=(1<<t-1)/((1<<t)-1);let r=0,i=0;switch(this.matrixId){case 0:return new s.A;case 1:case 2:r=.2126,i=.0722;break;case 4:r=.3,i=.11;break;case 5:case 6:r=.299,i=.114;break;case 7:r=.212,i=.087;break;case 8:return s.A.RowMajor([.25,.5,.25,0,-.25,.5,-.25,e,.5,0,-.5,e,0,0,0,1]);case 10:return r=.2627,i=.0593,s.A.RowMajor([1,0,0,0,r,1-r-i,i,0,0,0,1,0,0,0,0,1]);case 9:r=.2627,i=.0593;break;case 11:return s.A.RowMajor([0,1,0,0,0,-.5,.493283,.5,.5,-.495951,0,.5,0,0,0,1])}let a=1-r-i,n=.5/(1-i),o=.5/(1-r);return s.A.RowMajor([r,a,i,0,n*-r,n*-a,n*(1-i),.5,o*(1-r),o*-a,o*-i,.5,0,0,0,1])}getRangeAdjustMatrix(t){if(2===this.rangeId)return new s.A;const e=t-8,r=(1<<t)-1,i=r/(219<<e);switch(this.matrixId){case 0:case 8:return(new s.A).setScale(new a.P([i,i,i])).postTranslate(new a.P([-16/219,-16/219,-16/219]));case 1:case 4:case 5:case 6:case 7:case 9:case 10:case 11:case 2:{const t=224<<e,n=r/t,o=(t-r)/(2*t);return(new s.A).setScale(new a.P([i,n,n])).postTranslate(new a.P([-16/219,o,o]))}}return new s.A}getTransferFunction_(){switch(this.transferId){case 8:return n.Hi;case 4:return n.$_;case 5:return n.J7;case 7:return n.q;case 1:case 6:case 14:case 15:return n.aP;case 17:return n.Cr;case 18:case 12:case 9:case 10:case 16:case 2:return null}}getTransferFunction(t){return this.transferId,this.getTransferFunction_()}getInverseTransferFunction(t){const e=this.getTransferFunction(t);if(e){const t={a:0,b:0,c:0,d:0,e:0,f:0,g:0};if(e.a>0&&e.g>0){const r=Math.pow(e.a,e.g);t.a=1/r,t.b=-e.e/r,t.g=1/e.g}return t.d=e.c*e.d+e.f,t.e=-e.b/e.a,0!=e.c&&(t.c=1/e.c,t.f=-e.f/e.c),t}}hasExtendedSkTransferFn(){return 0===this.matrixId}isValid(){return 2!==this.matrixId&&2!==this.primaryId&&2!==this.transferId&&0!==this.rangeId}getColorSpacePrimaries(){const t=o.WO;switch(this.primaryId){case 1:return o.P5;case 4:return o.Wc;case 5:return o.cA;case 7:return o.vi;case 8:return o.cp;case 9:return o.Je;case 10:return o.lf;case 11:return o.Rk;case 12:return o.tR}return t}getPrimaryMatrix(){const t=this.getColorSpacePrimaries(),e=o._O(t);return s.A.RowMajor([e.rc(0,0),e.rc(0,1),e.rc(0,2),0,e.rc(1,0),e.rc(1,1),e.rc(1,2),0,e.rc(2,0),e.rc(2,1),e.rc(2,2),0,0,0,0,1])}}},91131:(t,e,r)=>{"use strict";r.d(e,{Je:()=>u,P5:()=>o,Rk:()=>p,WO:()=>g,Wc:()=>c,_O:()=>v,cA:()=>d,cp:()=>l,lf:()=>f,tR:()=>m,vi:()=>h});var i=r(45726),s=r(1064),a=r(66551),n=r(60153);const o=[.64,.33,.3,.6,.15,.06,.3127,.329],c=[.67,.33,.21,.71,.14,.08,.31,.316],d=[.64,.33,.29,.6,.15,.06,.3127,.329],h=[.63,.34,.31,.595,.155,.07,.3127,.329],l=[.681,.319,.243,.692,.145,.049,.31,.316],u=[.708,.292,.17,.797,.131,.046,.3127,.329],f=[1,0,0,1,0,0,.3333333333333333,.3333333333333333],p=[.68,.32,.265,.69,.15,.06,.314,.351],m=[.68,.32,.265,.69,.15,.06,.3127,.329],g=[0,0,0,0,0,0,0,0];function v(t){const e=i.A.RowMajor([t[0],t[2],t[4],t[1],t[3],t[5],1-t[0]-t[1],1-t[2]-t[3],1-t[4]-t[5]]),r=e.copy().invert(),o=new s.P([t[6]/t[7],1,(1-t[6]-t[7])/t[7]]),c=(0,n.Y3)(r,o);let d=new i.A([c.x,0,0,0,c.y,0,0,0,c.z]);d=(0,a.B)(e,d);const h=function(t,e){const r=new s.P([t/e,1,(1-t-e)/e]),o=new s.P([.96422,1,.82521]),c=i.A.RowMajor([.8951,.2664,-.1614,-.7502,1.7135,.0367,.0389,-.0685,1.0296]),d=i.A.RowMajor([.9869929,-.1470543,.1599627,.4323053,.5183603,.0492912,-.0085287,.0400428,.9684867]),h=(0,n.Y3)(c,r),l=(0,n.Y3)(c,o);let u=new i.A([l.x/h.x,0,0,0,l.y/h.y,0,0,0,l.z/h.z]);return u=(0,a.B)(u,c),u=(0,a.B)(d,u),u}(t[6],t[7]);return(0,a.B)(h,d)}},86141:(t,e,r)=>{"use strict";r.d(e,{$_:()=>i,Cr:()=>c,Hi:()=>n,J7:()=>s,aP:()=>o,q:()=>a});const i={g:2.2,a:1,b:0,c:0,d:0,e:0,f:0},s={g:2.8,a:1,b:0,c:0,d:0,e:0,f:0},a={g:2.222222222222,a:.899626676224,b:.100373323776,c:.25,d:.091286342118,e:0,f:0},n={g:1,a:1,b:0,c:0,d:0,e:0,f:0},o={g:2.4,a:.9478672985781991,b:.05213270142180095,c:.07739938080495357,d:.04045,e:0,f:0},c={g:2.6,a:1.034080527699,b:0,c:0,d:0,e:0,f:0}},89401:(t,e,r)=>{"use strict";r.d(e,{A:()=>o,U:()=>n});const i=.2627,s=.678,a=.0593;function n(t){t.metadata.hlgOOTFGammaMinusOne=.2}function o(t){return 0===t.type?`\n      {\n        vec4 luma_vec = vec4(${i}, ${s}, ${a}, 0.0);\n        float L = dot(color, luma_vec);\n        if (L > 0.0) {\n          color.r *= pow(L, hlg_ootf_gamma_minus_one);\n          color.g *= pow(L, hlg_ootf_gamma_minus_one);\n          color.b *= pow(L, hlg_ootf_gamma_minus_one);\n        }\n      }\n    `:1===t.type?`\n      {\n        let luma_vec: vec4<f32> = vec4(${i}, ${s}, ${a}, 0.0);\n        let L: f32 = dot(color, luma_vec);\n        if (L > 0.0) {\n          color.r *= pow(L, hlg_ootf_gamma_minus_one);\n          color.g *= pow(L, hlg_ootf_gamma_minus_one);\n          color.b *= pow(L, hlg_ootf_gamma_minus_one);\n        }\n      }\n    `:""}},7511:(t,e,r)=>{"use strict";function i(t,e){let r="",i="";if(0===e.type?(r="mat4",i="vec4"):1===e.type&&(r="mat4x4",i="vec4"),!r||!i)return"";let s=`\n      color = ${r}(\n        ${t.rc(0,0)}, ${t.rc(1,0)}, ${t.rc(2,0)}, 0,\n        ${t.rc(0,1)}, ${t.rc(1,1)}, ${t.rc(2,1)}, 0,\n        ${t.rc(0,2)}, ${t.rc(1,2)}, ${t.rc(2,2)}, 0,\n        0, 0, 0, 1\n      ) * color;\n    `;return 0===t.rc(0,3)&&0===t.rc(1,3)&&0===t.rc(2,3)||(s+=`\n        color += ${i}(${t.rc(0,3)}, ${t.rc(1,3)}, ${t.rc(2,3)}, 0);\n      `),s}r.d(e,{A:()=>i})},79955:(t,e,r)=>{"use strict";function i(t,e){e.metadata.sdrRelativeToNitsFactor=e.dstSdrMaxLuminanceNits/t}function s(t){return"\n    color.r *= sdr_relative_to_nits_factor;\n    color.g *= sdr_relative_to_nits_factor;\n    color.b *= sdr_relative_to_nits_factor;\n "}r.d(e,{A:()=>s,j:()=>i})},64748:(t,e,r)=>{"use strict";r.d(e,{A:()=>a,n:()=>s});var i=r(57517);function s(t,e,r){let s=r.dstSdrMaxLuminanceNits;e&&(s=i.kH,r.sdrWhiteLevel&&(s=r.sdrWhiteLevel)),r.metadata.nitsToSdrRelativeFactor=t/s}function a(t){return"\n    color.r *= nits_to_sdr_relative_factor;\n    color.g *= nits_to_sdr_relative_factor;\n    color.b *= nits_to_sdr_relative_factor;\n  "}},70194:(t,e,r)=>{"use strict";r.d(e,{A:()=>a,J:()=>s});var i=r(57517);function s(t,e){const r=function(t,e){let r=i.hD;18!==t.getTransferId()&&e.maxContentLightLevel>0&&(r=e.maxContentLightLevel);let s=i.kH;return e.sdrWhiteLevel&&(s=e.sdrWhiteLevel),r/s}(t,e);r>e.dstMaxLuminanceRelative?(e.metadata.pqTonemapA=e.dstMaxLuminanceRelative/(r*r),e.metadata.pqTonemapB=1/e.dstMaxLuminanceRelative):(e.metadata.pqTonemapA=0,e.metadata.pqTonemapB=0)}function a(t){return`\n    {\n      ${1===t.type?"let maximum: f32":"float maximum"} = max(color.r, max(color.g, color.b));\n      if (maximum > 0.0) {\n        color.r *= (1.0 + pq_tonemap_a * maximum) / (1.0 + pq_tonemap_b * maximum);\n        color.g *= (1.0 + pq_tonemap_a * maximum) / (1.0 + pq_tonemap_b * maximum);\n        color.b *= (1.0 + pq_tonemap_a * maximum) / (1.0 + pq_tonemap_b * maximum);\n      }\n    }\n `}},15380:(t,e,r)=>{"use strict";function i(t){return t===t>>>0?`${t}.0`:t.toString()}r.d(e,{A:()=>i})},25669:(t,e,r)=>{"use strict";r.d(e,{A:()=>v});var i=r(6110),s=r(57517),a=r(7511),n=r(5361),o=r(63921),c=r(55168),d=r(16307),h=r(89401),l=r(64748),u=r(70194),f=r(79955),p=r(84272),m=r(51025),g=r(40326);function v(t,e,r){const v=[],A=8===t.getMatrixId(),y=(0,a.A)(t.getRangeAdjustMatrix(r.bitDepth),r);if(A||v.push(y),v.push((0,a.A)(t.getTransformMatrix(r.bitDepth).invert(),r)),A&&v.push(y),e.isValid()){if(t.isHDR()){switch(t.getTransferId()){case 18:v.push((0,n.A)(r));break;case 16:v.push((0,o.A)(r));break;default:const e=t.getTransferFunction();e?v.push((0,c.A)(e,t.hasExtendedSkTransferFn(),r)):v.push((0,d.A)(t.getTransferId(),r))}10===t.getMatrixId()&&v.push((0,a.A)(t.getTransformMatrix(r.bitDepth).invert(),r)),v.push((0,a.A)(t.getPrimaryMatrix(),r));const A=new i.A(0,9,8,2);switch(t.getTransferId()){case 18:v.push((0,a.A)(A.getPrimaryMatrix().invert(),r)),(0,h.U)(r),v.push((0,h.A)(r)),(0,l.n)(s.hD,!0,r),v.push((0,l.A)(r)),r.toneMapPQAndHlgToDst&&((0,u.J)(t,r),v.push((0,u.A)(r))),v.push((0,a.A)(A.getPrimaryMatrix(),r));break;case 16:(0,l.n)(s.th,!0,r),v.push((0,l.A)(r)),r.toneMapPQAndHlgToDst&&(v.push((0,a.A)(A.getPrimaryMatrix().invert(),r)),(0,u.J)(t,r),v.push((0,u.A)(r)),v.push((0,a.A)(A.getPrimaryMatrix(),r)))}switch(v.push((0,a.A)(e.getPrimaryMatrix().invert(),r)),10===e.getMatrixId()&&v.push((0,a.A)(e.getTransformMatrix(r.bitDepth),r)),e.getTransferId()){case 18:(0,f.j)(s.kH,r),v.push((0,f.A)(r)),v.push((0,p.A)(r));break;case 16:(0,f.j)(s.th,r),v.push((0,f.A)(r)),v.push((0,m.A)(r));default:const i=e.getInverseTransferFunction();i?v.push((0,c.A)(i,t.hasExtendedSkTransferFn(),r)):v.push((0,g.A)(t.getTransferId(),r))}}if(!r.outputRGB){const t=8===e.getMatrixId(),i=(0,a.A)(e.getRangeAdjustMatrix(r.bitDepth).invert(),r);t&&v.push(i),v.push((0,a.A)(e.getTransformMatrix(r.bitDepth),r)),t||v.push(i)}}return v}},57517:(t,e,r)=>{"use strict";r.d(e,{hD:()=>s,kH:()=>i,th:()=>a});const i=203,s=1e3,a=1e4},71323:(t,e,r)=>{"use strict";function i(t,e,r){return e?`\n      {\n        ${1===r.type?"var v: f32":"float v"} = abs(color.r);\n        ${t()}\n        color.r = sign(color.r) * v;\n      }\n      {\n        ${1===r.type?"var v: f32":"float v"} = abs(color.g);\n        ${t()}\n        color.g = sign(color.g) * v;\n      }\n      {\n        ${1===r.type?"var v: f32":"float v"} = abs(color.b);\n        ${t()}\n        color.b = sign(color.b) * v;\n      }\n    `:`\n      {\n        ${1===r.type?"var v: f32":"float v"} = color.r;\n        ${t()}\n        color.r = v;\n      }\n      {\n        ${1===r.type?"var v: f32":"float v"} = color.g;\n        ${t()}\n        color.g = v;\n      }\n      {\n        ${1===r.type?"var v: f32":"float v"} = color.b;\n        ${t()}\n        color.b = v;\n      }\n    `}r.d(e,{A:()=>i})},40326:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(71323);function s(t,e){return(0,i.A)((function(){switch(t){case 9:return"\n          if (v < 0.0) {\n            v = 0.0;\n          }\n          else {\n            v =  1.0 + log(v) / log(10.0) / 2.0;\n          }\n        ";case 10:return"\n          if (v < sqrt(10.0) / 1000.0)\n            v = 0.0;\n          }\n          else {\n            v = 1.0 + log(v) / log(10.0) / 2.5;\n          }\n        ";case 11:return`\n          ${1===e.type?"let a: f32":"float a"} = 1.099296826809442;\n          ${1===e.type?"let b: f32":"float b"}= 0.018053968510807;\n          if (v < -b) {\n            v = -a * pow(-v, 0.45) + (a - 1.0);\n          }\n          else if (v <= b) {\n            v = 4.5 * v;\n          }\n          else {\n            v = a * pow(v, 0.45) - (a - 1.0);\n          }\n        `;case 12:return`\n          ${1===e.type?"let a: f32":"float a"} = 1.099;\n          ${1===e.type?"let b: f32":"float b"} = 0.018;\n          ${1===e.type?"let l: f32":"float l"} = 0.0045;\n\n          if (v < -l) {\n            v = -(a * pow(-4.0 * v, 0.45) + (a - 1.0)) / 4.0;\n          }\n          else if (v <= b) {\n            v = 4.5 * v;\n          }\n          else {\n            v = a * pow(v, 0.45) - (a - 1.0);\n          }\n        `;default:return""}}),!1,e)}},5361:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(71323);function s(t){return(0,i.A)((function(){return`\n      v = max(0.0, v);\n      ${1===t.type?"let a: f32":"float a"} = 0.17883277;\n      ${1===t.type?"let b: f32":"float b"} = 0.28466892;\n      ${1===t.type?"let c: f32":"float c"} = 0.55991073;\n      if (v <= 0.5) {\n        v = v * v * 4.0;\n      }\n      else {\n        v = exp((v - c) / a) + b;\n      }\n      v = v / 12.0;\n    `}),!1,t)}},84272:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(71323);function s(t){return(0,i.A)((function(){return`\n      v = max(0.0, v);\n      ${1===t.type?"let a: f32":"float a"} = 0.17883277;\n      ${1===t.type?"let b: f32":"float b"} = 0.28466892;\n      ${1===t.type?"let c: f32":"float c"} = 0.55991073;\n      if (v <= 1.0) {\n        v = 0.5 * sqrt(v);\n      }\n      else {\n        v = a * log(v - b) + c;\n      }\n    `}),!1,t)}},63921:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(71323);function s(t){return(0,i.A)((function(){return`\n      v = max(0.0, v);\n      ${1===t.type?"let m1: f32":"float m1"} = (2610.0 / 4096.0) / 4.0;\n      ${1===t.type?"let m2: f32":"float m2"} = (2523.0 / 4096.0) * 128.0;\n      ${1===t.type?"let c1: f32":"float c1"} = 3424.0 / 4096.0;\n      ${1===t.type?"let c2: f32":"float c2"} = (2413.0 / 4096.0) * 32.0;\n      ${1===t.type?"let c3: f32":"float c3"} = (2392.0 / 4096.0) * 32.0;\n      \n      ${0===t.type?"\n        #ifdef GL_FRAGMENT_PRECISION_HIGH\n        highp float v2 = v;\n        #else\n        float v2 = v;\n        #endif\n      ":"var v2: f32 = v;"}\n  \n      v2 = pow(max(pow(v2, 1.0 / m2) - c1, 0.0) / (c2 - c3 * pow(v2, 1.0 / m2)), 1.0 / m1);\n      v = v2;\n    `}),!1,t)}},51025:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(71323);function s(t){return(0,i.A)((function(){return`\n      v = max(0.0, v);\n      ${1===t.type?"let m1: f32":"float m1"} = (2610.0 / 4096.0) / 4.0;\n      ${1===t.type?"let m2: f32":"float m2"} = (2523.0 / 4096.0) * 128.0;\n      ${1===t.type?"let c1: f32":"float c1"} = 3424.0 / 4096.0;\n      ${1===t.type?"let c2: f32":"float c2"} = (2413.0 / 4096.0) * 32.0;\n      ${1===t.type?"let c3: f32":"float c3"} = (2392.0 / 4096.0) * 32.0;\n      v =  pow((c1 + c2 * pow(v, m1)) / (1.0 + c3 * pow(v, m1)), m2);\n    `}),!1,t)}},16307:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(71323);function s(t,e){return(0,i.A)((function(){switch(t){case 9:return"\n          if (v < 0.0) {\n            v = 0.0;\n          }\n          else {\n            v = pow(10.0, (v - 1.0) * 2.0);\n          }\n        ";case 10:return"\n          if (v < 0.0) {\n            v = 0.0;\n          }\n          else {\n            v = pow(10.0, (v - 1.0) * 2.5);\n          }\n        ";case 11:return`\n          ${1===e.type?"let a: f32":"float a"} = 1.099296826809442;\n          ${1===e.type?"let from_linear_neg_a: f32":"float from_linear_neg_a"} = -1.047844;\n          ${1===e.type?"let from_linear_b: f32":"float from_linear_b"} = 0.081243;\n          if (v < from_linear_neg_a) {\n            v = -pow((a - 1.0 - v) / a, 1.0 / 0.45);\n          }\n          else if (v <= from_linear_b) {\n            v = v / 4.5;\n          }\n          else {\n            v = pow((v + a - 1.0) / a, 1.0 / 0.45);\n          }\n        `;case 12:return`\n          ${1===e.type?"let a: f32":"float a"} = 1.099;\n          ${1===e.type?"let from_linear_neg_l: f32":"float from_linear_neg_l"} = -0.020250;\n          ${1===e.type?"let from_linear_b: f32":"float from_linear_b"} = 0.081000;\n          if (v < from_linear_neg_l) {\n            v = -pow((1.0 - a - v * 4.0) / a, 1.0 / 0.45) / 4.0;\n          }\n          else if (v <= from_linear_b) {\n            v = v / 4.5;\n          }\n          else {\n            v = pow((v + a - 1.0) / a, 1.0 / 0.45);\n          }\n        `;default:return""}}),!1,e)}},55168:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(71323),s=r(15380);function a(t,e,r){return(0,i.A)((function(){let e=.0009765625,r="v";Math.abs(t.c-1)>e&&(r=`${(0,s.A)(t.c)} * ${r}`),Math.abs(t.f)>e&&(r=`${r} + ${(0,s.A)(t.f)}`);let i="v";return Math.abs(t.a=1)>e&&(i=`${(0,s.A)(t.a)} * ${i}`),Math.abs(t.b)>e&&(i=`${i} + ${(0,s.A)(t.b)}`),Math.abs(t.g-1)>e&&(i=`pow(${i}, ${(0,s.A)(t.g)})`),Math.abs(t.e)>e&&(i=`${i} + ${(0,s.A)(t.e)}`),`\n      if (v < ${(0,s.A)(t.d)}) {\n        v = ${r};\n      }\n      else {\n        v = ${i};\n      }\n    `}),!1,r)}},38469:(t,e,r)=>{"use strict";function i(t,e,r){if(e){let e=t[3],r=t[4];t[3]=t[17],t[4]=t[18],t[17]=e,t[18]=r,e=t[10],r=t[11],t[10]=t[24],t[11]=t[25],t[24]=e,t[25]=r}if(r){let e=t[3],r=t[4];t[3]=t[10],t[4]=t[11],t[10]=e,t[11]=r,e=t[17],r=t[18],t[17]=t[24],t[18]=t[25],t[24]=e,t[25]=r}}r.d(e,{A:()=>i})},20088:(t,e,r)=>{"use strict";r.d(e,{A:()=>h});var i,s,a=r(134),n=r(80662),o=r.n(n),c=r(61499),d=r(12085);class h{constructor(){(0,a.A)(this,"offset",void 0),(0,a.A)(this,"multiplier",void 0),(0,a.A)(this,"pqTonemapA",void 0),(0,a.A)(this,"pqTonemapB",void 0),(0,a.A)(this,"hlgOOTFGammaMinusOne",void 0),(0,a.A)(this,"nitsToSdrRelativeFactor",void 0),(0,a.A)(this,"sdrRelativeToNitsFactor",void 0)}}i=h.prototype,(s=new(o())).set("offset",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("multiplier",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("pqTonemapA",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),s.set("pqTonemapB",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),s.set("hlgOOTFGammaMinusOne",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),s.set("nitsToSdrRelativeFactor",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),s.set("sdrRelativeToNitsFactor",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),(0,d.A)(i,c.Og,!0),(0,d.A)(i,c.dc,4),(0,d.A)(i,c.g7,28),(0,d.A)(i,c.JY,s)},36719:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(9188);class a extends s.A{constructor(t,e,r=!0){super(t,e),(0,i.A)(this,"enableColor",void 0),(0,i.A)(this,"aPoint",void 0),(0,i.A)(this,"aColor",void 0),this.enableColor=r}link(t){super.link(t),this.aPoint=this.gl.getAttribLocation(this.program,"point"),this.aColor=this.gl.getAttribLocation(this.program,"color"),this.enableColor?(this.gl.enableVertexAttribArray(this.aPoint),this.gl.enableVertexAttribArray(this.aColor)):this.gl.enableVertexAttribArray(this.aPoint)}bind(){super.bind(),this.enableColor?(this.gl.vertexAttribPointer(this.aPoint,3,this.gl.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,0),this.gl.vertexAttribPointer(this.aColor,4,this.gl.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,3*Float32Array.BYTES_PER_ELEMENT)):this.gl.vertexAttribPointer(this.aPoint,3,this.gl.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,0)}}},9188:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(134);r(4624);class s{constructor(t,e){(0,i.A)(this,"gl",void 0),(0,i.A)(this,"_program",void 0),(0,i.A)(this,"vertexShader",void 0),(0,i.A)(this,"fragmentShader",void 0),this.vertexShader=t,this.fragmentShader=e}link(t){this.gl=t,this.vertexShader&&this.vertexShader.compile(this.gl),this.fragmentShader&&this.fragmentShader.compile(this.gl),this._program=this.gl.createProgram(),this.gl.attachShader(this._program,this.vertexShader.shader),this.gl.attachShader(this._program,this.fragmentShader.shader),this.gl.linkProgram(this._program)}stop(){this.vertexShader.stop(this.gl),this.fragmentShader.stop(this.gl),this.gl.deleteProgram(this._program),this.vertexShader=null,this.fragmentShader=null,this._program=null}bind(){this.gl.useProgram(this._program)}get program(){return this._program}}},24399:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(134),s=r(36719),a=r(37022),n=r(36200),o=r(84209);class c extends s.A{constructor(t,e){super(new a.A(e||o.A),new n.A(t)),(0,i.A)(this,"rotateMatrixLocation",void 0),(0,i.A)(this,"ySamplerLocation",void 0),(0,i.A)(this,"uSamplerLocation",void 0),(0,i.A)(this,"vSamplerLocation",void 0),(0,i.A)(this,"aSamplerLocation",void 0)}link(t){super.link(t),this.rotateMatrixLocation=this.gl.getUniformLocation(this.program,"rotateMatrix"),this.ySamplerLocation=this.gl.getUniformLocation(this.program,"y_Sampler"),this.uSamplerLocation=this.gl.getUniformLocation(this.program,"u_Sampler"),this.vSamplerLocation=this.gl.getUniformLocation(this.program,"v_Sampler"),this.aSamplerLocation=this.gl.getUniformLocation(this.program,"a_Sampler")}setRotateMatrix(t){this.gl.uniformMatrix4fv(this.rotateMatrixLocation,!1,new Float32Array(t))}bindYTexture(t=0){this.gl.uniform1i(this.ySamplerLocation,t)}bindUTexture(t=0){this.gl.uniform1i(this.uSamplerLocation,t)}bindVTexture(t=0){this.gl.uniform1i(this.vSamplerLocation,t)}bindATexture(t=0){this.gl.uniform1i(this.aSamplerLocation,t)}}},25408:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(24399);class a extends s.A{constructor(t,e){super(t,e),(0,i.A)(this,"offsetLocation",void 0),(0,i.A)(this,"multiplierLocation",void 0),(0,i.A)(this,"pqTonemapALocation",void 0),(0,i.A)(this,"pqTonemapBLocation",void 0),(0,i.A)(this,"hlgOOTFGammaMinusOneLocation",void 0),(0,i.A)(this,"hlgDstMaxLuminanceRelativeLocation",void 0),(0,i.A)(this,"nitsToSdrRelativeFactorLocation",void 0),(0,i.A)(this,"sdrRelativeToNitsFactorLocation",void 0)}link(t){super.link(t),this.offsetLocation=this.gl.getUniformLocation(this.program,"offset"),this.multiplierLocation=this.gl.getUniformLocation(this.program,"multiplier"),this.pqTonemapALocation=this.gl.getUniformLocation(this.program,"pq_tonemap_a"),this.pqTonemapBLocation=this.gl.getUniformLocation(this.program,"pq_tonemap_b"),this.hlgOOTFGammaMinusOneLocation=this.gl.getUniformLocation(this.program,"hlg_ootf_gamma_minus_one"),this.nitsToSdrRelativeFactorLocation=this.gl.getUniformLocation(this.program,"nits_to_sdr_relative_factor"),this.sdrRelativeToNitsFactorLocation=this.gl.getUniformLocation(this.program,"sdr_relative_to_nits_factor")}setMetaData(t){this.gl.uniform1f(this.offsetLocation,t.offset),this.gl.uniform1f(this.multiplierLocation,t.multiplier),this.gl.uniform1f(this.pqTonemapALocation,t.pqTonemapA),this.gl.uniform1f(this.pqTonemapBLocation,t.pqTonemapB),this.gl.uniform1f(this.hlgOOTFGammaMinusOneLocation,t.hlgOOTFGammaMinusOne),this.gl.uniform1f(this.nitsToSdrRelativeFactorLocation,t.nitsToSdrRelativeFactor),this.gl.uniform1f(this.sdrRelativeToNitsFactorLocation,t.sdrRelativeToNitsFactor)}}},18915:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(24399);class s extends i.A{constructor(t,e){super(t,e)}}},36200:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(27976);class s extends i.A{constructor(t){super(1,t)}}},27976:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(134);r(4624);class s{constructor(t,e){(0,i.A)(this,"type",void 0),(0,i.A)(this,"_shader",void 0),(0,i.A)(this,"_source",void 0),(0,i.A)(this,"compiled",void 0),this.type=t,this._shader=null,this._source=e,this.compiled=!1}compile(t){this.compiled||(this._shader=t.createShader(0===this.type?t.VERTEX_SHADER:t.FRAGMENT_SHADER),t.shaderSource(this._shader,this._source),t.compileShader(this._shader),this.compiled=!0)}stop(t){t.deleteShader(this._shader),this._shader=null}get shader(){return this._shader}}},37022:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(27976);class s extends i.A{constructor(t){super(0,t)}}},22684:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(67672);class a{constructor(t,e,r){(0,i.A)(this,"gl",void 0),(0,i.A)(this,"width",void 0),(0,i.A)(this,"height",void 0),(0,i.A)(this,"texture",void 0),this.gl=t,this.width=e,this.height=r,this.texture=this.gl.createTexture()}getTexture(){return this.texture}bind(t){s.ai(t)&&this.gl.activeTexture(this.gl.TEXTURE0+t),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture)}setSize(t,e){this.width=t,this.height=e}setUnpackAlignment(){this.width%8==0?this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,8):this.width%4==0?this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,4):this.width%2==0?this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,2):this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1)}destroy(){this.texture&&(this.gl.deleteTexture(this.texture),this.texture=null)}}},18105:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(134),s=r(22684),a=r(4624);class n extends s.A{constructor(t,e,r){super(t,e,r),(0,i.A)(this,"filter",void 0),(0,i.A)(this,"format",void 0),(0,i.A)(this,"internalformat",void 0),(0,i.A)(this,"dataType",void 0),(0,i.A)(this,"firstUploaded",void 0),(0,i.A)(this,"pbo",void 0),this.format=this.gl.LUMINANCE,this.filter=this.gl.LINEAR,this.internalformat=this.gl.LUMINANCE,this.dataType=this.gl.UNSIGNED_BYTE}init(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.firstUploaded=!1}setFormat(t){this.format=t}setInternalformat(t){this.internalformat=t}setDataType(t){this.dataType=t}setFilter(t){this.filter=t}fill(t){if(this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.setUnpackAlignment(),this.firstUploaded)if(this.pbo){const e=this.gl;e.bindBuffer(e.PIXEL_UNPACK_BUFFER,this.pbo),e.bufferSubData(e.PIXEL_UNPACK_BUFFER,0,t),e.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,this.width,this.height,this.format,this.dataType,0)}else this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,this.width,this.height,this.format,this.dataType,t);else{if("function"==typeof WebGL2RenderingContext&&this.gl instanceof WebGL2RenderingContext)try{this.pbo=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.PIXEL_UNPACK_BUFFER,this.pbo),this.gl.bufferData(this.gl.PIXEL_UNPACK_BUFFER,t,this.gl.STREAM_DRAW),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.internalformat,this.width,this.height,0,this.format,this.dataType,0)}catch(e){this.pbo=null,a.R8("not support pbo","src\\avrender\\image\\webgl\\texture\\VideoTexture.ts",109),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.internalformat,this.width,this.height,0,this.format,this.dataType,t)}else this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.internalformat,this.width,this.height,0,this.format,this.dataType,t);this.firstUploaded=!0}}destroy(){this.pbo&&this.gl.deleteBuffer(this.pbo),super.destroy()}}},48641:(t,e,r)=>{"use strict";r.d(e,{A:()=>g});var i=r(134),s=r(63939),a=r(50932),n=(r(10278),r(37837)),o=r(11473),c=r(84149),d=r(4624),h=r(26429),l=r(44690),u=r(67672),f=r(14686),p=r(86932);const m=l.A.windows||l.A.mac||l.A.linux?20:30;class g{constructor(t,e,r={}){(0,i.A)(this,"context",void 0),(0,i.A)(this,"observer",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"pullIPC",void 0),(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"channels",void 0),(0,i.A)(this,"ended",void 0),(0,i.A)(this,"float32",void 0),(0,i.A)(this,"buffered",void 0),(0,i.A)(this,"pause",void 0),(0,i.A)(this,"startTime",void 0),(0,i.A)(this,"dest",void 0),(0,i.A)(this,"queue",void 0),(0,i.A)(this,"firstRendered",void 0),(0,i.A)(this,"lastStutterTimestamp",void 0),this.context=t,this.observer=e,this.options=r}async request(t,e,r){switch(t){case"init":break;case"start":{const{port:t,channels:r}=e;this.channels=r,this.pullIPC=new c.Ay(t),this.buffer=this.allocBuffer(),this.float32=new Float32Array((0,o.eq)().buffer),this.queue=[],this.startTime=0,this.ended=!1,this.pause=!1,this.firstRendered=!1,this.lastStutterTimestamp=(0,p.A)(),await this.pullInterval(),this.buffering(),await this.pullInterval(),this.buffered=!0,this.process();break}case"restart":if(!this.ended)return;this.buffer=this.allocBuffer(),this.queue=[],this.startTime=0,this.ended=!1,this.pause=!1,this.firstRendered=!1,await this.pullIPC.request("pull",{buffer:this.buffer}),this.buffering(),await this.pullIPC.request("pull",{buffer:this.buffer}),this.buffered=!0,this.lastStutterTimestamp=(0,p.A)(),this.process();break;case"stop":this.freeBuffer(this.buffer),this.buffer=null,this.ended=!0,this.pullIPC.destroy();break;case"clear":this.queue.forEach((t=>{t.disconnect()})),this.queue.length=0;break;case"pause":this.pause=!0;break;case"unpause":this.pause=!1,this.queue.length||this.process()}}allocBuffer(){const t=(0,n.Gy)(48);a.M[20](t,(0,n.Gy)(4*this.channels));const e=(0,n.Gy)(512*m*this.channels);for(let r=0;r<this.channels;r++)a.M[20](s.f[20](t)+4*r,e+128*m*4*r);return a.M[15](t+12,128*m),t}freeBuffer(t){t&&((0,n.aI)(s.f[20](t)),(0,n.aI)(t),(0,n.Eb)(t))}async pullInterval(){let t=0;if(this.options.isMainWorker){const e=await this.pullIPC.request("pullBuffer",{nbSamples:128*m});u.sv(e)?(t=0,(0,f.lW)(s.f[20](s.f[20](this.buffer)),e.byteLength,new Uint8Array(e))):t=e}else t=await this.pullIPC.request("pull",{buffer:this.buffer});return t}async pull(){this.buffered=!1,await this.pullInterval()<0?this.ended=!0:(this.buffered=!0,this.queue.length||this.process())}buffering(){this.float32.length||(this.float32=new Float32Array((0,o.eq)().buffer));const t=this.context.createBuffer(this.channels,128*m,this.context.sampleRate);for(let e=0;e<this.channels;e++)if(s.f[20](s.f[20](this.buffer)+4*e)){let r=s.f[20](s.f[20](this.buffer)+4*e)>>>2;t.copyToChannel&&!h.USE_THREADS?t.copyToChannel(this.float32.subarray(r,r+128*m),e,0):t.getChannelData(e).set(this.float32.subarray(r,r+128*m),0)}const e=this.context.createBufferSource();e.buffer=t,e.onended=()=>{if(this.queue.shift(),this.ended&&!this.queue.length)return this.freeBuffer(this.buffer),d.pq("audio source ended","src\\avrender\\pcm\\AudioSourceBufferNode.ts",257),void this.observer.onEnded();this.process(),this.queue.length||(0,p.A)()-this.lastStutterTimestamp>1e3&&(this.observer.onStutter(),this.lastStutterTimestamp=(0,p.A)()),this.firstRendered||(this.firstRendered=!0,this.observer.onFirstRendered())},0===this.startTime&&(this.startTime=this.context.currentTime),e.start(this.startTime),this.dest&&e.connect(this.dest),this.startTime+=e.buffer.duration,this.queue.push(e)}connect(t){this.dest=t}disconnect(){for(let t=0;t<this.queue.length;t++)this.queue[t].disconnect();this.dest=null,this.queue.length=0}process(){this.buffer&&!this.pause&&this.buffered&&(this.buffering(),this.pull())}}},88397:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(6534);class s extends i.A{constructor(t,e,r={}){super(t,e,"audio-source-processor",r)}}},6534:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(134),s=r(84149),a=r(67672);class n{constructor(t,e,r,a={}){(0,i.A)(this,"audioWorkletNode",void 0),(0,i.A)(this,"ipcPort",void 0),(0,i.A)(this,"observer",void 0),this.observer=e,this.audioWorkletNode=new AudioWorkletNode(t,r,a),this.ipcPort=new s.Ay(this.audioWorkletNode.port),this.ipcPort.on(s.Wo,(t=>{switch(t.method){case"ended":this.observer.onEnded();break;case"firstRendered":this.observer.onFirstRendered();break;case"stutter":this.observer.onStutter()}}))}async request(t,e,r){return this.ipcPort.request(t,e,r)}connect(t){this.audioWorkletNode.connect(t)}getNode(){return this.audioWorkletNode}disconnect(){this.audioWorkletNode.disconnect()}getParameters(t){const e=this.audioWorkletNode.parameters;if(a.Pc(e.get))return e.get(t);e.forEach(((e,r)=>{if(r===t)return e}))}}},41324:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(61837);async function s(t,e){const r=(0,i.A)(e,{varName:"processor"}),s=new Blob([r],{type:"text/javascript"}),a=URL.createObjectURL(s);await t.audioWorklet.addModule(a)}},60120:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i,s=r(134),a=r(95335),n=r(4624);!function(t){t[t.ADD=0]="ADD",t[t.REMOVE=1]="REMOVE",t[t.UPDATE_TIMESTAMP_OFFSET=2]="UPDATE_TIMESTAMP_OFFSET",t[t.CALLBACK=3]="CALLBACK",t[t.CHANGE_MIME_TYPE=4]="CHANGE_MIME_TYPE"}(i||(i={}));const o={mediaBufferMax:10};class c{constructor(t={}){(0,s.A)(this,"sourceBuffer",void 0),(0,s.A)(this,"operatorQueue",void 0),(0,s.A)(this,"updating",void 0),(0,s.A)(this,"lastRemoveTime",void 0),(0,s.A)(this,"paddingCallback",void 0),(0,s.A)(this,"options",void 0),(0,s.A)(this,"ending",void 0),(0,s.A)(this,"onQuotaExceededError",void 0),(0,s.A)(this,"onEnded",void 0),this.options=a.X$({},o,t),this.operatorQueue=[],this.updating=!1,this.lastRemoveTime=0,this.ending=!1}setSourceBuffer(t){this.sourceBuffer&&(this.sourceBuffer.onupdateend=null,this.sourceBuffer.onerror=null),this.sourceBuffer=t,this.sourceBuffer.onupdateend=()=>{this.paddingCallback&&(this.paddingCallback(),this.paddingCallback=null),this.operatorQueue&&this.operatorQueue.length?this.enqueue():(this.updating=!1,this.ending&&this.onEnded&&this.onEnded())},this.sourceBuffer.onerror=t=>{n.z3(`track update buffer error: ${t}`,"src\\avrender\\track\\Track.ts",110)}}changeMimeType(t,e){this.sourceBuffer&&(this.operatorQueue.push({operator:i.CHANGE_MIME_TYPE,type:t,mode:e}),this.updating||this.enqueue())}enqueue(){if(this.operatorQueue.length){const t=this.operatorQueue.shift();if(t.operator===i.ADD)try{this.sourceBuffer.appendBuffer(t.buffer),this.updating=!0,t.callback&&(this.paddingCallback=t.callback)}catch(e){if(!(e instanceof DOMException&&"QuotaExceededError"===e.name))throw e;this.operatorQueue.unshift(t),this.onQuotaExceededError&&this.onQuotaExceededError(),this.updating=!1}else t.operator===i.REMOVE?(this.sourceBuffer.remove(t.start,t.end),this.updating=!0,t.callback&&(this.paddingCallback=t.callback)):t.operator===i.UPDATE_TIMESTAMP_OFFSET?(this.sourceBuffer.timestampOffset=t.timestampOffset,t.callback&&t.callback(),this.operatorQueue.length?this.enqueue():this.updating=!1):t.operator===i.CALLBACK?(t.callback&&t.callback(),this.operatorQueue.length?this.enqueue():this.updating=!1):t.operator===i.CHANGE_MIME_TYPE&&(this.sourceBuffer.changeType(t.type),this.sourceBuffer.mode=t.mode,this.sourceBuffer.timestampOffset=0)}}addBuffer(t,e){t?(this.operatorQueue.push({operator:i.ADD,buffer:t,callback:e}),this.updating||this.enqueue()):e&&e()}insertEnqueueCallback(t){this.operatorQueue.push({operator:i.CALLBACK,callback:t}),this.updating||this.enqueue()}updateTimestampOffset(t,e){this.operatorQueue.push({operator:i.UPDATE_TIMESTAMP_OFFSET,timestampOffset:t,callback:e}),this.updating||this.enqueue()}removeBuffer(t,e){this.ending||(t=Math.floor(t))-this.lastRemoveTime<this.options.mediaBufferMax<<1||(this.operatorQueue.push({operator:i.REMOVE,start:this.lastRemoveTime,end:t-this.options.mediaBufferMax,callback:e}),this.updating||this.enqueue(),this.lastRemoveTime=t-this.options.mediaBufferMax)}removeAllBuffer(t){this.sourceBuffer.buffered.length?(this.operatorQueue.push({operator:i.REMOVE,start:this.sourceBuffer.buffered.start(0),end:this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1),callback:t}),this.updating||this.enqueue()):t&&t()}end(){this.ending=!0,this.updating||this.operatorQueue.length||this.onEnded&&this.onEnded()}stop(){if(this.sourceBuffer){try{this.sourceBuffer.abort(),this.updating=!1}catch(t){}try{this.sourceBuffer.buffered.length&&(this.updating?this.operatorQueue.push({operator:i.REMOVE,start:this.sourceBuffer.buffered.start(0),end:this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1)}):(this.sourceBuffer.remove(this.sourceBuffer.buffered.start(0),this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1)),this.updating=!0)),this.paddingCallback&&(this.paddingCallback(),this.paddingCallback=null)}catch(t){}}}reset(){this.stop(),this.operatorQueue.length=0,this.ending=!1}isPaused(){return!this.updating&&this.operatorQueue.length}getQueueLength(){return this.operatorQueue.length}getBufferedTime(){return this.sourceBuffer&&this.sourceBuffer.buffered.length?this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1)-this.sourceBuffer.buffered.start(0):0}getBufferedStart(){return this.sourceBuffer&&this.sourceBuffer.buffered.length?this.sourceBuffer.buffered.start(0):0}getBufferedEnd(){return this.sourceBuffer&&this.sourceBuffer.buffered.length?this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1):0}getBufferedDuration(t){if(this.sourceBuffer&&this.sourceBuffer.buffered.length){let e=0;try{for(let r=0;r<this.sourceBuffer.buffered.length;r++){const i=Math.max(t,this.sourceBuffer.buffered.start(r));e+=Math.max(t,this.sourceBuffer.buffered.end(r))-i}}catch(t){}return e}return 0}getSourceBuffer(){return this.sourceBuffer}setMediaBufferMax(t){this.options.mediaBufferMax=t}getMediaBufferMax(){return this.options.mediaBufferMax}destroy(){this.stop(),this.operatorQueue=null,this.sourceBuffer&&(this.sourceBuffer.onupdateend=this.sourceBuffer.onerror=null,this.sourceBuffer=null)}}},85224:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(63939),s=r(79756),a=r(86834);function n(t){let e="";return e=86017!==i.f[15](t+4)||a.A.firefox?`audio/mp4; codecs="${(0,s.A)(t)}"`:"audio/mpeg",e}},10333:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(63939),s=r(28875);function a(t){return 139===i.f[15](t+4)?`video/webm; codecs="${(0,s.A)(t)}"`:`video/mp4; codecs="${(0,s.A)(t)}"`}},68960:(t,e,r)=>{"use strict";r.d(e,{A:()=>l});var i=r(134),s=r(80662),a=r.n(s),n=r(77162),o=r(74503),c=r(9599),d=r(94300),h=r(77231);class l{constructor(){(0,i.A)(this,"index",h.N_),(0,i.A)(this,"id",h.N_),(0,i.A)(this,"privData",null),(0,i.A)(this,"privateData2",null),(0,i.A)(this,"codecpar",(0,o.A)(new n.A,n.A)),(0,i.A)(this,"sideData",{}),(0,i.A)(this,"nbFrames",BigInt(0)),(0,i.A)(this,"metadata",{}),(0,i.A)(this,"duration",h.Dh),(0,i.A)(this,"startTime",h.Dh),(0,i.A)(this,"firstDTS",h.Dh),(0,i.A)(this,"disposition",0),(0,i.A)(this,"timeBase",(0,o.A)(c.P)),(0,i.A)(this,"sampleIndexes",[]),(0,i.A)(this,"sampleIndexesPosMap",new(a()))}destroy(){this.codecpar&&(this.codecpar.destroy(),(0,d.A)(this.codecpar),this.codecpar=null),this.timeBase&&((0,d.A)(this.timeBase),this.timeBase=null),this.sampleIndexes.length=0,this.sampleIndexesPosMap.clear()}}},95832:(t,e,r)=>{"use strict";r.d(e,{Bq:()=>l,Ij:()=>h,XC:()=>d,f7:()=>u,uF:()=>a});var i=r(77231),s=r(37246);const a={1:"Main",2:"LC",3:"SSR",4:"LTP",5:"HE",6:"SCALABLE",29:"HEv2",23:"LD",39:"ELD"},n={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},o=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,i.N_,i.N_,i.N_],c=[i.N_,1,2,3,4,5,6,7];function d(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e){const{profile:r,sampleRate:s,channels:a}=function(t){let e=i.N_,r=i.N_,s=i.N_;return t.length>=2&&(e=t[0]>>3&31,r=o[(7&t[0])<<1|t[1]>>7],s=c[t[1]>>3&15]),{profile:e,sampleRate:r,channels:s}}(e);t.codecpar.profile=r,t.codecpar.sampleRate=s,t.codecpar.chLayout.nbChannels=a,t.codecpar.frameSize=5===r?2048:1024,t.codecpar.format=8}}function h(t){const e=n[t.sampleRate],r=t.chLayout.nbChannels,s=t.profile===i.N_?2:t.profile,a=new Uint8Array(2);return a[0]=(31&s)<<3|(14&e)>>1,a[1]=(1&e)<<7|(15&r)<<3,a}function l(t){if(t.length<7)return-1;const e=t[0]<<4|t[1]>>4;if(4095!==e)return-1;const r=1&t[1],i=(192&t[2])>>>6,s=(60&t[2])>>>2,a=(1&t[2])<<2|(192&t[3])>>>6,n=(3&t[3])<<11|t[4]<<3|(224&t[5])>>>5,d=3&t[6];let h=1===r?7:9,l=n-h;return{syncWord:e,profile:i+1,sampleRate:o[s],channels:c[a],aacFrameLength:n,numberOfRawDataBlocksInFrame:d,headerLength:h,framePayloadLength:l}}function u(t,e){function r(){const t=e.readU(2);let r=0;for(let i=0;i<=t;i++)r<<=8,r|=e.readU(8);return r}e||(e=new s.A).appendBuffer(t);const i=e.getPointer(),a={syncWord:0,profile:0,sampleRate:0,channels:0,useSameStreamMux:!1,headerLength:0,framePayloadLength:0,muxLengthBytes:0},n=e.readU(11);if(695!==n)return-1;a.syncWord=n,a.muxLengthBytes=e.readU(13);const d=1===e.readU1();if(a.useSameStreamMux=d,!d){const t=1===e.readU1();if(t&&1===e.readU1())return-1;if(t&&r(),1!==e.readU1())return-1;if(0!==e.readU(6))return-1;if(0!==e.readU(4))return-1;if(0!==e.readU(3))return-1;let i=t?r():0;const s=e.readU(5);i-=5;const n=e.readU(4);i-=4;const d=e.readU(4);if(i-=4,e.readU(3),i-=3,i>0&&e.readU(i),0!==e.readU(3))return-1;if(e.readU(8),1===e.readU1())if(t)r();else{let t=0;for(;;){t<<=8;const r=1===e.readU1();if(t+=e.readU(8),!r)break}}1===e.readU1()&&e.readU(8),a.profile=s+1,a.sampleRate=o[n],a.channels=c[d]}let h=0;for(;;){const t=e.readU(8);if(h+=t,255!==t)break}return a.framePayloadLength=h,a.headerLength=e.getPointer()-i+(8===e.getBitLeft()?0:1),a}},87518:(t,e,r)=>{"use strict";r.d(e,{R:()=>f,j:()=>s});var i=r(37246);const s=[3,4,3,7,259,263,1539,1543],a=[[64,69,96],[64,70,96],[80,87,120],[80,88,120],[96,104,144],[96,105,144],[112,121,168],[112,122,168],[128,139,192],[128,140,192],[160,174,240],[160,175,240],[192,208,288],[192,209,288],[224,243,336],[224,244,336],[256,278,384],[256,279,384],[320,348,480],[320,349,480],[384,417,576],[384,418,576],[448,487,672],[448,488,672],[512,557,768],[512,558,768],[640,696,960],[640,697,960],[768,835,1152],[768,836,1152],[896,975,1344],[896,976,1344],[1024,1114,1536],[1024,1115,1536],[1152,1253,1728],[1152,1254,1728],[1280,1393,1920],[1280,1394,1920]],n=[4,5,6,5],o=[4,6,7,6],c=[48e3,44100,32e3,0],d=[32,40,48,56,64,80,96,112,128,160,192,224,256,320,384,448,512,576,640],h=[2,1,2,3,3,4,4,5],l=[1,2,3,6],u=7;function f(t){const e=new i.A(t.length);e.appendBuffer(t);const r={syncWord:0,crc1:0,srCode:0,bitstreamId:0,bitstreamMode:0,channelMode:0,lfeOn:0,frameType:0,substreamId:0,centerMixLevel:0,surroundMixLevel:0,channelMap:0,numBlocks:0,dolbySurroundMode:0,srShift:0,sampleRate:0,bitrate:0,channels:0,frameSize:0,channelLayout:BigInt(0),ac3BitrateCode:0};if(r.syncWord=e.readU(16),2935!==r.syncWord)return-1;if(r.bitstreamId=31&e.peekU(29),r.bitstreamId>16)return-2;if(r.numBlocks=6,r.ac3BitrateCode=-1,r.centerMixLevel=5,r.surroundMixLevel=6,r.dolbySurroundMode=0,r.bitstreamId<=10){if(r.crc1=e.readU(16),r.srCode=e.readU(2),3===r.srCode)return-3;const t=e.readU(6);if(t>37)return-4;r.ac3BitrateCode=t>>1,e.readU(5),r.bitstreamMode=e.readU(3),r.channelMode=e.readU(3),2==r.channelMode?r.dolbySurroundMode=e.readU(2):(1&r.channelMode&&1!=r.channelMode&&(r.centerMixLevel=n[e.readU(2)]),4&r.channelMode&&(r.surroundMixLevel=o[e.readU(2)])),r.lfeOn=e.readU(1),r.srShift=Math.max(r.bitstreamId,8)-8,r.sampleRate=c[r.srCode]>>r.srShift,r.bitrate=1e3*d[r.ac3BitrateCode]>>r.srShift,r.channels=h[r.channelMode]+r.lfeOn,r.frameSize=2*a[t][r.srCode],r.frameType=2,r.substreamId=0}else{if(r.crc1=0,r.frameType=e.readU(2),3==r.frameType)return-5;if(r.substreamId=e.readU(3),r.frameSize=e.readU(11)+1<<1,r.frameSize<u)return-6;if(r.srCode=e.readU(2),3==r.srCode){const t=e.readU(2);if(3==t)return-7;r.sampleRate=c[t]/2,r.srShift=1}else r.numBlocks=l[e.readU(2)],r.sampleRate=c[r.srCode],r.srShift=0;r.channelMode=e.readU(3),r.lfeOn=e.readU(1),r.bitrate=8*r.frameSize*r.sampleRate/(256*r.numBlocks),r.channels=h[r.channelMode]+r.lfeOn}return r.channelLayout=BigInt(s[r.channelMode]),r.lfeOn&&(r.channelLayout|=BigInt(8)),r}},21477:(t,e,r)=>{"use strict";r.d(e,{Ui:()=>n,XC:()=>a,zk:()=>s});var i=r(37246);r(83314),r(97317);const s={0:"Main",1:"High",2:"Professional"};function a(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=4){const r=n(e);t.codecpar.profile=r.profile,t.codecpar.level=r.level}}function n(t){const e=new i.A(t.length);e.appendBuffer(t),e.readU1(),e.readU(7);const r=e.readU(3),s=e.readU(5),a=e.readU1();let n=e.readU1()?10:8;return e.readU1()&&(n=12),{profile:r,level:s,tier:a,bitDepth:n,monochrome:e.readU1(),chromaSubsamplingX:e.readU1(),chromaSubsamplingY:e.readU1(),chromaSamplePosition:e.readU(2)}}},14769:(t,e,r)=>{"use strict";r.d(e,{DK:()=>o,XC:()=>d,Xr:()=>c,jA:()=>a,ob:()=>s,oe:()=>n});var i=r(31865);const s=34,a=8,n=[0,8,12,0,16,20,24,32],o=[0,88200,176400,192e3,8e3,16e3,22050,24e3,32e3,44100,48e3,96e3,0,0,0,0],c=[0,192,576,1152,2304,4608,0,0,256,512,1024,2048,4096,8192,16384,32768];function d(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length===s){const{bitsPerRawSample:r,sampleRate:s,channels:a}=function(t){const e=new i.A(t);e.skip(10);const r=e.readUint24();return{sampleRate:r>>4,channels:1+((15&r)>>>1),bitsPerRawSample:1+((1&r)<<4|(240&e.readUint8())>>>4)}}(e);t.codecpar.bitsPerRawSample=r,t.codecpar.sampleRate=s,t.codecpar.chLayout.nbChannels=a}}},62815:(t,e,r)=>{"use strict";r.d(e,{KD:()=>T,S1:()=>b,XC:()=>I,kM:()=>x,oT:()=>k,sL:()=>w,tZ:()=>A,wf:()=>P});var i=r(63939),s=r(72739),a=r(729),n=r(31865),o=r(37246),c=r(4624),d=r(14686),h=r(60264),l=r(37837),u=r(23991),f=r(39381),p=r(82774);const m="src\\avutil\\codecs\\h264.ts",g=16,v=3,A={66:"Constrained Baseline",77:"Main",100:"High",110:"High10",122:"High422",244:"High444"};function y(t,e,r=[]){t.length>32&&(c.R8(`h264 metadata's sps max length is 32, but get ${t.length}`,m,216),t=t.slice(0,32)),t.length>256&&(c.R8(`h264 metadata's pps max length is 256, but get ${t.length}`,m,220),t=t.slice(0,256));let i=7;i=t.reduce(((t,e)=>t+2+e.length),i),i=e.reduce(((t,e)=>t+2+e.length),i);const n=t[0],o=P(n);66!==o.profile&&77!==o.profile&&88!==o.profile&&(i+=4,r.length&&(i=r.reduce(((t,e)=>t+2+e.length),i)));const d=new Uint8Array(i),h=new a.A(d);return h.writeUint8(1),h.writeUint8(n[1]),h.writeUint8(n[2]),h.writeUint8(n[3]),h.writeUint8(252|v),h.writeUint8(224|31&t.length),s.__(t,(t=>{h.writeUint16(t.length),h.writeBuffer(t)})),h.writeUint8(e.length),s.__(e,(t=>{h.writeUint16(t.length),h.writeBuffer(t)})),66!==o.profile&&77!==o.profile&&88!==o.profile&&(h.writeUint8(252|o.chromaFormatIdc),h.writeUint8(248|o.bitDepthLumaMinus8),h.writeUint8(248|o.bitDepthChromaMinus8),r.length&&s.__(r,(t=>{h.writeUint16(t.length),h.writeBuffer(t)}))),d}function b(t){let e=h.py(t);if(e.length>1){const t=[],r=[],i=[];if(e.forEach((e=>{const s=31&e[0];7===s?t.push(e):8===s?r.push(e):13===s&&i.push(e)})),t.length&&r.length)return y(t,r,i)}}function w(t){let e=h.py(t);if(e.length>1){const t=[],r=[],i=[];if(e.forEach((e=>{const s=31&e[0];7===s?t.push(e):8===s?r.push(e):13===s&&i.push(e)})),t.length&&r.length){const e=[t[0],r[0]];return i.length&&e.push(i[0]),h.nW(e,0)}}}function k(t,e=!1){let r,i=h.py(t),s=!1;if(i.length){const t=[],a=[],n=[];i.forEach((e=>{const r=31&e[0];7===r?t.push(e):8===r?a.push(e):13===r?n.push(e):5===r&&(s=!0)})),t.length&&a.length?(r=y(t,a,n),i=i.filter((t=>{const r=31&t[0];return e?9!==r:9!==r&&8!==r&&7!==r&&13!==r}))):i=i.filter((t=>9!=(31&t[0])))}const a=i.reduce(((t,e)=>t+v+1+e.length),0),n=(0,l.sY)(a),o=(0,d.s3)(n,a);return h.S9(i,v,o),{bufferPointer:n,length:a,key:s,extradata:r}}function x(t,e){let r=h.py(t).concat(h.py(e));if(r.length){const t=[],e=[],i=[],s=[],a=[];return r.forEach((r=>{const n=31&r[0];7===n?t.push(r):8===n?e.push(r):13===n?i.push(r):6===n?s.push(r):9!==n&&a.push(r)})),function(t,e,r,i,s){const a=[h.Le(i,0),h.Le(t,0),h.Le(e,0),h.Le(r,0),h.Le(s,2)];let n=a.reduce(((t,e)=>t+e),0);const o=(0,l.sY)(n+6);let c=o;return p.w8((c+=1,c-1),0),p.w8((c+=1,c-1),0),p.w8((c+=1,c-1),0),p.w8((c+=1,c-1),1),p.w8((c+=1,c-1),9),p.w8((c+=1,c-1),240),i.length&&(h.nW(i,0,(0,d.s3)(c,a[0])),c+=a[0]),t.length&&(h.nW(t,0,(0,d.s3)(c,a[1])),c+=a[1]),e.length&&(h.nW(e,0,(0,d.s3)(c,a[2])),c+=a[2]),r.length&&(h.nW(r,0,(0,d.s3)(c,a[3])),c+=a[3]),s.length&&h.nW(s,2,(0,d.s3)(c,a[4])),{bufferPointer:o,length:n+6}}(t,e,i,s,a)}}function I(t,e){let r;if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&h.Bs(e))s.__(h.py(e),(t=>{if(7==(31&t[0]))return r=t,!1}));else if(e&&e.length>=6){t.metadata.naluLengthSizeMinusOne=3&e[4];const{spss:i}=function(t){const e=new n.A(t);e.skip(5);const r=[],i=[],s=[],a=31&e.readUint8();for(let t=0;t<a;t++){const t=e.readUint16();r.push(e.readBuffer(t))}const o=e.readUint8();for(let t=0;t<o;t++){const t=e.readUint16();i.push(e.readBuffer(t))}if(e.remainingSize()>4){e.skip(3);const t=e.readUint8();if(t>0)for(let r=0;r<t;r++){const t=e.readUint16();s.push(e.readBuffer(t))}}return{spss:r,ppss:i,spsExts:s}}(e);i.length&&(r=i[0])}if(r){const{profile:e,level:i,width:s,height:a,videoDelay:n,chromaFormatIdc:o,bitDepthLumaMinus8:c}=P(r);switch(t.codecpar.profile=e,t.codecpar.level=i,t.codecpar.width=s,t.codecpar.height=a,t.codecpar.videoDelay=n,c){case 0:t.codecpar.format=3===o?5:2===o?4:0;break;case 1:t.codecpar.format=3===o?66:2===o?70:60;break;case 2:t.codecpar.format=3===o?68:2===o?64:62}}}function T(t,e=4){if(64&i.f[15](t+36))return h.py((0,d.s3)(i.f[20](t+24),i.f[15](t+28))).some((t=>5==(31&t[0])));{const r=i.f[15](t+28);let s=0;for(;s<r-e;){if(5==(31&f.r8(i.f[20](t+24)+(s+e))))return!0;s+=4===e?f.Sg(i.f[20](t+24)+s):3===e?f.ht(i.f[20](t+24)+s):2===e?f.yd(i.f[20](t+24)+s):f.r8(i.f[20](t+24)+s),s+=e}return!1}}function P(t){if(!t||t.length<3)return;let e=0;0===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&(e=4);const r=h.BN(t.subarray(e)),i=new o.A(r.length);i.appendBuffer(r),i.readU1(),i.readU(2),i.readU(5);const s=i.readU(8);i.readU1(),i.readU1(),i.readU1(),i.readU1(),i.readU1(),i.readU1(),i.readU(2);const a=i.readU(8);u.xb(i);let n=1,c=0,d=0;if(100==s||110==s||122==s||244==s||44==s||83==s||86==s||118==s||128==s||138==s||139==s||134==s||135==s){function I(t){let e,r=8,s=8;for(let a=0;a<t;a++)0!==s&&(e=u.$x(i),s=(r+e+256)%256),r=0===s?r:s}if(n=u.xb(i),3===n&&i.readU1(),c=u.xb(i),d=u.xb(i),i.readU1(),i.readU1()){const T=new Array(8);for(let P=0;P<(3!=n?8:12);P++)T[P]=i.readU1(),T[P]&&I(P<6?16:64)}}const l=u.xb(i),f=u.xb(i);let p=0,m=0;if(0===f)p=u.xb(i);else if(1===f){m=i.readU1(),u.$x(i),u.$x(i);const S=u.xb(i);for(let _=0;_<S;_++)u.$x(i)}u.xb(i),i.readU1();const v=u.xb(i),A=u.xb(i),y=i.readU1();let b=16*(v+1),w=(2-y)*(A+1)*16;y||i.readU1(),i.readU1();const k=i.readU1();if(k){let M=1,C=2-k;1===n?(M=2,C=2*(2-k)):2===k&&(M=2,C=2-k),b-=M*(u.xb(i)+u.xb(i)),w-=C*(u.xb(i)+u.xb(i))}let x=0;if(i.readU1()){let B=i.readU1();function R(){const t=u.xb(i)+1;i.readU(4),i.readU(4);for(let e=0;e<t;e++)u.xb(i),u.xb(i),i.readU1();i.readU(5),i.readU(5),i.readU(5),i.readU(5)}B&&i.readU(8)>=17&&(i.readU(16),i.readU(16)),B=i.readU1(),B&&i.readU1(),B=i.readU1(),B&&(i.readU(3),i.readU1(),B=i.readU1(),B&&(i.readU(8),i.readU(8),i.readU(8))),B=i.readU1(),B&&(u.xb(i),u.xb(i)),B=i.readU1(),B&&(i.readU(32),i.readU(32),i.readU1());let D=i.readU1();D&&R();let U=i.readU1();U&&R(),(D||U)&&i.readU1(),i.readU1(),B=i.readU1(),B&&(i.readU1(),u.xb(i),u.xb(i),u.xb(i),u.xb(i),x=Math.min(u.xb(i),g))}return{profile:s,level:a,width:b,height:w,chromaFormatIdc:n,bitDepthLumaMinus8:c,bitDepthChromaMinus8:d,frameMbsOnlyFlag:y,picOrderCntType:f,log2MaxPicOrderCntLsbMinus4:p,deltaPicOrderAlwaysZeroFlag:m,log2MaxFrameNumMinus4:l,videoDelay:x}}},67659:(t,e,r)=>{"use strict";r.d(e,{KD:()=>x,S1:()=>A,XC:()=>k,ZU:()=>T,dT:()=>m,kM:()=>w,oT:()=>b,sL:()=>y,wf:()=>I});var i=r(63939),s=r(72739),a=r(729),n=r(31865),o=r(37246),c=r(14686),d=r(60264),h=r(37837),l=r(23991),u=r(39381),f=r(82774);const p=16,m={1:"Main",2:"Main10",3:"MainStillPicture",4:"Main444"},g=3;function v(t,e,r){const i=e[0];let n=23;t.length&&(n+=3,n=t.reduce(((t,e)=>t+2+e.length),n)),e.length&&(n+=3,n=e.reduce(((t,e)=>t+2+e.length),n)),r.length&&(n+=3,n=r.reduce(((t,e)=>t+2+e.length),n));const o=new Uint8Array(n),c=new a.A(o,!0),d=I(i);c.writeUint8(1),c.writeUint8(i[1]),c.writeUint8(i[2]),c.writeUint8(i[3]),c.writeUint8(i[4]),c.writeUint8(i[5]),c.writeUint8(i[6]),c.writeUint8(i[7]),c.writeUint8(i[8]),c.writeUint8(i[9]),c.writeUint8(i[10]),c.writeUint8(i[11]),c.writeUint8(d.level),c.writeUint8(1020),c.writeUint8(0),c.writeUint8(16320),c.writeUint8(16320|d.chroma_format_idc),c.writeUint8(8160|d.bit_depth_luma_minus8),c.writeUint8(8160|d.bit_depth_chroma_minus8),c.writeUint16(0),c.writeUint8(8|(1&i[0])<<2|g);let h=0;return t.length&&h++,e.length&&h++,r.length&&h++,c.writeUint8(h),t.length&&(c.writeUint8(160),c.writeUint16(t.length),s.__(t,(t=>{c.writeUint16(t.length),c.writeBuffer(t)}))),e.length&&(c.writeUint8(161),c.writeUint16(e.length),s.__(e,(t=>{c.writeUint16(t.length),c.writeBuffer(t)}))),r.length&&(c.writeUint8(162),c.writeUint16(r.length),s.__(r,(t=>{c.writeUint16(t.length),c.writeBuffer(t)}))),o}function A(t){let e=d.py(t);if(e.length>=2){const t=[],r=[],i=[];if(e.forEach((e=>{const s=e[0]>>>1&63;32===s?t.push(e):33===s?r.push(e):34===s&&i.push(e)})),r.length&&i.length)return v(t,r,i)}}function y(t){let e=d.py(t);if(e.length>=2){const t=[],r=[],i=[];if(e.forEach((e=>{const s=e[0]>>>1&63;32===s?t.push(e):33===s?r.push(e):34===s&&i.push(e)})),r.length&&i.length){const e=[r[0],i[0]];return t.length&&e.unshift(t[0]),d.nW(e,0)}}}function b(t,e=!1){let r,i=!1,s=d.py(t);if(s.length){const t=[],a=[],n=[];s.forEach((e=>{const r=e[0]>>>1&63;32===r?t.push(e):33===r?a.push(e):34===r&&n.push(e),19!==r&&20!==r&&21!==r||(i=!0)})),a.length&&n.length?(r=v(t,a,n),s=s.filter((t=>{const r=t[0]>>>1&63;return(e||32!==r&&33!==r&&34!==r)&&35!==r}))):s=s.filter((t=>35!=(t[0]>>>1&63)))}const a=s.reduce(((t,e)=>t+g+1+e.length),0),n=(0,h.sY)(a),o=(0,c.s3)(n,a);return d.S9(s,g,o),{bufferPointer:n,length:a,extradata:r,key:i}}function w(t,e){let r=d.py(t).concat(d.py(e));if(r.length){let t=[],e=[],i=[],s=[];return r.forEach((r=>{const a=r[0]>>>1&63;32===a?t.push(r):33===a?e.push(r):34===a?i.push(r):35!==a&&s.push(r)})),function(t,e,r,i){const s=[d.Le(t,0),d.Le(e,0),d.Le(r,0),d.Le(i,2)];let a=s.reduce(((t,e)=>t+e),0);const n=(0,h.sY)(a+7);let o=n;return f.w8((o+=1,o-1),0),f.w8((o+=1,o-1),0),f.w8((o+=1,o-1),0),f.w8((o+=1,o-1),1),f.w8((o+=1,o-1),70),f.w8((o+=1,o-1),1),f.w8((o+=1,o-1),80),t.length&&(d.nW(t,0,(0,c.s3)(o,s[0])),o+=s[0]),e.length&&(d.nW(e,0,(0,c.s3)(o,s[1])),o+=s[1]),r.length&&(d.nW(r,0,(0,c.s3)(o,s[2])),o+=s[2]),i.length&&d.nW(i,2,(0,c.s3)(o,s[3])),{bufferPointer:n,length:a+7}}(t,e,i,s)}}function k(t,e){let r;if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&d.Bs(e))s.__(d.py(e),(t=>{if(33==(t[0]>>>1&63))return r=t,!1}));else if(e&&e.length>=6){t.metadata.naluLengthSizeMinusOne=3&e[21];const{spss:i}=function(t){const e=new n.A(t,!0);e.skip(22);let r=[],i=[],s=[];const a=e.readUint8();for(let t=0;t<a;t++){const t=63&e.readUint8(),a=e.readUint16(),n=[];for(let t=0;t<a;t++){const t=e.readUint16();n.push(e.readBuffer(t))}32===t?r=n:33===t?i=n:34===t&&(s=n)}return{vpss:r,spss:i,ppss:s}}(e);i.length&&(r=i[0])}if(r){const{profile:e,level:i,width:s,height:a,video_delay:n,chroma_format_idc:o,bit_depth_luma_minus8:c}=I(r);switch(t.codecpar.profile=e,t.codecpar.level=i,t.codecpar.width=s,t.codecpar.height=a,t.codecpar.videoDelay=n,c){case 0:t.codecpar.format=3===o?5:2===o?4:0;break;case 2:t.codecpar.format=3===o?68:2===o?64:62}}}function x(t,e=4){if(64&i.f[15](t+36))return d.py((0,c.s3)(i.f[20](t+24),i.f[15](t+28))).some((t=>{const e=t[0]>>>1&63;return 20===e||19===e}));{const r=i.f[15](t+28);let s=0;for(;s<r-e;){const r=u.r8(i.f[20](t+24)+(s+e))>>>1&63;if(20===r||19===r)return!0;s+=4===e?u.Sg(i.f[20](t+24)+s):3===e?u.ht(i.f[20](t+24)+s):2===e?u.yd(i.f[20](t+24)+s):u.r8(i.f[20](t+24)+s),s+=e}return!1}}function I(t){if(!t||t.length<3)return;let e=0;0===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&(e=4);let r=0,i=0,s=0,a=0,n=0,c=0,h=1,u=0,f=0,m=0,g=0;const v=d.BN(t.subarray(e)),A=new o.A(v.length);A.appendBuffer(v),A.readU1(),A.readU(6),A.readU(6),A.readU(3),A.readU(4);const y=A.readU(3);A.readU1();let b=0;if(y<=6){u=A.readU(2),f=A.readU1(),r=A.readU(5),m=A.readU(32),g=A.readU(48),i=A.readU(8);const t=new Array(6),e=new Array(6);for(let r=0;r<y;r++)t[r]=A.readU1(),e[r]=A.readU1();if(y>0)for(let t=y;t<8;t++)A.readU(2);for(let r=0;r<y;r++)t[r]&&(A.readU(2),A.readU(1),A.readU(5),A.readU(32),A.readU(1),A.readU(1),A.readU(1),A.readU(1),A.readU(44)),e[r]&&A.readU(8);l.xb(A),h=l.xb(A),3===h&&(b=A.readU(1)),s=l.xb(A),a=l.xb(A);let o=0,d=0,p=0,v=0;A.readU1()&&(o=l.xb(A),d=l.xb(A),p=l.xb(A),v=l.xb(A)),n=l.xb(A),c=l.xb(A);let w=2,k=2;0===h?w=k=0:2===h?(w=2,k=1):3===h&&(w=k=1),s-=w*(1<<n+1)*(o+d),a-=k*(1<<n+1)*(p+v)}const w=l.xb(A)+4;let k=0;for(let t=A.readU1()?0:y;t<y+1;t++)l.xb(A),k=Math.max(k,Math.min(l.xb(A),p)),l.xb(A);const x=l.xb(A)+3,I=l.xb(A),T=l.xb(A)+2,P=l.xb(A),S=x+I,_=x-1,M=s+(1<<S)-1>>S,C=a+(1<<S)-1>>S;return{profile:r,level:i,width:s,height:a,chroma_format_idc:h,bit_depth_luma_minus8:n,bit_depth_chroma_minus8:c,general_profile_space:u,general_tier_flag:f,general_profile_compatibility_flags:m,constraint_flags:g,separate_colour_plane_flag:b,log2_min_cb_size:x,log2_diff_max_min_coding_block_size:I,log2_min_tb_size:T,log2_diff_max_min_transform_block_size:P,log2_max_trafo_size:P+T,log2_ctb_size:S,log2_min_pu_size:_,ctb_width:M,ctb_height:C,ctb_size:M*C,min_cb_width:s>>x,min_cb_height:a>>x,min_tb_width:s>>T,min_tb_height:a>>T,min_pu_width:s>>_,min_pu_height:a>>_,log2_max_poc_lsb:w,video_delay:k}}function T(t){if(!t||t.length<3)return;let e=0;0===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&(e=4);const r=d.BN(t.subarray(e)),i=new o.A(r.length);return i.appendBuffer(r),{pps_pic_parameter_set_id:l.xb(i),pps_seq_parameter_set_id:l.xb(i),dependent_slice_segment_flag:i.readU1(),output_flag_present_flag:i.readU1(),num_extra_slice_header_bits:i.readU(3)}}},64093:(t,e,r)=>{"use strict";r.d(e,{Au:()=>A,He:()=>y,XC:()=>b,Y2:()=>m,hG:()=>g,oz:()=>v});var i=r(77231);const s=[44100,48e3,32e3,0],a=[22050,24e3,16e3,0],n=[11025,12e3,8e3,0],o=[0,1152,1152,384],c=[0,576,1152,384],d=[0,576,1152,384],h=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],l=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],u=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],f=[0,32,48,56,64,80,96,112,128,144,160,176,192,224,256,-1],p=[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1];function m(t,e){switch(t){case 0:return n[e];case 2:return a[e];case 3:return s[e]}return i.N_}function g(t,e){switch(t){case 0:return d[e];case 2:return c[e];case 3:return o[e]}return i.N_}function v(t,e,r){switch(e){case 1:switch(t){case 0:case 2:return p[r];case 3:return u[r]}break;case 2:switch(t){case 0:case 2:return p[r];case 3:return l[r]}case 3:switch(t){case 0:case 2:return f[r];case 3:return h[r]}}return i.N_}function A(t){switch(t){case 1:return 34;case 2:return 33;case 3:return 32}return i.N_}const y={32:"Layer1",33:"Layer2",34:"Layer3"};function b(t,e){if(e&&e.length>=4){const r=e[1]>>>3&3,i=(6&e[1])>>1,s=(12&e[2])>>>2,a=3&~(e[3]>>>6)?2:1,n=A(i),o=m(r,s);t.codecpar.profile=n,t.codecpar.sampleRate=o,t.codecpar.chLayout.nbChannels=a}}},74762:(t,e,r)=>{"use strict";r.d(e,{q:()=>o});var i=r(79331),s=r(67672),a=r(72739),n=r(54825);function o(t){const e=(0,i.A)(t,{aloneValueName:"context"});if(!e.tt)return{queue:[],head:{}};const r=[];function o(t){let e="";return a.__(t,(t=>{s.Yj(t)?e+=t:t.context?e+=`<${t.tagName}>${t.context}</${t.tagName}>`:e+=`<${t.tagName}/>`})),e}function c(t,e,i){let c=(0,n.j)(e||t.begin),d=t.context||"",h=t.region||"Default",l="";s.YO(d)&&(d=o(d)),s.YO(t.span)?a.__(t.span,(t=>{t.context&&(c===-BigInt(1)&&t.begin&&(c=(0,n.j)(t.begin)),!h&&t.region&&(h=t.region),s.Yj(t.context)?(d+=t.context,t.br&&(d+="<br>")):(d+=o(t.context),t.br&&(d+="<br>"))),t.end&&(l=t.end)})):t.span&&(t.span.context&&(c===-BigInt(1)&&t.span.begin&&(c=(0,n.j)(t.span.begin)),!h&&t.span.region&&(h=t.span.region),s.Yj(t.span.context)?d+=t.span.context:d+=o(t.span.context)),t.span.end&&(l=t.span.end)),r.push({context:d,pts:c,region:h,duration:t.dur?(0,n.j)(t.dur):(0,n.j)(i||t.end||l)-c})}function d(t,e,r){s.YO(t)?a.__(t,(t=>{c(t,e,r)})):c(t,e,r)}return e.tt.body&&e.tt.body.div&&(s.YO(e.tt.body.div)?a.__(e.tt.body.div,(t=>{t.p&&d(t.p,t.begin,t.end)})):e.tt.body.div.p&&d(e.tt.body.div.p,e.tt.body.div.begin,e.tt.body.end)),{queue:r,head:e.tt.head||{}}}},97077:(t,e,r)=>{"use strict";r.d(e,{Ui:()=>a,XC:()=>s});var i=r(37246);function s(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=6){const r=a(e);t.codecpar.profile=r.profile,t.codecpar.level=r.level}}function a(t){const e=new i.A(t.length);return e.appendBuffer(t.subarray(4)),{profile:e.readU(8),level:e.readU(8),bitDepth:e.readU(4),chromaSubsampling:e.readU(3),fullRangeFlag:e.readU1(),colorPrimaries:e.readU(8),colorTrc:e.readU(8),colorSpace:e.readU(8)}}},82014:(t,e,r)=>{"use strict";r.d(e,{Ui:()=>n,XC:()=>a,wN:()=>s}),r(9599);var i=r(37246);r(77231),r(97317),r(44328),r(729);const s={0:"Profile0",1:"Profile1",2:"Profile2",3:"Profile3"};function a(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=6){const r=n(e);t.codecpar.profile=r.profile,t.codecpar.level=r.level}}function n(t){const e=new i.A(t.length);return e.appendBuffer(t),{profile:e.readU(8),level:e.readU(8),bitDepth:e.readU(4),chromaSubsampling:e.readU(3),fullRangeFlag:e.readU1(),colorPrimaries:e.readU(8),colorTrc:e.readU(8),colorSpace:e.readU(8)}}},59166:(t,e,r)=>{"use strict";r.d(e,{KD:()=>x,S1:()=>A,Ui:()=>T,XC:()=>k,kM:()=>w,oT:()=>b,sL:()=>y,wf:()=>I});var i=r(63939),s=r(72739),a=r(729),n=r(31865),o=r(37246),c=r(14686),d=r(60264),h=r(37837),l=r(23991),u=r(83314),f=r(39381),p=r(82774);const m=3;function g(t){const e=t.readU(9),r=t.readU(3),i=t.readU(2),s=t.readU(2),a=t.readU(3);t.readU(5),t.readU(2);const n=t.readU(6),o=t.readU(7),c=t.readU(1),d=t.readU(8),h=t.readU(1),l=t.readU(1),u=[],f=[];if(n){for(let e=0;e<n-1;e++)u[e]=t.readU(8);u[n-1]=t.readU(6)}else t.readU(6);if(r>1){let e=0;for(let i=r-2;i>=0;--i)e|=t.readU(1)<<i;for(let e=r;e<=8&&r>1;++e)t.readU(1);for(let i=r-2;i>=0;--i)e&1<<i&&(f[i]=t.readU(8))}const p=t.readU(8),m=[];if(p)for(let e=0;e<p;e++)m.push(t.readU(8));return{olsIdx:e,numSublayers:r,bitDepthMinus8:a,chromaFormatIdc:s,constantFrameRate:i,generalProfileIdc:o,generalTierFlag:c,generalLevelIdc:d,ptlFrameOnlyConstraintFlag:h,ptlMultilayerEnabledFlag:l,generalConstraintInfo:u,sublayerLevelIdc:f,generalSubProfileIdc:m,maxPictureWidth:t.readU(16),maxPictureHeight:t.readU(16),avgFramerate:t.readU(16)}}function v(t,e,r){const i=e[0];let n;if(i){const t=I(i);let e=t.generalConstraintInfo;e.length||(e=new Array(12).fill(0));const r=new u.A;if(r.writeU(9,0),r.writeU(3,t.spsMaxSublayersMinus1+1),r.writeU(2,1),r.writeU(2,t.chromaFormatIdc),r.writeU(3,t.bitDepthMinus8),r.writeU(5,31),r.writeU(2,0),r.writeU(6,e.length),r.writeU(7,t.profile),r.writeU1(t.tierFlag),r.writeU(8,t.level),r.writeU1(t.ptlFrameOnlyConstraintFlag),r.writeU1(t.ptlMultilayerEnabledFlag),e.length){for(let t=0;t<e.length-1;t++)r.writeU(8,e[t]);r.writeU(6,e[e.length-1])}else r.writeU(6,63);if(t.spsMaxSublayersMinus1+1>1){let e=0;for(let r=t.spsMaxSublayersMinus1-1;r>=0;r--)e=e<<1|t.ptlSublayerLevelPresentFlag[r];r.writeU(t.spsMaxSublayersMinus1,e);for(let e=t.spsMaxSublayersMinus1+1;e<=8&&t.spsMaxSublayersMinus1>0;++e)r.writeU1(0);for(let e=t.spsMaxSublayersMinus1-1;e>=0;e--)t.ptlSublayerLevelPresentFlag[e]&&r.writeU(8,t.sublayerLevelIdc[e])}r.writeU(8,t.generalSubProfileIdc.length);for(let e=0;e<t.generalSubProfileIdc.length;e++)r.writeU(8,t.sublayerLevelIdc[e]);r.writeU(16,t.width),r.writeU(16,t.height),r.writeU(16,0),r.padding(),n=r.getBuffer().subarray(0,r.getPointer())}let o=2+(n?n.length:0);t.length&&(o+=3,o=t.reduce(((t,e)=>t+2+e.length),o)),e.length&&(o+=3,o=e.reduce(((t,e)=>t+2+e.length),o)),r.length&&(o+=3,o=r.reduce(((t,e)=>t+2+e.length),o));const c=new Uint8Array(o),d=new a.A(c,!0);d.writeUint8(m<<1|(n?1:0)|248),n&&d.writeBuffer(n);let h=0;return t.length&&h++,e.length&&h++,r.length&&h++,d.writeUint8(h),t.length&&(d.writeUint8(142),d.writeUint16(t.length),s.__(t,(t=>{d.writeUint16(t.length),d.writeBuffer(t)}))),e.length&&(d.writeUint8(143),d.writeUint16(e.length),s.__(e,(t=>{d.writeUint16(t.length),d.writeBuffer(t)}))),r.length&&(d.writeUint8(144),d.writeUint16(r.length),s.__(r,(t=>{d.writeUint16(t.length),d.writeBuffer(t)}))),c}function A(t){let e=d.py(t);if(e.length>=2){const t=[],r=[],i=[];if(e.forEach((e=>{const s=e[1]>>>3&31;14===s?t.push(e):15===s?r.push(e):16===s&&i.push(e)})),r.length&&i.length)return v(t,r,i)}}function y(t){let e=d.py(t);if(e.length>=2){const t=[],r=[],i=[];if(e.forEach((e=>{const s=e[1]>>>3&31;14===s?t.push(e):15===s?r.push(e):16===s&&i.push(e)})),r.length&&i.length){const e=[r[0],i[0]];return t.length&&e.unshift(t[0]),d.nW(e,0)}}}function b(t,e=!1){let r,i=!1,s=d.py(t);if(s.length){const t=[],a=[],n=[];s.forEach((e=>{const r=e[1]>>>3&31;14===r?t.push(e):15===r?a.push(e):16===r&&n.push(e),8!==r&&7!==r&&9!==r&&10!==r||(i=!0)})),a.length&&n.length?(r=v(t,a,n),s=s.filter((t=>{const r=t[1]>>>3&31;return(e||14!==r&&15!==r&&16!==r)&&20!==r}))):s=s.filter((t=>20!=(t[1]>>>3&31)))}const a=s.reduce(((t,e)=>t+m+1+e.length),0),n=(0,h.sY)(a),o=(0,c.s3)(n,a);return d.S9(s,m,o),{bufferPointer:n,length:a,extradata:r,key:i}}function w(t,e){let r=d.py(t).concat(d.py(e));if(r.length){let t=[],e=[],i=[],s=[];return r.forEach((r=>{const a=r[1]>>>3&31;14===a?t.push(r):15===a?e.push(r):16===a?i.push(r):20!==a&&s.push(r)})),function(t,e,r,i,s){const a=[d.Le(t,0),d.Le(e,0),d.Le(r,0),d.Le(i,2)];let n=a.reduce(((t,e)=>t+e),0);const o=(0,h.sY)(n+7);let l=o;return p.w8((l+=1,l-1),0),p.w8((l+=1,l-1),0),p.w8((l+=1,l-1),0),p.w8((l+=1,l-1),1),p.w8((l+=1,l-1),0),p.w8((l+=1,l-1),161),p.w8((l+=1,l-1),(s?1:0)<<7|40),t.length&&(d.nW(t,0,(0,c.s3)(l,a[0])),l+=a[0]),e.length&&(d.nW(e,0,(0,c.s3)(l,a[1])),l+=a[1]),r.length&&(d.nW(r,0,(0,c.s3)(l,a[2])),l+=a[2]),i.length&&d.nW(i,2,(0,c.s3)(l,a[3])),{bufferPointer:o,length:n+7}}(t,e,i,s,!0)}}function k(t,e){let r;if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&d.Bs(e))s.__(d.py(e),(t=>{if(15==(t[1]>>>3&31))return r=t,!1}));else if(e&&e.length>=6){t.metadata.naluLengthSizeMinusOne=e[0]>>>1&3;const{spss:i}=function(t){const e=new n.A(t,!0);if(1&e.readUint8()){const r=new o.A;r.appendBuffer(t.subarray(1)),g(r),e.skip(r.getPointer())}let r=[],i=[],s=[];const a=e.readUint8();for(let t=0;t<a;t++){const t=31&e.readUint8();let a=1;13!==t&&12!==t&&(a=e.readUint16());const n=[];for(let t=0;t<a;t++){const t=e.readUint16();n.push(e.readBuffer(t))}14===t?r=n:15===t?i=n:16===t&&(s=n)}return{vpss:r,spss:i,ppss:s}}(e);i.length&&(r=i[0])}r&&function(t,e){const{profile:r,level:i,width:s,height:a,videoDelay:n,chromaFormatIdc:o,bitDepthMinus8:c}=I(e);switch(t.codecpar.profile=r,t.codecpar.level=i,t.codecpar.width=s,t.codecpar.height=a,t.codecpar.videoDelay=n,c){case 0:t.codecpar.format=3===o?5:2===o?4:0;break;case 2:t.codecpar.format=3===o?68:2===o?64:62}}(t,r)}function x(t,e=4){if(64&i.f[15](t+36))return d.py((0,c.s3)(i.f[20](t+24),i.f[15](t+28))).some((t=>{const e=t[1]>>>3&31;return 8===e||7===e}));{const r=i.f[15](t+28);let s=0;for(;s<r-e;){const r=f.r8(i.f[20](t+24)+(s+e+1))>>>3&31;if(8===r||7===r)return!0;s+=4===e?f.Sg(i.f[20](t+24)+s):3===e?f.ht(i.f[20](t+24)+s):2===e?f.yd(i.f[20](t+24)+s):f.r8(i.f[20](t+24)+s),s+=e}return!1}}function I(t){if(!t||t.length<3)return;let e=0;0===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&(e=4);let r=0,i=0,s=0,a=0,n=0,c=1,h=0,u=0,f=0;const p=[],m=[],g=[],v=[],A=d.BN(t.subarray(e)),y=new o.A(A.length);y.appendBuffer(A),y.readU1(),y.readU1(),y.readU(6),y.readU(5),y.readU(3),y.readU(8);const b=y.readU(3);c=y.readU(2);const w=y.readU(2);if(y.readU(1)){if(r=y.readU(7),h=y.readU(1),i=y.readU(8),u=y.readU(1),f=y.readU(1),y.readU(1)){for(let t=0;t<8;t++)p[t]=y.readU(8);p[8]=y.readU(7);const t=y.readU(8);y.readU(t)}y.skipPadding();for(let t=b-1;t>=0;t--)m[t]=y.readU(1);y.skipPadding();for(let t=b-1;t>=0;t--)m[t]&&(g[t]=y.readU(8));const t=y.readU(8);if(t)for(let e=0;e<t;e++)v[e]=y.readU(32)}y.readU1(),y.readU1()&&y.readU1();const k=s=l.xb(y),x=a=l.xb(y);if(y.readU1()&&(l.xb(y),l.xb(y),l.xb(y),l.xb(y)),y.readU1()){const t=l.xb(y),e=w+5,r=1<<e,i=k/(1<<e),s=x/(1<<e),a=Math.ceil(Math.log2(i)),n=Math.ceil(Math.log2(s));let o=0,c=0,d=0;t>0&&(d=y.readU1(),c=y.readU1());for(let e=0;t>0&&e<=t;e++)c&&0!=e||(e>0&&k>r&&y.readU(a),e>0&&x>r&&y.readU(n),e<t&&k>r&&y.readU(a),e<t&&x>r&&y.readU(n)),d||y.readU(2);if(o=l.xb(y)+1,y.readU(1)&&y.readU(1))for(let e=0;e<=t;e++)y.readU(o)}n=l.xb(y),y.readU(1),y.readU(1);const I=y.readU(4),T=y.readU(1);let P=0;T&&(P=l.xb(y));const S=[],_=y.readU(2);for(let t=0;t<8*_;t++)S[t]=y.readU(1);return{profile:r,level:i,width:s,height:a,videoDelay:b+1>2?2:b,chromaFormatIdc:c,bitDepthMinus8:n,generalProfileSpace:0,tierFlag:h,generalConstraintInfo:p,generalSubProfileIdc:v,ptlFrameOnlyConstraintFlag:u,ptlMultilayerEnabledFlag:f,spsMaxSublayersMinus1:b,ptlSublayerLevelPresentFlag:m,sublayerLevelIdc:g,sps_log2_max_pic_order_cnt_lsb_minus4:I,sps_poc_msb_cycle_flag:T,sps_poc_msb_cycle_len_minus1:P,sps_num_extra_ph_bytes:_,sps_extra_ph_bit_present_flag:S}}function T(t){d.Bs(t)&&(t=A(t));const e=new o.A;return e.appendBuffer(t),1&e.readU(8)?g(e):{}}},77231:(t,e,r)=>{"use strict";r.d(e,{Dh:()=>s,FQ:()=>u,H3:()=>c,KR:()=>h,N_:()=>a,SF:()=>n,WT:()=>d,f7:()=>g,go:()=>f,i0:()=>l,qs:()=>o,vh:()=>p,zg:()=>m});var i=r(9599);const s=-BigInt(1),a=-1,n=1e6,o=1e3,c=1e9,d=BigInt(2208988800)*BigInt(1e6),h=new i.P({den:n,num:1}),l=new i.P({den:o,num:1}),u=new i.P({den:c,num:1}),f=(new i.P({den:1,num:1}),2147483647),p=BigInt(0x8000000000000000),m=65535,g=4294967295;BigInt(0x10000000000000000)},9705:(t,e,r)=>{"use strict";r.d(e,{E$:()=>i,LR:()=>s,LT:()=>d,NU:()=>l,OY:()=>c,UY:()=>a,gR:()=>n,lh:()=>o,nr:()=>u,r8:()=>h});const i=-1,s=-2,a=-3,n=-4,o=-5,c=-6,d=-7,h=-8,l=-9,u=-10},49032:(t,e,r)=>{"use strict";async function i(t,e=-1){let r=await t.peekString(8);if(/^FLV/.test(r))return 0;if(/^DKIF/.test(r))return 5;if(/^ftyp/.test(r.slice(4,8)))return 1;if(/^OggS/.test(r))return 4;if(/^ID3/.test(r))return 14;if(/^fLaC/.test(r))return 17;if(/^RIFF/.test(r)){const e=(await t.peekString(12)).slice(8);if(/^WAVE/.test(e))return 16;if(/^AVI/.test(e))return 10}else{if(/^ADIF/.test(r))return 15;if(440786851===await t.peekUint32())return 8;if(/^WEBVTT/.test(r))return 18;if(/^LIMA/.test(r))return await t.skip(4),await t.readUint16();{const e=await t.peekBuffer(2);switch(e[0]){case 86:if(!(224&~e[1]))return 15;break;case 255:if(240==(246&e[1]))return 15;if([242,244,246,250,252].includes(254&e[1]))return 14}}}return e}r.d(e,{A:()=>i})},364:(t,e,r)=>{"use strict";r.d(e,{A:()=>h});var i=r(62751),s=r(92647),a=r(95335),n=r(50011),o=r(8507),c=r(72739);const d=["php","asp","aspx","jsp","do","pl"];async function h(t,e="",r={}){let h,l="",u={url:t};if(/^rtsp/.test(t)||/^rtmp/.test(t)){/^rtsp/.test(t)?l="rtsp":/^rtmp/.test(t)&&(l="rtmp"),h=2;const e=o.qg(t).protocol.split("+")[1]||"wss";"wss"===e||"ws"===e?h=2:"webtransport"===e&&(h=3),u.url=u.url.replace(/^\S+:\/\//,e+"://"),"rtmp"===l&&(u.subProtocol=h,h=6)}else{var f;const u=o.qg(t).protocol;l=e||o.qg(t).file.split(".").pop(),l&&!c.zy(d,l)||!/^https?/.test(u)||(l=await async function(t,e={}){const r={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};let i;e.headers&&a.__(e.headers,((t,e)=>{r.headers[e]=t})),e.credentials&&(r.credentials=e.credentials),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),"function"==typeof AbortController&&(i=new AbortController,r.signal=i.signal);const o=await fetch(t,r);if(o.ok&&o.status>=200&&o.status<=299){const t=o.body.getReader(),e=[];let r=0;for(;;){let i=await t.read();if(i.done)break;if(r+=i.value.length,e.push(i.value),r>=100)break}if(i&&i.abort(),e.length){const t=e.length>1?(0,s.A)(Uint8Array,e):e[0];if(t.length){const e=n.decode(t.subarray(0,100));if(/<\?xml/.test(e)){if(e.indexOf("<MPD")>-1)return"mpd"}else if(/#EXTM3U/.test(e))return"m3u8"}}}return""}(t,r));let p=0;"wss"===u||"ws"===u?p=2:"webtransport"===u&&(p=3),h=null!==(f=i.$$[l])&&void 0!==f?f:p}return{type:h,ext:l,info:u}}},36204:(t,e,r)=>{"use strict";r.d(e,{t:()=>d});var i=r(63939),s=r(50932),a=r(56024),n=r(66788),o=r(14686),c=r(77231);function d(t,e=0){0===e&&(e=(0,a.FP)()),s.M[15](e+152,t.sampleRate),s.M[15](e+76,t.numberOfFrames),s.M[15](e+292,t.numberOfChannels),s.M[15](e+80,function(t){switch(t){case"u8":return 0;case"s16":return 1;case"s32":return 2;case"f32":return 3;case"u8-planar":return 5;case"s16-planar":return 6;case"s32-planar":return 7;case"f32-planar":return 8;default:throw new Error("not support")}}(t.format)),s.M[17](e+104,t.timestamp<0?c.Dh:BigInt(Math.floor(t.timestamp))),s.M[17](e+312,BigInt(Math.floor(t.duration))),s.M[15](e+124,c.SF),s.M[15](e+120,1),(0,a.rh)(e);const r=(0,n.K0)(i.f[15](e+80))?i.f[15](e+292):1;for(let s=0;s<r;s++)t.copyTo((0,o.s3)(i.f[20](i.f[20](e+64)+4*s),i.f[15](e+32)),{planeIndex:s});return e}},89188:(t,e,r)=>{"use strict";r.d(e,{pt:()=>l});var i=r(63939),s=(r(9599),r(97317)),a=r(44328),n=r(77231),o=r(11473),c=r(95335);function d(t){switch(t){case 0:return"I420";case 33:return"I420A";case 4:return"I422";case 5:return"I444";case 28:return"BGRA";case 26:return"RGBA";case 23:return"NV12";default:return null}}function h(t){const e={fullRange:!1,matrix:null,primaries:null,transfer:null};switch(i.f[15](t+220)){case 1:default:e.matrix="bt709";break;case 6:e.matrix="smpte170m";break;case 5:e.matrix="bt470bg";break;case 0:e.matrix="rgb"}switch(i.f[15](t+212)){case 1:default:e.primaries="bt709";break;case 5:e.primaries="bt470bg";break;case 6:e.primaries="smpte170m"}switch(i.f[15](t+216)){case 1:default:e.transfer="bt709";break;case 13:e.transfer="iec61966-2-1";break;case 6:e.transfer="smpte170m"}return 2===i.f[15](t+208)&&(e.fullRange=!0),e}function l(t,e,r={}){let l=i.f[15](t+72);const u=(0,s.I)(i.f[15](t+80)),f=[];for(let e=0;e<u.comp.length;e++)f.push({offset:i.f[20](t+4*e),stride:i.f[15](t+32+4*e)});const p=c.X$({codedWidth:i.f[15](t+68),codedHeight:l,timestamp:Number(e||(0,a.Mr)(i.f[17](t+104),t+120,n.KR)),format:d(i.f[15](t+80)),duration:Number((0,a.Mr)(i.f[17](t+312),t+120,n.KR)),layout:f,colorSpace:h(t),visibleRect:{x:i.f[25](t+276),y:i.f[25](t+268),width:i.f[15](t+68)-(i.f[25](t+276)+i.f[25](t+280)),height:i.f[15](t+72)-(i.f[25](t+268)+i.f[25](t+272))}},r);return new VideoFrame((0,o.Lv)(),p)}},22898:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(63939),s=(r(9599),r(44328)),a=r(14686),n=r(77231);function o(t){const e=1&i.f[15](t+36);return new EncodedAudioChunk({type:e?"key":"delta",timestamp:i.f[17](t+8)===n.Dh?n.N_:Number((0,s.Mr)(i.f[17](t+8),t+72,n.KR)),data:(0,a.s3)(i.f[20](t+24),i.f[15](t+28))})}},28917:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(63939),s=(r(9599),r(44328)),a=r(14686),n=r(77231);function o(t){const e=1&i.f[15](t+36);return new EncodedVideoChunk({type:e?"key":"delta",timestamp:i.f[17](t+8)===n.Dh?n.N_:Number((0,s.Mr)(i.f[17](t+8),t+72,n.KR)),data:(0,a.s3)(i.f[20](t+24),i.f[15](t+28))})}},94561:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(26429),s=r(76045),a=r(67672);async function n(t,e=!1){let r;return a.Yj(t)||a.sv(t)?(r=await(0,s.A)({source:t}),i.USE_THREADS&&e&&(r.threadModule=await(0,s.A)({source:r.buffer},{child:!0})),delete r.buffer):r=t,r}},79756:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(63939),s=r(62751);function a(t){const e=i.f[15](t+4);let r=i.f[15](t+48),a=s.os[e];return 86018===e&&(a=`${a}.${r}`),a||"unknown"}},39365:(t,e,r)=>{"use strict";r.d(e,{C:()=>s});var i=r(86834);function s(t){return t?!i.A.chrome||i.A.checkVersion(i.A.majorVersion,"94",!0)?"prefer-hardware":"allow":!i.A.chrome||i.A.checkVersion(i.A.majorVersion,"94",!0)?"prefer-software":"deny"}},28875:(t,e,r)=>{"use strict";r.d(e,{A:()=>m});var i=r(63939),s=r(62751),a=r(21477),n=r(97077),o=r(82014),c=r(59166),d=r(67659),h=r(20525),l=r(77231),u=r(14686),f=r(90932),p=r(60264);function m(t,e){const r=i.f[15](t+4);let m=i.f[15](t+48),g=i.f[15](t+52);!e&&0!==i.f[20](t+12)&&i.f[15](t+16)&&(e=(0,u.s3)(i.f[20](t+12),i.f[15](t+16)));let v=s.os[r],A="";if(27===r)110===m&&(m=100),A=h.GP("%s.%02x00%02x",v,255&m,255&g);else if(173===r){let t=0,r=0,i=0,s=0;e&&(p.Bs(e)&&(e=d.S1(e)),e.length>13&&(t=e[1]>>>6&3,i=e[1]>>>5&1,r=e[2]|e[3]<<8|e[4]<<16|e[5]<<24,s=240&e[6]));const a={0:"",1:"A",2:"B",3:"C"};A=h.GP("%s.%s%d.%x.%s%d.%x",v,a[t],m,r,0===i?"L":"H",g,s)}else if(196===r){var y;let t=0;if((null===(y=e)||void 0===y?void 0:y.length)>13&&(t=1&e[5]),A=h.GP("%s.%d.%s%d",v,m,0===t?"L":"H",g),e){p.Bs(e)&&(e=c.S1(e));const t=c.Ui(e);if(t.generalConstraintInfo.length){let e=t.generalConstraintInfo.length-1;for(;e>0&&0===t.generalConstraintInfo[e];)e--;const r=t.generalConstraintInfo.slice(0,e+1);r.length&&(A+=`.C${f.l(new Uint8Array(r),!1)}`)}t.generalSubProfileIdc.length&&(A+=`.S${t.generalSubProfileIdc.map((t=>t.toString(16))).join("+")}`),A+=`.O${t.olsIdx}+${t.numSublayers}`}}else if(225===r)if(e){const t=a.Ui(e);A=h.GP("%s.%d.%02d%s.%02d.%d.%d%d%d",v,t.profile,t.level,t.tier?"H":"M",t.bitDepth,t.monochrome,t.chromaSubsamplingX,t.chromaSubsamplingY,t.chromaSamplePosition)}else A=h.GP("%s.%d.%02dM.08",v,m,g);else if(139===r)if(e){const t=n.Ui(e);A=h.GP("%s.%02d.%02d.%02d",v,t.profile,t.level,t.bitDepth)}else A=m!==l.N_&&g!==l.N_?h.GP("%s.%02d.%02d.08",v,m,g):v;else if(167===r)if(e){const t=o.Ui(e);A=h.GP("%s.%02d.%02d.%02d.%02d.%02d.%02d.%02d.%02d",v,t.profile,t.level,t.bitDepth,t.chromaSubsampling,t.colorPrimaries,t.colorTrc,t.colorSpace,t.fullRangeFlag)}else A=m!==l.N_&&g!==l.N_?h.GP("%s.%02d.%02d.08.00",v,m,g):h.GP("%s.%02d.%02d.08.00",v,0,40);else A=v||"unknown";return A}},67603:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(4919);let s=WebAssembly.validate((0,i.E_)("AGFzbQEAAAABBgFgAX8BfwISAQNlbnYGbWVtb3J5AgMBgIACAwIBAAcJAQVsb2FkOAAACgoBCAAgAP4SAAAL")),a=WebAssembly.validate((0,i.E_)("AGFzbQEAAAABBQFgAAF7AhIBA2VudgZtZW1vcnkCAwGAgAIDAgEACgoBCABBAP0ABAAL"));function n(t,e,r){let i=a?"-simd":s?"-atomic":"";switch(e){case"decoder":if(r>65536&&r<=65572)return`${t}/decode/pcm${i}.wasm`;if(r>=69632&&r<=69683)return`${t}/decode/adpcm${i}.wasm`;switch(r){case 2:return`${t}/decode/mpeg2video${i}.wasm`;case 27:return`${t}/decode/h264${i}.wasm`;case 30:return`${t}/decode/theora${i}.wasm`;case 86018:return`${t}/decode/aac${i}.wasm`;case 86019:return`${t}/decode/ac3${i}.wasm`;case 86056:return`${t}/decode/eac3${i}.wasm`;case 86020:return`${t}/decode/dca${i}.wasm`;case 86017:return`${t}/decode/mp3${i}.wasm`;case 173:return`${t}/decode/hevc${i}.wasm`;case 196:return`${t}/decode/vvc${i}.wasm`;case 12:return`${t}/decode/mpeg4${i}.wasm`;case 225:return`${t}/decode/av1${i}.wasm`;case 86051:return`${t}/decode/speex${i}.wasm`;case 86076:return`${t}/decode/opus${i}.wasm`;case 86028:return`${t}/decode/flac${i}.wasm`;case 86021:return`${t}/decode/vorbis${i}.wasm`;case 139:return`${t}/decode/vp8${i}.wasm`;case 167:return`${t}/decode/vp9${i}.wasm`;case 86022:return`${t}/decode/dvaudio${i}.wasm`;case 24:return`${t}/decode/dvvideo${i}.wasm`;case 3:return`${t}/decode/h261${i}.wasm`;case 4:case 20:case 19:return`${t}/decode/h263${i}.wasm`;case 14:case 15:case 16:case 5:case 6:case 68:case 69:return`${t}/decode/msmpeg4${i}.wasm`;case 86036:case 86057:case 86073:return`${t}/decode/ra${i}.wasm`;case 86023:case 86024:case 86052:case 86054:case 86053:return`${t}/decode/wma${i}.wasm`;case 17:case 18:case 71:return`${t}/decode/wmv${i}.wasm`;case 7:return`${t}/decode/mjpeg${i}.wasm`;default:return null}case"encoder":if(r>65536&&r<=65572)return`${t}/encode/pcm${i}.wasm`;switch(r){case 27:return`${t}/encode/x264${i}.wasm`;case 30:return`${t}/encode/theora${i}.wasm`;case 86018:return`${t}/encode/aac${i}.wasm`;case 86019:return`${t}/encode/ac3${i}.wasm`;case 86056:return`${t}/encode/eac3${i}.wasm`;case 86020:return`${t}/encode/dca${i}.wasm`;case 86017:return`${t}/encode/mp3lame${i}.wasm`;case 173:return`${t}/encode/x265${i}.wasm`;case 12:return`${t}/encode/mpeg4${i}.wasm`;case 225:return`${t}/encode/av1${i}.wasm`;case 86051:return`${t}/encode/speex${i}.wasm`;case 86076:return`${t}/encode/opus${i}.wasm`;case 86028:return`${t}/encode/flac${i}.wasm`;case 86021:return`${t}/encode/vorbis${i}.wasm`;case 139:return`${t}/encode/vp8${i}.wasm`;case 167:return`${t}/encode/vp9${i}.wasm`;default:return null}case"resampler":return`${t}/resample/resample${i}.wasm`;case"scaler":return`${t}/scale/scale${i}.wasm`;case"stretchpitcher":return`${t}/stretchpitch/stretchpitch${i}.wasm`}}},93147:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(63939),s=r(97317);function a(t){if(0!==i.f[15](t))return!1;const e=(0,s.I)(i.f[15](t+28));return e&&128&e.flags}},24310:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(63939),s=r(97317);function a(t){if(0!==i.f[15](t))return!1;const e=(0,s.I)(i.f[15](t+28));return!(!e||e.comp[0].depth<=8||18!==i.f[15](t+92)&&16!==i.f[15](t+92))}},16041:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(134),s=(r(55833),r(40046)),a=r(73783),n=r(37837),o=r(56024);class c{constructor(t,e){(0,i.A)(this,"list",void 0),(0,i.A)(this,"mutex",void 0),this.list=t,this.mutex=e}alloc(){let t=this.list.find((t=>-1===s.p_(t+320,-1,1,16,2)),20);return t||(t=(0,n.Gy)(328),(0,o._h)(t),s.M_(t+320,1,16,2),a.s2(this.mutex),this.list.push(t,20),a.Tl(this.mutex)),t}release(t){s.Hh(t+320,16,2)<=0||1===s.jb(t+320,1,16,2)&&((0,o.to)(t),s.M_(t+320,-1,16,2))}}},47442:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=(r(10278),r(40046)),a=r(73783),n=r(37837);class o{constructor(t,e){(0,i.A)(this,"list",void 0),(0,i.A)(this,"mutex",void 0),this.list=t,this.mutex=e}alloc(){let t=this.list.find((t=>-1===s.p_(t+48,-1,1,16,2)),20);return t||(t=(0,n.Gy)(56),s.M_(t+48,1,16,2),a.s2(this.mutex),this.list.push(t,20),a.Tl(this.mutex)),t}release(t){s.Hh(t+48,16,2)<=0||1===s.jb(t+48,1,16,2)&&s.M_(t+48,-1,16,2)}}},84290:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(134),s=r(40046),a=r(73783),n=r(37837),o=(r(47958),r(71517));class c{constructor(t,e){(0,i.A)(this,"list",void 0),(0,i.A)(this,"mutex",void 0),this.list=t,this.mutex=e}alloc(){let t=this.list.find((t=>-1===s.p_(t+80,-1,1,16,2)),20);return t||(t=(0,n.Gy)(88),(0,o.Pd)(t),s.M_(t+80,1,16,2),a.s2(this.mutex),this.list.push(t,20),a.Tl(this.mutex)),t}release(t){s.Hh(t+80,16,2)<=0||1===s.jb(t+80,1,16,2)&&((0,o.Up)(t),s.M_(t+80,-1,16,2))}}},97317:(t,e,r)=>{"use strict";r.d(e,{I:()=>a});var i=r(80662);const s=new(r.n(i)());function a(t){if(s.has(t))return s.get(t);const e=B[t];if(!e)return;const r={log2ChromaW:e[0],log2ChromaH:e[1],flags:e[2],comp:e[3].map((t=>({plane:t[0],step:t[1],offset:t[2],shift:t[3],depth:t[4]})))};return s.set(t,r),r}const n=[[0,1,0,0,8],[1,1,0,0,8],[2,1,0,0,8]],o=[...n,[3,1,0,0,8]],c=[[0,2,0,0,9],[1,2,0,0,9],[2,2,0,0,9]],d=[...c,[3,2,0,0,9]],h=[[0,2,0,0,10],[1,2,0,0,10],[2,2,0,0,10]],l=[...h,[3,2,0,0,10]],u=[[0,2,0,0,12],[1,2,0,0,12],[2,2,0,0,12]],f=[...u,[3,2,0,0,12]],p=[[0,2,0,0,14],[1,2,0,0,14],[2,2,0,0,14]],m=[[0,2,0,0,16],[1,2,0,0,16],[2,2,0,0,16]],g=[...m,[3,2,0,0,16]],v=[[0,1,0,0,8],[1,2,0,0,8],[1,2,1,0,8]],A=[[0,1,0,0,8],[1,2,1,0,8],[1,2,0,0,8]],y=[[0,8,2,0,16],[0,8,4,0,16],[0,8,6,0,16],[0,8,0,0,16]],b=[[0,2,0,6,10],[1,4,0,6,10],[1,4,2,6,10]],w=[[0,2,0,4,12],[1,4,0,4,12],[1,4,2,4,12]],k=[[0,2,0,0,16],[1,4,0,0,16],[1,4,2,0,16]],x=[[0,8,0,0,16],[0,8,2,0,16],[0,8,4,0,16],[0,8,6,0,16]],I=[[0,8,4,0,16],[0,8,2,0,16],[0,8,0,0,16],[0,8,6,0,16]],T=[[2,2,0,0,9],[0,2,0,0,9],[1,2,0,0,9]],P=[[2,2,0,0,10],[0,2,0,0,10],[1,2,0,0,10]],S=[[2,2,0,0,12],[0,2,0,0,12],[1,2,0,0,12]],_=[[2,2,0,0,14],[0,2,0,0,14],[1,2,0,0,14]],M=[[2,2,0,0,16],[0,2,0,0,16],[1,2,0,0,16]],C=[[2,2,0,0,16],[0,2,0,0,16],[1,2,0,0,16],[3,2,0,0,16]],B={6:[2,2,16,n],0:[1,1,16,n],12:[1,1,16,n],4:[1,0,16,n],13:[1,0,16,n],5:[0,0,16,n],14:[0,0,16,n],23:[1,1,16,v],24:[1,1,16,A],188:[0,0,16,v],189:[0,0,16,A],59:[1,1,17,c],60:[1,1,16,c],69:[1,0,17,c],70:[1,0,16,c],65:[0,0,17,c],66:[0,0,16,c],61:[1,1,17,h],62:[1,1,16,h],63:[1,0,17,h],64:[1,0,16,h],67:[0,0,17,h],68:[0,0,16,h],122:[1,1,17,u],123:[1,1,16,u],126:[1,0,17,u],127:[1,0,16,u],130:[0,0,17,u],131:[0,0,16,u],124:[1,1,17,p],125:[1,1,16,p],128:[1,0,17,p],129:[1,0,16,p],132:[0,0,17,p],133:[0,0,16,p],46:[1,1,17,m],45:[1,1,16,m],48:[1,0,17,m],47:[1,0,16,m],50:[0,0,17,m],49:[0,0,16,m],33:[1,1,144,o],78:[1,0,144,o],79:[0,0,144,o],80:[1,1,145,d],81:[1,1,144,d],82:[1,0,145,d],83:[1,0,144,d],84:[0,0,145,d],85:[0,0,144,d],86:[1,1,145,l],87:[1,1,144,l],88:[1,0,145,l],89:[1,0,144,l],90:[0,0,145,l],91:[0,0,144,l],184:[1,0,145,f],185:[1,0,144,f],186:[0,0,145,f],187:[0,0,144,f],92:[1,1,145,g],93:[1,1,144,g],94:[1,0,145,g],95:[1,0,144,g],96:[0,0,145,g],97:[0,0,144,g],156:[0,0,129,y],155:[0,0,128,y],159:[1,1,17,b],158:[1,1,16,b],210:[1,1,17,w],209:[1,1,16,w],170:[1,1,17,k],169:[1,1,16,k],8:[0,0,0,[[0,1,0,0,8]]],29:[0,0,1,[[0,2,0,0,16]]],30:[0,0,0,[[0,2,0,0,16]]],56:[0,0,128,[[0,2,0,0,8],[0,2,1,0,8]]],109:[0,0,129,[[0,4,0,0,16],[0,4,2,0,16]]],110:[0,0,128,[[0,4,0,0,16],[0,4,2,0,16]]],26:[0,0,160,[[0,4,0,0,8],[0,4,1,0,8],[0,4,2,0,8],[0,4,3,0,8]]],25:[0,0,160,[[0,4,1,0,8],[0,4,2,0,8],[0,4,3,0,8],[0,4,0,0,8]]],104:[0,0,161,x],105:[0,0,160,x],28:[0,0,160,[[0,4,2,0,8],[0,4,1,0,8],[0,4,0,0,8],[0,4,3,0,8]]],27:[0,0,160,[[0,4,3,0,8],[0,4,2,0,8],[0,4,1,0,8],[0,4,0,0,8]]],106:[0,0,161,I],107:[0,0,160,I],2:[0,0,32,[[0,3,0,0,8],[0,3,1,0,8],[0,3,2,0,8]]],3:[0,0,32,[[0,3,2,0,8],[0,3,1,0,8],[0,3,0,0,8]]],119:[0,0,32,[[0,4,0,0,8],[0,4,1,0,8],[0,4,2,0,8]]],121:[0,0,32,[[0,4,2,0,8],[0,4,1,0,8],[0,4,0,0,8]]],71:[0,0,48,[[2,1,0,0,8],[0,1,0,0,8],[1,1,0,0,8]]],111:[0,0,176,[[2,1,0,0,8],[0,1,0,0,8],[1,1,0,0,8],[3,1,0,0,8]]],72:[0,0,49,T],73:[0,0,48,T],74:[0,0,49,P],75:[0,0,48,P],134:[0,0,49,S],135:[0,0,48,S],136:[0,0,49,_],137:[0,0,48,_],76:[0,0,49,M],77:[0,0,48,M],112:[0,0,177,C],113:[0,0,176,C]}},58055:(t,e,r)=>{"use strict";r.d(e,{J:()=>i});const i={0:{bits:8,planar:!1},1:{bits:16,planar:!1},2:{bits:32,planar:!1},10:{bits:64,planar:!1},3:{bits:32,planar:!1},4:{bits:64,planar:!1},5:{bits:8,planar:!0},6:{bits:16,planar:!0},7:{bits:32,planar:!0},11:{bits:64,planar:!0},8:{bits:32,planar:!0},9:{bits:64,planar:!0}}},62751:(t,e,r)=>{"use strict";r.d(e,{$$:()=>a,Eh:()=>p,HR:()=>s,IY:()=>A,Ki:()=>v,Mb:()=>g,Sz:()=>h,Xp:()=>c,_R:()=>n,_m:()=>f,d8:()=>m,iW:()=>l,mX:()=>u,n1:()=>o,os:()=>i,qO:()=>d});const i={86017:"mp3",86018:"mp4a.40",86021:"vorbis",86028:"flac",86076:"opus",65542:"ulaw",65543:"alaw",86019:"ac-3",86056:"ec-3",86020:"dtsc",225:"av01",27:"avc1",173:"hev1",196:"vvc1",139:"vp8",167:"vp09",12:"mp4v"},s={flv:0,mp4:1,m4s:1,mov:1,ts:2,mts:2,m2ts:2,ivf:5,opus:4,oggs:4,ogg:4,m3u8:2,m3u:2,mpd:1,mp3:14,mkv:8,mka:8,webm:9,aac:15,flac:17,wav:16,srt:19,vtt:18,ssa:20,ass:20,xml:21,ttml:21,h264:11,264:11,avc:11,h265:12,265:12,hevc:12,h266:13,266:13,vvc:13,mpeg:3,mpg:3,rtsp:6,rtmp:7,avi:10},a={m3u8:4,m3u:4,mpd:5},n={copy:0,h264:27,h261:3,h263:4,h263i:20,h263p:19,mjpeg:7,wmv1:17,wmv2:18,wmv3:71,avc:27,hevc:173,h265:173,vvc:196,h266:196,av1:225,vp9:167,vp8:139,mpeg4:12,theora:30,mpeg2video:2,rv10:5,rv20:6,rv30:68,rv40:69},o={copy:0,aac:86018,ac3:86019,eac3:86056,dts:86020,mp3:86017,opus:86076,flac:86028,speex:86051,vorbis:86021,pcm_alaw:65543,pcm_mulaw:65542,wmav1:86023,wmav2:86024,cook:86036,sipr:86057,ralf:86073,pcm_u8:65541,pcm_s16le:65536,pcm_s24le:65548,pcm_s32le:65544,pcm_s64le:65567,pcm_f32le:65557,pcm_f64le:65559},c={webvtt:94226,subrip:94225,ass:94230,ttml:94232,mov_text:94213,hdmv_pgs:94214,hdmv_text:94231,dvd:94208,dvb:94209,eia_608:94218},d={yuv420p:0,yuv422p:4,yuv444p:5,yuva420p:33,yuva422p:78,yuva444p:79,yuvj420p:12,yuvj422p:13,yuvj444p:14,yuv420p10le:62,yuv422p10le:64,yuv444p10le:68,yuva420p10le:87,yuva422p10le:89,yuva444p10le:91,yuv420p10be:61,yuv422p10be:63,yuv444p10be:67,yuva420p10be:86,yuva422p10be:88,yuva444p10be:90},h={u8:0,"u8-planar":5,s16:1,"s16-planar":6,s32:2,"s32-planar":7,s64:10,"s64-planar":11,float:3,"float-planar":8,double:4,"double-planar":9},l={flv:0,mp4:1,mov:1,ts:2,mpegts:2,mpeg:3,ivf:5,ogg:4,opus:4,m3u8:2,m3u:2,mpd:1,mp3:14,mkv:8,matroska:8,mka:8,webm:9,aac:15,flac:17,wav:16,raw_h264:11,raw_h265:12,raw_vvc:13,rtsp:6,rtmp:7,avi:10},u={tv:1,pc:2},f={bt709:1,fcc:4,bt470bg:5,smpte170m:6,smpte240m:7,ycgco:8,gbr:0,bt2020nc:9},p={bt709:1,bt470m:4,bt470bg:5,smpte170m:6,smpte240m:7,smpte428:10,film:8,smpte431:11,smpte432:12,bt2020:9,"jedec-p22":22,ebu3213:22},m={bt709:1,gamma22:4,gamma28:5,smpte170m:6,smpte240m:7,srgb:13,xvycc:11,"bt2020-10":14,"bt2020-12":15,smpte2084:16,"arib-std-b67":18},g={Audio:1,Video:0,Subtitle:3,Attachment:4,Data:2},v={default:1,dub:2,original:4,comment:8,lyrics:16,karaoke:32,forced:64,"hearing impaired":128,"visual impaired":256,"clean effects":512,"attached pic":1024,"timed thumbnails":2048,captions:65536,descriptions:131072,metadata:262144,dependent:524288,"still image":1048576},A={mono:4,stereo:3,2.1:11,"3.0":7,"3.0(back)":259,"4.0":263,quad:51,"quad(side)":1539,3.1:15,"5.0":55,"5.0(side)":1543,4.1:271,5.1:63,"5.1(side)":1551,"6.0":1799,"6.0(front)":1731,"3.1.2":20495,hexagonal:311,6.1:1807,"6.1(back)":319,"6.1(front)":1739,"7.0":1591,"7.0(front)":1735,7.1:1599,"7.1(wide)":255,"7.1(wide-side)":1743,"5.1.2":20543,octagonal:1847,cube:184371,"5.1.4":184383,"7.1.2":22079,"7.1.4":185919,"7.2.3":34359825983,"9.1.4":186111,hexadecagonal:6442710839,downmix:1610612736,22.2:2164663779327}},36981:(t,e,r)=>{"use strict";r.d(e,{r:()=>l});var i,s,a=r(134),n=r(80662),o=r.n(n),c=r(61499),d=r(12085);class h{constructor(){(0,a.A)(this,"id",void 0),(0,a.A)(this,"name",void 0),(0,a.A)(this,"opaque",void 0)}}i=h.prototype,(s=new(o())).set("id",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("name",{0:4,1:0,2:0,3:1,4:16,5:0,6:0,7:4,8:0}),s.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:20,8:0}),(0,d.A)(i,c.Og,!0),(0,d.A)(i,c.dc,4),(0,d.A)(i,c.g7,24),(0,d.A)(i,c.JY,s);class l{constructor(){(0,a.A)(this,"order",void 0),(0,a.A)(this,"nbChannels",void 0),(0,a.A)(this,"u",void 0),(0,a.A)(this,"opaque",void 0)}}!function(t){var e=new(o());e.set("order",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("nbChannels",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("u",{0:function(t){var e=new(o());return e.set("mask",{0:10,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("map",{0:h,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),(0,d.A)(t,c.Og,!0),(0,d.A)(t,c.dc,8),(0,d.A)(t,c.g7,8),(0,d.A)(t,c.JY,e),t}({}),1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),e.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),(0,d.A)(t,c.Og,!0),(0,d.A)(t,c.dc,8),(0,d.A)(t,c.g7,24),(0,d.A)(t,c.JY,e)}(l.prototype)},50288:(t,e,r)=>{"use strict";r.d(e,{BU:()=>u});var i,s,a=r(134),n=r(80662),o=r.n(n),c=r(61499),d=r(12085),h=r(73783);r(37837);class l{constructor(){(0,a.A)(this,"data",0),(0,a.A)(this,"size",0),(0,a.A)(this,"refcount",0),(0,a.A)(this,"free",0),(0,a.A)(this,"opaque",0),(0,a.A)(this,"flags",0),(0,a.A)(this,"flagsInternal",0)}}i=l.prototype,(s=new(o())).set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("size",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("refcount",{0:9,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),s.set("free",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),s.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),s.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),s.set("flagsInternal",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),(0,d.A)(i,c.Og,!0),(0,d.A)(i,c.dc,4),(0,d.A)(i,c.g7,28),(0,d.A)(i,c.JY,s);class u{constructor(){(0,a.A)(this,"buffer",0),(0,a.A)(this,"data",0),(0,a.A)(this,"size",0)}}!function(t){var e=new(o());e.set("buffer",{0:l,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("size",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,d.A)(t,c.Og,!0),(0,d.A)(t,c.dc,4),(0,d.A)(t,c.g7,12),(0,d.A)(t,c.JY,e)}(u.prototype);class f{constructor(){(0,a.A)(this,"mutex",void 0),(0,a.A)(this,"pool",0),(0,a.A)(this,"refcount",0),(0,a.A)(this,"size",0),(0,a.A)(this,"opaque",0),(0,a.A)(this,"alloc",0),(0,a.A)(this,"alloc2",0),(0,a.A)(this,"poolFree",0)}}!function(t){var e=new(o());e.set("mutex",{0:h.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("pool",{get 0(){return p},1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("refcount",{0:9,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),e.set("size",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),e.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),e.set("alloc",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:20,8:0}),e.set("alloc2",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:24,8:0}),e.set("poolFree",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:28,8:0}),(0,d.A)(t,c.Og,!0),(0,d.A)(t,c.dc,4),(0,d.A)(t,c.g7,32),(0,d.A)(t,c.JY,e)}(f.prototype);class p{constructor(){(0,a.A)(this,"data",0),(0,a.A)(this,"opaque",0),(0,a.A)(this,"free",0),(0,a.A)(this,"pool",0),(0,a.A)(this,"next",0),(0,a.A)(this,"buffer",void 0)}}!function(t){var e=new(o());e.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("free",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:8,8:0}),e.set("pool",{0:f,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),e.set("next",{0:p,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),e.set("buffer",{0:l,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),(0,d.A)(t,c.Og,!0),(0,d.A)(t,c.dc,4),(0,d.A)(t,c.g7,48),(0,d.A)(t,c.JY,e)}(p.prototype)},77162:(t,e,r)=>{"use strict";r.d(e,{A:()=>m});var i,s,a=r(134),n=r(80662),o=r.n(n),c=r(61499),d=r(12085),h=r(47958),l=r(9599),u=r(36981),f=r(77231),p=r(71766);class m{constructor(){(0,a.A)(this,"codecType",-1),(0,a.A)(this,"codecId",0),(0,a.A)(this,"codecTag",0),(0,a.A)(this,"extradata",0),(0,a.A)(this,"extradataSize",0),(0,a.A)(this,"codedSideData",0),(0,a.A)(this,"nbCodedSideData",0),(0,a.A)(this,"format",f.N_),(0,a.A)(this,"bitrate",BigInt(0)),(0,a.A)(this,"bitsPerCodedSample",0),(0,a.A)(this,"bitsPerRawSample",0),(0,a.A)(this,"profile",f.N_),(0,a.A)(this,"level",f.N_),(0,a.A)(this,"width",0),(0,a.A)(this,"height",0),(0,a.A)(this,"sampleAspectRatio",new l.P({den:1,num:1})),(0,a.A)(this,"framerate",new l.P({den:1,num:0})),(0,a.A)(this,"fieldOrder",0),(0,a.A)(this,"colorRange",0),(0,a.A)(this,"colorPrimaries",2),(0,a.A)(this,"colorTrc",2),(0,a.A)(this,"colorSpace",2),(0,a.A)(this,"chromaLocation",0),(0,a.A)(this,"videoDelay",0),(0,a.A)(this,"chLayout",void 0),(0,a.A)(this,"sampleRate",f.N_),(0,a.A)(this,"blockAlign",0),(0,a.A)(this,"frameSize",0),(0,a.A)(this,"initialPadding",0),(0,a.A)(this,"trailingPadding",0),(0,a.A)(this,"seekPreroll",0),(0,a.A)(this,"flags",0)}destroy(){(0,p.dn)(this[c.o9]),this[c.o9]=0}}i=m.prototype,(s=new(o())).set("codecType",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("codecId",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("codecTag",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),s.set("extradata",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),s.set("extradataSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),s.set("codedSideData",{0:h.lg,1:1,2:1,3:0,4:0,5:0,6:0,7:20,8:0}),s.set("nbCodedSideData",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),s.set("format",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),s.set("bitrate",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),s.set("bitsPerCodedSample",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:40,8:0}),s.set("bitsPerRawSample",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:44,8:0}),s.set("profile",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),s.set("level",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:52,8:0}),s.set("width",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:56,8:0}),s.set("height",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:60,8:0}),s.set("sampleAspectRatio",{0:l.P,1:0,2:0,3:0,4:0,5:0,6:0,7:64,8:0}),s.set("framerate",{0:l.P,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),s.set("fieldOrder",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),s.set("colorRange",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),s.set("colorPrimaries",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),s.set("colorTrc",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:92,8:0}),s.set("colorSpace",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:96,8:0}),s.set("chromaLocation",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:100,8:0}),s.set("videoDelay",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:104,8:0}),s.set("chLayout",{0:u.r,1:0,2:0,3:0,4:0,5:0,6:0,7:112,8:0}),s.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:136,8:0}),s.set("blockAlign",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:140,8:0}),s.set("frameSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:144,8:0}),s.set("initialPadding",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:148,8:0}),s.set("trailingPadding",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:152,8:0}),s.set("seekPreroll",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:156,8:0}),s.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:160,8:0}),(0,d.A)(i,c.Og,!0),(0,d.A)(i,c.dc,8),(0,d.A)(i,c.g7,168),(0,d.A)(i,c.JY,s)},56490:(t,e,r)=>{"use strict";r.d(e,{A:()=>l});var i,s,a=r(134),n=r(80662),o=r.n(n),c=r(61499),d=r(12085);class h{constructor(){(0,a.A)(this,"key",0),(0,a.A)(this,"value",0)}}i=h.prototype,(s=new(o())).set("key",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("value",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),(0,d.A)(i,c.Og,!0),(0,d.A)(i,c.dc,4),(0,d.A)(i,c.g7,8),(0,d.A)(i,c.JY,s);class l{constructor(){(0,a.A)(this,"count",0),(0,a.A)(this,"elems",0)}}!function(t){var e=new(o());e.set("count",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("elems",{0:h,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),(0,d.A)(t,c.Og,!0),(0,d.A)(t,c.dc,4),(0,d.A)(t,c.g7,8),(0,d.A)(t,c.JY,e)}(l.prototype)},55833:(t,e,r)=>{"use strict";r.d(e,{pu:()=>m});var i=r(134),s=r(80662),a=r.n(s),n=r(61499),o=r(12085),c=r(56490),d=r(50288),h=r(9599),l=r(94300),u=r(36981),f=r(77231),p=r(56024);const m=8;class g{constructor(){(0,i.A)(this,"type",0),(0,i.A)(this,"data",0),(0,i.A)(this,"size",0),(0,i.A)(this,"metadata",0),(0,i.A)(this,"buf",0)}}var v,A;v=g.prototype,(A=new(a())).set("type",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),A.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),A.set("size",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),A.set("metadata",{0:c.A,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),A.set("buf",{0:d.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),(0,o.A)(v,n.Og,!0),(0,o.A)(v,n.dc,4),(0,o.A)(v,n.g7,20),(0,o.A)(v,n.JY,A),function(t){var e=new(a());e.set("displayPrimaries",{0:h.P,1:0,2:0,3:1,4:6,5:0,6:0,7:0,8:0}),e.set("whitePoint",{0:h.P,1:0,2:0,3:1,4:2,5:0,6:0,7:48,8:0}),e.set("minLuminance",{0:h.P,1:0,2:0,3:0,4:0,5:0,6:0,7:64,8:0}),e.set("maxLuminance",{0:h.P,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),e.set("hasPrimaries",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),e.set("hasLuminance",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),(0,o.A)(t,n.Og,!0),(0,o.A)(t,n.dc,4),(0,o.A)(t,n.g7,88),(0,o.A)(t,n.JY,e)}(class{constructor(){(0,i.A)(this,"displayPrimaries",void 0),(0,i.A)(this,"whitePoint",void 0),(0,i.A)(this,"minLuminance",void 0),(0,i.A)(this,"maxLuminance",void 0),(0,i.A)(this,"hasPrimaries",void 0),(0,i.A)(this,"hasLuminance",void 0)}}.prototype),function(t){var e=new(a());e.set("maxCLL",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("maxFALL",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,o.A)(t,n.Og,!0),(0,o.A)(t,n.dc,4),(0,o.A)(t,n.g7,8),(0,o.A)(t,n.JY,e)}(class{constructor(){(0,i.A)(this,"maxCLL",void 0),(0,i.A)(this,"maxFALL",void 0)}}.prototype);class y{constructor(){(0,i.A)(this,"data",new Array(m).fill(0,0,m)),(0,i.A)(this,"linesize",new Array(m).fill(0,0,m)),(0,i.A)(this,"extendedData",0),(0,i.A)(this,"width",f.N_),(0,i.A)(this,"height",f.N_),(0,i.A)(this,"nbSamples",f.N_),(0,i.A)(this,"format",f.N_),(0,i.A)(this,"keyFrame",0),(0,i.A)(this,"pictType",0),(0,i.A)(this,"sampleAspectRatio",new h.P({den:1,num:0})),(0,i.A)(this,"pts",f.Dh),(0,i.A)(this,"pktDts",f.Dh),(0,i.A)(this,"timeBase",void 0),(0,i.A)(this,"quality",f.N_),(0,i.A)(this,"opaque",0),(0,i.A)(this,"repeatPict",f.N_),(0,i.A)(this,"interlacedFrame",f.N_),(0,i.A)(this,"topFieldFirst",f.N_),(0,i.A)(this,"paletteHasChanged",f.N_),(0,i.A)(this,"sampleRate",f.N_),(0,i.A)(this,"buf",new Array(m).fill(0,0,m)),(0,i.A)(this,"extendedBuf",0),(0,i.A)(this,"nbExtendedBuf",0),(0,i.A)(this,"sideData",0),(0,i.A)(this,"nbSideData",0),(0,i.A)(this,"flags",0),(0,i.A)(this,"colorRange",0),(0,i.A)(this,"colorPrimaries",2),(0,i.A)(this,"colorTrc",2),(0,i.A)(this,"colorSpace",2),(0,i.A)(this,"chromaLocation",0),(0,i.A)(this,"bestEffortTimestamp",f.Dh),(0,i.A)(this,"pktPos",f.Dh),(0,i.A)(this,"metadata",0),(0,i.A)(this,"decodeErrorFlags",0),(0,i.A)(this,"pktSize",f.N_),(0,i.A)(this,"hwFramesCtx",0),(0,i.A)(this,"opaqueRef",0),(0,i.A)(this,"cropTop",0),(0,i.A)(this,"cropBottom",0),(0,i.A)(this,"cropLeft",0),(0,i.A)(this,"cropRight",0),(0,i.A)(this,"privateRef",0),(0,i.A)(this,"chLayout",void 0),(0,i.A)(this,"duration",BigInt(0))}close(){(0,p.to)(this[n.o9]),(0,l.A)(this)}}!function(t){var e=new(a());e.set("data",{0:2,1:1,2:1,3:1,4:8,5:0,6:0,7:0,8:0}),e.set("linesize",{0:15,1:0,2:0,3:1,4:8,5:0,6:0,7:32,8:0}),e.set("extendedData",{0:2,1:1,2:2,3:0,4:0,5:0,6:0,7:64,8:0}),e.set("width",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:68,8:0}),e.set("height",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),e.set("nbSamples",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:76,8:0}),e.set("format",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),e.set("keyFrame",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),e.set("pictType",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),e.set("sampleAspectRatio",{0:h.P,1:0,2:0,3:0,4:0,5:0,6:0,7:92,8:0}),e.set("pts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:104,8:0}),e.set("pktDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:112,8:0}),e.set("timeBase",{0:h.P,1:0,2:0,3:0,4:0,5:0,6:0,7:120,8:0}),e.set("quality",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:128,8:0}),e.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:132,8:0}),e.set("repeatPict",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:136,8:0}),e.set("interlacedFrame",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:140,8:0}),e.set("topFieldFirst",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:144,8:0}),e.set("paletteHasChanged",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:148,8:0}),e.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:152,8:0}),e.set("buf",{0:d.BU,1:1,2:1,3:1,4:8,5:0,6:0,7:156,8:0}),e.set("extendedBuf",{0:d.BU,1:1,2:2,3:0,4:0,5:0,6:0,7:188,8:0}),e.set("nbExtendedBuf",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:192,8:0}),e.set("sideData",{0:g,1:1,2:2,3:0,4:0,5:0,6:0,7:196,8:0}),e.set("nbSideData",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:200,8:0}),e.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:204,8:0}),e.set("colorRange",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:208,8:0}),e.set("colorPrimaries",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:212,8:0}),e.set("colorTrc",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:216,8:0}),e.set("colorSpace",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:220,8:0}),e.set("chromaLocation",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:224,8:0}),e.set("bestEffortTimestamp",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:232,8:0}),e.set("pktPos",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:240,8:0}),e.set("metadata",{0:c.A,1:1,2:1,3:0,4:0,5:0,6:0,7:248,8:0}),e.set("decodeErrorFlags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:252,8:0}),e.set("pktSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:256,8:0}),e.set("hwFramesCtx",{0:d.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:260,8:0}),e.set("opaqueRef",{0:d.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:264,8:0}),e.set("cropTop",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:268,8:0}),e.set("cropBottom",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:272,8:0}),e.set("cropLeft",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:276,8:0}),e.set("cropRight",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:280,8:0}),e.set("privateRef",{0:d.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:284,8:0}),e.set("chLayout",{0:u.r,1:0,2:0,3:0,4:0,5:0,6:0,7:288,8:0}),e.set("duration",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:312,8:0}),(0,o.A)(t,n.Og,!0),(0,o.A)(t,n.dc,8),(0,o.A)(t,n.g7,320),(0,o.A)(t,n.JY,e)}(y.prototype),function(t){var e=new(a());e.set("refCount",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:320,8:0}),(0,o.A)(t,n.Og,!0),(0,o.A)(t,n.dc,8),(0,o.A)(t,n.g7,328),(0,o.A)(t,n.JY,e)}(class extends y{constructor(...t){super(...t),(0,i.A)(this,"refCount",void 0)}}.prototype)},47958:(t,e,r)=>{"use strict";r.d(e,{lg:()=>f});var i,s,a=r(134),n=r(80662),o=r.n(n),c=r(61499),d=r(12085),h=r(50288),l=r(9599),u=r(77231);class f{constructor(){(0,a.A)(this,"data",0),(0,a.A)(this,"size",0),(0,a.A)(this,"type",-1)}}i=f.prototype,(s=new(o())).set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("size",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("type",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,d.A)(i,c.Og,!0),(0,d.A)(i,c.dc,4),(0,d.A)(i,c.g7,12),(0,d.A)(i,c.JY,s),function(t){var e=new(o());e.set("wallclock",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,d.A)(t,c.Og,!0),(0,d.A)(t,c.dc,8),(0,d.A)(t,c.g7,16),(0,d.A)(t,c.JY,e)}(class{constructor(){(0,a.A)(this,"wallclock",void 0),(0,a.A)(this,"flags",void 0)}}.prototype);class p{constructor(){(0,a.A)(this,"buf",0),(0,a.A)(this,"pts",u.Dh),(0,a.A)(this,"dts",u.Dh),(0,a.A)(this,"data",0),(0,a.A)(this,"size",0),(0,a.A)(this,"streamIndex",u.N_),(0,a.A)(this,"flags",0),(0,a.A)(this,"sideData",0),(0,a.A)(this,"sideDataElems",0),(0,a.A)(this,"duration",u.Dh),(0,a.A)(this,"pos",u.Dh),(0,a.A)(this,"opaque",0),(0,a.A)(this,"opaqueRef",0),(0,a.A)(this,"timeBase",new l.P({den:u.SF,num:1}))}}!function(t){var e=new(o());e.set("buf",{0:h.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("pts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),e.set("dts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),e.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:24,8:0}),e.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),e.set("streamIndex",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),e.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:36,8:0}),e.set("sideData",{0:f,1:1,2:1,3:0,4:0,5:0,6:0,7:40,8:0}),e.set("sideDataElems",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:44,8:0}),e.set("duration",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),e.set("pos",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:56,8:0}),e.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:64,8:0}),e.set("opaqueRef",{0:h.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:68,8:0}),e.set("timeBase",{0:l.P,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),(0,d.A)(t,c.Og,!0),(0,d.A)(t,c.dc,8),(0,d.A)(t,c.g7,80),(0,d.A)(t,c.JY,e)}(p.prototype),function(t){var e=new(o());e.set("refCount",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),(0,d.A)(t,c.Og,!0),(0,d.A)(t,c.dc,8),(0,d.A)(t,c.g7,88),(0,d.A)(t,c.JY,e)}(class extends p{constructor(...t){super(...t),(0,a.A)(this,"refCount",void 0)}}.prototype)},10278:(t,e,r)=>{"use strict";r.d(e,{A:()=>h});var i,s,a=r(134),n=r(80662),o=r.n(n),c=r(61499),d=r(12085);class h{constructor(){(0,a.A)(this,"data",void 0),(0,a.A)(this,"linesize",void 0),(0,a.A)(this,"nbSamples",void 0),(0,a.A)(this,"maxnbSamples",void 0),(0,a.A)(this,"channels",void 0),(0,a.A)(this,"sampleRate",void 0),(0,a.A)(this,"format",void 0),(0,a.A)(this,"timestamp",void 0),(0,a.A)(this,"duration",void 0)}}i=h.prototype,(s=new(o())).set("data",{0:2,1:1,2:2,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("linesize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("nbSamples",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),s.set("maxnbSamples",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),s.set("channels",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),s.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),s.set("format",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),s.set("timestamp",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),s.set("duration",{0:19,1:0,2:0,3:0,4:0,5:0,6:0,7:40,8:0}),(0,d.A)(i,c.Og,!0),(0,d.A)(i,c.dc,8),(0,d.A)(i,c.g7,48),(0,d.A)(i,c.JY,s),function(t){var e=new(o());e.set("refCount",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),(0,d.A)(t,c.Og,!0),(0,d.A)(t,c.dc,8),(0,d.A)(t,c.g7,56),(0,d.A)(t,c.JY,e)}(class extends h{constructor(...t){super(...t),(0,a.A)(this,"refCount",void 0)}}.prototype)},9599:(t,e,r)=>{"use strict";r.d(e,{P:()=>h});var i,s,a=r(134),n=r(80662),o=r.n(n),c=r(61499),d=r(12085);class h{constructor(t){(0,a.A)(this,"num",1),(0,a.A)(this,"den",1),t&&(this.den=t.den,this.num=t.num)}}i=h.prototype,(s=new(o())).set("num",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("den",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,d.A)(i,c.Og,!0),(0,d.A)(i,c.dc,4),(0,d.A)(i,c.g7,8),(0,d.A)(i,c.JY,s)},37815:(t,e,r)=>{"use strict";r.d(e,{A6:()=>v,D$:()=>u,Q7:()=>m,VG:()=>f,aw:()=>l,us:()=>g});var i=r(14686),s=r(63939),a=r(50932),n=r(37837),o=r(40046),c=(r(50288),r(73783)),d=r(52699);const h=1;function l(t,e,r=0,i=0,s=0){const c=(0,n.Gy)(28);if(!c)return 0;const d=function(t,e,r,i=0,s=0,c=0){a.M[20](t,e),a.M[25](t+4,r),a.M[20](t+12,i),a.M[20](t+16,s),o.M_(t+8,1,9,2),a.M[15](t+20,c);const d=(0,n.Gy)(12);return d?(a.M[20](d,t),a.M[20](d+4,e),a.M[25](d+8,r),d):0}(c,t,e,r,i,s);return d||((0,n.Eb)(c),0)}function u(t){return l((0,n.sY)(t),t)}function f(t){const e=(0,n.Gy)(12);return(0,i.Mr)(e,t,12),o.WQ(s.f[20](t)+8,1,9,2),e}function p(t,e){const r=s.f[20](s.f[20](t));if(e?((0,i.Mr)(s.f[20](t),s.f[20](e),12),(0,n.aI)(e)):(0,n.aI)(t),1===o.jb(r+8,1,9,2)){const t=!(2&s.f[15](r+24));s.f[20](r+16)?A(s.f[20](r+16),s.f[20](r)):(0,n.Eb)(s.f[20](r)),t&&(0,n.Eb)(r)}}function m(t){t&&s.f[20](t)&&p(t,0)}function g(t,e){const r=s.f[20](t);if(!e)return m(t),0;if(r&&s.f[20](r+4)===s.f[20](e+4))return a.M[20](r+4,s.f[20](e+4)),a.M[25](r+8,s.f[25](e+8)),0;const i=f(e);return m(t),a.M[20](t,i),0}function v(t,e){if(!s.f[20](t)){const r=l((0,n.cz)(0,e),e);return a.M[20](t,r),a.M[15](s.f[20](r)+24,s.f[15](s.f[20](r)+24)|h),0}const r=s.f[20](t),c=s.f[20](r);if(s.f[25](r+8)===e)return 0;if(!(s.f[15](c+24)&h&&function(t){return 1&s.f[15](s.f[20](t)+20)?0:1===o.Hh(s.f[20](t)+8,9,2)?1:0}(r)&&s.f[20](r+4)===s.f[20](c))){let r=d.z(4);a.M[20](r,0);const n=v(r,e);return n<0?(d.t(4),n):((0,i.Mr)(s.f[20](s.f[20](r)+4),s.f[20](c),Math.min(e,s.f[25](c+4))),p(t,r),d.t(4),0)}const u=(0,n.cz)(s.f[20](c),e);return a.M[20](r+4,u),a.M[20](c,u),a.M[25](r+8,e),a.M[25](c+4,e),0}function A(t,e){const r=t,i=s.f[20](r+12);c.s2(i),a.M[20](r+16,s.f[20](i+4)),a.M[20](i+4,r),c.Tl(i),1===o.jb(i+8,1,9,2)&&function(t){!function(t){for(;s.f[20](t+4);){const e=s.f[20](t+4);a.M[20](t+4,s.f[20](e+16)),s.f[20](e+4)?A(s.f[20](e+4),s.f[20](e)):(0,n.Eb)(s.f[20](e)),(0,n.Eb)(e)}}(t),c.zr(t),(0,n.Eb)(t)}(i)}},73749:(t,e,r)=>{"use strict";r.d(e,{AO:()=>l,IH:()=>h,a5:()=>f});var i=r(63939),s=r(50932),a=(r(56490),r(11473)),n=r(14686),o=r(37837),c=r(67672),d=r(62100);function h(t){l(i.f[20](t)),(0,o.aI)(t)}function l(t){if(t){for(;s.M[15](t,i.f[15](t)-1),i.f[15](t)+1;)(0,o.aI)(i.f[20](t+4)+8*i.f[15](t)),(0,o.aI)(i.f[20](t+4)+8*i.f[15](t)+4);(0,o.aI)(t+4)}}function u(t,e){let r=0;return t?(e&&(r=1+(e-i.f[20](t+4)>>3)),r>=i.f[15](t)?0:i.f[20](t+4)+8*r):0}function f(t,e,r,o=0){if(!t)throw new Error("m is nullptr");let h=0;if(64&o&&(h=function(t,e,r=0,s=0){if(!t)return 0;let a=r;if(!e)return 0;for(;a=u(t,a);){let t=(0,n.lH)(i.f[20](a));if(1&s&&(t.toLocaleLowerCase(),e.toLocaleLowerCase()),t===e||2&s&&0===t.indexOf(e))return a}}(t,e,0,o)),h){if(16&o)return 0;32&o&&(r=`${(0,n.lH)(i.f[20](h+4))},${r}`),a.s_.free(i.f[20](h+4)),s.M[20](h+4,a.s_.malloc(r.length+1)),(0,n.qW)(i.f[20](h+4),r,r.length)}else{c.Yj(r)||(r=(0,d.A)(r));let o=a.s_.realloc(i.f[20](t+4),8*(i.f[15](t)+1));s.M[20](t+4,o),s.M[20](i.f[20](t+4)+8*i.f[15](t),a.s_.malloc(e.length+1)),s.M[20](i.f[20](t+4)+8*i.f[15](t)+4,a.s_.malloc(r.length+1)),(0,n.qW)(i.f[20](i.f[20](t+4)+8*i.f[15](t)),e,e.length),(0,n.qW)(i.f[20](i.f[20](t+4)+8*i.f[15](t)+4),r,r.length),s.M[15](t,i.f[15](t)+1)}return 0}},56024:(t,e,r)=>{"use strict";r.d(e,{FP:()=>m,_h:()=>y,aH:()=>A,rh:()=>b,to:()=>w,xj:()=>g});var i,s=r(63939),a=r(50932),n=(r(36981),r(9599),r(55833)),o=r(37837),c=r(14686),d=r(77231),h=r(37815),l=r(73749),u=r(99991),f=r(66788),p=r(9705);function m(){const t=(0,o.Gy)(320);return y(t),t}function g(t){w(t),(0,o.Eb)(t)}function v(t){const e=s.f[20](t);(0,h.Q7)(e+16),(0,l.IH)(e+12),(0,o.aI)(t)}function A(t,e){for(let r=0;r<s.f[15](t+200);r++)if(s.f[15](s.f[20](s.f[20](t+196)+4*r))===e)return s.f[20](s.f[20](t+196)+4*r);return 0}function y(t){s.f[20](t+64)!==t&&(0,o.aI)(t+64),(0,u.bl)(t+288),(0,c.sO)(t,0,320),a.M[17](t+104,d.Dh),a.M[17](t+112,d.Dh),a.M[17](t+232,d.Dh),a.M[17](t+240,d.Dh),a.M[15](t+256,-1),a.M[15](t+84,1),a.M[15](t+92,0),a.M[15](t+96,1),a.M[15](t+80,-1),a.M[20](t+64,t),a.M[15](t+212,2),a.M[15](t+216,2),a.M[15](t+220,2),a.M[15](t+208,0),a.M[15](t+224,0),a.M[15](t+204,0)}function b(t,e){const r=(0,f.K0)(s.f[15](t+80)),i=s.f[15](t+292),c=r?i:1;let d=0;if(!s.f[15](t+32)){if(d=(0,f.f8)(s.f[15](t+80),i,s.f[15](t+76),e),d<0)return d;a.M[15](t+32,d)}if(c>n.pu){if(a.M[20](t+64,(0,o.sY)(4*c)),a.M[20](t+188,(0,o.sY)(4*c)),!s.f[20](t+188)||!s.f[20](t+64))return(0,o.aI)(t+64),(0,o.aI)(t+188),p.gR;a.M[15](t+192,c-n.pu)}else a.M[20](t+64,t);for(let e=0;e<Math.min(c,n.pu);e++){if(a.M[20](t+156+4*e,(0,h.D$)(s.f[15](t+32))),!s.f[20](t+156+4*e))return w(t),p.gR;a.M[20](s.f[20](t+64)+4*e,s.f[20](s.f[20](t+156+4*e)+4)),a.M[20](t+4*e,s.f[20](s.f[20](t+156+4*e)+4))}for(let e=0;e<c-n.pu;e++){if(a.M[20](s.f[20](t+188)+4*e,(0,h.D$)(s.f[15](t+32))),!s.f[20](s.f[20](t+188)+4*e))return w(t),p.gR;a.M[20](s.f[20](t+64)+4*(e+n.pu),s.f[20](s.f[20](s.f[20](t+188)+4*e)+4))}}function w(t){if(t){!function(t){!function(t,e){const r=s.f[15](e),i=s.f[20](t);for(let t=0;t<r;t++)v(i+4*t);a.M[15](e,0),(0,o.aI)(t)}(t+196,t+200)}(t);for(let e=0;e<8;e++)(0,h.Q7)(t+156+4*e);for(let e=0;e<s.f[15](t+192);e++)(0,h.Q7)(s.f[20](t+188)+4*e);(0,o.aI)(t+188),(0,l.IH)(t+248),(0,h.Q7)(t+260),(0,h.Q7)(t+264),(0,h.Q7)(t+284),y(t)}}r(97317),r(38156),function(t){t[t.UNIQUE=1]="UNIQUE"}(i||(i={}))},71517:(t,e,r)=>{"use strict";r.d(e,{$W:()=>m,E4:()=>g,Is:()=>A,NX:()=>_,NZ:()=>w,Ow:()=>v,Pd:()=>k,Qe:()=>b,Un:()=>l,Up:()=>P,Zx:()=>S,_5:()=>y,fQ:()=>p,iI:()=>h,rN:()=>T,rU:()=>u,sn:()=>f,zu:()=>x});var i=r(14686),s=r(63939),a=r(50932),n=(r(47958),r(37837)),o=r(77231),c=r(37815);const d=64;function h(t,e){return e?(0,i.JW)(s.f[20](t+24),s.f[15](t+28)):(0,i.s3)(s.f[20](t+24),s.f[15](t+28))}function l(t,e,r){const i=s.f[15](e),a=s.f[20](t);for(let t=0;t<i;t++)if(s.f[15](a+12*t+8)===r)return a+12*t;return 0}function u(t,e){return l(t+40,t+44,e)}function f(t,e,r){const i=s.f[15](e),a=s.f[20](t);for(let t=0;t<i;t++)if(s.f[15](a+12*t+8)===r)return!0;return!1}function p(t,e){return f(t+40,t+44,e)}function m(t,e,r,o,c){const d=s.f[15](e),h=s.f[20](t);for(let t=0;t<d;t++)if(s.f[15](h+12*t+8)===r)return(0,n.Eb)(s.f[20](h+12*t)),a.M[20](h+12*t,o),void a.M[25](h+12*t+4,c);const l=12*(d+1),u=(0,n.Gy)(l);if(d)for(let t=0;t<d;t++)(0,i.Mr)(u+12*t,h+12*t,12);const f=u+12*d;return a.M[20](f,o),a.M[15](f+8,r),a.M[25](f+4,c),h&&(0,n.Eb)(h),a.M[20](t,u),a.M[15](e,d+1),f}function g(t,e,r,s){const a=(0,n.sY)(s+d);return(0,i.sO)(a+s,0,d),m(t,e,r,a,s)}function v(t,e,r,i){m(t+40,t+44,e,r,i)}function A(t,e){let r=-1;for(let i=0;i<s.f[15](t+44);i++)if(s.f[15](s.f[20](t+40)+12*i+8)===e){r=i;break}if(r>-1)if(1===s.f[15](t+44))(0,n.Eb)(s.f[20](s.f[20](t+40))),(0,n.Eb)(s.f[20](t+40)),a.M[20](t+40,0),a.M[15](t+44,0);else{const e=12*(s.f[15](t+44)-1),o=(0,n.Gy)(e);for(let e=0;e<s.f[15](t+44);e++)e!==r?(0,i.Mr)(o+12*e,s.f[20](t+40)+12*e,12):(0,n.Eb)(s.f[20](s.f[20](t+40)+12*e));(0,n.Eb)(s.f[20](t+40)),a.M[20](t+40,o),a.M[15](t+44,s.f[15](t+44)-1)}}function y(){const t=(0,n.Gy)(80);return k(t),t}function b(t){P(t),(0,n.Eb)(t)}function w(t,e){const r=s.f[20](t),i=s.f[15](e);if(r){for(let t=0;t<i;t++)(0,n.Eb)(s.f[20](r+12*t));(0,n.aI)(t),a.M[15](e,0)}}function k(t){a.M[20](t+24,0),a.M[15](t+28,0),a.M[20](t+40,0),a.M[15](t+44,0),a.M[15](t+32,o.N_),a.M[17](t+56,o.Dh),a.M[17](t+48,o.Dh),a.M[15](t+36,0),a.M[17](t+16,o.Dh),a.M[17](t+8,o.Dh),a.M[15](t+76,o.SF),a.M[15](t+72,1),a.M[20](t,0)}function x(t,e){return a.M[15](t+32,s.f[15](e+32)),a.M[17](t+56,s.f[17](e+56)),a.M[17](t+48,s.f[17](e+48)),a.M[15](t+36,s.f[15](e+36)),a.M[17](t+16,s.f[17](e+16)),a.M[17](t+8,s.f[17](e+8)),a.M[20](t+64,s.f[20](e+64)),a.M[15](t+76,s.f[15](e+76)),a.M[15](t+72,s.f[15](e+72)),a.M[20](t+68,0),(0,c.us)(t+68,s.f[20](e+68)),function(t,e){if(w(t+40,t+44),s.f[15](e+44)){let r=12;a.M[20](t+40,(0,n.Gy)(r*s.f[15](e+44)));for(let r=0;r<s.f[15](e+44);r++)a.M[25](s.f[20](t+40)+12*r+4,s.f[25](s.f[20](e+40)+12*r+4)),a.M[15](s.f[20](t+40)+12*r+8,s.f[15](s.f[20](e+40)+12*r+8)),a.M[20](s.f[20](t+40)+12*r,(0,n.sY)(s.f[25](s.f[20](e+40)+12*r+4))),(0,i.Mr)(s.f[20](s.f[20](t+40)+12*r),s.f[20](s.f[20](e+40)+12*r),s.f[25](s.f[20](e+40)+12*r+4));a.M[15](t+44,s.f[15](e+44))}}(t,e),0}function I(t,e){return(0,c.A6)(t,e+d),(0,i.sO)(s.f[20](s.f[20](t)+4)+e,0,d),0}function T(t,e){return s.f[20](t)&&(0,c.Q7)(t),a.M[20](t,0),x(t,e),!s.f[20](e)&&s.f[15](e+28)?(I(t,s.f[15](e+28)),s.f[15](e+28)&&(0,i.Mr)(s.f[20](s.f[20](t)+4),s.f[20](e+24),s.f[15](e+28)),a.M[20](t+24,s.f[20](s.f[20](t)+4))):s.f[20](e)&&(a.M[20](t,(0,c.VG)(s.f[20](e))),a.M[20](t+24,s.f[20](e+24))),a.M[15](t+28,s.f[15](e+28)),0}function P(t){w(t+40,t+44),(0,c.Q7)(t+68),s.f[20](t)?(0,c.Q7)(t):s.f[20](t+24)&&(0,n.Eb)(s.f[20](t+24)),k(t)}function S(t,e){s.f[20](t)&&(0,c.Q7)(t),a.M[20](t,0),!s.f[20](e)&&s.f[15](e+28)?(I(t,s.f[15](e+28)),s.f[15](e+28)&&(0,i.Mr)(s.f[20](s.f[20](t)+4),s.f[20](e+24),s.f[15](e+28)),a.M[20](t+24,s.f[20](s.f[20](t)+4))):s.f[20](e)&&(a.M[20](t,(0,c.VG)(s.f[20](e))),a.M[20](t+24,s.f[20](e+24))),a.M[15](t+28,s.f[15](e+28))}function _(t,e,r){s.f[20](t)?(0,c.Q7)(t):s.f[20](t+24)&&(0,n.Eb)(s.f[20](t+24)),a.M[20](t,(0,c.aw)(e,r+d)),a.M[20](t+24,e),a.M[15](t+28,r)}},99991:(t,e,r)=>{"use strict";r.d(e,{ML:()=>h,bl:()=>d,xY:()=>l});var i=r(63939),s=r(50932),a=r(85103),n=r(37837),o=r(14686),c=r(9705);function d(t){2==i.f[15](t)&&(0,n.aI)(t+8),(0,o.sO)(t,0,24)}function h(t,e){return e?(s.M[15](t,1),s.M[15](t+4,(0,a.Xb)(e)),s.M[10](t+8,e),0):c.UY}function l(t,e){if(e<=0)throw new Error("invalid channels");const r=(0,n.Gy)(24*e);for(let t=0;t<e;t++)s.M[15](r+24*t,768);s.M[15](t,2),s.M[15](t+4,e),s.M[20](t+8,r)}},71766:(t,e,r)=>{"use strict";r.d(e,{Yi:()=>h,dn:()=>l});var i=r(14686),s=r(63939),a=r(50932),n=(r(36981),r(9599),r(37837)),o=r(99991),c=r(71517),d=r(77231);function h(t,e){a.M[15](t,s.f[15](e)),a.M[15](t+4,s.f[15](e+4)),a.M[8](t+8,s.f[8](e+8)),a.M[15](t+28,s.f[15](e+28)),a.M[17](t+32,s.f[17](e+32)),a.M[15](t+40,s.f[15](e+40)),a.M[15](t+44,s.f[15](e+44)),a.M[15](t+48,s.f[15](e+48)),a.M[15](t+52,s.f[15](e+52)),a.M[15](t+56,s.f[15](e+56)),a.M[15](t+60,s.f[15](e+60)),a.M[15](t+68,s.f[15](e+68)),a.M[15](t+64,s.f[15](e+64)),a.M[15](t+80,s.f[15](e+80)),a.M[15](t+84,s.f[15](e+84)),a.M[15](t+88,s.f[15](e+88)),a.M[15](t+92,s.f[15](e+92)),a.M[15](t+96,s.f[15](e+96)),a.M[15](t+100,s.f[15](e+100)),a.M[15](t+104,s.f[15](e+104)),(0,i.Mr)(t+112,e+112,24),a.M[15](t+136,s.f[15](e+136)),a.M[15](t+140,s.f[15](e+140)),a.M[15](t+144,s.f[15](e+144)),a.M[15](t+148,s.f[15](e+148)),a.M[15](t+152,s.f[15](e+152)),a.M[15](t+156,s.f[15](e+156)),a.M[15](t+160,s.f[15](e+160)),(0,i.Mr)(t+72,e+72,8),s.f[20](e+12)&&(s.f[20](t+12)&&(0,n.Eb)(s.f[20](t+12)),a.M[20](t+12,(0,n.sY)(s.f[15](e+16))),a.M[15](t+16,s.f[15](e+16)),(0,i.Mr)(s.f[20](t+12),s.f[20](e+12),s.f[15](e+16))),s.f[20](e+20)&&function(t,e,r,o){if(!r)return;const c=(0,n.Gy)(12*o);for(let t=0;t<o;t++)a.M[15](c+12*t+8,s.f[15](r+12*t+8)),a.M[25](c+12*t+4,s.f[25](r+12*t+4)),a.M[20](c+12*t,(0,n.sY)(s.f[25](r+12*t+4))),(0,i.Mr)(s.f[20](c+12*t),s.f[20](r+12*t),s.f[25](r+12*t+4));a.M[15](e,o),a.M[20](t,c)}(t+20,t+24,s.f[20](e+20),s.f[15](e+24))}function l(t){t&&(function(t){s.f[20](t+12)&&(0,n.aI)(t+12),(0,o.bl)(t+112),(0,c.NZ)(t+20,t+24),(0,i.sO)(t,0,168),a.M[15](t,-1),a.M[15](t+4,0),a.M[15](t+28,-1),a.M[15](t+112,0),a.M[15](t+80,0),a.M[15](t+84,0),a.M[15](t+88,2),a.M[15](t+92,2),a.M[15](t+96,2),a.M[15](t+100,0),a.M[15](t+64,0),a.M[15](t+68,1),a.M[15](t+72,0),a.M[15](t+72,1),a.M[15](t+48,d.N_),a.M[15](t+52,d.N_),a.M[15](t+160,0)}(t),(0,n.Eb)(t))}r(47958)},85103:(t,e,r)=>{"use strict";function i(t){return t=(t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135,(t+=t>>8)+(t>>16)&63}function s(t){return i(Number(BigInt.asUintN(32,t)))+i(Number(BigInt.asUintN(32,t>>BigInt(32))))}function a(t){const e=t/BigInt(1e3),r=t-e*BigInt(1e3);return Number(e)+Number(r)/1e3}r.d(e,{Xb:()=>s,yw:()=>a})},50315:(t,e,r)=>{"use strict";r.d(e,{ZK:()=>o,bE:()=>c,p$:()=>a,zz:()=>n});var i=r(31865),s=r(729);function a(t){const e=new i.A(t,!0),r=e.readUint32(),s=e.readUint32(),a=e.readUint32(),n=e.readUint32(),o=e.readUint32(),c=e.readUint32(),d={scheme:r,cryptByteBlock:s,skipByteBlock:a,keyId:e.readBuffer(n),iv:e.readBuffer(o),subsamples:[]};if(c)for(let t=0;t<c;t++)d.subsamples.push({bytesOfClearData:e.readUint32(),bytesOfProtectedData:e.readUint32()});return d}function n(t){const e=new Uint8Array(24+t.keyId.length+t.iv.length+8*t.subsamples.length),r=new s.A(e,!0);return r.writeUint32(t.scheme),r.writeUint32(t.cryptByteBlock),r.writeUint32(t.skipByteBlock),r.writeUint32(t.keyId.length),r.writeUint32(t.iv.length),r.writeUint32(t.subsamples.length),r.writeBuffer(t.keyId),r.writeBuffer(t.iv),t.subsamples.forEach((t=>{r.writeUint32(t.bytesOfClearData),r.writeUint32(t.bytesOfProtectedData)})),e}function o(t){const e=new i.A(t,!0),r=e.readUint32(),s=[];for(let t=0;t<r;t++){const t=e.readUint32(),r=e.readUint32(),i=e.readUint32(),a=e.readUint32(),n={systemId:e.readBuffer(t),keyIds:[],data:null};if(r)for(let t=0;t<r;t++)n.keyIds.push(e.readBuffer(i));n.data=e.readBuffer(a),s.push(n)}return s}function c(t){let e=4;t.forEach((t=>{e+=16+t.systemId.length+t.keyIds.length*(t.keyIds.length?t.keyIds[0].length:0)+t.data.length}));const r=new Uint8Array(e),i=new s.A(r,!0);return i.writeUint32(t.length),t.forEach((t=>{i.writeUint32(t.systemId.length),i.writeUint32(t.keyIds.length),i.writeUint32(t.keyIds.length?t.keyIds[0].length:0),i.writeUint32(t.data.length),i.writeBuffer(t.systemId),t.keyIds.forEach((t=>{i.writeBuffer(t)})),i.writeBuffer(t.data)})),r}},23991:(t,e,r)=>{"use strict";function i(t){let e=0,r=0;for(;r<32&&0===t.readU1();)r++;return e=t.readU(r),e+=(1<<r)-1,e}function s(t){let e=i(t);return e=1&e?(e+1)/2:-e/2,e}r.d(e,{$x:()=>s,xb:()=>i})},39381:(t,e,r)=>{"use strict";r.d(e,{E3:()=>a,Sg:()=>d,Y0:()=>c,ht:()=>o,r8:()=>s,yd:()=>n});var i=r(63939);function s(t){return i.f[2](t)}function a(t){return s(t+1)<<8|s(t)}function n(t){return s(t)<<8|s(t+1)}function o(t){return s(t)<<16|s(t+1)<<8|s(t+2)}function c(t){return a(t+2)<<16|a(t)}function d(t){return n(t)<<16|n(t+2)}},82774:(t,e,r)=>{"use strict";r.d(e,{Cv:()=>o,w8:()=>s});var i=r(50932);function s(t,e){i.M[2](t,255&e)}function a(t,e){s(t,e>>>8),s(t+1,e)}function n(t,e){a(t,e>>>16),a(t+2,65535&e)}function o(t,e){n(t,Number(BigInt.asUintN(32,e>>BigInt(32)))),n(t+4,Number(BigInt.asUintN(32,e)))}},37837:(t,e,r)=>{"use strict";r.d(e,{Eb:()=>l,Gy:()=>h,aI:()=>u,cz:()=>f,sY:()=>d});var i=r(11473),s=r(63939),a=r(50932),n=r(14686),o=r(4624);const c="src\\avutil\\util\\mem.ts";function d(t){const e=i.s_.malloc(t);return e||o.h2("can not alloc buffer",c,32),e}function h(t){const e=i.s_.malloc(t);return e||o.h2("can not alloc buffer",c,40),(0,n.sO)(e,0,t),e}function l(t){i.s_.free(t)}function u(t){i.s_.free(s.f[20](t)),a.M[20](t,0)}function f(t,e){return i.s_.realloc(t,e)}},60264:(t,e,r)=>{"use strict";r.d(e,{BN:()=>u,Bs:()=>n,Ky:()=>o,Le:()=>d,S9:()=>l,nW:()=>h,py:()=>c});var i=r(79630),s=(r(31865),r(729)),a=r(72739);function n(t){return t.length>4&&0===t[0]&&0===t[1]&&(1===t[2]||0===t[2]&&1===t[3])}function o(t,e){let r=0;for(let i=e;i<t.length;i++)switch(t[i]){case 0:r++;break;case 1:if(r>=2)return{offset:i-Math.min(r,3),startCode:Math.min(r+1,4)};r=0;break;default:r=0}return{offset:-1,startCode:0}}function c(t){const e=[];t instanceof i.A&&(t=t.subarray(0,t.length,!1));let r=o(t,0),s={offset:-1,startCode:0};for(;s=o(t,r.offset+r.startCode),s.offset>-1;)e.push(t.subarray(r.offset+r.startCode,s.offset,!0)),r=s;return e.push(t.subarray(r.offset+r.startCode,void 0,!0)),e}function d(t,e){return t.reduce(((t,r,i)=>0===e?t+4+r.length:1===e?t+3+r.length:t+(i?3:4)+r.length),0)}function h(t,e,r){if(!r){let i=t.reduce(((t,r,i)=>0===e?t+4+r.length:1===e?t+3+r.length:t+(i?3:4)+r.length),0);r=new Uint8Array(i)}const i=new s.A(r);return a.__(t,((t,r)=>{i.writeUint8(0),i.writeUint8(0),(0===e||2===e&&!r)&&i.writeUint8(0),i.writeUint8(1),i.writeBuffer(t)})),r}function l(t,e,r){if(!r){const i=t.reduce(((t,r)=>t+e+1+r.length),0);r=new Uint8Array(i)}const i=new s.A(r);return a.__(t,(t=>{3===e?i.writeUint32(t.length):2===e?i.writeUint24(t.length):1===e?i.writeUint16(t.length):i.writeUint8(t.length),i.writeBuffer(t)})),r}function u(t,e=0,r){r||(r=t.length);const i=new Uint8Array(t.length);let s=0,a=0;for(let n=0;n<t.length;n++){if(n>=e&&n<r)if(0===t[n])s++;else if(3===t[n]&&2===s&&n+1<t.length&&t[n+1]<=3){if(n++,n===t.length)break;s=0===t[n]?1:0}else s=0;i[a++]=t[n]}return i.slice(0,a)}},38156:(t,e,r)=>{"use strict";r(97317),r(77231),r(37837)},44328:(t,e,r)=>{"use strict";r.d(e,{FP:()=>c,Mr:()=>o,iU:()=>l,j2:()=>h,k:()=>n,lb:()=>d});var i=r(63939),s=r(77231),a=r(31658);function n(t,e,r){return t*BigInt(e.num)*BigInt(r.den)/(BigInt(e.den)*BigInt(r.num))}function o(t,e,r){return t*BigInt(i.f[15](e))*BigInt(r.den)/(BigInt(i.f[15](e+4))*BigInt(r.num))}function c(t,e,r){return t*BigInt(e.num)*BigInt(i.f[15](r+4))/(BigInt(e.den)*BigInt(i.f[15](r)))}function d(t){return t.num/t.den}function h(t,e){if(isNaN(19))return{den:0,num:0};if(Math.abs(t)>s.go+3)return{den:0,num:t<0?-1:1};const r=t>1?{den:Math.floor(e/t+.5),num:e}:{den:e,num:Math.floor(t*e+.5)};return l(r),r}function l(t){const e=(0,a.A)(t.num,t.den);e<=1||(t.den/=e,t.num/=e)}},66788:(t,e,r)=>{"use strict";r.d(e,{K0:()=>n,f8:()=>o});var i=r(77231),s=r(95073),a=(r(37837),r(58055));function n(t){return!(t<0||t>=12)&&a.J[t].planar}function o(t,e,r,o){const c=function(t){return t<0||t>=12?0:a.J[t].bits>>3}(t),d=n(t);return!c||r<=0||e<=0?-1:(o||(o=1,r=(0,s.A)(r,32)),e>i.go/o||e*r>(i.go-o*e)/c?-1:d?(0,s.A)(r*c,o):(0,s.A)(r*c*e,o))}},71762:(t,e,r)=>{"use strict";r.d(e,{T8:()=>l,Wu:()=>h,r0:()=>d,wm:()=>c});var i=r(63939),s=r(50932),a=r(14686),n=r(71517),o=r(37837);function c(t){const e={pts:i.f[17](t+8),dts:i.f[17](t+16),data:(0,n.iI)(t).slice(),streamIndex:i.f[15](t+32),flags:i.f[15](t+36),sideData:[],duration:i.f[17](t+48),pos:i.f[17](t+56),timeBase:{den:i.f[15](t+76),num:i.f[15](t+72)}};for(let r=0;r<i.f[15](t+44);r++){const s={type:i.f[15](i.f[20](t+40)+12*r+8),data:(0,a.s3)(i.f[20](i.f[20](t+40)+12*r),i.f[25](i.f[20](t+40)+12*r+4)).slice()};e.sideData.push(s)}return e}function d(t,e=0){e||(e=(0,n._5)()),s.M[17](e+8,t.pts),s.M[17](e+16,t.dts);const r=(0,o.sY)(t.data.length);if((0,a.lW)(r,t.data.length,t.data),(0,n.NX)(e,r,t.data.length),s.M[15](e+32,t.streamIndex),s.M[15](e+36,t.flags),s.M[17](e+48,t.duration),s.M[17](e+56,t.pos),s.M[15](e+76,t.timeBase.den),s.M[15](e+72,t.timeBase.num),t.sideData.length)for(let r=0;r<t.sideData.length;r++){const i=(0,o.sY)(t.sideData[r].data.length);(0,a.lW)(i,t.sideData[r].data.length,t.sideData[r].data),(0,n.Ow)(e,t.sideData[r].type,i,t.sideData[r].data.length)}else(0,n.NZ)(e+40,e+44);return e}function h(t){const e={codecType:i.f[15](t),codecId:i.f[15](t+4),codecTag:i.f[8](t+8),extradata:null,codedSideData:[],format:i.f[15](t+28),bitrate:i.f[17](t+32),bitsPerCodedSample:i.f[15](t+40),bitsPerRawSample:i.f[15](t+44),profile:i.f[15](t+48),level:i.f[15](t+52),width:i.f[15](t+56),height:i.f[15](t+60),sampleAspectRatio:{den:i.f[15](t+68),num:i.f[15](t+64)},framerate:{den:i.f[15](t+76),num:i.f[15](t+72)},fieldOrder:i.f[15](t+80),colorRange:i.f[15](t+84),colorPrimaries:i.f[15](t+88),colorTrc:i.f[15](t+92),colorSpace:i.f[15](t+96),chromaLocation:i.f[15](t+100),videoDelay:i.f[15](t+104),chLayout:{order:i.f[15](t+112),nbChannels:i.f[15](t+116),u:i.f[10](t+120)},sampleRate:i.f[15](t+136),blockAlign:i.f[15](t+140),frameSize:i.f[15](t+144),initialPadding:i.f[15](t+148),trailingPadding:i.f[15](t+152),seekPreroll:i.f[15](t+156),flags:i.f[15](t+160)};i.f[15](t+16)&&(e.extradata=(0,a.s3)(i.f[20](t+12),i.f[15](t+16)).slice());for(let r=0;r<i.f[15](t+24);r++){const s={type:i.f[15](i.f[20](t+20)+12*r+8),data:(0,a.s3)(i.f[20](i.f[20](t+20)+12*r),i.f[25](i.f[20](t+20)+12*r+4)).slice()};e.codedSideData.push(s)}return e}function l(t,e=0){if(e||(e=(0,o.sY)(168),(0,a.sO)(e,0,168)),s.M[15](e,t.codecType),s.M[15](e+4,t.codecId),s.M[8](e+8,t.codecTag),t.extradata&&(i.f[20](e+12)&&(0,o.Eb)(i.f[20](e+12)),s.M[20](e+12,(0,o.sY)(t.extradata.length)),(0,a.lW)(i.f[20](e+12),t.extradata.length,t.extradata),s.M[15](e+16,t.extradata.length)),t.codedSideData.length)for(let r=0;r<t.codedSideData.length;r++){const i=(0,o.sY)(t.codedSideData[r].data.length);(0,a.lW)(i,t.codedSideData[r].data.length,t.codedSideData[r].data),(0,n.$W)(e+20,e+24,t.codedSideData[r].type,i,t.codedSideData[r].data.length)}else(0,n.NZ)(e+20,e+24);return s.M[15](e+28,t.format),s.M[17](e+32,t.bitrate),s.M[15](e+40,t.bitsPerCodedSample),s.M[15](e+44,t.bitsPerRawSample),s.M[15](e+48,t.profile),s.M[15](e+52,t.level),s.M[15](e+56,t.width),s.M[15](e+60,t.height),s.M[15](e+68,t.sampleAspectRatio.den),s.M[15](e+64,t.sampleAspectRatio.num),s.M[15](e+76,t.framerate.den),s.M[15](e+72,t.framerate.num),s.M[15](e+80,t.fieldOrder),s.M[15](e+84,t.colorRange),s.M[15](e+88,t.colorPrimaries),s.M[15](e+92,t.colorTrc),s.M[15](e+96,t.colorSpace),s.M[15](e+100,t.chromaLocation),s.M[15](e+104,t.videoDelay),s.M[15](e+112,t.chLayout.order),s.M[15](e+116,t.chLayout.nbChannels),s.M[10](e+120,t.chLayout.u),s.M[15](e+136,t.sampleRate),s.M[15](e+140,t.blockAlign),s.M[15](e+144,t.frameSize),s.M[15](e+148,t.initialPadding),s.M[15](e+152,t.trailingPadding),s.M[15](e+156,t.seekPreroll),s.M[15](e+160,t.flags),e}r(77162)},95007:(t,e,r)=>{"use strict";r.d(e,{A:()=>f});var i=r(134),s=r(95335),a=r(72739),n=r(73783),o=r(7417),c=r(4624);const d="src\\cheap\\allocator\\AllocatorJS.ts",h=v(16),l=32,u=68;class f{constructor(t,e=!0){var r,a,n,o;(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"byteOffset",void 0),(0,i.A)(this,"heapOffset",void 0),(0,i.A)(this,"heapLength",void 0),(0,i.A)(this,"int32Array",void 0),(0,i.A)(this,"updates",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"shared",void 0),(0,i.A)(this,"handles",void 0),this.options=s.X$({growSize:1048576,maxHeapSize:2097152e3},t),this.handles=[],this.buffer=t.buffer,this.shared=!1,this.options.memory||this.buffer instanceof ArrayBuffer||this.buffer instanceof SharedArrayBuffer?(this.byteOffset=null!==(r=t.byteOffset)&&void 0!==r?r:0,this.heapOffset=y(this.byteOffset+g(l),null!==(a=t.byteLength)&&void 0!==a?a:this.buffer.byteLength),this.heapLength=b((null!==(n=t.byteLength)&&void 0!==n?n:this.buffer.byteLength)-this.heapOffset),this.int32Array=new Int32Array(this.buffer,this.heapOffset,v(this.heapLength)),this.updates=new Int32Array(this.buffer,this.byteOffset,l),"function"==typeof SharedArrayBuffer&&this.buffer instanceof SharedArrayBuffer&&(this.shared=!0)):c.h2("Expected buffer to be an instance of Buffer or ArrayBuffer",d,109),e&&(this.updates.fill(1),function(t){return 65===t[0]&&65===t[66]}(o=this.int32Array)||function(t){const e=t.length-69;x(t,65,1),t[1]=1,t[3]=68;for(let e=1;e<l;e++)t[3+e]=1;x(t,e,68),t[68]=1,t[70]=1}(o),function(t){let e=u;for(;e<t.length-1;){const r=k(t,e);r<2||r>=t.length-u?c.h2(`Got invalid sized chunk at ${g(e)} (${g(r)} bytes).`,d,565):P(t,e)?p(t,e,r):m(t,e,r),e+=r+2}}(this.int32Array))}addUpdateHandle(t){a.zy(this.handles,t)||this.handles.push(t)}removeUpdateHandle(t){a.TF(this.handles,t)}malloc_(t){(t=A(t,7))<16&&(t=16);const e=v(t),r=this.findFreeBlock(this.int32Array,e);if(r<=1)return 0;const i=k(this.int32Array,r);return i-(e+2)>=h?function(t,e,r,i,s){const a=e+r+2,n=i-(a-e);T(t,e,i,s),t[e-1]=-r,t[e+r]=-r,t[a-1]=-n,t[a+n]=-n,M(t,a,n,s)}(this.int32Array,r,e,i,this.updates):T(this.int32Array,r,i,this.updates),g(r)+this.heapOffset}malloc(t){this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer());const e=this.malloc_(t);return this.shared&&(0,n.Tl)(o.II),e}calloc_(t,e){let r=t*e;r=r<16?16:A(r,7);const i=this.malloc_(r);if(0===i)return 0;const s=v(i-this.heapOffset);return this.int32Array.subarray(s,s+v(r)).fill(0),i}calloc(t,e){this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer());const r=this.calloc_(t,e);return this.shared&&(0,n.Tl)(o.II),r}realloc_(t,e){if(0===t)return this.malloc_(e);const r=t;if(0===e)return this.free_(r),0;let i=v(t-=this.heapOffset),s=i,a=0;S(this.int32Array,i)&&(s=this.int32Array[i-1],a=i-s);const n=k(this.int32Array,s)-a;if(n>=v(A(e,7)))return r;{const t=this.malloc_(e);return 0===t?(this.free_(r),0):(this.int32Array.set(this.int32Array.subarray(i,i+n),v(t-this.heapOffset)),this.free_(r),t)}}realloc(t,e){return this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer()),t=this.realloc_(t,e),this.shared&&(0,n.Tl)(o.II),t}alignedAlloc_(t,e){if(t<=8)return this.malloc_(e);const r=this.malloc_(e+t-1+4);if(0===r)return 0;const i=r+t-1+4&~(t-1);return this.int32Array[v(i-this.heapOffset)-1]=v(r-this.heapOffset),i}alignedAlloc(t,e){this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer());const r=this.alignedAlloc_(t,e);return this.shared&&(0,n.Tl)(o.II),r}free_(t){if(0===t)return;let e=v(t-=this.heapOffset);if(S(this.int32Array,e)&&(e=this.int32Array[e-1]),P(this.int32Array,e))return;const r=k(this.int32Array,e),i=_(this.int32Array,e),s=function(t,e){const r=k(t,e);if(e+r+2>=t.length-2)return 0;const i=e+r+2;return t[i-1]<2?0:i}(this.int32Array,e);0!==i?0!==s?function(t,e,r,i,s,a){const n=k(t,e),o=k(t,s),c=s-e+o;T(t,e,n,a),T(t,s,o,a),t[e-1]=-c,t[s+o]=-c,M(t,e,c,a)}(this.int32Array,i,0,0,s,this.updates):C(this.int32Array,i,e,r,this.updates):0!==s?function(t,e,r,i,s){const a=k(t,e);T(t,e,a,s);const n=i+a+2;t[r-1]=-n,t[e+a]=-n,M(t,r,n,s)}(this.int32Array,s,e,r,this.updates):M(this.int32Array,e,r,this.updates)}free(t){this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer()),this.free_(t),this.shared&&(0,n.Tl)(o.II)}sizeof(t){if(0===t)return 0;let e=v(t-=this.heapOffset);return S(this.int32Array,e)&&(e=this.int32Array[e-1]),g(k(this.int32Array,e))}inspect(){return this.checkBuffer(),function(t,e){const r=[],i=w(t,1,e);let s=u,a=0;for(;s<t.length-1;){const i=k(t,s);(i<2||i>=t.length)&&c.h2(`Got invalid sized chunk at ${g(s)} (${g(i)})`,d,621),P(t,s)?r.push(w(t,s,e)):(a+=g(i),r.push({type:"used",block:s,offset:g(s)+e,size:g(i)})),s+=i+2}return{header:i,blocks:r,total:g(t.length),used:a}}(this.int32Array,this.heapOffset)}findFreeBlock(t,e){let r=function(t,e){let r=1;for(let i=t[1];i>0;i--){let s=t[r+2+(i-1)];for(;1!==s&&t[s-1]<e;)r=s,s=t[r+2+(i-1)]}return r=t[r+2],r}(t,e);if(1===r){if(this.options.growAllowed&&this.heapLength<this.options.maxHeapSize){const t=this.int32Array.length+1;let r,o,c=0,d=0,h=0;if(this.options.onResize){var i,s,n;const t=this.options.onResize(this.int32Array,this.int32Array.byteLength+A(Math.max(this.options.growSize,g(e)),7));c=null!==(i=t.byteOffset)&&void 0!==i?i:0,h=y(c+g(l),null!==(s=t.byteLength)&&void 0!==s?s:t.buffer.byteLength),d=b((null!==(n=t.byteLength)&&void 0!==n?n:t.buffer.byteLength)-h),r=new Int32Array(t.buffer,h,v(d)),o=new Int32Array(t.buffer,c,l)}else{const t=new ArrayBuffer(this.int32Array.length+v(this.options.growSize));h=y(c+g(l),t.byteLength),d=b(t.byteLength-h),r=new Int32Array(t,h,v(d)),r.set(this.int32Array,0),o=new Int32Array(t,c,l)}this.byteOffset=c,this.heapOffset=h,this.buffer=r.buffer,this.heapLength=d,this.int32Array=r,this.updates=o;const u=r.length-(t-1)-2;x(r,u,t);const f=_(r,t);return 0!==f?C(r,f,t,u,this.updates):M(r,t,u,this.updates),this.handles.length&&a.__(this.handles,(t=>{t(this.buffer)})),this.findFreeBlock(this.int32Array,e)}return r}return r}getBuffer(){return this.buffer}isAlloc(t){this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer());const e=v(t-this.heapOffset);let r=this.int32Array[3];for(;r&&1!==r;){if(e>=r&&e<r+this.int32Array[r-1])return this.shared&&(0,n.Tl)(o.II),!1;r=this.int32Array[r+2]}return this.shared&&(0,n.Tl)(o.II),!0}checkBuffer(){this.options.memory&&this.options.memory.buffer!==this.buffer&&(this.buffer=this.options.memory.buffer,this.heapLength=b(this.buffer.byteLength-this.heapOffset),this.int32Array=new Int32Array(this.buffer,this.heapOffset,v(this.heapLength)))}}function p(t,e,r){t[e-1]!==t[e+r]&&c.h2(`Block length header does not match footer (${g(t[e-1])} vs ${g(t[e+r])}).`,d,581);const i=t[e+0];(i<1||i>l)&&c.h2(`Block ${g(e)} height must be between 1 and 32, got ${i}.`,d,586);for(let r=0;r<i;r++){const i=t[e+2+r];i>=u&&!P(t,i)&&c.h2(`Block ${g(e)} has a pointer to a non-free block (${g(i)}).`,d,592)}return!0}function m(t,e,r){if(t[e-1]===t[e+r])return!0;c.h2(`Block length header does not match footer (${g(t[e-1])} vs ${g(t[e+r])}).`,d,601)}function g(t){return t<<2>>>0}function v(t){return t>>>2}function A(t,e){return(t+e&~e)>>>0}function y(t,e){const r=e-t;return t+(A(r,7)===r?0:r-A(r,7)+8)}function b(t){return t-4}function w(t,e,r){const i=t[e+0],s=[];for(let r=0;r<i;r++)s.push(t[e+2+r]);return{type:"free",block:e,offset:g(e)+r,height:i,pointers:s,size:g(t[e-1])}}function k(t,e){const r=t[e-1],i=r>>31;return r+i^i}function x(t,e,r){t[r-1]=e,t[r+e]=e}function I(t,e,r){let i=1;for(let s=t[1];s>0;s--){let a=i+2+(s-1);for(;t[a]>=u&&t[t[a]-1]<e;)i=t[a],a=i+2+(s-1);r[s-1]=i}}function T(t,e,r,i){I(t,r,i);let s=t[i[0]+2];for(;s!==e&&1!==s&&t[s-1]<=r;){for(let r=t[s+0]-1;r>=0;r--)t[s+2+r]===e&&(i[r]=s);s=t[s+2]}let a=t[1];for(let r=0;r<a&&t[i[r]+2+r]===e;r++)t[i[r]+2+r]=t[e+2+r];for(;a>0&&1===t[a-1+3];)a--,t[1]=a;t[e-1]=-r,t[e+r]=-r}function P(t,e){return!(e<65)&&!(t[e-1]<0)}function S(t,e){return!(e<65)&&!(t[e-1]<0)}function _(t,e){if(e<=u)return 0;const r=t[e-2];return r<2?0:e-(2+r)}function M(t,e,r,i){I(t,r,i);const s=function(t,e,r,i){const s=t[1];let a=function(){let t=1;for(;Math.random()<.5&&t<l;)t+=1;return t}();if(r-1<a+1&&(a=r-2),a>s){const r=s+1;return t[1]=r,t[r-1+3]=1,i[r]=1,t[e+0]=r,r}return t[e+0]=a,a}(t,e,r,i);for(let r=1;r<=s;r++){const s=i[r-1]+2+(r-1);t[e+2+(r-1)]=t[s],t[s]=e,i[r-1]=1}return t[e-1]=r,t[e+r]=r,r}function C(t,e,r,i,s){const a=r-e+i;return T(t,e,r-e-2,s),t[e-1]=-a,t[r+i]=-a,M(t,e,a,s),i}},94321:(t,e,r)=>{"use strict";r.d(e,{z:()=>s});var i=r(134);class s{constructor(){(0,i.A)(this,"table",void 0),(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"nodes",void 0),this.table=new WebAssembly.Table({initial:16,element:"anyfunc",address:"i32",index:"i32"}),this.pointer=6,this.nodes=[{pointer:this.pointer,length:10,free:!0}]}getPointer(){return this.pointer}alloc(t){let e=this.findFree(t);if(e<0){const r=this.nodes[this.nodes.length-1],i=t-(r.free?r.length:0);this.table.grow(i),r.free?r.length=r.length+i:this.nodes.push({pointer:r.pointer+r.length,length:i,free:!0}),e=this.findFree(t)}const r=this.nodes[e];return r.length>t&&(this.nodes.splice(e+1,0,{pointer:r.pointer+t,length:r.length-t,free:!0}),r.length=t),r.free=!1,r.pointer}free(t){let e=this.findNode(t);const r=this.nodes[e];if(r&&!r.free){const t=this.nodes[e-1],i=this.nodes[e+1];t&&t.free?i&&i.free?(t.length+=r.length+i.length,this.nodes.splice(e,2)):(t.length+=r.length,this.nodes.splice(e,1)):i&&i.free?(r.length+=i.length,this.nodes.splice(e+1,1),r.free=!0):r.free=!0}if(1===this.nodes.length&&this.nodes[0].free){const t=new WebAssembly.Table({initial:16,element:"anyfunc",address:"i32",index:"i32"});this.pointer=6,this.nodes=[{pointer:this.pointer,length:10,free:!0}];for(let e=1;e<this.pointer;e++)t.set(e,this.table.get(e));this.table=t}}get(t){return this.table.get(t)}set(t,e){if(t<0||t>=this.pointer)throw new RangeError("index out of bound");this.table.set(t,e)}inspect(){return this.nodes}findFree(t){let e=-1;for(let r=0;r<this.nodes.length;r++)if(this.nodes[r].length>=t&&this.nodes[r].free){e=r;break}return e}findNode(t){let e=-1;for(let r=0;r<this.nodes.length;r++)if(this.nodes[r].pointer===t){e=r;break}return e}}},15541:(t,e,r)=>{"use strict";r.d(e,{A:()=>i});const i="AGFzbQEAAAABLwlgAn9/AGACf34AYAJ/fQBgAn98AGABfwF/YAF/AX5gAX8BfWABfwF8YAN/f38AAhIBA2VudgZtZW1vcnkCAwGAgAQDERAAAAABAgMEBAQEBAUGBwgIB5YBEAZ3cml0ZTgAAAd3cml0ZTE2AAEHd3JpdGUzMgACB3dyaXRlNjQAAwh3cml0ZWYzMgAECHdyaXRlZjY0AAUFcmVhZDgABgZyZWFkVTgABwZyZWFkMTYACAdyZWFkVTE2AAkGcmVhZDMyAAoGcmVhZDY0AAsHcmVhZGYzMgAMB3JlYWRmNjQADQRmaWxsAA4EY29weQAPCpYBEAkAIAAgAToAAAsJACAAIAE7AQALCQAgACABNgIACwkAIAAgATcDAAsJACAAIAE4AgALCQAgACABOQMACwcAIAAsAAALBwAgAC0AAAsHACAALgEACwcAIAAvAQALBwAgACgCAAsHACAAKQMACwcAIAAqAgALBwAgACsDAAsLACAAIAEgAvwLAAsMACAAIAEgAvwKAAAL"},98564:(t,e,r)=>{"use strict";r.d(e,{Ts:()=>l});var i=r(4919),s=r(4624),a=r(63939),n=r(50932),o=r(88096),c=r(15541);const d="src\\cheap\\asm\\memory.ts";let h;function l(t,e,r){try{const s=o.bx((0,i.E_)(c.A),{shared:"function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer,initial:e,maximum:r});h=new WebAssembly.Instance(new WebAssembly.Module(s),{env:{memory:t}}),(0,a.$)({4:h.exports.readU8,5:h.exports.readU8,2:h.exports.readU8,3:h.exports.readU8,6:h.exports.readU16,7:h.exports.readU16,8:t=>h.exports.read32(t)>>>0,9:t=>h.exports.read32(t)>>>0,10:t=>BigInt.asUintN(64,h.exports.read64(t)),22:t=>BigInt.asUintN(64,h.exports.read64(t)),11:h.exports.read8,12:h.exports.read8,13:h.exports.read16,14:h.exports.read16,15:h.exports.read32,16:h.exports.read32,17:h.exports.read64,21:h.exports.read64,18:h.exports.readf32,19:h.exports.readf64,20:t=>h.exports.read32(t)>>>0,25:t=>h.exports.read32(t)>>>0}),(0,n.$)({4:h.exports.write8,5:h.exports.write8,2:h.exports.write8,3:h.exports.write8,6:h.exports.write16,7:h.exports.write16,8:h.exports.write32,9:h.exports.write32,10:h.exports.write64,22:h.exports.write64,11:h.exports.write8,12:h.exports.write8,13:h.exports.write16,14:h.exports.write16,15:h.exports.write32,16:h.exports.write32,17:h.exports.write64,21:h.exports.write64,18:h.exports.writef32,19:h.exports.writef64,20:h.exports.write32,25:h.exports.write32,copy:h.exports.copy,fill:h.exports.fill})}catch(t){s.R8("memory asm not support, cannot use asm memory function",d,119)}}},26429:(t,e,r)=>{"use strict";r.r(e),r.d(e,{HEAP_INITIAL:()=>p,HEAP_MAXIMUM:()=>m,HEAP_OFFSET:()=>f,STACK_ALIGNMENT:()=>l,STACK_SIZE:()=>u,USE_THREADS:()=>h});var i,s,a=r(95797),n=r(10576),o=r(86834),c=r(44690);const d=n.TK,h=!!a.A.thread&&!d.CHEAP_DISABLE_THREAD;let l=16,u=1048576;const f=1024,p=null!==(i=d.CHEAP_HEAP_INITIAL)&&void 0!==i?i:265,m=null!==(s=d.CHEAP_HEAP_MAXIMUM)&&void 0!==s?s:h&&c.A.ios&&!o.A.checkVersion(c.A.version,"17",!0)?8192:65536},73281:(t,e,r)=>{"use strict";r.d(e,{A:()=>R});var i=r(59135),s=r(63939),a=r(50932);let n,o;const c=(0,i.A)();function d(t,e){o().setUint8(t,e)}function h(t){return o().getUint8(t)}function l(t,e){o().setUint16(t,e,c)}function u(t){return o().getUint16(t,c)}function f(t,e){o().setUint32(t,e,c)}function p(t){return o().getUint32(t,c)}function m(t,e){o().setBigUint64(t,e,c)}function g(t){return o().getBigUint64(t,c)}function v(t,e){o().setInt8(t,e)}function A(t){return o().getInt8(t)}function y(t,e){o().setInt16(t,e,c)}function b(t){return o().getInt16(t,c)}function w(t,e){o().setInt32(t,e,c)}function k(t){return o().getInt32(t,c)}function x(t,e){o().setBigInt64(t,e,c)}function I(t){return o().getBigInt64(t,c)}function T(t,e){o().setFloat32(t,e,c)}function P(t){return o().getFloat32(t,c)}function S(t,e){o().setFloat64(t,e,c)}function _(t){return o().getFloat64(t,c)}function M(t){return o().getUint32(t,c)}function C(t,e){return o().setUint32(t,e,c)}function B(t,e){o().setUint32(t,e,c)}function R(t,e){n=t,o=e,(0,s.$)({4:h,5:h,2:h,3:h,6:u,7:u,8:p,9:p,10:g,11:A,12:A,13:b,14:b,15:k,16:k,17:I,18:P,19:_,20:M,23:t=>!!A(t),24:t=>!!A(t),25:t=>function(t){return o().getUint32(t,c)}(t)}),(0,a.$)({4:d,5:d,2:d,3:d,6:l,7:l,8:f,9:f,10:m,11:v,12:v,13:y,14:y,15:w,16:w,17:x,18:T,19:S,20:C,23:(t,e)=>{v(t,e?1:0)},24:(t,e)=>{v(t,e?1:0)},25:B})}},63939:(t,e,r)=>{"use strict";r.d(e,{$:()=>a,f:()=>s});var i=r(95335);const s={4:function(t){throw new Error("unimplemented")},5:function(t){throw new Error("unimplemented")},2:function(t){throw new Error("unimplemented")},3:function(t){throw new Error("unimplemented")},6:function(t){throw new Error("unimplemented")},7:function(t){throw new Error("unimplemented")},8:function(t){throw new Error("unimplemented")},9:function(t){throw new Error("unimplemented")},10:function(t){throw new Error("unimplemented")},11:function(t){throw new Error("unimplemented")},12:function(t){throw new Error("unimplemented")},13:function(t){throw new Error("unimplemented")},14:function(t){throw new Error("unimplemented")},15:function(t){throw new Error("unimplemented")},16:function(t){throw new Error("unimplemented")},17:function(t){throw new Error("unimplemented")},18:function(t){throw new Error("unimplemented")},19:function(t){throw new Error("unimplemented")},20:function(t){throw new Error("unimplemented")},0:function(t){throw new Error("invalid operate")},1:function(t){throw new Error("invalid operate")},22:function(t){throw new Error("invalid operate")},21:function(t){throw new Error("invalid operate")},23:function(t){throw new Error("invalid operate")},24:function(t){throw new Error("invalid operate")},25:function(t){throw new Error("unimplemented")}};function a(t){i.X$(s,t)}},50932:(t,e,r)=>{"use strict";r.d(e,{$:()=>a,M:()=>s});var i=r(95335);const s={4:function(t,e){throw new Error("unimplemented")},5:function(t,e){throw new Error("unimplemented")},2:function(t,e){throw new Error("unimplemented")},3:function(t,e){throw new Error("unimplemented")},6:function(t,e){throw new Error("unimplemented")},7:function(t,e){throw new Error("unimplemented")},8:function(t,e){throw new Error("unimplemented")},9:function(t,e){throw new Error("unimplemented")},10:function(t,e){throw new Error("unimplemented")},11:function(t,e){throw new Error("unimplemented")},12:function(t,e){throw new Error("unimplemented")},13:function(t,e){throw new Error("unimplemented")},14:function(t,e){throw new Error("unimplemented")},15:function(t,e){throw new Error("unimplemented")},16:function(t,e){throw new Error("unimplemented")},17:function(t,e){throw new Error("unimplemented")},18:function(t,e){throw new Error("unimplemented")},19:function(t,e){throw new Error("unimplemented")},20:function(t,e){throw new Error("unimplemented")},0:function(t,e){throw new Error("invalid operate")},1:function(t,e){throw new Error("invalid operate")},22:function(t,e){throw new Error("invalid operate")},21:function(t,e){throw new Error("invalid operate")},23:function(t,e){throw new Error("invalid operate")},24:function(t,e){throw new Error("invalid operate")},25:function(t,e){throw new Error("unimplemented")},copy:function(t,e,r){throw new Error("invalid operate")},fill:function(t,e,r){throw new Error("invalid operate")}};function a(t){i.X$(s,t)}},25323:(t,e,r)=>{"use strict";r.d(e,{X:()=>D,l:()=>R});var i=r(66681),s=r.n(i),a=r(11919),n=r.n(a),o=r(75019),c=r.n(o),d=r(99921),h=r(63939),l=r(50932),u=r(61499),f=r(6704),p=r(67672),m=r(95335),g=r(62100),v=r(72739);function A(t,e,r,i){s()(t,e,{get:r,set:i,configurable:!0,enumerable:!0})}function y(t){return function(){return h.f[20](t())}}function b(t,e,r,i){return function(){return t[`__$__${e}`]||(t[`__$__${e}`]=R(r(),i))}}function w(t,e){return function(){return h.f[e](t())}}function k(t,e,r,i){const s=8*f.i[e]-i-r,a=Math.pow(2,r)-1;return function(){return h.f[e](t())>>>s&a}}function x(t){return function(e){l.M[20](t(),e)}}function I(t,e,r,i){const s=`__$__${e}`;return function(e){const a=t[s]||(t[s]=R(r(),i));m.__(e,((t,e)=>{a[e]=t})),t[s]=a}}function T(t,e){return function(r){l.M[e](t(),r)}}function P(t,e,r,i){let s=0,a=8*f.i[e];for(let t=0;t<r;t++)s|=1<<a-1-(t+i);const n=Math.pow(2,r)-1,o=a-i-r;return function(r){const i=t(),a=h.f[e](i);l.M[e](i,a&~s|(r&n)<<o)}}function S(t,e,r){const i={};let s=(0,d.A)(r);for(let a=0;a<e;a++){const e=(0,g.A)(a);A(i,e,b(i,e,(()=>t()+s*a),r),I(i,e,(()=>t()+s*a),r))}return i}function _(t,e,r){const i={};let s=(0,d.A)(r);for(let a=0;a<e;a++)A(i,(0,g.A)(a),w((()=>t()+s*a),r),T((()=>t()+s*a),r));return i}function M(t,e,r,i,s){return function(){let a=e[`__$__${r}`];return a||(a=p.Pc(s)||p.Ik(s)?S(t,i,s):_(t,i,s),e[`__$__${r}`]=a),a[u.o9]=t(),a}}function C(t,e,r,i,s){const a=`__$__${e}`;return function(e){let n=t[a]||S(r,i,s);n[u.o9]=r(),v.__(e,((t,e)=>{n[e]=t})),t[a]=n}}function B(t,e,r,i,s){const a=`__$__${e}`;return function(e){let n=t[a]||_(r,i,s);n[u.o9]=r(),v.__(e,((t,e)=>{n[e]=t})),t[a]=n}}function R(t,e){let r=p.Pc(e)?e.prototype:e;const i={};for(i[u.o9]=t,n()(i,r);;){let t=r[u.JY];if(t&&t.forEach(((t,e)=>{t[3]?t[1]?A(i,e,M((()=>i[u.o9]+t[7]),i,e,t[4],t[0]),B(i,e,(()=>i[u.o9]+t[7]),t[4],20)):p.Pc(t[0])||p.Ik(t[0])?A(i,e,M((()=>i[u.o9]+t[7]),i,e,t[4],t[0]),C(i,e,(()=>i[u.o9]+t[7]),t[4],t[0])):A(i,e,M((()=>i[u.o9]+t[7]),i,e,t[4],t[0]),B(i,e,(()=>i[u.o9]+t[7]),t[4],t[0])):t[1]?A(i,e,y((()=>i[u.o9]+t[7])),x((()=>i[u.o9]+t[7]))):p.Pc(t[0])||p.Ik(t[0])?A(i,e,b(i,e,(()=>i[u.o9]+t[7]),t[0]),I(i,e,(()=>i[u.o9]+t[7]),t[0])):t[5]?A(i,e,k((()=>i[u.o9]+t[7]),t[0],t[6],t[8]),P((()=>i[u.o9]+t[7]),t[0],t[6],t[8])):A(i,e,w((()=>i[u.o9]+t[7]),t[0]),T((()=>i[u.o9]+t[7]),t[0]))})),r=c()(r),!r)break}return i}function D(t){let e=c()(t);for(;;){let r=e[u.JY];if(r&&r.forEach(((e,r)=>{delete t[r]})),e=c()(e),!e)break}}},12085:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(66681),s=r.n(i);function a(t,e,r){s()(t,e,{value:r,writable:!1,enumerable:!1,configurable:!1})}},11473:(t,e,r)=>{"use strict";r.d(e,{GE:()=>k,Lv:()=>O,Tg:()=>H,XI:()=>T,ce:()=>S,eq:()=>g,pv:()=>q,s_:()=>P,wE:()=>x});var i=r(39638),s=r(95007),a=r(94321),n=r(10576),o=r(26429),c=r(7417),d=r(33856),h=r(98564),l=r(82854),u=r(73281),f=r(54568),p=r(86834),m=r(44690);let g,v,A,y=-1,b=!0,w="",k=null,x=null,I=0,T=null,P=null,S=null,_=null,M=null,C=null,B=null,R=null,D=null,U=null,E=null,L=null,$={5:R,3:R,7:D,9:U,22:E,12:_,14:M,16:C,21:B};function F(){return!(!S||S.buffer===R.buffer)}function O(){return S.buffer}function z(){return F()&&G(S.buffer),R}function N(){return F()&&G(S.buffer),L}function V(t){return F()&&G(S.buffer),$[t]}function W(){o.USE_THREADS?(g=z,v=N,A=V):(g=()=>R,v=()=>L,A=t=>$[t])}function G(t){_=new Int8Array(t),M=new Int16Array(t),C=new Int32Array(t),B=new BigInt64Array(t),R=new Uint8Array(t),D=new Uint16Array(t),U=new Uint32Array(t),E=new BigUint64Array(t),L=new DataView(t),$={5:R,3:R,7:D,9:U,22:E,12:_,14:M,16:C,21:B}}function q(){return Atomics.add(U,c.hb>>>2,1)}async function H(t){var e;W(),(0,u.A)((()=>P),v),(0,d.A)(A),S=t.memory,t.disableAsm||("function"==typeof BigInt&&BigInt!==Number&&(p.A.chrome&&p.A.checkVersion(p.A.majorVersion,"85",!0)||p.A.firefox&&p.A.checkVersion(p.A.majorVersion,"78",!0)||p.A.safari&&p.A.checkVersion(p.A.majorVersion,"15",!0)||m.A.ios&&p.A.checkVersion(m.A.version,"15",!0)||p.A.newEdge)&&h.Ts(S,o.HEAP_INITIAL,o.HEAP_MAXIMUM),(p.A.chrome&&p.A.checkVersion(p.A.majorVersion,"85",!0)||p.A.firefox&&p.A.checkVersion(p.A.majorVersion,"78",!0)||p.A.safari&&p.A.checkVersion(p.A.majorVersion,"15",!0)||m.A.ios&&p.A.checkVersion(m.A.version,"15",!0)||p.A.newEdge)&&l.Ts(S,o.HEAP_INITIAL,o.HEAP_MAXIMUM));var r;r=new s.A({buffer:S.buffer,memory:S,byteOffset:o.HEAP_OFFSET,maxHeapSize:64*o.HEAP_MAXIMUM*1024,growAllowed:!0,onResize:(t,e)=>(S.grow(e-t.byteLength>>>16),{buffer:S.buffer,byteOffset:o.HEAP_OFFSET})},!1),P&&P.removeUpdateHandle(G),P=r,n.TK.CHeap&&(n.TK.CHeap.Allocator=P),P.addUpdateHandle(G),G(P.getBuffer()),t.stackPointer&&(I=t.stackSize,x=t.stackPointer,k=new WebAssembly.Global({value:"i32",mutable:!0},x+I),T=new a.z),y="number"==typeof t.id?t.id:Atomics.add(U,c.hb>>>2,1),w=null!==(e=t.name)&&void 0!==e?e:"anonymous",n.TK.CHeap={initThread:H,Allocator:P,Table:T,ThreadId:y,ThreadName:w,Memory:S,Config:o,StackSize:I,StackTop:x,StackPointer:k,isMainThread:!1},b=!1}!(0,i.A)()&&!(0,f.A)()||(0,i.A)()&&!o.USE_THREADS?function(){var t,e,r,i,f,g,_,M;if(W(),(0,u.A)((()=>P),v),(0,d.A)(A),S=null!==(t=n.TK.CHeap)&&void 0!==t&&t.Memory?n.TK.CHeap.Memory:new WebAssembly.Memory({initial:o.HEAP_INITIAL,maximum:o.HEAP_MAXIMUM,shared:o.USE_THREADS,address:"i32",index:"i32"}),"function"==typeof BigInt&&BigInt!==Number&&(p.A.chrome&&p.A.checkVersion(p.A.majorVersion,"85",!0)||p.A.firefox&&p.A.checkVersion(p.A.majorVersion,"78",!0)||p.A.safari&&p.A.checkVersion(p.A.majorVersion,"15",!0)||m.A.ios&&p.A.checkVersion(m.A.version,"15",!0)||p.A.newEdge)&&o.USE_THREADS&&h.Ts(S,o.HEAP_INITIAL,o.HEAP_MAXIMUM),o.USE_THREADS&&(p.A.chrome&&p.A.checkVersion(p.A.majorVersion,"85",!0)||p.A.firefox&&p.A.checkVersion(p.A.majorVersion,"78",!0)||p.A.safari&&p.A.checkVersion(p.A.majorVersion,"15",!0)||m.A.ios&&p.A.checkVersion(m.A.version,"15",!0)||p.A.newEdge)&&l.Ts(S,o.HEAP_INITIAL,o.HEAP_MAXIMUM),P=null!==(e=n.TK.CHeap)&&void 0!==e&&e.Allocator?n.TK.CHeap.Allocator:new s.A({buffer:S.buffer,memory:S,byteOffset:o.HEAP_OFFSET,maxHeapSize:64*o.HEAP_MAXIMUM*1024,growAllowed:!0,onResize:(t,e)=>(S.grow(e-t.byteLength>>>16),{buffer:S.buffer,byteOffset:o.HEAP_OFFSET})}),P.addUpdateHandle(G),G(P.getBuffer()),I=null!==(r=n.TK.CHeap)&&void 0!==r&&r.StackSize?n.TK.CHeap.StackSize:o.STACK_SIZE,x=null!==(i=n.TK.CHeap)&&void 0!==i&&i.StackTop?n.TK.CHeap.StackTop:P.malloc(I),k=null!==(f=n.TK.CHeap)&&void 0!==f&&f.StackPointer?n.TK.CHeap.StackPointer:new WebAssembly.Global({value:"i32",mutable:!0},x+I),T=null!==(g=n.TK.CHeap)&&void 0!==g&&g.Table?n.TK.CHeap.Table:new a.z,y=null!==(_=n.TK.CHeap)&&void 0!==_&&_.ThreadId?n.TK.CHeap.ThreadId:0,w=null!==(M=n.TK.CHeap)&&void 0!==M&&M.ThreadName?n.TK.CHeap.ThreadName:"main",!n.TK.CHeap)if(o.USE_THREADS)Atomics.store(U,c.hb>>>2,y+1),Atomics.store(C,c.II>>>2,0);else{U[c.hb>>>2]=y+1;let t=c.II>>>2;C[t]=0}n.TK.CHeap||(n.TK.CHeap={Allocator:P,Table:T,ThreadId:y,ThreadName:w,Memory:S,Config:o,StackSize:I,StackTop:x,StackPointer:k,isMainThread:!0,threadCounter:c.hb,heapMutex:c.II}),b=!0}():(n.TK.CHeap={initThread:H,isMainThread:!1,Config:o},b=!1)},80098:(t,e,r)=>{"use strict";r.d(e,{I_:()=>w,SQ:()=>k});var i=r(75019),s=r.n(i),a=r(11919),n=r.n(a),o=r(42096),c=r.n(o),d=r(99921),h=r(63939),l=r(50932),u=r(61499),f=r(6704),p=r(67672),m=r(95335),g=r(72739),v=r(2148);const A=s()({});function y(t,e){for(;;){let r=t[u.JY];if(r){const t=r.get(e);if(t)return t}if(!(t=s()(t))||t===A)return null}}function b(t,e,r,i){const s={};s[u.o9]=t;let a=(0,d.A)(i?20:r);return new Proxy(s,{get(t,e,s){if(e===u.o9)return t[u.o9];const n=(0,v.A)(e);return i?h.f[20](t[u.o9]+n*a):p.Pc(r)?t[e]:h.f[r](t[u.o9]+n*a)},set(t,e,s,n){if(e===u.o9)return t[u.o9]=s,!0;const o=(0,v.A)(e);if(i)l.M[20](t[u.o9]+o*a,s),t[e]=s;else if(p.Pc(r)){const i=t[e]||(t[e]=w(t[u.o9]+o*a,r));m.__(s,((t,e)=>{i[e]=t})),t[e]=i}else l.M[r](t[u.o9]+o*a,s),t[e]=s;return!0}})}function w(t,e){const r=p.Pc(e)?e.prototype:e,i={};i[u.o9]=t,n()(i,r);const{proxy:s,revoke:a}=Proxy.revocable(i,{get(t,e,i){if(p.Yj(e)){const i=y(r,e.replace(/^\$+/,""));if(i){const r=t[u.o9]+i[7];if(i[3]){let s=t[e];return s||(s=b(r,i[4],i[0],i[1]),t[e]=s),s[u.o9]=r,s}if(i[1])return h.f[20](r);if(p.Pc(i[0])||p.Ik(i[0]))return t[e]||(t[e]=w(r,i[0]));{let t=h.f[i[0]](r);return i[5]&&(t=t>>>8*f.i[i[0]]-i[8]-i[6]&Math.pow(2,i[6])-1),t}}return t[e]}return t[e]},set(t,e,i,s){if(p.Yj(e)){const s=y(r,e.replace(/^\$+/,""));if(s){const r=t[u.o9]+s[7];if(s[3]){const a=t[e]||b(r,s[4],s[0],s[1]);g.__(i,((t,e)=>{a[e]=t})),t[e]=a}else if(s[1])l.M[20](r,i),t[e]=i;else if(p.Pc(s[0])||p.Ik(s[0])){const a=t[e]||(t[e]=w(r,s[0]));m.__(i,((t,e)=>{a[e]=t})),t[e]=a}else{if(s[5]){let t=0,e=8*f.i[s[0]];for(let r=0;r<s[6];r++)t|=1<<e-1-(r+s[8]);const a=h.f[s[0]](r);l.M[s[0]](r,a&~t|(i&Math.pow(2,s[6])-1)<<e-s[8]-s[6])}else l.M[s[0]](r,i);t[e]=i}}else t[e]=i}else t[e]=i;return!0},getOwnPropertyDescriptor:(t,e)=>({enumerable:!0,configurable:!0}),ownKeys:t=>c()(t[u.JY].keys())});return i[u.kE]=a,s}function k(t){const e=t[u.kE];e&&e()}},52699:(t,e,r)=>{"use strict";r.d(e,{t:()=>a,z:()=>s});var i=r(11473);function s(t){return i.GE.value=i.GE.value-t,i.GE.value}function a(t){i.GE.value=i.GE.value+t}},7417:(t,e,r)=>{"use strict";r.d(e,{II:()=>d,hb:()=>c,z1:()=>o});var i,s,a=r(10576);let n=4;function o(t,e=1){let r=n;for(;r%e;)r+=1;return n=r+t,r}const c=null!==(i=a.TK.CHeap)&&void 0!==i&&i.threadCounter?a.TK.CHeap.threadCounter:o(4,4),d=null!==(s=a.TK.CHeap)&&void 0!==s&&s.heapMutex?a.TK.CHeap.heapMutex:o(4,4)},79630:(t,e,r)=>{"use strict";r.d(e,{A:()=>h});var i=r(134),s=r(63939),a=r(50932),n=r(11473),o=r(61403),c=r(26429);class d{constructor(t,e){(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"len",void 0),(0,i.A)(this,"view",void 0),this.pointer=t,this.len=e}get byteLength(){return this.len}get buffer(){return n.Lv}get byteOffset(){return this.pointer}getView(){return this.view&&this.view.buffer===n.ce.buffer||(this.view=new DataView((0,n.Lv)(),this.pointer,this.len)),this.view}getFloat32(t,e){return this.getView().getFloat32(t,e)}getFloat64(t,e){return this.getView().getFloat64(t,e)}getInt8(t){return this.getView().getInt8(t)}getInt16(t,e){return this.getView().getInt16(t,e)}getInt32(t,e){return this.getView().getInt32(t,e)}getUint8(t){return this.getView().getUint8(t)}getUint16(t,e){return this.getView().getUint16(t,e)}getUint32(t,e){return this.getView().getUint32(t,e)}setFloat32(t,e,r){this.getView().setFloat32(t,e,r)}setFloat64(t,e,r){this.getView().setFloat64(t,e,r)}setInt8(t,e){this.getView().setInt8(t,e)}setInt16(t,e,r){this.getView().setInt16(t,e,r)}setInt32(t,e,r){this.getView().setInt32(t,e,r)}setUint8(t,e){this.getView().setUint8(t,e)}setUint16(t,e,r){this.getView().setUint16(t,e,r)}setUint32(t,e,r){this.getView().setUint32(t,e,r)}getBigInt64(t,e){return this.getView().getBigInt64(t,e)}getBigUint64(t,e){return this.getView().getBigUint64(t,e)}setBigInt64(t,e,r){this.getView().setBigInt64(t,e,r)}setBigUint64(t,e,r){this.getView().setBigUint64(t,e,r)}}class h extends o.A{constructor(t,e){return super(),(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"len",void 0),this.pointer=t,this.len=e,this.proxy}getIndexValue(t){return s.f[2](this.pointer+t)}setIndexValue(t,e){a.M[2](this.pointer+t,e)}set(t,e=0){new Uint8Array((0,n.Lv)(),this.pointer,this.len).set(t,e)}subarray(t=0,e,r){return r&&!c.USE_THREADS?new h(this.pointer+t,(e||this.len)-t):new Uint8Array((0,n.Lv)(),this.pointer+t,(null!=e?e:this.len)-t)}slice(t=0,e){return new Uint8Array((0,n.Lv)(),this.pointer+t,(null!=e?e:this.len)-t).slice()}get length(){return this.len}get byteLength(){return this.len}get buffer(){return(0,n.Lv)()}get byteOffset(){return this.pointer}get view(){return new d(this.pointer,this.len)}}},12264:(t,e,r)=>{"use strict";r.d(e,{A:()=>A});var i,s,a=r(134),n=r(80662),o=r.n(n),c=r(61499),d=r(12085),h=r(11473),l=r(63939),u=r(50932),f=r(99921),p=r(14686),m=r(67672),g=r(29170);class v{constructor(){(0,a.A)(this,"prev",void 0),(0,a.A)(this,"next",void 0),(0,a.A)(this,"data",void 0)}}i=v.prototype,(s=new(o())).set("prev",{0:v,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("next",{0:v,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("data",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:8,8:0}),(0,d.A)(i,c.Og,!0),(0,d.A)(i,c.dc,4),(0,d.A)(i,c.g7,12),(0,d.A)(i,c.JY,s);class A{constructor(){(0,a.A)(this,"length",0),(0,a.A)(this,"head",0),(0,a.A)(this,"tail",0)}createNode(t,e,r=!1){const i=h.s_.malloc(12);if(u.M[20](i+4,0),u.M[20](i,0),m.ai(e))if(20===e)u.M[20](i+8,t);else{const r=h.s_.malloc((0,f.A)(e));u.M[e](r,t),u.M[20](i+8,r)}else if(r)u.M[20](i+8,t);else{const r=h.s_.malloc((0,f.A)(e));(0,p.Mr)(r,t[c.o9],(0,f.A)(e)),u.M[20](i+8,r)}return i}getItem(t,e){let r;return r=m.ai(e)?20===e?t:l.f[e](t):(0,g.A)(t,e),r}push(t,e,r=!1){const i=this.createNode(t,e,r);this.tail?(u.M[20](this.tail+4,i),u.M[20](i,this.tail),this.tail=i):(this.head=i,this.tail=i),this.length++}pop(t){const e=this.tail;let r=this.getItem(l.f[20](e+8),t);return this.length>1?(u.M[20](l.f[20](e)+4,0),this.tail=l.f[20](e)):(this.head=0,this.tail=0),this.length--,h.s_.free(l.f[20](e+8)),h.s_.free(e),r}shift(t){const e=this.head;let r=this.getItem(l.f[20](e+8),t);return this.length>1?(u.M[20](l.f[20](e+4),0),this.head=l.f[20](e+4)):(this.head=0,this.tail=0),this.length--,h.s_.free(l.f[20](e+8)),h.s_.free(e),r}unshift(t,e,r=!1){const i=this.createNode(t,e,r);this.head?(u.M[20](this.head,i),u.M[20](i+4,this.head),this.head=i):(this.head=i,this.tail=i),this.length++}forEach(t,e){if(!this.length)return;let r=this.head,i=0;for(;0!==r&&!1!==t(this.getItem(l.f[20](r+8),e),i);)r=l.f[20](r+4),i++}find(t,e){if(!this.length)return 0;let r=this.head,i=0;for(;0!==r;){const s=this.getItem(l.f[20](r+8),e);if(!0===t(s,i))return s;r=l.f[20](r+4),i++}return 0}indexOf(t,e){if(!this.length)return 0;let r=this.head,i=0;for(;0!==r;){if(i===t)return this.getItem(l.f[20](r+8),e);r=l.f[20](r+4),i++}return 0}clear(t,e){if(this.length){let r=this.head;for(;0!==r;){t&&t(this.getItem(l.f[20](r+8),e)),h.s_.free(l.f[20](r+8));const i=l.f[20](r+4);h.s_.free(r),r=i}}this.head=0,this.tail=0,this.length=0}}!function(t){var e=new(o());e.set("length",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("head",{0:v,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("tail",{0:v,1:1,2:1,3:0,4:0,5:0,6:0,7:8,8:0}),(0,d.A)(t,c.Og,!0),(0,d.A)(t,c.dc,4),(0,d.A)(t,c.g7,12),(0,d.A)(t,c.JY,e)}(A.prototype)},72703:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(67672);function s(t){return i.ai(t)&&t>=0}},74503:(t,e,r)=>{"use strict";r.d(e,{A:()=>d});var i=r(99921),s=r(11473),a=r(14686),n=r(95335),o=r(34677),c=r(29170);function d(t,e){(0,o.A)(e)||(e=t,t=null);const r=(0,i.A)(e),d=s.s_.malloc(r);if(!d)throw new TypeError("cannot alloc memory for struct");(0,a.sO)(d,0,r);const h=(0,c.A)(d,e),l=new e;return t&&n.X$(l,t),n.__(l,((t,e)=>{(0,o.A)(t)&&(h[e]=t)})),h}},14686:(t,e,r)=>{"use strict";r.d(e,{JW:()=>u,Mr:()=>d,bg:()=>p,lH:()=>m,lW:()=>h,qW:()=>g,s3:()=>f,sO:()=>l});var i=r(11473),s=r(50011),a=r(50932),n=r(79630),o=r(26429),c=r(63939);function d(t,e,r){(0,i.eq)().set((0,i.eq)().subarray(e,e+r),t)}function h(t,e,r){(0,i.eq)().set(r.subarray(0,e),t)}function l(t,e,r){(0,i.eq)().subarray(t,t+r).fill(e)}function u(t,e){return o.USE_THREADS?f(t,e):new n.A(t,e)}function f(t,e){return new Uint8Array((0,i.Lv)(),t,e)}function p(t,e){return new Uint16Array((0,i.Lv)(),t,e)}function m(t,e){let r=0;for(;c.f[4]((t+=1)-1)&&(r++,!(e&&r>=e)););const i=Math.min(r,null!=e?e:r);return s.decode(f(t,i))}function g(t,e,r,i=!0){const n=s.encode(e);let o=n.length,c=i?1:0;r&&o-c>r&&(o=r-c),h(t,o,n),i&&a.M[11](t+o,0)}},99921:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(61499),s=r(67672),a=r(6704);function n(t){return s.ai(t)?a.i[t]||0:s.Pc(t)&&t.prototype[i.Og]?t.prototype[i.g7]:0}},29170:(t,e,r)=>{"use strict";r.d(e,{A:()=>d});var i=r(61499),s=r(80098),a=r(25323),n=r(95797),o=r(67672),c=r(10534);function d(t,e){return arguments[2]&&o.Yj(arguments[2])&&(e=e.prototype,c.__(arguments[2],(t=>{const r=e[i.JY];e=r.get(t)[0]}))),n.A.proxy?(0,s.I_)(t,e):(0,a.l)(t,e)}},94300:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(11473),s=r(61499),a=r(80098),n=r(25323),o=r(95797);function c(t){const e=t[s.o9];e&&(i.s_.free(e),t[s.o9]=0,o.A.proxy?(0,a.SQ)(t):(0,n.X)(t))}},61499:(t,e,r)=>{"use strict";r.d(e,{JY:()=>d,Og:()=>a,dc:()=>o,g7:()=>n,kE:()=>h,o9:()=>c});var i=r(75062),s=r.n(i);const a=s()("Struct"),n=s()("StructLength"),o=s()("StructMaxBaseTypeByteLength"),c=s()("StructAddress"),d=(s()("StructKeysQueue"),s()("StructKeysMeta")),h=(s()("StructKeysInstance"),s()("StructProxyRevoke"))},10047:(t,e,r)=>{"use strict";r.d(e,{A:()=>i});const i="AGFzbQEAAAABLAdgAX8Bf2ABfwF+YAJ/fwF/YAJ/fgF+YAN/f38Bf2ADf35+AX5gA39/fgF/AhIBA2VudgZtZW1vcnkCAwGAgAQDKCcAAAABAgICAwICAgMCAgIDAgICAwICAgMCAgIDAgICAwQEBAUCAgYHhgMnBWxvYWQ4AAAGbG9hZDE2AAEGbG9hZDMyAAIGbG9hZDY0AAMGc3RvcmU4AAQHc3RvcmUxNgAFB3N0b3JlMzIABgdzdG9yZTY0AAcEYWRkOAAIBWFkZDE2AAkFYWRkMzIACgVhZGQ2NAALBHN1YjgADAVzdWIxNgANBXN1YjMyAA4Fc3ViNjQADwRhbmQ4ABAFYW5kMTYAEQVhbmQzMgASBWFuZDY0ABMDb3I4ABQEb3IxNgAVBG9yMzIAFgRvcjY0ABcEeG9yOAAYBXhvcjE2ABkFeG9yMzIAGgV4b3I2NAAbCWV4Y2hhbmdlOAAcCmV4Y2hhbmdlMTYAHQpleGNoYW5nZTMyAB4KZXhjaGFuZ2U2NAAfEWNvbXBhcmVfZXhjaGFuZ2U4ACASY29tcGFyZV9leGNoYW5nZTE2ACESY29tcGFyZV9leGNoYW5nZTMyACISY29tcGFyZV9leGNoYW5nZTY0ACMGbm90aWZ5ACQEd2FpdAAlC3dhaXRUaW1lb3V0ACYKugMnCAAgAP4SAAALCAAgAP4TAQALCAAgAP4QAgALCAAgAP4RAwALDAAgACAB/hkAACABCwwAIAAgAf4aAQAgAQsMACAAIAH+FwIAIAELDAAgACAB/hgDACABCwoAIAAgAf4gAAALCgAgACAB/iEBAAsKACAAIAH+HgIACwoAIAAgAf4fAwALCgAgACAB/icAAAsKACAAIAH+KAEACwoAIAAgAf4lAgALCgAgACAB/iYDAAsKACAAIAH+LgAACwoAIAAgAf4vAQALCgAgACAB/iwCAAsKACAAIAH+LQMACwoAIAAgAf41AAALCgAgACAB/jYBAAsKACAAIAH+MwIACwoAIAAgAf40AwALCgAgACAB/jwAAAsKACAAIAH+PQEACwoAIAAgAf46AgALCgAgACAB/jsDAAsKACAAIAH+QwAACwoAIAAgAf5EAQALCgAgACAB/kECAAsKACAAIAH+QgMACwwAIAAgASAC/koAAAsMACAAIAEgAv5LAQALDAAgACABIAL+SAIACwwAIAAgASAC/kkDAAsKACAAIAH+AAIACwwAIAAgAUJ//gECAAsMACAAIAEgAv4BAgAL"},82854:(t,e,r)=>{"use strict";r.d(e,{KJ:()=>d,Ko:()=>h,Ts:()=>l});var i=r(4919),s=r(4624),a=r(88096),n=r(10047),o=r(40046);const c="src\\cheap\\thread\\asm\\atomics.ts";let d;function h(){return!!d}function l(t,e,r){try{if(!("function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer))return;{const s=a.bx((0,i.E_)(n.A),{shared:!0,initial:e,maximum:r});d=new WebAssembly.Instance(new WebAssembly.Module(s),{env:{memory:t}})}(0,o.$Z)({add:function(t,e,r){switch(r){case 5:case 3:return 255&d.exports.add8(t,e);case 12:return d.exports.add8(t,e);case 14:return d.exports.add16(t,e);case 7:return 65535&d.exports.add16(t,e);case 16:return d.exports.add32(t,e);case 9:return 4294967295&d.exports.add32(t,e);case 21:return d.exports.add64(t,e);case 22:return BigInt.asUintN(64,d.exports.add64(t,e))}},sub:function(t,e,r){switch(r){case 5:case 3:return 255&d.exports.sub8(t,e);case 12:return d.exports.sub8(t,e);case 14:return d.exports.sub16(t,e);case 7:return 65535&d.exports.sub16(t,e);case 16:return d.exports.sub32(t,e);case 9:return 4294967295&d.exports.sub32(t,e);case 21:return d.exports.sub64(t,e);case 22:return BigInt.asUintN(64,d.exports.sub64(t,e))}},and:function(t,e,r){switch(r){case 5:case 3:return 255&d.exports.and8(t,e);case 12:return d.exports.and8(t,e);case 14:return d.exports.and16(t,e);case 7:return 65535&d.exports.and16(t,e);case 16:return d.exports.and32(t,e);case 9:return 4294967295&d.exports.and32(t,e);case 21:return d.exports.and64(t,e);case 22:return BigInt.asUintN(64,d.exports.and64(t,e))}},or:function(t,e,r){switch(r){case 5:case 3:return 255&d.exports.or8(t,e);case 12:return d.exports.or8(t,e);case 14:return d.exports.or16(t,e);case 7:return 65535&d.exports.or16(t,e);case 16:case 9:return d.exports.or32(t,e);case 21:return d.exports.or64(t,e);case 22:return BigInt.asUintN(64,d.exports.or64(t,e))}},xor:function(t,e,r){switch(r){case 5:case 3:return 255&d.exports.xor8(t,e);case 12:return d.exports.xor8(t,e);case 14:return d.exports.xor16(t,e);case 7:return 65535&d.exports.xor16(t,e);case 16:case 9:return d.exports.xor32(t,e);case 21:return d.exports.xor64(t,e);case 22:return BigInt.asUintN(64,d.exports.xor64(t,e))}},store:function(t,e,r){switch(r){case 5:case 12:case 3:return d.exports.store8(t,e);case 14:case 7:return d.exports.store16(t,e);case 16:case 9:return d.exports.store32(t,e);case 21:case 22:return d.exports.store64(t,e)}},load:function(t,e){switch(e){case 5:case 3:return 255&d.exports.load8(t);case 12:return d.exports.load8(t);case 14:case 7:return d.exports.load16(t);case 16:return d.exports.load32(t);case 9:return 4294967295&d.exports.load32(t);case 21:return d.exports.load64(t);case 22:return BigInt.asUintN(64,d.exports.load64(t))}},compareExchange:function(t,e,r,i){switch(i){case 5:case 3:return 255&d.exports.compare_exchange8(t,e,r);case 12:return d.exports.compare_exchange8(t,e,r);case 14:return d.exports.compare_exchange16(t,e,r);case 7:return 65535&d.exports.compare_exchange16(t,e,r);case 16:return d.exports.compare_exchange32(t,e,r);case 9:return 4294967295&d.exports.compare_exchange32(t,e,r);case 21:return d.exports.compare_exchange64(t,e,r);case 22:return BigInt.asUintN(64,d.exports.compare_exchange64(t,e,r))}},exchange:function(t,e,r){switch(r){case 5:case 3:return 255&d.exports.exchange8(t,e);case 12:return d.exports.exchange8(t,e);case 14:return d.exports.exchange16(t,e);case 7:return 65535&d.exports.exchange16(t,e);case 16:return d.exports.exchange32(t,e);case 9:return 4294967295&d.exports.exchange32(t,e);case 21:return d.exports.exchange64(t,e);case 22:return BigInt.asUintN(64,d.exports.exchange64(t,e))}},notify:function(t,e){return d.exports.notify(t,e)},wait:function(t,e){return d.exports.wait(t,e)},waitTimeout:function(t,e,r){return d.exports.waitTimeout(t,e,BigInt(0|r)*BigInt(1e6))}})}catch(t){s.R8("atomics asm not support, cannot use asm atomics function",c,291)}}},40046:(t,e,r)=>{"use strict";let i,s,a,n,o,c,d,h,l,u,f,p,m,g;function v(t){t.add&&(i=t.add),t.sub&&(s=t.sub),t.and&&(a=t.and),t.or&&(n=t.or),t.xor&&(o=t.xor),t.store&&(c=t.store),t.load&&(d=t.load),t.compareExchange&&(h=t.compareExchange),t.exchange&&(l=t.exchange),t.notify&&(u=t.notify),t.wait&&(f=t.wait),t.waitTimeout&&(p=t.waitTimeout),t.waitAsync&&(m=t.waitAsync),t.waitTimeoutAsync&&(g=t.waitTimeoutAsync)}r.d(e,{$Z:()=>v,Hh:()=>d,I8:()=>o,M_:()=>c,Uo:()=>a,WQ:()=>i,cv:()=>l,j4:()=>p,jb:()=>s,me:()=>u,or:()=>n,p_:()=>h,uk:()=>f})},33856:(t,e,r)=>{"use strict";r.d(e,{A:()=>_});var i=r(54001),s=r.n(i),a=r(86932),n=r(7972),o=r(40046),c=r(26429),d=r(86834),h=r(95797);let l;const u=c.USE_THREADS||!d.A.chrome&&h.A.atomics||d.A.checkVersion(d.A.majorVersion,"94",!0);function f(t,e,r,i){if(u)return Atomics.add(l(r),t>>>i,e);{const s=l(r),a=t>>>i,n=s[a];return s[a]+=e,n}}function p(t,e,r,i){if(u)return Atomics.sub(l(r),t>>>i,e);{const s=l(r),a=t>>>i,n=s[a];return s[a]-=e,n}}function m(t,e,r,i){if(u)return Atomics.and(l(r),t>>>i,e);{const s=l(r),a=t>>>i,n=s[a];return s[a]&=e,n}}function g(t,e,r,i){if(u)return Atomics.or(l(r),t>>>i,e);{const s=l(r),a=t>>>i,n=s[a];return s[a]|=e,n}}function v(t,e,r,i){if(u)return Atomics.xor(l(r),t>>>i,e);{const s=l(r),a=t>>>i,n=s[a];return s[a]^=e,n}}function A(t,e,r,i){if(u)return Atomics.store(l(r),t>>>i,e);{const s=l(r),a=t>>>i,n=s[a];return s[a]=e,n}}function y(t,e,r){return u?Atomics.load(l(e),t>>>r):l(e)[t>>>r]}function b(t,e,r,i,s){if(u)return Atomics.compareExchange(l(i),t>>>s,e,r);{const a=l(i),n=t>>>s,o=a[n];return o===e&&(a[n]=r),o}}function w(t,e,r,i){if(u)return Atomics.exchange(l(r),t>>>i,e);{const s=l(r),a=t>>>i,n=s[a];return s[a]=e,n}}function k(t,e){return u?Atomics.notify(l(16),t>>>2,e):void 0}const x={ok:0,"not-equal":1,"timed-out":2};function I(t,e){return x[Atomics.wait(l(16),t>>>2,e)]}function T(t,e,r){return x[Atomics.wait(l(16),t>>>2,e,r)]}async function P(t,e){if(Atomics.waitAsync){const r=Atomics.waitAsync(l(16),t>>>2,e);return r.async?x[await r.value]:x[r.value]}if(y(t)!==e)return 1;for(;y(t)===e;)await new(s())((t=>{(0,n.A)((()=>{t()}))}));return 0}async function S(t,e,r){if(Atomics.waitAsync){const i=Atomics.waitAsync(l(16),t>>>2,e,r);return i.async?x[await i.value]:x[i.value]}if(y(t)!==e)return 1;{const i=(0,a.A)();for(;y(t)===e&&(0,a.A)()-i<r;)await new(s())((t=>{(0,n.A)((()=>{t()}))}));return y(t)!==e?0:2}}function _(t){l=t,(0,o.$Z)({add:f,sub:p,and:m,or:g,xor:v,store:A,load:y,compareExchange:b,exchange:w,notify:k,wait:I,waitTimeout:T,waitAsync:P,waitTimeoutAsync:S})}},42518:(t,e,r)=>{"use strict";r.d(e,{Ts:()=>u,XR:()=>v,mq:()=>m,uk:()=>g,vP:()=>p,zr:()=>f});var i,s,a=r(134),n=r(80662),o=r.n(n),c=r(61499),d=r(12085),h=r(73783),l=r(40046);function u(t,e){return l.M_(t,0,16,2),0}function f(t){return l.M_(t,0,16,2),0}function p(t){return l.WQ(t,1,16,2),l.me(t,1),0}function m(t){return l.WQ(t,1,16,2),l.me(t,1073741824),0}function g(t,e){let r=l.Hh(t,16,2);return h.Tl(e),l.uk(t,r),h.s2(e),0}function v(t,e,r){let i=l.Hh(t,16,2);h.Tl(e);let s=l.j4(t,i,r);return h.s2(e),2===s?110:0}i=class{constructor(){(0,a.A)(this,"atomic",void 0)}}.prototype,(s=new(o())).set("atomic",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),(0,d.A)(i,c.Og,!0),(0,d.A)(i,c.dc,4),(0,d.A)(i,c.g7,4),(0,d.A)(i,c.JY,s)},81574:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});var i=r(84149),s=(r(55013),r(10576)),a=r(67672);let n=s.TK;function o(t){let e,r;n.onmessage=o=>{const c=o.data,d=c.type,h=c.data;switch(d){case"init":if(s.TK.CHeap&&s.TK.CHeap.initThread&&s.TK.CHeap.Config.USE_THREADS)return void s.TK.CHeap.initThread(h).then((()=>{n.postMessage({type:"ready"})}));n.postMessage({type:"ready"});break;case"run":n.postMessage({type:"running"}),r=t(h.params),l=h.port,e=new i.Ay(l),e.on(i.S3,(async t=>{const i=t.method,s=t.params;if(a.Pc(r[i]))try{r[i].transfer||(r[i].transfer=[]);const a=await r[i](...s.params);e.reply(t,a,null,r[i].transfer),r[i].transfer.length=0}catch(r){e.reply(t,-2097152,{message:r.message})}}));break;case"stop":e&&e.destroy(),s.TK.__freeSmartPtr__&&s.TK.__freeSmartPtr__(),n.postMessage({type:"stopped"})}var l}}},26848:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>a});var i=r(10576);let s=i.TK;function a(t){let e;s.onmessage=r=>{const a=r.data,n=a.type,o=a.data;switch(n){case"init":if(i.TK.CHeap&&i.TK.CHeap.initThread&&i.TK.CHeap.Config.USE_THREADS)return void i.TK.CHeap.initThread(o).then((()=>{s.postMessage({type:"ready"})}));s.postMessage({type:"ready"});break;case"run":e=t(o.params);break;case"stop":e&&e.then?e.then((t=>{i.TK.__freeSmartPtr__&&i.TK.__freeSmartPtr__(),s.postMessage({type:"stopped",data:t})})):(i.TK.__freeSmartPtr__&&i.TK.__freeSmartPtr__(),s.postMessage({type:"stopped",data:e}))}}}},67524:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});var i=r(84149),s=(r(55013),r(10576)),a=r(67672);let n=s.TK;function o(t){let e;n.onmessage=r=>{const o=r.data,c=o.type,d=o.data;switch(c){case"init":if(s.TK.CHeap&&s.TK.CHeap.initThread&&s.TK.CHeap.Config.USE_THREADS)return void s.TK.CHeap.initThread(d).then((()=>{n.postMessage({type:"ready"})}));n.postMessage({type:"ready"});break;case"run":n.postMessage({type:"running"}),h=d.port,e=new i.Ay(h),e.on(i.S3,(async r=>{const i=r.method,s=r.params;if(a.Pc(t[i]))try{t[i].transfer||(t[i].transfer=[]);const a=await t[i](...s.params);e.reply(r,a,null,t[i].transfer),t[i].transfer.length=0}catch(t){e.reply(r,-2097152,{message:t.message})}}));break;case"stop":e&&e.destroy(),s.TK.__freeSmartPtr__&&s.TK.__freeSmartPtr__(),n.postMessage({type:"stopped"})}var h}}},73783:(t,e,r)=>{"use strict";r.d(e,{Tl:()=>g,Ts:()=>f,bh:()=>m,eu:()=>u,s2:()=>p,zr:()=>v});var i,s,a=r(134),n=r(80662),o=r.n(n),c=r(61499),d=r(12085),h=r(40046),l=r(39638);class u{constructor(){(0,a.A)(this,"atomic",void 0)}}function f(t){return h.M_(t,0,16,2),0}function p(t,e=!1){let r;if(0!==(r=h.p_(t,0,1,16,2)))do{2!=r&&0===h.p_(t,1,2,16,2)||!e&&(0,l.A)()&&h.uk(t,2)}while(0!==(r=h.p_(t,0,2,16,2)));return 0}function m(t){return 0===h.p_(t,0,1,16,2)?0:16}function g(t){return 1!==h.jb(t,1,16,2)&&(h.M_(t,0,16,2),h.me(t,1)),0}function v(t){return h.M_(t,0,16,2),0}i=u.prototype,(s=new(o())).set("atomic",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),(0,d.A)(i,c.Og,!0),(0,d.A)(i,c.dc,4),(0,d.A)(i,c.g7,4),(0,d.A)(i,c.JY,s)},79490:(t,e,r)=>{"use strict";r.d(e,{Ts:()=>p,XR:()=>y,Zr:()=>A,bE:()=>g,uk:()=>v,zr:()=>m});var i,s,a=r(134),n=r(80662),o=r.n(n),c=r(61499),d=r(12085),h=r(73783),l=r(63939),u=r(50932),f=r(40046);function p(t,e){return f.M_(t,0|e,16,2),h.Ts(t+4),0}function m(t){return h.zr(t+4),0}function g(t){return f.WQ(t,1,16,2),f.me(t,1),0}function v(t){for(;f.uk(t,0),f.jb(t,1,16,2)<=0;)f.WQ(t,1,16,2);return 0}function A(t){return h.s2(t+4),l.f[16](t)>0?(u.M[16](t,l.f[16](t)-1),h.Tl(t+4),0):(h.Tl(t+4),11)}function y(t,e){return 2!==f.j4(t,0,e)&&f.jb(t,1,16,2)<=0?(f.WQ(t,1,16,2),110):0}i=class{constructor(){(0,a.A)(this,"atomic",void 0),(0,a.A)(this,"mutex",void 0)}}.prototype,(s=new(o())).set("atomic",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("mutex",{0:h.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,d.A)(i,c.Og,!0),(0,d.A)(i,c.dc,4),(0,d.A)(i,c.g7,8),(0,d.A)(i,c.JY,s)},88506:(t,e,r)=>{"use strict";r.d(e,{nE:()=>I,nx:()=>T,pt:()=>x});var i=r(75062),s=r.n(i),a=r(80662),n=r.n(a),o=r(54001),c=r.n(o),d=r(11473),h=r(84149),l=(r(55013),r(61837)),u=r(26429),f=r(67672),p=r(10576),m=r(62100),g=r(95073);let v=p.TK.Worker,A=p.TK.MessageChannel;r(81574),r(26848),r(67524);const y=(0,l.A)(81574,{varName:"init"}),b=((0,l.A)(26848,{varName:"init"}),(0,l.A)(67524,{varName:"init"}),s()("revoke")),w=new(n());function k(t,e){return`${t}_${e}`}function x(t,e,r){e=e||{},f.Pc(e)&&(r=e,e={});let i,s=[];function a(...e){const i=new t(...e);return new(c())((e=>{const s={$worker:null,$ipc:null,$channel:null,$moduleId:(0,m.A)(r),$stackPointer:0,$instance:i,$type:"class"},{proxy:a,revoke:n}=Proxy.revocable(s,{get(e,r,a){if(e[r])return s[r];if(r in t.prototype&&"function"==typeof t.prototype[r]){const t=function(...t){return i[r](...t)};t.transfer=function(...t){return{invoke:function(...t){return i[r](...t)}}},e[r]=t}return e[r]}});s[b]=n,e(a)}))}return i=(...i)=>{let a;if(f.Pc(r))a=r();else{let e;const i=k(r,"class");if(w.has(i))e=w.get(i).url,w.get(i).refCount++;else{const s=(0,l.A)(r,{varName:`__module_${t.name}__`,exportName:`__${t.name}__`,pointName:t.name,exportIsClass:!0}),a=`\n            self.CHEAP_DISABLE_THREAD = ${p.TK.CHEAP_DISABLE_THREAD}\n            self.CHEAP_HEAP_INITIAL = ${p.TK.CHEAP_HEAP_INITIAL}\n            self.CHEAP_HEAP_MAXIMUM = ${p.TK.CHEAP_HEAP_MAXIMUM}\n            ${p.TK.CHEAP_POLYFILL_URL?`self.CHEAP_POLYFILL_URL = '${p.TK.CHEAP_POLYFILL_URL}'`:""}\n            ${p.TK.CHEAP_POLYFILL_URL?`importScripts('${p.TK.CHEAP_POLYFILL_URL}');`:""}\n            ${s}\n            function run(params) {\n              params.unshift(null)\n              return new (Function.prototype.bind.apply(__module_${t.name}__.__${t.name}__, params))()\n            }\n            ${y}\n            init.default(run);\n          `;{const t=new Blob([a],{type:"text/javascript"});e=URL.createObjectURL(t)}w.set(i,{url:e,refCount:1})}a=new v(e)}const n=new A;return new(c())(((o,c)=>{var l;const f=u.USE_THREADS?d.s_.alignedAlloc(u.STACK_ALIGNMENT,e.stackSize?(0,g.A)(e.stackSize,u.STACK_ALIGNMENT):u.STACK_SIZE):0;a.onmessage=e=>{const c=e.data,d=c.type;switch(c.data,d){case"ready":a.postMessage({type:"run",data:{port:n.port2,params:i}},[n.port2,...s]);break;case"running":!function(){const e=new h.Ay(n.port1),i={$worker:a,$ipc:e,$channel:n,$moduleId:(0,m.A)(r),$stackPointer:f,$type:"class"},{proxy:s,revoke:c}=Proxy.revocable(i,{get(r,s,a){if(r[s])return i[s];if(s in t.prototype&&"function"==typeof t.prototype[s]){const t=async function(...t){return e.request(s,{params:t})};t.transfer=function(...t){return{invoke:async function(...r){return e.request(s,{params:r},t)}}},r[s]=t}return r[s]}});i[b]=c,o(s)}()}},a.postMessage({type:"init",data:{memory:u.USE_THREADS?d.ce:null,name:e.name||t.name,stackPointer:f,stackSize:null!==(l=e.stackSize)&&void 0!==l?l:u.STACK_SIZE}})}))},{run:!u.USE_THREADS&&!e.dispatchToWorker||e.disableWorker?a:i,transfer:function(...t){return s=t,{run:!u.USE_THREADS&&!e.dispatchToWorker||e.disableWorker?a:i}}}}function I(t){if(t.$worker&&(t.$worker.terminate(),t.$worker=null),t.$moduleId){if(f.Yj(t.$moduleId)){const e=k(t.$moduleId,t.$type);w.has(e)&&(w.get(e).refCount--,0===w.get(e).refCount&&(URL.revokeObjectURL(w.get(e).url),w.delete(e)))}t.$moduleId=null}if(t.$ipc&&(t.$ipc.destroy(),t.$ipc=null),t.$stackPointer&&(d.s_.free(t.$stackPointer),t.$stackPointer=0),t.$channel=null,t.$instance=null,t[b]){const e=t[b];t[b]=null,e()}}async function T(t){return t.$worker?new(c())((e=>{t.$worker.onmessage=function(r){const i=r.data,s=i.type,a=i.data;"stopped"===s&&(I(t),e(a))},t.$worker.postMessage({type:"stop"})})):t.$retval?t.$retval:void 0}},6704:(t,e,r)=>{"use strict";r.d(e,{_:()=>s,i:()=>i});const i={2:1,3:1,4:1,5:1,6:2,7:2,8:4,9:4,10:8,11:1,12:1,13:2,14:2,15:4,16:4,17:8,18:4,19:8,20:4,0:4,1:4,22:8,21:8,23:1,24:1,25:4},s={2:0,3:0,4:0,5:0,6:1,7:1,8:2,9:2,10:4,11:0,12:0,13:1,14:1,15:2,16:2,17:4,18:2,19:4,20:2,1:2,0:2,22:4,21:4,23:0,24:0,25:2}},19094:(t,e,r)=>{"use strict";r.d(e,{A:()=>p});var i=r(134),s=r(54001),a=r.n(s),n=r(11473),o=r(63939),c=r(50932),d=r(26429),h=r(14686),l=r(42518),u=r(73783),f=r(40046);class p{constructor(t,e){(0,i.A)(this,"count",void 0),(0,i.A)(this,"url",void 0),(0,i.A)(this,"childThreads",void 0),this.count=t,this.url=e,this.childThreads=[]}async createTheadPoolEntry(t){return new(a())(((e,r)=>{const i=new Worker(this.url),s=n.s_.alignedAlloc(d.STACK_ALIGNMENT,d.STACK_SIZE),a=n.s_.malloc(8);(0,h.sO)(a,0,8),c.M[15](a+4,0),c.M[15](a,2|o.f[15](a));const f=(0,n.pv)();i.onmessage=t=>{if("ready"===t.data.type){const t=s;(0,h.sO)(t,0,20),u.Ts(t+16),l.Ts(t+12),i.postMessage({type:"wait"}),e({id:f,thread:{thread:0,worker:i,stackPointer:s,threadDescriptor:a},threadWait:t})}},i.postMessage({type:"ready",data:{cheap:{memory:n.ce,stackPointer:s,stackSize:d.STACK_SIZE,id:f},runner:{resource:{tableSize:t.tableSize,module:t.module,initFuncs:t.initFuncs},options:{memoryBase:t.memoryBase,tableBase:t.tableBase,threadDescriptor:a,childImports:t.childImports},imports:t.childImports}}})}))}async ready(t){this.childThreads=await a().all(new Array(this.count).fill(0).map((()=>this.createTheadPoolEntry(t))))}hasFree(){for(let t=0;t<this.childThreads.length;t++)if(0===o.f[15](this.childThreads[t].thread.threadDescriptor+4))return!0;return!1}isPoolThread(t){for(let e=0;e<this.childThreads.length;e++)if(this.childThreads[e].thread.thread===t)return!0;return!1}createThread(t,e,r,i){for(let e=0;e<this.childThreads.length;e++)if(0===o.f[15](this.childThreads[e].thread.threadDescriptor+4))return c.M[15](this.childThreads[e].thread.threadDescriptor+4,1),this.childThreads[e].thread.thread=t,c.M[15](t+8,2|o.f[15](t+8)),u.s2(this.childThreads[e].threadWait+16),c.M[20](this.childThreads[e].threadWait,t),c.M[20](this.childThreads[e].threadWait+4,r),c.M[20](this.childThreads[e].threadWait+8,i),u.Tl(this.childThreads[e].threadWait+16),void l.vP(this.childThreads[e].threadWait+12)}joinThread(t,e){let r;for(let e=0;e<this.childThreads.length;e++)if(this.childThreads[e].thread.thread===t){r=this.childThreads[e];break}return r?(1&o.f[15](t+8)||(f.uk(t+12,1),0!==e&&c.M[20](e,o.f[20](t+4)),c.M[15](r.thread.threadDescriptor+4,0)),0):-1}detachThread(t){let e;for(let r=0;r<this.childThreads.length;r++)if(this.childThreads[r].thread.thread===t){e=this.childThreads[r];break}return e?(c.M[15](e.thread.threadDescriptor,1|o.f[15](e.thread.threadDescriptor)),c.M[15](t+8,1|o.f[15](t+8)),0):-1}destroy(){for(let t=0;t<this.childThreads.length;t++)n.s_.free(this.childThreads[t].thread.stackPointer),n.s_.free(this.childThreads[t].thread.threadDescriptor),this.childThreads[t].thread.worker.terminate();this.childThreads=[]}}},16030:(t,e,r)=>{"use strict";r.d(e,{A:()=>E});var i=r(134),s=r(80662),a=r.n(s),n=r(54001),o=r.n(n),c=r(63939),d=r(50932),h=r(11473),l=r(95335),u=r(72739),f=r(4624),p=r(67672),m=r(14686),g=r(14621),v=r(1708),A=r(20357),y=r(77775),b=r(26429),w=r(40046),k=r(82854),x=r(80905),I=r(24565),T=r(19094),P=r(42518),S=r(73783),_=r(95797),M=(r(81999),r(10576)),C=r(61837);const B="src\\cheap\\webassembly\\WebAssemblyRunner.ts";let R=M.TK.Worker;function D(){}let U=!1;class E{static getTable(){return h.XI}static mutexLock(t){S.s2(t)}static mutexUnlock(t){S.Tl(t)}static condWait(t,e){P.uk(t,e)}static readPointer(t){return c.f[20](t)}static writePointer(t,e){d.M[20](t,e)}constructor(t,e={}){var r,s;(0,i.A)(this,"resource",void 0),(0,i.A)(this,"instance",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"builtinMalloc",void 0),(0,i.A)(this,"memoryBase",void 0),(0,i.A)(this,"tableBase",void 0),(0,i.A)(this,"childImports",void 0),(0,i.A)(this,"childUrl",void 0),(0,i.A)(this,"childBlob",void 0),(0,i.A)(this,"childThreads",void 0),(0,i.A)(this,"imports",void 0),(0,i.A)(this,"childReadyPromises",void 0),(0,i.A)(this,"threadPool",void 0),(0,i.A)(this,"initCalling",void 0),(0,i.A)(this,"promisingMap",void 0),this.resource=t,this.builtinMalloc=[],this.initCalling=!1,this.childThreads=new(a()),this.childReadyPromises=[],this.promisingMap=new(a()),p.Yj(e.childImports)?this.childImports=e.childImports:p.Ik(e.childImports)&&e.childImports instanceof Blob&&(this.childImports=URL.createObjectURL(e.childImports)),this.memoryBase=t.dataSize?h.s_.alignedAlloc(null!==(r=t.dataAlign)&&void 0!==r?r:8,t.dataSize):0,this.memoryBase&&t.bssSize&&(0,m.sO)(this.memoryBase+(t.dataSize-t.bssSize),0,t.bssSize),e.thread&&e.tableBase&&h.XI.getPointer()!==e.tableBase&&h.XI.alloc(e.tableBase-h.XI.getPointer()),this.tableBase=t.tableSize?h.XI.alloc(t.tableSize):0,this.options=e,this.imports={env:{memory:h.ce,__stack_pointer:h.GE,__indirect_function_table:h.XI.table,clock_time_get:g.WU,clock_res_get:g.Lq,random_get:g.Pp,abort:g.h2,proc_exit:function(t){f.z3(`wasm module exit, code: ${t}`,B,158)},__syscall_renameat:D,__syscall_unlinkat:D,environ_get:g.B,environ_sizes_get:g.CK,fd_close:D,fd_fdstat_get:g.LS,fd_read:D,fd_seek:D,fd_write:g.nK,emscripten_builtin_malloc:t=>{const e=h.s_.malloc(t);return this.builtinMalloc.push(e),e},emscripten_builtin_free:t=>{h.s_.free(t)},emscripten_builtin_memalign:(t,e,r)=>{const i=h.s_.alignedAlloc(e,r);return 0!==i?(d.M[20](t,i),this.builtinMalloc.push(i),0):-1},emscripten_memcpy_big:function(t,e,r){(0,m.Mr)(t,e,r)},__libc_malloc:function(t){return h.s_.malloc(t)},__libc_free:t=>{h.s_.free(t)},malloc:t=>{if(!0===this.initCalling){const e=h.s_.malloc(t);return this.builtinMalloc.push(e),e}return h.s_.malloc(t)},calloc:function(t,e){return h.s_.calloc(t,e)},realloc:function(t,e){return h.s_.realloc(t,e)},aligned_alloc:(t,e)=>h.s_.alignedAlloc(t,e),free:function(t){h.s_.free(t)},posix_memalign:function(t,e,r){const i=h.s_.alignedAlloc(e,r);return 0!==i?(d.M[20](t,i),0):-1},memalign:function(t,e){return h.s_.alignedAlloc(t,e)}},"GOT.func":{malloc:new WebAssembly.Global({mutable:!0,value:"i32"},2),calloc:new WebAssembly.Global({mutable:!0,value:"i32"},3),realloc:new WebAssembly.Global({mutable:!0,value:"i32"},4),aligned_alloc:new WebAssembly.Global({mutable:!0,value:"i32"},5),free:new WebAssembly.Global({mutable:!0,value:"i32"},1)}};{const t=(t,e,r,i)=>{if(this.threadPool&&this.threadPool.hasFree())return this.threadPool.createThread(t,e,r,i),0;this.childUrl||this.createChildUrl();const s=new R(this.childUrl);d.M[15](t,(0,h.pv)()),d.M[16](t+12,1),d.M[15](t+8,0),d.M[20](t+4,0);const a=h.s_.alignedAlloc(b.STACK_ALIGNMENT,b.STACK_SIZE),n=h.s_.malloc(8);let l;(0,m.sO)(n,0,8),this.childThreads.set(c.f[15](t),{thread:t,worker:s,stackPointer:a,threadDescriptor:n});const u=new(o())((t=>{l=t}));_.A.jspi||this.childReadyPromises.push(u);return s.onmessage=t=>{const e=t.data,r=e.type;e.data,"run"===r&&l(0)},s.postMessage({type:"run",data:{cheap:{memory:h.ce,stackPointer:a,stackSize:b.STACK_SIZE,id:c.f[15](t)},runner:{resource:{tableSize:this.resource.tableSize,module:this.resource.threadModule.module,initFuncs:this.resource.threadModule.initFuncs},options:{memoryBase:this.options.memoryBase||this.memoryBase,tableBase:this.tableBase,thread:t,threadDescriptor:n,childImports:this.childImports},func:r,args:i,imports:this.childImports,thread:t}}}),_.A.jspi?u:0};l.X$(this.imports.env,{wasm_pthread_create:_.A.jspi?new WebAssembly.Suspending(t):t,wasm_pthread_join2:(t,e)=>{if(this.threadPool&&this.threadPool.isPoolThread(t))return this.threadPool.joinThread(t,e),0;if(1&c.f[15](t+8))return this.childThreads.delete(c.f[15](t)),0;w.uk(t+12,1),0!==e&&d.M[20](e,c.f[20](t+4));const r=this.childThreads.get(c.f[15](t));return h.s_.free(r.stackPointer),h.s_.free(r.threadDescriptor),r.worker.terminate(),this.childThreads.delete(c.f[15](t)),(0,m.sO)(t,0,16),0},wasm_pthread_detach2:t=>{if(this.threadPool&&this.threadPool.isPoolThread(t))return this.threadPool.detachThread(t),0;const e=this.childThreads.get(c.f[15](t));d.M[15](e.threadDescriptor,1|c.f[15](e.threadDescriptor)),d.M[15](t+8,1|c.f[15](t+8))}}),l.X$(this.imports.env,v),l.X$(this.imports.env,A),l.X$(this.imports.env,y)}if(this.memoryBase?l.X$(this.imports.env,{__memory_base:this.memoryBase}):e.memoryBase&&l.X$(this.imports.env,{__memory_base:e.memoryBase}),this.tableBase&&l.X$(this.imports.env,{__table_base:this.tableBase}),null!==(s=e.imports)&&void 0!==s&&s.env&&(l.X$(this.imports.env,e.imports.env),e.envKey&&e.importMap)){const t={};l.__(this.imports.env,((r,i)=>{e.importMap[i]&&(t[e.importMap[i]]=r)})),this.imports[e.envKey]=t}this.imports.wasi_snapshot_preview1=this.imports.env}createChildUrl(){{let t="";{r(81999);const e=(0,C.A)(16030,{varName:"__WebAssemblyRunner__",exportName:"__WebAssemblyRunner__",pointName:E.name,exportIsClass:!0}),i=(0,C.A)(81999,{varName:"runThread"});let s="",a="";this.childImports&&(s=`importScripts('${this.childImports}');`),M.TK.CHEAP_POLYFILL_URL&&(a=`importScripts('${M.TK.CHEAP_POLYFILL_URL}');`),t=`\n          ${e}\n          ${i}\n          self.imports = {env:{}};\n          ${a}\n          ${s}\n          runThread.default();\n        `}this.childBlob=new Blob([t],{type:"text/javascript"}),this.childUrl=URL.createObjectURL(this.childBlob)}}overrideAtomic(){v.override({atomic_add_i8:k.KJ.exports.add8,atomic_sub_i8:k.KJ.exports.sub8,atomic_and_i8:k.KJ.exports.and8,atomic_or_i8:k.KJ.exports.or8,atomic_xor_i8:k.KJ.exports.xor8,atomic_store_i8:k.KJ.exports.store8,atomic_load_i8:k.KJ.exports.load8,atomic_compare_exchange_i8:k.KJ.exports.compare_exchange8,atomic_exchange_i8:k.KJ.exports.exchange8,atomic_add_i16:k.KJ.exports.add16,atomic_sub_i16:k.KJ.exports.sub16,atomic_and_i16:k.KJ.exports.and16,atomic_or_i16:k.KJ.exports.or16,atomic_xor_i16:k.KJ.exports.xor16,atomic_store_i16:k.KJ.exports.store16,atomic_load_i16:k.KJ.exports.load16,atomic_compare_exchange_i16:k.KJ.exports.compare_exchange16,atomic_exchange_i16:k.KJ.exports.exchange16,atomic_add_i32:k.KJ.exports.add32,atomic_sub_i32:k.KJ.exports.sub32,atomic_and_i32:k.KJ.exports.and32,atomic_or_i32:k.KJ.exports.or32,atomic_xor_i32:k.KJ.exports.xor32,atomic_store_i32:k.KJ.exports.store32,atomic_load_i32:k.KJ.exports.load32,atomic_compare_exchange_i32:k.KJ.exports.compare_exchange32,atomic_exchange_i32:k.KJ.exports.exchange32,atomic_add_i64:k.KJ.exports.add64,atomic_sub_i64:k.KJ.exports.sub64,atomic_and_i64:k.KJ.exports.and64,atomic_or_i64:k.KJ.exports.or64,atomic_xor_i64:k.KJ.exports.xor64,atomic_store_i64:k.KJ.exports.store64,atomic_load_i64:k.KJ.exports.load64,atomic_compare_exchange_i64:k.KJ.exports.compare_exchange64,atomic_exchange_i64:k.KJ.exports.exchange64,atomics_notify:k.KJ.exports.notify,atomics_wait:k.KJ.exports.wait}),l.X$(this.imports.env,v)}async run(t,e){if(p.Ik(t)&&l.X$(this.options.imports,t),I.Ko()&&this.resource.threadModule&&(I.LK||I.Ts(h.ce,b.HEAP_INITIAL,b.HEAP_MAXIMUM,A.override),l.X$(this.imports.env,A)),!x.LK&&x.Ko()&&x.Ts(h.ce,b.HEAP_INITIAL,b.HEAP_MAXIMUM),!U&&k.Ko()&&(U=!0,this.overrideAtomic()),this.instance=await WebAssembly.instantiate(this.resource.module,this.imports),this.initRunTime(),this.resource.threadModule&&this.resource.enableThreadPool&&e>0&&!_.A.jspi){this.childUrl||this.createChildUrl();let t=e;this.resource.enableThreadCountRate&&(t*=this.resource.enableThreadCountRate),this.threadPool=new T.A(t,this.childUrl),await this.threadPool.ready({tableSize:this.resource.tableSize,module:this.resource.threadModule.module,initFuncs:this.resource.threadModule.initFuncs,memoryBase:this.options.memoryBase||this.memoryBase,tableBase:this.tableBase,childImports:this.childImports})}}runAsChild(t){p.Ik(t)&&l.X$(this.options.imports,t),I.Ko()&&(I.LK||I.Ts(h.ce,b.HEAP_INITIAL,b.HEAP_MAXIMUM,A.override),l.X$(this.imports.env,A)),!U&&k.Ko()&&(U=!0,this.overrideAtomic()),this.instance=new WebAssembly.Instance(this.resource.module,this.imports),this.initRunTime()}async childThreadsReady(){if(!this.childReadyPromises.length)return;const t=this.childReadyPromises;this.childReadyPromises=[],await o().all(t)}initRunTime(){this.builtinMalloc=[],this.initCalling=!0,p.YO(this.resource.initFuncs)&&u.__(this.resource.initFuncs,(t=>{let e;if(this.asm[t]&&(e=this.asm[t]),e)return e()})),this.initCalling=!1}invoke(t,...e){if(!this.asm)return-1;let r;if(this.asm[t]?r=this.asm[t]:this.options.exportMap&&this.options.exportMap[t]&&this.asm[this.options.exportMap[t]]&&(r=this.asm[this.options.exportMap[t]]),r)return r.apply(null,e);f.z3(`the wasm module has not function ${t} to call`,B,676)}async invokeAsync(t,...e){if(!this.asm)return-1;if(!_.A.jspi)return this.invoke(t,...e);let r;if(this.promisingMap.has(t)?r=this.promisingMap.get(t):(this.asm[t]?r=this.asm[t]:this.options.exportMap&&this.options.exportMap[t]&&this.asm[this.options.exportMap[t]]&&(r=this.asm[this.options.exportMap[t]]),r=WebAssembly.promising(r),this.promisingMap.set(t,r)),r)return r.apply(null,e);f.z3(`the wasm module has not function ${t} to call`,B,717)}get asm(){return this.instance&&this.instance.exports}getInstance(){return this.instance}getChildThreadCount(){return this.childThreads.size}destroy(){var t;null!==(t=this.builtinMalloc)&&void 0!==t&&t.length&&(u.__(this.builtinMalloc,(t=>{h.s_.free(t)})),this.builtinMalloc.length=0),this.memoryBase&&(h.s_.free(this.memoryBase),this.memoryBase=null),this.tableBase&&(h.XI.free(this.tableBase),this.tableBase=0),this.childImports&&(URL.revokeObjectURL(this.childImports),this.childImports=null),this.childUrl&&(URL.revokeObjectURL(this.childUrl),this.childUrl=null),this.childBlob=null,this.childReadyPromises.length=0,this.childThreads.size&&this.childThreads.forEach(((t,e)=>{1&c.f[15](t.threadDescriptor)||(f.R8("has child thread running, maybe resource leakage",B,772),t.worker.terminate(),d.M[16](t.thread+12,0),t.stackPointer&&h.s_.free(t.stackPointer),h.s_.free(t.threadDescriptor),this.childThreads.delete(e))})),this.builtinMalloc=null,this.instance=null,this.options.thread&&(this.options.threadDescriptor&&d.M[15](this.options.threadDescriptor+4,0),this.options.threadDescriptor&&(1&c.f[15](this.options.threadDescriptor)||4&c.f[15](this.options.thread+8))?2&c.f[15](this.options.threadDescriptor)||(h.wE&&h.s_.free(h.wE),h.s_.free(this.options.threadDescriptor),(0,m.sO)(this.options.thread,0,16),self.close()):(d.M[16](this.options.thread+12,0),w.me(this.options.thread+12,1))),this.threadPool&&this.threadPool.destroy(),this.threadPool=null,this.promisingMap&&(this.promisingMap.clear(),this.promisingMap=null)}}},76045:(t,e,r)=>{"use strict";r.d(e,{A:()=>g});var i=r(54001),s=r.n(i),a=r(67672),n=r(24175),o=r(34531),c=r(88096),d=r(92647),h=r(95335),l=r(26429),u=r(86834),f=r(44690),p=r(729),m=r(4304);async function g(t,e={}){let r,i,g,v,A,y,b;if(e=h.X$({enableThread:l.USE_THREADS,initFuncs:e.child?[]:["__wasm_apply_data_relocs","_initialize"]},e),a.ai(t.dataSize)&&a.ai(t.tableSize))if(i=t.dataSize,v=t.dataSize,g=t.dataAlign,A=t.dataAlign,y=t.bssSize,a.Yj(t.source)){const e={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(a.Pc(WebAssembly.compileStreaming))r=await WebAssembly.compileStreaming(fetch(t.source,e));else{const i=await fetch(t.source,e);b=await i.arrayBuffer(),r=await WebAssembly.compile(b)}}else r=await WebAssembly.compile(t.source),b=a.sv(t.source)?t.source:t.source.buffer;else{const h={ioReader:new n.A(1048576),ioWriter:new o.A(1048576),bufferEnded:!1,compileStopped:!1,error:"",abortController:null,pullResolve:null,bufferResolve:null,buffers:[],data:{},options:e},m=new Response(new ReadableStream({async start(e){if(a.Yj(t.source)){var r;"function"==typeof AbortController&&(h.abortController=new AbortController);const i={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade",signal:null===(r=h.abortController)||void 0===r?void 0:r.signal},s=await fetch(t.source,i);let a;s.ok&&s.status>=200&&s.status<=299?a=s.body.getReader():e.error(`Http code invalid, ${s.status} ${s.statusText}`);const n=[];h.ioReader.onFlush=async t=>{let e=0;for(;n.length&&e<t.length;){const r=n.shift();r.length>t.length-e?(t.set(r.subarray(0,t.length-e),e),n.unshift(r.subarray(t.length-e)),e=t.length):(t.set(r,e),e+=r.length)}if(e>=t.length)return t.length;const{value:r,done:i}=await a.read();return i?e>0?e:-1048576:(h.buffers.push(r),r.length>t.length-e?(t.set(r.subarray(0,t.length-e),e),n.push(r.subarray(t.length-e)),t.length):(t.set(r,e),e+=r.length,e))}}else{let e=0,r=t.source.byteLength;const i=a.sv(t.source)?new Uint8Array(t.source):t.source;h.ioReader.onFlush=async t=>{if(e>=r)return-1048576;const s=Math.min(t.length,r-e);return t.set(i.subarray(e,e+s),0),e+=s,s}}h.ioWriter.onFlush=async t=>{if(h.pullResolve)return h.pullResolve(t.slice()),h.pullResolve=null,0;const e=await new(s())((t=>{h.bufferResolve=t}));return e.enqueue(t.slice()),h.bufferEnded&&e.close(),0},async function(t){try{for(await t.ioWriter.writeUint32(await t.ioReader.readUint32()),await t.ioWriter.writeUint32(await t.ioReader.readUint32());;){if(t.compileStopped){t.abortController&&t.abortController.abort();break}const e=await t.ioReader.readUint8();if(t.options.child&&11===e){await t.ioWriter.writeUint8(e),await(0,c.$z)(t.ioWriter,7),await(0,c.$z)(t.ioWriter,1),await(0,c.$z)(t.ioWriter,0),await t.ioWriter.writeUint8(65),await t.ioWriter.writeUint8(0),await t.ioWriter.writeUint8(11),await(0,c.$z)(t.ioWriter,1),await t.ioWriter.writeUint8(0);const r=await(0,c.GW)(t.ioReader);await t.ioReader.skip(r);continue}await t.ioWriter.writeUint8(e);const r=await(0,c.GW)(t.ioReader),i=t.ioReader.getPos();if(0===e){await(0,c.$z)(t.ioWriter,r);const e=t.ioReader.getPos(),i=await(0,c.GW)(t.ioReader),s=await t.ioReader.readString(i);if(await(0,c.$z)(t.ioWriter,i),await t.ioWriter.writeString(s),"dylink.0"===s){const i=t.ioReader.getPos()+(BigInt(Math.floor(r))-(t.ioReader.getPos()-e));for(;t.ioReader.getPos()<i;){const e=await t.ioReader.readUint8();await t.ioWriter.writeUint8(e);const r=await(0,c.GW)(t.ioReader);await(0,c.$z)(t.ioWriter,r),1===e?(t.data.dataSize=await(0,c.GW)(t.ioReader),t.data.dataAlign=await(0,c.GW)(t.ioReader),t.data.tableSize=await(0,c.GW)(t.ioReader),t.data.tableAlign=await(0,c.GW)(t.ioReader),await(0,c.$z)(t.ioWriter,t.data.dataSize),await(0,c.$z)(t.ioWriter,t.data.dataAlign),await(0,c.$z)(t.ioWriter,t.data.tableSize),await(0,c.$z)(t.ioWriter,t.data.tableAlign)):await t.ioWriter.writeBuffer(await t.ioReader.readBuffer(r))}}}else if(11===e){await(0,c.$z)(t.ioWriter,r);const e=await(0,c.GW)(t.ioReader);if(await(0,c.$z)(t.ioWriter,e),e){for(await(0,c.$z)(t.ioWriter,await(0,c.GW)(t.ioReader));;){const e=await t.ioReader.readUint8();if(await t.ioWriter.writeUint8(e),11===e)break}const e=await(0,c.GW)(t.ioReader);t.data.dataSize?t.data.bssSize=t.data.dataSize-e:t.data.dataSize=e,await(0,c.$z)(t.ioWriter,e)}}else if(2===e){const e=new p.A(new Uint8Array(r+100));let s=await(0,c.GW)(t.ioReader);(0,c.tt)(e,s);let a=0;for(;s--;){const r=await(0,c.GW)(t.ioReader);(0,c.tt)(e,r),e.writeBuffer(await t.ioReader.readBuffer(r));const i=await(0,c.GW)(t.ioReader);(0,c.tt)(e,i),e.writeBuffer(await t.ioReader.readBuffer(i));const s=await t.ioReader.readUint8();switch(e.writeUint8(s),s){case 0:(0,c.tt)(e,await(0,c.GW)(t.ioReader));break;case 3:(0,c.p2)(e,await(0,c.WP)(t.ioReader)),(0,c.tt)(e,await(0,c.GW)(t.ioReader));break;case 2:{let r=await(0,c.GW)(t.ioReader);t.options.enableThread?r|=2:r&=-3,(0,c.tt)(e,r);const i=await(0,c.GW)(t.ioReader);if((0,c.tt)(e,l.HEAP_INITIAL||i),1&r){let r=await(0,c.GW)(t.ioReader);f.A.ios&&!u.A.checkVersion(f.A.version,"17",!0)&&t.options.enableThread||(r=l.HEAP_MAXIMUM),(0,c.tt)(e,r)}a++;break}case 1:{(0,c.p2)(e,await(0,c.WP)(t.ioReader));const r=await(0,c.GW)(t.ioReader);(0,c.tt)(e,r);const i=await(0,c.GW)(t.ioReader);(0,c.tt)(e,i),t.data.tableSize=i,1&r&&(0,c.tt)(e,await(0,c.GW)(t.ioReader)),a++;break}}if(2===a)break}const n=e.getWroteBuffer(),o=r-Number(t.ioReader.getPos()-i);await(0,c.$z)(t.ioWriter,n.length+o),await t.ioWriter.writeBuffer(n)}else await(0,c.$z)(t.ioWriter,r);r-Number(t.ioReader.getPos()-i)&&await t.ioReader.pipe(t.ioWriter,r-Number(t.ioReader.getPos()-i))}}catch(e){-1048576===t.ioReader.error?t.bufferEnded=!0:t.error=e,t.ioReader.remainingLength()&&await t.ioWriter.writeBuffer(await t.ioReader.readBuffer(t.ioReader.remainingLength())),await t.ioWriter.flush()}}(h)},async pull(t){if(h.error)t.close();else{if(h.bufferResolve)return h.bufferResolve(t),void(h.bufferResolve=null);t.enqueue(await new(s())(((t,e)=>{h.pullResolve=t}))),h.bufferEnded?t.close():h.error&&t.error(h.error)}},cancel(t){h.compileStopped=!0}}),{headers:{"Content-Type":"application/wasm"}});r=a.Pc(WebAssembly.compileStreaming)?await WebAssembly.compileStreaming(m):await WebAssembly.compile(await m.arrayBuffer()),b=a.Yj(t.source)?(0,d.A)(Uint8Array,h.buffers).buffer:a.sv(t.source)?t.source:t.source.buffer,i=h.data.tableSize,v=h.data.dataSize,g=h.data.tableAlign,A=h.data.dataAlign,y=h.data.bssSize}return e.child?{module:r,initFuncs:e.initFuncs||[],tableSize:0,tableAlign:g||0,dataSize:1,dataAlign:A?Math.max((0,m.A)(A),8):8,bssSize:0,buffer:b}:{module:r,tableSize:i,tableAlign:g||0,dataSize:v,dataAlign:A?Math.max((0,m.A)(A),8):8,bssSize:y||0,initFuncs:e.initFuncs||[],buffer:b}}},81999:(t,e,r)=>{"use strict";function i(){let t;t=__WebAssemblyRunner__?__WebAssemblyRunner__.__WebAssemblyRunner__:__CHeap_WebAssemblyRunner__.default;let e,r,i=self,s=0;i.onmessage=a=>{const n=a.data,o=n.type,c=n.data;switch(o){case"run":i.postMessage({type:"run"}),self.CHeap&&self.CHeap.initThread&&self.CHeap.initThread(c.cheap).then((()=>{self.__SELF_THREAD__=c.runner.thread,c.runner.options.imports=self.imports,e=new t(c.runner.resource,c.runner.options),e.runAsChild(),t.getTable().get(c.runner.func)(c.runner.args),e.destroy()}));break;case"ready":r=c.runner,s=c.cheap.stackPointer,self.CHeap&&self.CHeap.initThread&&self.CHeap.initThread(c.cheap).then((()=>{i.postMessage({type:"ready"})}));break;case"wait":{async function d(){for(;;){for(t.mutexLock(s+16);0===t.readPointer(s);)t.condWait(s+12,s+16);self.__SELF_THREAD__=t.readPointer(s),r.options.thread=t.readPointer(s),r.thread=t.readPointer(s),r.func=t.readPointer(s+4),r.args=t.readPointer(s+8),e=new t(r.resource,r.options),e.runAsChild(),t.getTable().get(r.func)(r.args),e.destroy(),t.writePointer(s,0),t.mutexUnlock(s+16)}}r.options.imports=self.imports,d();break}}}}r.r(e),r.d(e,{default:()=>i})},91808:(t,e,r)=>{"use strict";r.d(e,{A:()=>i});const i="AGFzbQEAAAABEANgAX8Bf2ABfwBgAn9/AX8CWQYDZW52Bm1lbW9yeQIDAYCABANlbnYGbWFsbG9jAAADZW52BGZyZWUAAQNlbnYGY2FsbG9jAAIDZW52B3JlYWxsb2MAAgNlbnYNYWxpZ25lZF9hbGxvYwACAwYFAAECAgIHMwUGbWFsbG9jAAUEZnJlZQAGBmNhbGxvYwAHB3JlYWxsb2MACAxhbGlnbmVkQWxsb2MACQoqBQYAIAAQAAsGACAAEAELCAAgACABEAILCAAgACABEAMLCAAgACABEAML"},80905:(t,e,r)=>{"use strict";r.d(e,{Ko:()=>l,LK:()=>d,Ts:()=>u});var i=r(11473),s=r(4919),a=r(4624),n=r(91808),o=r(88096);const c="src\\cheap\\webassembly\\runtime\\asm\\libc.ts";let d,h=!0;function l(){return h}function u(t,e,r){try{const a=o.bx((0,s.E_)(n.A),{shared:"function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer,initial:e,maximum:r});d=new WebAssembly.Instance(new WebAssembly.Module(a),{env:{memory:t,malloc:function(t){return i.s_.malloc(t)},calloc:function(t,e){return i.s_.calloc(t,e)},realloc:function(t,e){return i.s_.realloc(t,e)},aligned_alloc:(t,e)=>i.s_.alignedAlloc(t,e),free:function(t){i.s_.free(t)}}}),i.XI.set(2,d.exports.malloc),i.XI.set(1,d.exports.free),i.XI.set(3,d.exports.calloc),i.XI.set(4,d.exports.realloc),i.XI.set(5,d.exports.alignedAlloc)}catch(t){h=!1,a.R8("libc asm not support, cannot use asm thread function",c,60)}}},60:(t,e,r)=>{"use strict";r.d(e,{A:()=>i});const i="AGFzbQEAAAABEwNgAX8Bf2ACf38Bf2ADf39/AX8CEgEDZW52Bm1lbW9yeQIDAYCABAMIBwAAAAECAAAHQwcEbG9jawAAB3RyeWxvY2sAAQZ1bmxvY2sAAgR3YWl0AAMJdGltZWR3YWl0AAQGc2lnbmFsAAUJYnJvYWRjYXN0AAYKnAIHVgEBfyAAQQBBAf5IAgAhASABQQBHBEADQCABQQJGBH9BAQUgAEEBQQL+SAIAQQBHCwRAIABBAkJ//gECABoLIABBAEEC/kgCACEBIAFBAEcNAAsLQQALFwAgAEEAQQH+SAIAQQBGBH9BAAVBEAsLIwAgAEEB/iUCAEEBRwRAIABBAP4XAgAgAEEB/gACABoLQQALHQAgACAA/hACACABEAIaQn/+AQIAGiABEAAaQQALNwAgACAA/hACACABEAIaIAIpAwBCgJTr3AN+IAIoAgitfP4BAgAgARAAGkECRgR/QfAABUEACwsWACAAQQH+HgIAGiAAQQH+AAIAGkEACxoAIABBAf4eAgAaIABBgICAgAT+AAIAGkEACw=="},24565:(t,e,r)=>{"use strict";r.d(e,{Ko:()=>h,LK:()=>c,Ts:()=>l});var i=r(4919),s=r(4624),a=r(60),n=r(88096);const o="src\\cheap\\webassembly\\runtime\\asm\\thread.ts";let c,d=!0;function h(){return d}function l(t,e,r,h){try{if(!("function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer))return void(d=!1);{const s=n.bx((0,i.E_)(a.A),{shared:!0,initial:e,maximum:r});c=new WebAssembly.Instance(new WebAssembly.Module(s),{env:{memory:t}})}h({wasm_pthread_mutex_lock:c.exports.lock,wasm_pthread_mutex_trylock:c.exports.trylock,wasm_pthread_mutex_unlock:c.exports.unlock,wasm_pthread_cond_wait:c.exports.wait,wasm_pthread_cond_timedwait:c.exports.timedwait,wasm_pthread_cond_signal:c.exports.signal,wasm_pthread_cond_broadcast:c.exports.broadcast})}catch(t){d=!1,s.R8("thread asm not support, cannot use asm thread function",o,69)}}},1708:(t,e,r)=>{"use strict";r.r(e),r.d(e,{atomic_add_i16:()=>p,atomic_add_i32:()=>x,atomic_add_i64:()=>R,atomic_add_i8:()=>a,atomic_and_i16:()=>g,atomic_and_i32:()=>T,atomic_and_i64:()=>U,atomic_and_i8:()=>o,atomic_compare_exchange_i16:()=>w,atomic_compare_exchange_i32:()=>C,atomic_compare_exchange_i64:()=>O,atomic_compare_exchange_i8:()=>u,atomic_exchange_i16:()=>k,atomic_exchange_i32:()=>B,atomic_exchange_i64:()=>z,atomic_exchange_i8:()=>f,atomic_load_i16:()=>b,atomic_load_i32:()=>M,atomic_load_i64:()=>F,atomic_load_i8:()=>l,atomic_or_i16:()=>v,atomic_or_i32:()=>P,atomic_or_i64:()=>E,atomic_or_i8:()=>c,atomic_store_i16:()=>y,atomic_store_i32:()=>_,atomic_store_i64:()=>$,atomic_store_i8:()=>h,atomic_sub_i16:()=>m,atomic_sub_i32:()=>I,atomic_sub_i64:()=>D,atomic_sub_i8:()=>n,atomic_xor_i16:()=>A,atomic_xor_i32:()=>S,atomic_xor_i64:()=>L,atomic_xor_i8:()=>d,atomics_notify:()=>N,atomics_wait:()=>V,atomics_wait_timeout:()=>W,override:()=>G});var i=r(40046),s=r(6704);let a=function(t,e){return i.WQ(t,e,12,s._[12])},n=function(t,e){return i.jb(t,e,12,s._[12])},o=function(t,e){return i.Uo(t,e,12,s._[12])},c=function(t,e){return i.or(t,e,12,s._[12])},d=function(t,e){return i.I8(t,e,12,s._[12])},h=function(t,e){return i.M_(t,e,12,s._[12])},l=function(t){return i.Hh(t,12,s._[12])},u=function(t,e,r){return i.p_(t,e,r,12,s._[12])},f=function(t,e){return i.cv(t,e,12,s._[12])},p=function(t,e){return i.WQ(t,e,14,s._[14])},m=function(t,e){return i.jb(t,e,14,s._[14])},g=function(t,e){return i.Uo(t,e,14,s._[14])},v=function(t,e){return i.or(t,e,14,s._[14])},A=function(t,e){return i.I8(t,e,14,s._[14])},y=function(t,e){return i.M_(t,e,14,s._[14])},b=function(t){return i.Hh(t,14,s._[14])},w=function(t,e,r){return i.p_(t,e,r,14,s._[14])},k=function(t,e){return i.cv(t,e,14,s._[14])},x=function(t,e){return i.WQ(t,e,16,s._[16])},I=function(t,e){return i.jb(t,e,16,s._[16])},T=function(t,e){return i.Uo(t,e,16,s._[16])},P=function(t,e){return i.or(t,e,16,s._[16])},S=function(t,e){return i.I8(t,e,16,s._[16])},_=function(t,e){return i.M_(t,e,16,s._[16])},M=function(t){return i.Hh(t,16,s._[16])},C=function(t,e,r){return i.p_(t,e,r,16,s._[16])},B=function(t,e){return i.cv(t,e,16,s._[16])},R=function(t,e){return i.WQ(t,e,21,s._[21])},D=function(t,e){return i.jb(t,e,21,s._[21])},U=function(t,e){return i.Uo(t,e,21,s._[21])},E=function(t,e){return i.or(t,e,21,s._[21])},L=function(t,e){return i.I8(t,e,21,s._[21])},$=function(t,e){return i.M_(t,e,21,s._[21])},F=function(t){return i.Hh(t,21,s._[21])},O=function(t,e,r){return i.p_(t,e,r,21,s._[21])},z=function(t,e){return i.cv(t,e,21,s._[21])},N=function(t,e){return i.me(t,e)},V=function(t,e){return i.uk(t,e)},W=function(t,e,r){return i.j4(t,e,Number(BigInt.asIntN(32,r)))};function G(t){t.atomic_add_i8&&(a=t.atomic_add_i8),t.atomic_sub_i8&&(n=t.atomic_sub_i8),t.atomic_and_i8&&(o=t.atomic_and_i8),t.atomic_or_i8&&(c=t.atomic_or_i8),t.atomic_xor_i8&&(d=t.atomic_xor_i8),t.atomic_store_i8&&(h=t.atomic_store_i8),t.atomic_load_i8&&(l=t.atomic_load_i8),t.atomic_compare_exchange_i8&&(u=t.atomic_compare_exchange_i8),t.atomic_exchange_i8&&(f=t.atomic_exchange_i8),t.atomic_add_i16&&(p=t.atomic_add_i16),t.atomic_sub_i16&&(m=t.atomic_sub_i16),t.atomic_and_i16&&(g=t.atomic_and_i16),t.atomic_or_i16&&(v=t.atomic_or_i16),t.atomic_xor_i16&&(A=t.atomic_xor_i16),t.atomic_store_i16&&(y=t.atomic_store_i16),t.atomic_load_i16&&(b=t.atomic_load_i16),t.atomic_compare_exchange_i16&&(w=t.atomic_compare_exchange_i16),t.atomic_exchange_i16&&(k=t.atomic_exchange_i16),t.atomic_add_i32&&(x=t.atomic_add_i32),t.atomic_sub_i32&&(I=t.atomic_sub_i32),t.atomic_and_i32&&(T=t.atomic_and_i32),t.atomic_or_i32&&(P=t.atomic_or_i32),t.atomic_xor_i32&&(S=t.atomic_xor_i32),t.atomic_store_i32&&(_=t.atomic_store_i32),t.atomic_load_i32&&(M=t.atomic_load_i32),t.atomic_compare_exchange_i32&&(C=t.atomic_compare_exchange_i32),t.atomic_exchange_i32&&(B=t.atomic_exchange_i32),t.atomic_add_i64&&(R=t.atomic_add_i64),t.atomic_sub_i64&&(D=t.atomic_sub_i64),t.atomic_and_i64&&(U=t.atomic_and_i64),t.atomic_or_i64&&(E=t.atomic_or_i64),t.atomic_xor_i64&&(L=t.atomic_xor_i64),t.atomic_store_i64&&($=t.atomic_store_i64),t.atomic_load_i64&&(F=t.atomic_load_i64),t.atomic_compare_exchange_i64&&(O=t.atomic_compare_exchange_i64),t.atomic_exchange_i64&&(z=t.atomic_exchange_i64),t.atomics_notify&&(N=t.atomics_notify),t.atomics_wait&&(V=t.atomics_wait),t.atomics_wait_timeout&&(W=t.atomics_wait_timeout)}},14621:(t,e,r)=>{"use strict";r.d(e,{B:()=>b,CK:()=>w,LS:()=>k,Lq:()=>_,Pp:()=>M,WU:()=>S,h2:()=>P,nK:()=>T});var i=r(134),s=r(80662),a=r.n(s),n=r(61499),o=r(50932),c=r(12085),d=r(63939),h=r(14686),l=r(50011);const u=[null,[],[]],f=0,p=28;function m(t,e){const r=u[t];0===e||10===e?(console.log.bind(console)(l.decode(r)),r.length=0):r.push(e)}const g={};let v,A="./this.program";function y(){if(!v){const t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:A||"./this.program"};for(let e in g)t[e]=g[e];const e=[];for(let r in t)e.push(r+"="+t[r]);v=e}return v}function b(t,e){let r=0;return y().forEach((function(i,s){const a=e+r;o.M[20](t+4*s,a),function(t,e){for(let r=0;r<t.length;++r)o.M[4](e,t.charCodeAt(r)),e+=1;o.M[4](e,0)}(i,a),r+=i.length+1})),0}function w(t,e){const r=y();o.M[25](t,r.length);let i=0;return r.forEach((function(t){i+=t.length+1})),o.M[25](e,i),0}function k(t,e){let r=0;return 0==t?r=2:1!=t&&2!=t||(r=64),o.M[11](e,2),o.M[13](e+2,1),o.M[15](e+8,r),o.M[15](e+12,0),o.M[17](e+16,BigInt(0)),f}var x,I;function T(t,e,r,i){let s=0;for(let i=0;i<r;i++){let r=d.f[20](e),i=d.f[25](e+4);for(let e=0;e<i;e++)m(t,d.f[4](r+e));s+=i,e+=8}return o.M[25](i,s),f}function P(t){throw t=`abort(${t+=""}). Build with -s ASSERTIONS=1 for more info.`,new WebAssembly.RuntimeError(t)}function S(t,e,r){if(0!==t)return p;const i=(new Date).getTime();return o.M[10](r,BigInt(i)*BigInt(1e6)),f}function _(t,e){return 0!==t?p:(o.M[10](e,BigInt(1e6)),f)}function M(t,e){const r=(0,h.s3)(t,e);return crypto.getRandomValues(r),f}x=class{constructor(){(0,i.A)(this,"buf",void 0),(0,i.A)(this,"len",void 0)}}.prototype,(I=new(a())).set("buf",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),I.set("len",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,c.A)(x,n.Og,!0),(0,c.A)(x,n.dc,4),(0,c.A)(x,n.g7,8),(0,c.A)(x,n.JY,I)},20357:(t,e,r)=>{"use strict";r.r(e),r.d(e,{override:()=>C,wasm_cpu_core_count:()=>_,wasm_pthread_cond_broadcast:()=>k,wasm_pthread_cond_destroy:()=>A,wasm_pthread_cond_init:()=>v,wasm_pthread_cond_signal:()=>w,wasm_pthread_cond_timedwait:()=>b,wasm_pthread_cond_wait:()=>y,wasm_pthread_equal2:()=>P,wasm_pthread_exit:()=>T,wasm_pthread_mutex_destroy:()=>f,wasm_pthread_mutex_init:()=>u,wasm_pthread_mutex_lock:()=>p,wasm_pthread_mutex_trylock:()=>m,wasm_pthread_mutex_unlock:()=>g,wasm_pthread_once:()=>x,wasm_pthread_self2:()=>I,wasm_pthread_support:()=>S,wasm_threw_error:()=>M});var i=r(63939),s=r(50932),a=r(73783),n=r(42518),o=r(26429),c=r(11473),d=r(40046),h=r(10576),l=r(14686);let u,f,p,m,g,v,A,y,b,w,k,x;function I(){return h.TK.__SELF_THREAD__}function T(t){const e=h.TK.__SELF_THREAD__;s.M[20](e+4,t),s.M[15](e+8,4|i.f[15](e+8))}function P(t,e){return i.f[15](t)===i.f[15](e)?1:0}function S(){return o.USE_THREADS?1:0}function _(){return navigator.hardwareConcurrency}function M(t,e){throw new Error((0,l.lH)(e))}function C(t){t.wasm_pthread_mutex_lock&&(p=t.wasm_pthread_mutex_lock),t.wasm_pthread_mutex_trylock&&(m=t.wasm_pthread_mutex_trylock),t.wasm_pthread_mutex_unlock&&(g=t.wasm_pthread_mutex_unlock),t.wasm_pthread_cond_wait&&(y=t.wasm_pthread_cond_wait),t.wasm_pthread_cond_timedwait&&(b=t.wasm_pthread_cond_timedwait),t.wasm_pthread_cond_signal&&(w=t.wasm_pthread_cond_signal),t.wasm_pthread_cond_broadcast&&(k=t.wasm_pthread_cond_broadcast)}u=function(t,e){return a.Ts(t)},f=function(t){return a.zr(t)},p=function(t){return a.s2(t)},m=function(t){return a.bh(t)},g=function(t){return a.Tl(t)},v=function(t,e){return n.Ts(t,e)},A=function(t){return n.zr(t)},y=function(t,e){return n.uk(t,e)},b=function(t,e,r){let s=1e3*Number(i.f[17](r))+i.f[15](r+8)/1e6;return n.XR(t,e,s)},w=function(t){return n.vP(t)},k=function(t){return n.mq(t)},x=function(t,e){return 0===d.WQ(t,1,16,2)&&c.XI.get(e)(),0}},77775:(t,e,r)=>{"use strict";r.r(e),r.d(e,{Timespec:()=>u,wasm_sem_destroy:()=>p,wasm_sem_init:()=>f,wasm_sem_post:()=>A,wasm_sem_timedwait:()=>v,wasm_sem_trywait:()=>g,wasm_sem_wait:()=>m});var i,s,a=r(134),n=r(80662),o=r.n(n),c=r(61499),d=r(12085),h=r(63939),l=r(79490);class u{constructor(){(0,a.A)(this,"tvSec",void 0),(0,a.A)(this,"tvNSec",void 0)}}function f(t,e,r){return l.Ts(t,r)}function p(t){return l.zr(t)}function m(t){return l.uk(t)}function g(t){return l.Zr(t)}function v(t,e){let r=1e3*Number(h.f[17](e))+h.f[15](e+8)/1e6;return l.XR(t,r)}function A(t){return l.bE(t)}i=u.prototype,(s=new(o())).set("tvSec",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("tvNSec",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,d.A)(i,c.Og,!0),(0,d.A)(i,c.dc,8),(0,d.A)(i,c.g7,16),(0,d.A)(i,c.JY,s)},6331:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(10576);class a{constructor(t,e){(0,i.A)(this,"type",void 0),(0,i.A)(this,"phase",void 0),(0,i.A)(this,"ns",void 0),(0,i.A)(this,"target",void 0),(0,i.A)(this,"originalEvent",void 0),(0,i.A)(this,"isPrevented",void 0),(0,i.A)(this,"isStopped",void 0),(0,i.A)(this,"listener",void 0),this.type=t,this.phase=a.PHASE_CURRENT,e&&(this.originalEvent=e)}preventDefault(){const t=this;if(!t.isPrevented){const{originalEvent:e}=t;e&&e.preventDefault(),t.isPrevented=s.rT}return t}stopPropagation(){const t=this;if(!t.isStopped){const{originalEvent:e}=t;e&&e.stopPropagation(),t.isStopped=s.rT}return t}prevent(){return this.preventDefault()}stop(){return this.stopPropagation()}}(0,i.A)(a,"PHASE_CURRENT",0),(0,i.A)(a,"PHASE_UPWARD",1),(0,i.A)(a,"PHASE_DOWNWARD",s.Cy)},96172:(t,e,r)=>{"use strict";r.d(e,{A:()=>l});var i=r(134),s=r(67672),a=r(72739),n=r(6331),o=r(95335),c=r(20525),d=(r(4624),r(56401)),h=r(10576);class l{constructor(t){(0,i.A)(this,"ns",void 0),(0,i.A)(this,"listeners",void 0),(0,i.A)(this,"nativeListeners",void 0),this.ns=t||h.W8,this.listeners={}}fire(t,e,r){let i=this,c=s.Yj(t)?i.parse(t):t,l=i.listeners[c.type],u=h.rT;if(l){l=o.C(l);const t=e&&e[0]instanceof n.A?e[0]:h.ZH;a.__(l,(function(s){if(!p(c.ns,s,h.rT)||!a.zy(l,s)||r&&!r(c,e,s))return;t&&(t.listener=s.fn);let n=(0,d.A)(s.fn,s.ctx,e);return t&&(t.listener=h.ZH),s.num=s.num?s.num+1:1,s.num===s.max&&i.off(c,s.fn),t&&(n===h.W8?t.prevent().stop():t.isStopped&&(n=h.W8)),n===h.W8?u=h.W8:void 0}))}return u}on(t,e){const r=this,i=r.listeners,n=s.Pc(e)?{fn:e}:e;if(s.Ik(n)&&s.Pc(n.fn)){const e=s.Yj(t)?r.parse(t):t;n.ns=e.ns,a.VC(i[e.type]||(i[e.type]=[]),n)}return this}one(t,e){return s.Pc(e)?e={fn:e,max:1}:e.max=1,this.on(t,e)}off(t,e){const r=this,i=r.listeners;if(t){const n=s.Yj(t)?r.parse(t):t,c=n.type,d=n.ns,l=f(e),u=function(t,e){a.__(t,(function(e,r){l(e)&&t.splice(r,1)}),h.rT),t.length||delete i[e]},m=function(t,e){a.__(t,(function(e,r){p(d,e)&&t.splice(r,1)}),h.rT),t.length||delete i[e]};c?i[c]&&u(i[c],c):d&&o.__(i,m)}else r.listeners={}}has(t,e){let r=this.listeners,i=s.Yj(t)?this.parse(t):t,n=i.type,c=i.ns,d=h.rT,l=f(e);var u;return n?r[n]&&(u=r[n],a.__(u,(function(t){if(l(t))return d=h.W8}))):c&&o.__(r,(function(t){return a.__(t,(function(t){if(p(c,t))return d=h.W8})),d})),!d}parse(t){const e={type:t,ns:h.u1};if(this.ns){const r=c.qh(t,h.ZG);r>=0&&(e.type=c.di(t,0,r),e.ns=c.di(t,r+1))}return e}}function u(){return h.rT}function f(t){return s.Pc(t)?function(e){return t===e.fn}:u}function p(t,e,r){const{ns:i}=e;return i&&t?i===t:r?h.rT:h.W8}},84504:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(2148);function s(t,e,r=!1){const s=e.split("."),a=t.split(".");for(let t=0;t<a.length;t++){if(r&&t==a.length-1&&(0,i.A)(a[t])>=(0,i.A)(s[t]))return a.length>=s.length;if((0,i.A)(a[t])>(0,i.A)(s[t]))return!0;if((0,i.A)(a[t])<(0,i.A)(s[t]))return!1;if(t===s.length-1&&t===a.length-1)return r;if(t===s.length-1)return!0;if(t===a.length-1)return!1}return!0}},92647:(t,e,r)=>{"use strict";function i(t,e){if(!e.length)return null;if(1===e.length)return e[0];let r,i=0;for(r of e)i+=r.length;let s=new t(i),a=0;for(r of e)s.set(r,a),a+=r.length;return s}r.d(e,{A:()=>i})},78995:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(56401),s=r(72739),a=r(10576);function n(t,e,r,n=!1){let o,c;return function(){let d=this;n&&(c=s.$r(arguments)),o||(n||(c=s.$r(arguments)),r&&(0,i.A)(t,d,c),o=setTimeout((function(){o=a.ZH,r||(0,i.A)(t,d,c)}),e))}}},56401:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(67672),s=r(10576);function a(t,e,r){if(i.Pc(t))return i.YO(r)?t.apply(e,r):e!==s.ZH?t.call(e,r):r!==s.ZH?t(r):t()}},8284:(t,e,r)=>{"use strict";function i(){let t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){let r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?r:3&r|8).toString(16)}))}r.d(e,{A:()=>i})},86932:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(45249),s=r.n(i);function a(){return s()()}},54568:(t,e,r)=>{"use strict";function i(){return"function"==typeof registerProcessor&&"number"==typeof sampleRate&&"number"==typeof currentFrame&&"number"==typeof currentTime}r.d(e,{A:()=>i})},34677:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(10576);function s(t){return t!==i.ZH}},59135:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(34677);let s;function a(){if((0,i.A)(s))return s;const t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),s=256===new Int16Array(t)[0],s}},20491:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(67672),s=r(62100),a=r(20525);function n(t){return i.Pc(t)&&a.zy((0,s.A)(t),"[native code]")}},39638:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(34677),s=r(54568);function a(){return!("object"==typeof window&&(0,i.A)(window.document)||(0,s.A)())}},7972:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(64236),s=r.n(i),a=r(20491),n=r(10576);let o;typeof s()===n.s0&&(0,a.A)(s())&&(o=s()),o=typeof MessageChannel===n.s0&&(0,a.A)(MessageChannel)?function(t){const e=new MessageChannel;e.port1.onmessage=t,e.port2.postMessage(1)}:"function"==typeof setTimeout?setTimeout:function(t){setTimeout(t)};const c=o},36:(t,e,r)=>{"use strict";function i(t,e,r){return t<e?t=e:t>r&&(t=r),t}r.d(e,{A:()=>i})},61837:(t,e,r)=>{"use strict";r.d(e,{A:()=>f});var i=r(69736),s=r.n(i),a=r(73146),n=r.n(a);const o='\nfunction webpackBootstrapFunc (modules) {\n  var installedModules = {};\n  function __webpack_require__(moduleId) {\n    if(installedModules[moduleId])\n    return installedModules[moduleId].exports;\n    var module = installedModules[moduleId] = {\n      i: moduleId,\n      l: false,\n      exports: {}\n    };\n    if (!modules[moduleId]) {\n      console.error(\'can not found module:\', moduleId)\n    }\n    modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n    module.l = true;\n    return module.exports;\n  }\n  __webpack_require__.m = modules;\n  __webpack_require__.c = installedModules;\n  __webpack_require__.i = function(value) { return value; };\n  __webpack_require__.d = function(exports, definition, getter) {\n    if (typeof definition === \'string\') {\n      if(!__webpack_require__.o(exports, definition)) {\n        Object.defineProperty(exports, definition, {\n          enumerable: true,\n          get: getter\n        });\n      }\n    }\n    else {\n      for(var key in definition) {\n        if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n          Object.defineProperty(exports, key, {\n            enumerable: true,\n            get: definition[key]\n          });\n        }\n      }\n    }\n  };\n  __webpack_require__.r = function(exports) {\n    if(typeof Symbol !== \'undefined\' && Symbol.toStringTag) {\n    \tObject.defineProperty(exports, Symbol.toStringTag, { value: \'Module\' });\n    }\n    Object.defineProperty(exports, \'__esModule\', { value: true });\n  };\n  __webpack_require__.f = {};\n  __webpack_require__.e = function(chunkId) {\n    return Promise.all(Object.keys(__webpack_require__.f).reduce(function (promises, key) {\n      __webpack_require__.f[key](chunkId, promises);\n        return promises;\n    \t}, []));\n\t};\n  __webpack_require__.u = function(chunkId) {\n    return chunkId + "LIB_NAME";\n  };\n  __webpack_require__.n = function(module) {\n    var getter = module && module.__esModule ?\n      function getDefault() { return module[\'default\']; } :\n      function getModuleExports() { return module; };\n    __webpack_require__.d(getter, \'a\', getter);\n    return getter;\n  };\n  (function() {\n    var installedChunks = {\n      "main": 0\n    };\n    __webpack_require__.f.j = function(chunkId, promises) {\n      var installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n      if (installedChunkData !== 0) {\n        if(installedChunkData) {\n          promises.push(installedChunkData[2]);\n        } else {\n          if (true) {\n            var promise = new Promise(function(resolve, reject){installedChunkData = installedChunks[chunkId] = [resolve, reject]});\n            promises.push(installedChunkData[2] = promise);\n            var url = __webpack_require__.p + __webpack_require__.u(chunkId);\n            var error = new Error();\n            var loadingEnded = function(event) {\n              if(__webpack_require__.o(installedChunks, chunkId)) {\n                installedChunkData = installedChunks[chunkId];\n                if(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n                if(installedChunkData) {\n                  var errorType = event && (event.type === \'load\' ? \'missing\' : event.type);\n                  var realSrc = url;\n                  error.message = "Loading chunk " + chunkId + " failed.\\n(" + errorType + ": " + realSrc + ")";\n                  error.name = "ChunkLoadError";\n                  error.type = errorType;\n                  error.request = realSrc;\n                  installedChunkData[1](error);\n                }\n              }\n            };\n            __webpack_require__.l(url, loadingEnded);\n          }\n        }\n      }\n    };\n    var webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n    var [chunkIds, moreModules, runtime] = data;\n    var moduleId, chunkId, i = 0;\n    if (chunkIds.some(function(id){return installedChunks[id] !== 0})) {\n      for(moduleId in moreModules) {\n        if(__webpack_require__.o(moreModules, moduleId)) {\n          __webpack_require__.m[moduleId] = moreModules[moduleId];\n        }\n      }\n      if(runtime) runtime(__webpack_require__);\n    }\n    if (parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n      for (;i < chunkIds.length; i++) {\n        chunkId = chunkIds[i];\n        if (__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n          installedChunks[chunkId][0]();\n        }\n        installedChunks[chunkId] = 0;\n      }\n    }\n    var self = typeof globalThis !== undefined ? globalThis : self\n    var exportName = \'LIBRARY_EXPORT_NAME\'\n    var chunkLoadingGlobal = self["webpackChunk" + exportName] = self["webpackChunk" + exportName] || [];\n    chunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\n    chunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));\n  })();\n  (function() {\n    var inProgress = {};\n    __webpack_require__.l = function(url, done) {\n      if (inProgress[url]) { inProgress[url].push(done); return; }\n        inProgress[url] = [done];\n        var onComplete = function(event) {\n          clearTimeout(timeout);\n          var doneFns = inProgress[url];\n          delete inProgress[url];\n          doneFns && doneFns.forEach(function(fn){fn(event)});\n        }\n        var timeout = setTimeout(onComplete.bind(null, undefined, { type: "timeout" }), 120000);\n      if (typeof importScripts === \'function\') {\n        try {\n          importScripts(url);onComplete({type: "load"});\n        }\n        catch(e) {\n          onComplete({type: "missing"});\n        }\n      }\n      else {\n        import(url).then(function() {\n          onComplete({\n            type: "load"\n          });\n        }, function (error) {\n          onComplete({\n            type: "missing"\n          });\n        })\n      }\n    };\n  })();\n  __webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n  __webpack_require__.p = "ROOT_URL";\n  __webpack_require__.oe = function(err) { console.error(err); throw err; };\n  var f = __webpack_require__(__webpack_require__.s = ENTRY_MODULE);\n  return f;\n}\n',c="[\\.|\\-|\\+|\\w|/|@|!]+",d="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+c+").*?\\)";function h(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function l(t,e,i,a){const n={};n[i]=[];let o=e.toString();const l=o.match(/^(function)?\s?\w*\(\w+,\s*(\w+),\s*(\w+)\)/);if(!l)return n;const u=l[3];a.__webpack_exports_process__||(a.__webpack_require__=u,a.__webpack_exports__=l[2],a.__webpack_exports_process__=!0);let f,p=new RegExp("(\\\\n|\\W)"+h(u)+d,"g");for(;f=p.exec(o);)"dll-reference"!==f[3]&&n[i].push(f[3]);for(p=new RegExp("\\("+h(u)+'\\("(dll-reference\\s('+c+'))"\\)\\)'+d,"g");f=p.exec(o);)t[f[2]]||(n[i].push(f[1]),t[f[2]]=r(f[1]).m),n[f[2]]=n[f[2]]||[],n[f[2]].push(f[4]);const m=s()(n);for(let t=0;t<m.length;t++)for(let e=0;e<n[m[t]].length;e++)g=+n[m[t]][e],isNaN(g)||(n[m[t]][e]=+n[m[t]][e]);var g;return n}function u(t){return s()(t).reduce((function(e,r){return e||t[r].length>0}),!1)}function f(t,e){const i={main:r.m},a=function(t,e){const r={main:[e]},i={main:[],__webpack_exports__:"__webpack_exports__",__webpack_require__:"__webpack_require__",__webpack_exports_process__:!1},a={main:{}};for(;u(r);){const e=s()(r);for(let n=0;n<e.length;n++){let o=e[n],c=r[o].pop();if(a[o]=a[o]||{},a[o][c]||!t[o][c])continue;a[o][c]=!0,i[o]=i[o]||[],i[o].push(c);let d=l(t,t[o][c],o,i),h=s()(d);for(let t=0;t<h.length;t++)r[h[t]]=r[h[t]]||[],r[h[t]]=r[h[t]].concat(d[h[t]])}}return i}(i,t);let c=n()(t);return"var "+e.varName+"=("+o.replace("ENTRY_MODULE",c).replace("ROOT_URL",r.p||"").replace("LIBRARY_EXPORT_NAME","AVPlayer").replace("LIB_NAME",r.u&&r.u("")||"")+")({"+a.main.map((function(t){const r=n()(t);let s=r+": "+i.main[t].toString();if(r===c&&e.exportName&&e.pointName){const t=`;${a.__webpack_require__}.d(\n          ${a.__webpack_exports__},\n          "${e.exportName}",\n          function() {\n            if (${e.exportIsClass}) {\n              for (var key in ${a.__webpack_exports__}) {\n                if (key === '${e.exportName}') {\n                  continue;\n                }\n                var v = ${a.__webpack_exports__}[key];\n                if (typeof v === 'function' && v.name === '${e.pointName}') {\n                  return v;\n                }\n              }\n            }\n            return ${e.pointName};\n          }\n        );`;s=s.slice(0,s.length-1)+t+"}"}return s})).join(",")+"});"}},6498:(t,e,r)=>{"use strict";r(67672),r(72739)},2148:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(67672),s=r(10576);function a(t,e){return i.sH(t)?+t:e!==s.ZH?e:0}},62100:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(10576);function s(t,e){return t!=i.Cq&&t.toString?t.toString():e!==i.ZH?e:i.u1}},61403:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(67672);class a{constructor(){(0,i.A)(this,"proxy",void 0),this.proxy=new Proxy(this,{get:(t,e,r)=>s.sH(e)?t.getIndexValue(+e):t[e],set:(t,e,r,i)=>(s.sH(e)?t.setIndexValue(+e,r):t[e]=r,!0)})}}},37246:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(4624);class a{constructor(t=1048576){(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"bitsLeft",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"endPointer",void 0),(0,i.A)(this,"pos",void 0),(0,i.A)(this,"error",void 0),(0,i.A)(this,"onFlush",void 0),this.pointer=0,this.bitsLeft=8,this.pos=BigInt(0),this.size=t,this.endPointer=0,this.error=0,this.buffer=new Uint8Array(this.size)}peekU1(){let t=0;(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush();let e=this.pointer,r=this.bitsLeft;return 0===r&&(e++,r=8),t=this.buffer[e]>>r-1&1,t}readU1(){let t=0;return(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush(),this.bitsLeft--,t=this.buffer[this.pointer]>>this.bitsLeft&1,0===this.bitsLeft&&(this.pointer++,this.bitsLeft=8,this.pos++),t}readU(t){let e=0;for(let r=0;r<t;r++)e|=this.readU1()<<t-r-1;return e}peekU(t){const e=this.pointer,r=this.bitsLeft,i=this.pos,s=this.readU(t);return this.pointer=e,this.bitsLeft=r,this.pos=i,s}remainingLength(){return this.endPointer-this.pointer}getBitLeft(){return this.bitsLeft}getPointer(){return this.pointer}setPointer(t){this.pointer=t}getPos(){return this.pos}skip(t){const e=(t-t%8)/8;this.pointer+=e,this.pos+=BigInt(e);const r=t%8;this.bitsLeft<=r?(this.pointer++,this.pos++,this.bitsLeft=8-(r-this.bitsLeft)):this.bitsLeft-=r}flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOReader error, flush failed because of no flush callback");if(0===this.bitsLeft&&(this.pointer++,this.pos++),!(this.size-this.remainingLength()<=0))if(this.pointer<this.endPointer){this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0);const t=this.onFlush(this.buffer.subarray(this.endPointer-this.pointer,this.size));if(t<0)throw this.error=t,Error("IOReader error, flush failed");this.endPointer=this.endPointer-this.pointer+t,this.pointer=0}else{const t=this.onFlush(this.buffer);if(this.endPointer=t,this.pointer=0,this.bitsLeft=8,t<0)throw this.error=t,Error("IOReader error, flush failed")}}getBuffer(){return this.buffer}appendBuffer(t){if(this.size-this.endPointer>=t.length)this.buffer.set(t,this.endPointer),this.endPointer+=t.length;else if(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer,this.pointer=0,this.size-this.endPointer>=t.length)this.buffer.set(t,this.endPointer),this.endPointer+=t.length;else{const e=Math.min(this.size-this.endPointer,t.length);this.buffer.set(t.subarray(0,e),this.endPointer),this.endPointer+=e,s.R8("BSReader, call appendBuffer but the buffer's size is lagger then the remaining size","src\\common\\io\\BitReader.ts",257)}}reset(){this.pointer=this.endPointer=0,this.bitsLeft=8,this.error=0,this.pos=BigInt(0)}skipPadding(){this.bitsLeft<8&&(this.bitsLeft=8,this.pointer++,this.pos++)}}},83314:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(134);class s{constructor(t=1048576){(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"pos",void 0),(0,i.A)(this,"bitPointer",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"error",void 0),(0,i.A)(this,"onFlush",void 0),this.pointer=0,this.bitPointer=0,this.size=t,this.error=0,this.pos=BigInt(0),this.buffer=new Uint8Array(this.size)}writeU1(t){(this.remainingLength()<1||1===this.remainingLength()&&this.bitPointer>=8)&&this.flush(),1&t?this.buffer[this.pointer]|=1<<7-this.bitPointer:this.buffer[this.pointer]&=~(1<<7-this.bitPointer),this.bitPointer++,8===this.bitPointer&&(this.pointer++,this.pos++,this.bitPointer=0)}writeU(t,e){for(let r=0;r<t;r++)this.writeU1(e>>t-r-1&1)}remainingLength(){return this.size-this.pointer}flush(){if(!this.onFlush)throw this.error=-1048574,Error("BSWriter error, flush failed because of no flush callback");if(this.pointer)if(this.bitPointer&&this.pointer>0){const t=this.onFlush(this.buffer.subarray(0,this.pointer).slice());if(0!==t)throw this.error=t,Error("BSWriter error, flush failed");this.buffer[0]=this.buffer[this.pointer]}else if(0===this.bitPointer){const t=this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==t)throw this.error=t,Error("BSWriter error, flush failed")}this.pointer=0}padding(){for(;0!==this.bitPointer;)this.writeU1(0)}reset(){this.pointer=0,this.bitPointer=0,this.error=0,this.pos=BigInt(0)}getBuffer(){return this.buffer}getPointer(){return this.pointer}getPos(){return this.pos}}},31865:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(134),s=r(92647),a=r(50011);class n{constructor(t,e=!0){(0,i.A)(this,"data",void 0),(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"byteStart",void 0),(0,i.A)(this,"pos",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"littleEndian",void 0),this.buffer=t,this.data=t instanceof Uint8Array?new DataView(t.buffer):t.view,this.byteStart=t instanceof Uint8Array?t.byteOffset:0,this.pos=0,this.size=t.byteLength,this.littleEndian=!e}readUint8(){return this.data.getUint8(this.pos+++this.byteStart)}peekUint8(){return this.data.getUint8(this.pos+this.byteStart)}readUint16(){const t=this.data.getUint16(this.pos+this.byteStart,this.littleEndian);return this.pos+=2,t}peekUint16(){return this.data.getUint16(this.pos+this.byteStart,this.littleEndian)}readUint24(){const t=this.readUint16(),e=this.readUint8();return this.littleEndian?e<<16|t:t<<8|e}peekUint24(){const t=this.readUint16(),e=this.readUint8();return this.pos-=3,this.littleEndian?e<<16|t:t<<8|e}readUint32(){const t=this.data.getUint32(this.pos+this.byteStart,this.littleEndian);return this.pos+=4,t}peekUint32(){return this.data.getUint32(this.pos+this.byteStart,this.littleEndian)}readUint64(){const t=BigInt(this.readUint32()),e=BigInt(this.readUint32());return this.littleEndian?e<<BigInt(32)|t:t<<BigInt(32)|e}peekUint64(){const t=BigInt(this.readUint32()),e=BigInt(this.readUint32());return this.pos-=8,this.littleEndian?e<<BigInt(32)|t:t<<BigInt(32)|e}readInt8(){return this.data.getInt8(this.pos+++this.byteStart)}peekInt8(){return this.data.getInt8(this.pos+this.byteStart)}readInt16(){const t=this.data.getInt16(this.pos+this.byteStart,this.littleEndian);return this.pos+=2,t}peekInt16(){return this.data.getInt16(this.pos+this.byteStart,this.littleEndian)}readInt24(){const t=this.readUint24();return 8388608&t?t-16777216:t}peekInt24(){const t=this.peekUint24();return 8388608&t?t-16777216:t}readInt32(){const t=this.data.getInt32(this.pos+this.byteStart,this.littleEndian);return this.pos+=4,t}peekInt32(){return this.data.getInt32(this.pos+this.byteStart,this.littleEndian)}readInt64(){const t=BigInt(this.readInt32()),e=BigInt(this.readInt32());return this.littleEndian?e<<BigInt(32)|t:t<<BigInt(32)|e}peekInt64(){const t=BigInt(this.readInt32()),e=BigInt(this.readInt32());return this.pos-=8,this.littleEndian?e<<BigInt(32)|t:t<<BigInt(32)|e}readFloat(){const t=this.data.getFloat32(this.pos+this.byteStart,this.littleEndian);return this.pos+=4,t}peekFloat(){return this.data.getFloat32(this.pos+this.byteStart,this.littleEndian)}readDouble(){const t=this.data.getFloat64(this.pos+this.byteStart,this.littleEndian);return this.pos+=8,t}peekDouble(){return this.data.getFloat64(this.pos+this.byteStart,this.littleEndian)}readHex(t=1){let e="";for(let r=0;r<t;r++){const t=this.readUint8().toString(16);e+=1===t.length?"0"+t:t}return e}peekHex(t=1){const e=this.pos,r=this.readHex(t);return this.pos=e,r}readString(t=1){let e="";if(t){let r=this.pos;for(let e=0;e<t&&0===this.buffer[this.pos+e];e++)r++;e=a.decode(this.buffer.subarray(r,r+t))}return this.pos+=t,e}peekString(t=1){const e=this.pos,r=this.readString(t);return this.pos=e,r}readLine(){let t="";for(let e=this.pos;e<this.size;e++)if(10===this.buffer[e]||13===this.buffer[e]){t+=this.readString(e-this.pos);break}for(let t=this.pos;t<this.size&&(10===this.buffer[t]||13===this.buffer[t]);t++)this.readUint8();return t}peekLine(){const t=this.pos,e=this.readLine();return this.pos=t,e}getPos(){return BigInt(this.pos)}seek(t){t>this.size&&(t=this.size),this.pos=Math.max(0,t)}skip(t){this.seek(this.pos+t)}back(t){this.seek(this.pos-t)}remainingSize(){return this.size-this.pos}readBuffer(t){t=Math.min(t,this.remainingSize());const e=this.buffer.slice(this.pos,this.pos+t);return this.pos+=t,e}appendBuffer(t){this.buffer=(0,s.A)(Uint8Array,[this.buffer.slice(),t.slice()]),this.data=new DataView(this.buffer.buffer),this.size+=t.byteLength,this.byteStart=0}resetBuffer(t,e=!0){this.buffer=t,this.data=t instanceof Uint8Array?new DataView(t.buffer):t.view,this.byteStart=t instanceof Uint8Array?t.byteOffset:0,this.pos=0,this.size=t.byteLength,this.littleEndian=!e}}},729:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(134),s=r(4624),a=r(50011);class n{constructor(t,e=!0){(0,i.A)(this,"data",void 0),(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"byteStart",void 0),(0,i.A)(this,"pos",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"littleEndian",void 0),this.buffer=t,this.data=t instanceof Uint8Array?new DataView(t.buffer):t.view,this.byteStart=t instanceof Uint8Array?t.byteOffset:0,this.pos=0,this.size=t.byteLength,this.littleEndian=!e}writeUint8(t){this.data.setUint8(this.pos+++this.byteStart,t)}writeUint16(t){this.data.setUint16(this.pos+this.byteStart,t,this.littleEndian),this.pos+=2}writeUint24(t){const e=3840&t,r=240&t,i=15&t;this.littleEndian?(this.writeUint8(i),this.writeUint8(r),this.writeUint8(e)):(this.writeUint8(e),this.writeUint8(r),this.writeUint8(i))}writeUint32(t){this.data.setUint32(this.pos+this.byteStart,t,this.littleEndian),this.pos+=4}writeUint64(t){this.data.setBigUint64(this.pos+this.byteStart,t,this.littleEndian),this.pos+=8}writeInt8(t){this.data.setInt8(this.pos+++this.byteStart,t)}writeInt16(t){this.data.setInt16(this.pos+this.byteStart,t,this.littleEndian),this.pos+=2}writeInt24(t){this.writeUint24(t<0?t+16777216:t)}writeInt32(t){this.data.setInt32(this.pos+this.byteStart,t,this.littleEndian),this.pos+=4}writeInt64(t){this.data.setBigInt64(this.pos+this.byteStart,t,this.littleEndian),this.pos+=8}writeFloat(t){this.data.setFloat32(this.pos+this.byteStart,t,this.littleEndian),this.pos+=4}writeDouble(t){this.data.setFloat64(this.pos+this.byteStart,t,this.littleEndian),this.pos+=8}getPos(){return this.pos}seek(t){t>this.size&&(t=this.size),this.pos=Math.max(0,t)}skip(t){this.seek(this.pos+t)}back(t){this.seek(this.pos-t)}remainingSize(){return this.size-this.pos}writeBuffer(t){let e=t.length;this.remainingSize()<e&&(e=this.remainingSize(),s.R8(`the remaining buffer size is smaller then the wrote buffer, hope set ${t.length}, but set ${e}`,"src\\common\\io\\BufferWriter.ts",202)),this.buffer.set(t,this.pos),this.pos+=t.length}writeString(t){const e=a.encode(t);return this.writeBuffer(e),e.length}getWroteBuffer(){return this.buffer.subarray(0,this.pos)}resetBuffer(t,e=!0){this.buffer=t,this.data=t instanceof Uint8Array?new DataView(t.buffer):t.view,this.byteStart=t instanceof Uint8Array?t.byteOffset:0,this.pos=0,this.size=t.byteLength,this.littleEndian=!e}}},24175:(t,e,r)=>{"use strict";r.d(e,{A:()=>h});var i=r(134),s=r(54001),a=r.n(s),n=r(4624),o=r(50011),c=r(13724);const d="src\\common\\io\\IOReader.ts";class h{constructor(t=1048576,e=!0,r){if((0,i.A)(this,"data",void 0),(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"endPointer",void 0),(0,i.A)(this,"pos",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"littleEndian",void 0),(0,i.A)(this,"fileSize_",void 0),(0,i.A)(this,"error",void 0),(0,i.A)(this,"onFlush",void 0),(0,i.A)(this,"onSeek",void 0),(0,i.A)(this,"onSize",void 0),(0,i.A)(this,"flags",void 0),(0,i.A)(this,"flushResolve",void 0),this.pos=BigInt(0),this.pointer=0,this.error=0,this.endPointer=0,this.littleEndian=!e,this.flags=0,r&&r.view)this.size=r.length,this.buffer=r,this.data=r.view;else if(r&&!r.byteOffset)this.size=r.length,this.buffer=r,this.data=new DataView(this.buffer.buffer);else{if(r)throw new Error("not support subarray of ArrayBuffer");this.size=Math.max(t,102400),this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}async readUint8(){this.remainingLength()<1&&await this.flush(1);const t=this.data.getUint8(this.pointer);return this.pointer++,this.pos++,t}async peekUint8(){return this.remainingLength()<1&&await this.flush(1),this.data.getUint8(this.pointer)}async readUint16(){this.remainingLength()<2&&await this.flush(2);const t=this.data.getUint16(this.pointer,this.littleEndian);return this.pointer+=2,this.pos+=BigInt(2),t}async peekUint16(){return this.remainingLength()<2&&await this.flush(2),this.data.getUint16(this.pointer,this.littleEndian)}async readUint24(){this.remainingLength()<3&&await this.flush(3);const t=await this.readUint16(),e=await this.readUint8();return this.littleEndian?e<<16|t:t<<8|e}async peekUint24(){this.remainingLength()<3&&await this.flush(3);const t=this.pointer,e=this.pos,r=await this.readUint16(),i=await this.readUint8(),s=this.littleEndian?i<<16|r:r<<8|i;return this.pointer=t,this.pos=e,s}async readUint32(){this.remainingLength()<4&&await this.flush(4);const t=this.data.getUint32(this.pointer,this.littleEndian);return this.pointer+=4,this.pos+=BigInt(4),t}async peekUint32(){return this.remainingLength()<4&&await this.flush(4),this.data.getUint32(this.pointer,this.littleEndian)}async readUint64(){this.remainingLength()<8&&await this.flush(8);const t=this.data.getBigUint64(this.pointer,this.littleEndian);return this.pointer+=8,this.pos+=BigInt(8),t}async peekUint64(){return this.remainingLength()<8&&await this.flush(8),this.data.getBigUint64(this.pointer,this.littleEndian)}async readInt8(){this.remainingLength()<1&&await this.flush(1);const t=this.data.getInt8(this.pointer);return this.pointer++,this.pos++,t}async peekInt8(){return this.remainingLength()<1&&await this.flush(1),this.data.getInt8(this.pointer)}async readInt16(){this.remainingLength()<2&&await this.flush(2);const t=this.data.getInt16(this.pointer,this.littleEndian);return this.pointer+=2,this.pos+=BigInt(2),t}async peekInt16(){return this.remainingLength()<2&&await this.flush(2),this.data.getInt16(this.pointer,this.littleEndian)}async readInt24(){const t=await this.readUint24();return 8388608&t?t-16777216:t}async peekInt24(){const t=await this.peekUint24();return 8388608&t?t-16777216:t}async readInt32(){this.remainingLength()<4&&await this.flush(4);const t=this.data.getInt32(this.pointer,this.littleEndian);return this.pointer+=4,this.pos+=BigInt(4),t}async peekInt32(){return this.remainingLength()<4&&await this.flush(4),this.data.getInt32(this.pointer,this.littleEndian)}async readInt64(){this.remainingLength()<8&&await this.flush(8);const t=this.data.getBigInt64(this.pointer,this.littleEndian);return this.pointer+=8,this.pos+=BigInt(8),t}async peekInt64(){return this.remainingLength()<8&&await this.flush(8),this.data.getBigInt64(this.pointer,this.littleEndian)}async readFloat(){this.remainingLength()<4&&await this.flush(4);const t=this.data.getFloat32(this.pointer,this.littleEndian);return this.pointer+=4,this.pos+=BigInt(4),t}async peekFloat(){return this.remainingLength()<4&&await this.flush(4),this.data.getFloat32(this.pointer,this.littleEndian)}async readDouble(){this.remainingLength()<8&&await this.flush(8);const t=this.data.getFloat64(this.pointer,this.littleEndian);return this.pointer+=8,this.pos+=BigInt(8),t}async peekDouble(){return this.remainingLength()<8&&await this.flush(8),this.data.getFloat64(this.pointer,this.littleEndian)}async readHex(t=1){let e="";for(let r=0;r<t;r++){const t=(await this.readUint8()).toString(16);e+=1===t.length?"0"+t:t}return e}async peekHex(t=1){t>this.size&&(this.error=-1048574,n.h2("peekHex, length too large",d,416)),this.remainingLength()<t&&await this.flush(t);const e=this.pointer,r=this.pos;let i="";for(let e=0;e<t;e++){const t=(await this.readUint8()).toString(16);i+=1===t.length?"0"+t:t}return this.pointer=e,this.pos=r,i}async readBuffer(t,e){if(e||(e=new Uint8Array(t)),this.remainingLength()<t){let r=0;if(this.remainingLength()>0){const i=this.remainingLength();e.set(this.buffer.subarray(this.pointer,this.pointer+i),r),r+=i,this.pointer+=i,this.pos+=BigInt(i),t-=i}for(;t>0;){await this.flush();const i=Math.min(this.endPointer-this.pointer,t);e.set(this.buffer.subarray(this.pointer,this.pointer+i),r),r+=i,this.pointer+=i,this.pos+=BigInt(i),t-=i}}else e.set(this.buffer.subarray(this.pointer,this.pointer+t),0),this.pointer+=t,this.pos+=BigInt(t);return e}async peekBuffer(t,e){return t>this.size&&(this.error=-1048574,n.h2("peekBuffer, length too large",d,501)),this.remainingLength()<t&&await this.flush(t),e||(e=new Uint8Array(t)),e.set(this.buffer.subarray(this.pointer,this.pointer+t),0),e}async readToBuffer(t,e){if(this.remainingLength()<t){let r=0;if(this.remainingLength()>0){const i=this.remainingLength();e.set(this.buffer.subarray(this.pointer,this.pointer+i),r),r+=i,this.pointer+=i,this.pos+=BigInt(i),t-=i}for(;t>0;){try{await this.flush()}catch(t){if(-1048576===this.error&&r)return r;throw t}const i=Math.min(this.endPointer-this.pointer,t);e.set(this.buffer.subarray(this.pointer,this.pointer+i),r),r+=i,this.pointer+=i,this.pos+=BigInt(i),t-=i}return r}return e.set(this.buffer.subarray(this.pointer,this.pointer+t),0),this.pointer+=t,this.pos+=BigInt(t),t}async readString(t=1){const e=await this.readBuffer(t);return o.decode(e)}async peekString(t=1){const e=await this.peekBuffer(t);return o.decode(e)}async readLine(){let t="";for(;;){let e=!1;for(let r=this.pointer;r<this.endPointer;r++)if(10===this.buffer[r]||13===this.buffer[r]){r!==this.pointer&&(t+=await this.readString(r-this.pointer)),e=!0;break}if(e)break;t+=await this.readString(this.remainingLength()),await this.flush()}let e=await this.peekUint8();return 10!==e&&13!==e||(this.pointer++,13===e&&(e=await this.peekUint8(),10===e&&this.pointer++)),t}async peekLine(){if(this.remainingLength()<this.size)try{await this.flush()}catch(t){if(-1048576!==this.error)throw t}let t="",e=!1;for(let r=this.pointer;r<this.endPointer;r++)if(10===this.buffer[r]||13===this.buffer[r]){t+=await this.peekString(r-this.pointer),e=!0;break}return e||(this.error=-1048574,n.h2("peekLine, out of buffer",d,659)),t}getPointer(){return this.pointer}getPos(){return this.pos}async skip(t){const e=t;for(;this.remainingLength()<t;)t-=this.remainingLength(),this.pointer=this.endPointer,await this.flush();this.remainingLength()>=t&&(this.pointer+=t),this.pos+=BigInt(e)}remainingLength(){return this.endPointer-this.pointer}async flush_(t){return new(a())((async e=>{for(this.flushResolve=e;;){const r=await this.onFlush(t);if(-1048575!==r){this.flushResolve=null,e(r);break}await new c.A(0)}}))}async flush(t=0){if(this.onFlush||(this.error=-1048574,n.h2("IOReader error, flush failed because of no flush callback",d,738)),!(this.size-this.remainingLength()<=0)){if(t=Math.min(t,this.size),this.pointer<this.endPointer?(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer):this.endPointer=0,this.pointer=0,t)for(;this.remainingLength()<t;){const t=await this.flush_(this.buffer.subarray(this.endPointer));if(t<0)throw this.error=t,new Error(`IOReader error, flush ${-1048576===t?"ended":"failed"}, ret: ${t}`);this.endPointer+=t}else{const t=await this.flush_(this.buffer.subarray(this.endPointer));if(t<0)throw this.error=t,new Error(`IOReader error, flush ${-1048576===t?"ended":"failed"}, ret: ${t}`);this.endPointer+=t}this.error=0}}async seek(t,e=!1,r=!0){if(!e){const e=Number(t-this.pos);if(e<0&&Math.abs(e)<this.pointer)return this.pointer+=e,void(this.pos=t);if(e>0&&this.pointer+e<this.endPointer)return this.pointer+=e,void(this.pos=t);if(0===e)return}this.onSeek||(this.error=-1048574,n.h2("IOReader error, seek failed because of no seek callback",d,809)),this.pointer=this.endPointer=0,this.pos=t;const i=await this.onSeek(t);0!==i&&(this.error=i,n.h2("IOReader error, seek failed",d,818)),r&&await this.flush()}getBuffer(){return this.buffer}appendBuffer(t){if(this.size-this.endPointer>=t.length)this.buffer.set(t,this.endPointer),this.endPointer+=t.length;else if(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer,this.pointer=0,this.size-this.endPointer>=t.length)this.buffer.set(t,this.endPointer),this.endPointer+=t.length;else{const e=Math.min(this.size-this.endPointer,t.length);this.buffer.set(t.subarray(0,e),this.endPointer),this.endPointer+=e,n.R8("IOReader, call appendBuffer but the buffer's size is lagger then the remaining size",d,856)}}reset(){this.pointer=this.endPointer=0,this.pos=BigInt(0),this.error=0}setEndian(t){this.littleEndian=!t}isBigEndian(){return!this.littleEndian}async fileSize(){if(this.fileSize_)return this.fileSize_;if(!this.onSize)return n.R8("IOReader error, fileSize failed because of no onSize callback",d,898),BigInt(0);try{this.fileSize_=await this.onSize()}catch(t){n.R8(`IOReader error, call fileSize failed: ${t}`,d,905),this.fileSize_=BigInt(0)}return this.fileSize_}getBufferSize(){return this.size}async pipe(t,e){if(e)if(this.remainingLength()<e){if(this.remainingLength()>0){const r=this.remainingLength();await t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+r)),this.pointer+=r,this.pos+=BigInt(r),e-=r}for(;e>0;){await this.flush();const r=Math.min(this.remainingLength(),e);await t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+r)),this.pointer+=r,this.pos+=BigInt(r),e-=r}}else await t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+e)),this.pointer+=e,this.pos+=BigInt(e);else{if(this.remainingLength()>0){const e=this.remainingLength();await t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+e)),this.pointer+=e,this.pos+=BigInt(e)}for(;await this.flush_(this.buffer.subarray(0))>0;){const e=this.remainingLength();await t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+e)),this.pointer+=e,this.pos+=BigInt(e)}}}abort(){this.error=-1048572,this.flushResolve&&(this.flushResolve(-1048572),this.flushResolve=null)}}},34531:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(50011);class a{constructor(t=1048576,e=!0,r){if((0,i.A)(this,"data",void 0),(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"pos",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"littleEndian",void 0),(0,i.A)(this,"error",void 0),(0,i.A)(this,"onFlush",void 0),(0,i.A)(this,"onSeek",void 0),this.pointer=0,this.pos=BigInt(0),this.size=t,this.littleEndian=!e,this.error=0,r&&r.view)this.size=r.length,this.buffer=r,this.data=r.view;else if(r&&!r.byteOffset)this.size=r.length,this.buffer=r,this.data=new DataView(this.buffer.buffer);else{if(r)throw new Error("not support subarray of ArrayBuffer");this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}async writeUint8(t){this.remainingLength()<1&&await this.flush(),this.data.setUint8(this.pointer,t),this.pointer++,this.pos++}async writeUint16(t){this.remainingLength()<2&&await this.flush(),this.data.setUint16(this.pointer,t,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}async writeUint24(t){this.remainingLength()<3&&await this.flush();const e=(16711680&t)>>16,r=(65280&t)>>8,i=255&t;this.littleEndian?(await this.writeUint8(i),await this.writeUint8(r),await this.writeUint8(e)):(await this.writeUint8(e),await this.writeUint8(r),await this.writeUint8(i))}async writeUint32(t){this.remainingLength()<4&&await this.flush(),this.data.setUint32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}async writeUint64(t){this.remainingLength()<8&&await this.flush(),this.data.setBigUint64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}async writeInt8(t){this.remainingLength()<1&&await this.flush(),this.data.setInt8(this.pointer,t),this.pointer++,this.pos++}async writeInt16(t){this.remainingLength()<2&&await this.flush(),this.data.setInt16(this.pointer,t,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}async writeInt24(t){await this.writeUint24(t<0?t+16777216:t)}async writeInt32(t){this.remainingLength()<4&&await this.flush(),this.data.setInt32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}async writeInt64(t){this.remainingLength()<8&&await this.flush(),this.data.setBigInt64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}async writeFloat(t){this.remainingLength()<4&&await this.flush(),this.data.setFloat32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}async writeDouble(t){this.remainingLength()<8&&await this.flush(),this.data.setFloat64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}getPointer(){return this.pointer}getPos(){return this.pos}remainingLength(){return this.size-this.pointer}async writeBuffer(t){if(!t.length)return;let e=t.length;if(this.remainingLength()<e){let r=0;for(;e>0;){await this.flush();const i=Math.min(this.size,e);this.buffer.set(t.subarray(r,r+i),this.pointer),this.pointer+=i,this.pos+=BigInt(i),r+=i,e-=i}}else this.buffer.set(t,this.pointer),this.pointer+=e,this.pos+=BigInt(e)}async writeString(t){const e=s.encode(t);return await this.writeBuffer(e),e.length}async flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const t=await this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==t)throw this.error=t,Error("IOWriter error, flush failed")}this.pointer=0}async flushToPos(t){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const e=await this.onFlush(this.buffer.subarray(0,this.pointer),t);if(0!==e)throw this.error=e,Error("IOWriter error, flush failed")}this.pointer=0}async seek(t){if(!this.onSeek)throw this.error=-1048574,Error("IOWriter error, seek failed because of no seek callback");await this.flush();const e=await this.onSeek(t);if(0!==e)throw this.error=e,Error("IOWriter error, seek failed");this.pos=t}seekInline(t){const e=this.pointer;this.pointer=Math.max(0,Math.min(this.size,t)),this.pos+=BigInt(this.pointer-e)}skip(t){const e=this.pointer;this.pointer=Math.min(this.size,this.pointer+t),this.pos+=BigInt(this.pointer-e)}back(t){const e=this.pointer;this.pointer=Math.max(0,this.pointer-t),this.pos+=BigInt(this.pointer-e)}getBuffer(){return this.buffer.subarray(0,this.pointer)}setEndian(t){this.littleEndian=!t}reset(){this.pointer=0,this.pos=BigInt(0),this.error=0}getBufferSize(){return this.size}}},35336:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(50011);class a{constructor(t=1048576,e=!0,r){if((0,i.A)(this,"data",void 0),(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"pos",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"littleEndian",void 0),(0,i.A)(this,"error",void 0),(0,i.A)(this,"onFlush",void 0),(0,i.A)(this,"onSeek",void 0),this.pointer=0,this.pos=BigInt(0),this.size=t,this.littleEndian=!e,this.error=0,r&&r.view)this.size=r.length,this.buffer=r,this.data=r.view;else if(r&&!r.byteOffset)this.size=r.length,this.buffer=r,this.data=new DataView(this.buffer.buffer);else{if(r)throw new Error("not support subarray of ArrayBuffer");this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}writeUint8(t){this.remainingLength()<1&&this.flush(),this.data.setUint8(this.pointer,t),this.pointer++,this.pos++}writeUint16(t){this.remainingLength()<2&&this.flush(),this.data.setUint16(this.pointer,t,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}writeUint24(t){this.remainingLength()<3&&this.flush();const e=(16711680&t)>>16,r=(65280&t)>>8,i=255&t;this.littleEndian?(this.writeUint8(i),this.writeUint8(r),this.writeUint8(e)):(this.writeUint8(e),this.writeUint8(r),this.writeUint8(i))}writeUint32(t){this.remainingLength()<4&&this.flush(),this.data.setUint32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeUint64(t){this.remainingLength()<8&&this.flush(),this.data.setBigUint64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}writeInt8(t){this.remainingLength()<1&&this.flush(),this.data.setInt8(this.pointer,t),this.pointer++,this.pos++}writeInt16(t){this.remainingLength()<2&&this.flush(),this.data.setInt16(this.pointer,t,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}writeInt24(t){this.writeUint24(t<0?t+16777216:t)}writeInt32(t){this.remainingLength()<4&&this.flush(),this.data.setInt32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeInt64(t){this.remainingLength()<8&&this.flush(),this.data.setBigInt64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}writeFloat(t){this.remainingLength()<4&&this.flush(),this.data.setFloat32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeDouble(t){this.remainingLength()<8&&this.flush(),this.data.setFloat64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}getPointer(){return this.pointer}getPos(){return this.pos}remainingLength(){return this.size-this.pointer}writeBuffer(t){if(!t.length)return;let e=t.length;if(this.remainingLength()<e){let r=0;for(;e>0;){this.flush();const i=Math.min(this.size,e);this.buffer.set(t.subarray(r,r+i),this.pointer),this.pointer+=i,this.pos+=BigInt(i),r+=i,e-=i}}else this.buffer.set(t,this.pointer),this.pointer+=e,this.pos+=BigInt(e)}writeString(t){const e=s.encode(t);return this.writeBuffer(e),e.length}flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const t=this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==t)throw this.error=t,Error("IOWriter error, flush failed")}this.pointer=0}flushToPos(t){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const e=this.onFlush(this.buffer.subarray(0,this.pointer),t);if(0!==e)throw this.error=e,Error("IOWriter error, flush failed")}this.pointer=0}seek(t){if(!this.onSeek)throw this.error=-1048574,Error("IOWriter error, seek failed because of no seek callback");this.flush();const e=this.onSeek(t);if(0!==e)throw this.error=e,Error("IOWriter error, seek failed");this.pos=t}seekInline(t){const e=this.pointer;this.pointer=Math.max(0,Math.min(this.size,t)),this.pos+=BigInt(this.pointer-e)}skip(t){const e=this.pointer;this.pointer=Math.min(this.size,this.pointer+t),this.pos+=BigInt(this.pointer-e)}back(t){const e=this.pointer;this.pointer=Math.max(0,this.pointer-t),this.pos+=BigInt(this.pointer-e)}getBuffer(){return this.buffer.subarray(0,this.pointer)}setEndian(t){this.littleEndian=!t}reset(){this.pointer=0,this.pos=BigInt(0),this.error=0}getBufferSize(){return this.size}}},22343:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(92647);class a{constructor(){(0,i.A)(this,"queue",void 0),(0,i.A)(this,"pos",void 0),(0,i.A)(this,"startPos",void 0),(0,i.A)(this,"endPos",void 0),(0,i.A)(this,"index",void 0),(0,i.A)(this,"offset",void 0),this.queue=[],this.startPos=BigInt(0),this.endPos=BigInt(0),this.pos=BigInt(0)}write(t){if(this.pos===this.endPos)this.queue.push(t),this.endPos+=BigInt(t.length),this.pos+=BigInt(t.length);else if(t.length<this.queue[this.index].length-this.offset)this.queue[this.index].set(t,this.offset),this.offset+=t.length,this.pos+=BigInt(t.length),this.offset===this.queue[this.index].length&&(this.index++,this.offset=0),this.index===this.queue.length&&(this.index=-1,this.offset=-1,this.pos=this.endPos);else{let e=0;for(;e<t.length;){const r=Math.min(this.queue[this.index].length-this.offset,t.length-e);if(this.queue[this.index].set(t.subarray(e,e+r),this.offset),e+=r,this.offset+=r,this.pos+=BigInt(r),this.offset===this.queue[this.index].length){if(this.index+1===this.queue.length){if(e<t.length){const r=t.subarray(t.length-e);this.queue.push(r),this.endPos+=BigInt(r.length)}this.pos=this.endPos,this.index=-1,this.offset=-1;break}this.index++,this.offset=0}}}}seek(t){if(t<this.startPos||t>this.endPos)return!1;this.pos=t,this.index=-1,this.offset=-1;let e=this.startPos;for(let r=0;r<this.queue.length;r++){if(t<=e+BigInt(this.queue[r].length)){this.index=r,this.offset=Number(t-e);break}e+=BigInt(this.queue[r].length)}return this.index<0&&(this.pos=this.endPos),!0}flush(){this.startPos=this.endPos,this.pos=this.endPos,this.index=-1,this.offset=-1;const t=(0,s.A)(Uint8Array,this.queue);return this.queue.length=0,t}get size(){return this.queue.length}}},45726:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(72739),a=r(4624);const n="src\\common\\math\\Matrix3.ts";class o{static RowMajor(t){return new o([t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]])}static ColMajor(t){return new o(t)}constructor(t){(0,i.A)(this,"element",void 0),t?(this.element=new Float32Array(9),this.set(t)):this.element=new Float32Array([1,0,0,0,1,0,0,0,1])}rc(t,e){return this.getValue(3*e+t)}setRC(t,e,r){this.setValue(3*e+t,r)}getValue(t){if(t>=0&&t<9)return this.element[t];a.z3("index out of Matrix4's rang [0 - 9]",n,47)}setValue(t,e){t>=0&&t<9?this.element[t]=e:a.z3("index out of Matrix4's rang [0 - 9]",n,56)}setIdentity(){return this.element=new Float32Array([1,0,0,0,1,0,0,0,1]),this}set(t){return s.__(t,((t,e)=>{this.element[e]=t})),this}invert(){const t=this.element,e=t[0],r=t[1],i=t[2],s=t[3],a=t[4],n=t[5],o=t[6],c=t[7],d=t[8],h=d*a-n*c,l=n*o-d*s,u=c*s-a*o,f=e*h+r*l+i*u;if(0===f)return this.set([0,0,0,0,0,0,0,0,0]);const p=1/f;return t[0]=h*p,t[1]=(i*c-d*r)*p,t[2]=(n*r-i*a)*p,t[3]=l*p,t[4]=(d*e-i*o)*p,t[5]=(i*s-n*e)*p,t[6]=u*p,t[7]=(r*o-c*e)*p,t[8]=(a*e-r*s)*p,this}toArray(){let t=[];for(let e=0;e<9;e++)t[e]=this.element[e];return t}copy(){return(new o).set(this.toArray())}}},12535:(t,e,r)=>{"use strict";r.d(e,{A:()=>d});var i=r(134),s=r(72739),a=r(4624),n=r(1064);const o="src\\common\\math\\Matrix4.ts";let c;class d{static shared(){return c||(c=new d)}static RowMajor(t){return new d([t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]])}static ColMajor(t){return new d(t)}constructor(t){(0,i.A)(this,"element",void 0),t?(this.element=new Float32Array(16),this.set(t)):this.element=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}rc(t,e){return this.getValue(4*e+t)}setRC(t,e,r){this.setValue(4*e+t,r)}getValue(t){if(t>=0&&t<=15)return this.element[t];a.z3("index out of Matrix4's rang [0 - 15]",o,58)}setValue(t,e){t>=0&&t<=15?this.element[t]=e:a.z3("index out of Matrix4's rang [0 - 15]",o,67)}setIdentity(){return this.element=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this}set(t){return s.__(t,((t,e)=>{this.element[e]=t})),this}multiply(t){let e,r,i,s,a,n,o,c;if(s=r=this.element,i=t.element,s===i)for(i=new Float32Array(16),e=0;e<16;e++)i[e]=s[e];for(e=0;e<4;e++)a=r[e],n=r[e+4],o=r[e+8],c=r[e+12],s[e]=a*i[0]+n*i[1]+o*i[2]+c*i[3],s[e+4]=a*i[4]+n*i[5]+o*i[6]+c*i[7],s[e+8]=a*i[8]+n*i[9]+o*i[10]+c*i[11],s[e+12]=a*i[12]+n*i[13]+o*i[14]+c*i[15];return this}multiplyVector3(t){let e=this.element,r=t.element;return new n.P([r[0]*e[0]+r[1]*e[4]+r[2]*e[8]+e[12],r[0]*e[1]+r[1]*e[5]+r[2]*e[9]+e[13],r[0]*e[2]+r[1]*e[6]+r[2]*e[10]+e[14]])}multiplyVector4(t){let e=this.element,r=t.element;return new n.I([r[0]*e[0]+r[1]*e[4]+r[2]*e[8]+r[3]*e[12],r[0]*e[1]+r[1]*e[5]+r[2]*e[9]+r[3]*e[13],r[0]*e[2]+r[1]*e[6]+r[2]*e[10]+r[3]*e[14],r[0]*e[3]+r[1]*e[7]+r[2]*e[11]+r[3]*e[15]])}transpose(){let t,e;return t=this.element,e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setInverseOf(t){let e,r,i,s,a;if(r=t.element,i=this.element,s=new Float32Array(16),s[0]=r[5]*r[10]*r[15]-r[5]*r[11]*r[14]-r[9]*r[6]*r[15]+r[9]*r[7]*r[14]+r[13]*r[6]*r[11]-r[13]*r[7]*r[10],s[1]=-r[1]*r[10]*r[15]+r[1]*r[11]*r[14]+r[9]*r[2]*r[15]-r[9]*r[3]*r[14]-r[13]*r[2]*r[11]+r[13]*r[3]*r[10],s[2]=r[1]*r[6]*r[15]-r[1]*r[7]*r[14]-r[5]*r[2]*r[15]+r[5]*r[3]*r[14]+r[13]*r[2]*r[7]-r[13]*r[3]*r[6],s[3]=-r[1]*r[6]*r[11]+r[1]*r[7]*r[10]+r[5]*r[2]*r[11]-r[5]*r[3]*r[10]-r[9]*r[2]*r[7]+r[9]*r[3]*r[6],s[4]=-r[4]*r[10]*r[15]+r[4]*r[11]*r[14]+r[8]*r[6]*r[15]-r[8]*r[7]*r[14]-r[12]*r[6]*r[11]+r[12]*r[7]*r[10],s[5]=r[0]*r[10]*r[15]-r[0]*r[11]*r[14]-r[8]*r[2]*r[15]+r[8]*r[3]*r[14]+r[12]*r[2]*r[11]-r[12]*r[3]*r[10],s[6]=-r[0]*r[6]*r[15]+r[0]*r[7]*r[14]+r[4]*r[2]*r[15]-r[4]*r[3]*r[14]-r[12]*r[2]*r[7]+r[12]*r[3]*r[6],s[7]=r[0]*r[6]*r[11]-r[0]*r[7]*r[10]-r[4]*r[2]*r[11]+r[4]*r[3]*r[10]+r[8]*r[2]*r[7]-r[8]*r[3]*r[6],s[8]=r[4]*r[9]*r[15]-r[4]*r[11]*r[13]-r[8]*r[5]*r[15]+r[8]*r[7]*r[13]+r[12]*r[5]*r[11]-r[12]*r[7]*r[9],s[9]=-r[0]*r[9]*r[15]+r[0]*r[11]*r[13]+r[8]*r[1]*r[15]-r[8]*r[3]*r[13]-r[12]*r[1]*r[11]+r[12]*r[3]*r[9],s[10]=r[0]*r[5]*r[15]-r[0]*r[7]*r[13]-r[4]*r[1]*r[15]+r[4]*r[3]*r[13]+r[12]*r[1]*r[7]-r[12]*r[3]*r[5],s[11]=-r[0]*r[5]*r[11]+r[0]*r[7]*r[9]+r[4]*r[1]*r[11]-r[4]*r[3]*r[9]-r[8]*r[1]*r[7]+r[8]*r[3]*r[5],s[12]=-r[4]*r[9]*r[14]+r[4]*r[10]*r[13]+r[8]*r[5]*r[14]-r[8]*r[6]*r[13]-r[12]*r[5]*r[10]+r[12]*r[6]*r[9],s[13]=r[0]*r[9]*r[14]-r[0]*r[10]*r[13]-r[8]*r[1]*r[14]+r[8]*r[2]*r[13]+r[12]*r[1]*r[10]-r[12]*r[2]*r[9],s[14]=-r[0]*r[5]*r[14]+r[0]*r[6]*r[13]+r[4]*r[1]*r[14]-r[4]*r[2]*r[13]-r[12]*r[1]*r[6]+r[12]*r[2]*r[5],s[15]=r[0]*r[5]*r[10]-r[0]*r[6]*r[9]-r[4]*r[1]*r[10]+r[4]*r[2]*r[9]+r[8]*r[1]*r[6]-r[8]*r[2]*r[5],a=r[0]*s[0]+r[1]*s[4]+r[2]*s[8]+r[3]*s[12],0===a)return this;for(a=1/a,e=0;e<16;e++)i[e]=s[e]*a;return this}invert(){return this.setInverseOf(this),this}setOrtho(t,e,r,i,s,n){let c,d,h;return t!==e&&r!==i&&s!==n||a.h2("null frustum",o,240),c=1/(e-t),d=1/(i-r),h=1/(n-s),this.set([2*c,0,0,0,0,2*d,0,0,0,0,-2*h,0,-(e+t)*c,-(i+r)*d,-(n+s)*h,1]),this}ortho(t,e,r,i,s,a){return this.multiply((new d).setOrtho(t,e,r,i,s,a))}setFrustum(t,e,r,i,s,n){let c,d,h;return t!==e&&r!==i&&s!==n||a.z3("null frustum",o,281),s<=0&&a.h2("near <= 0",o,284),n<=0&&a.h2("far <= 0",o,287),c=1/(e-t),d=1/(i-r),h=1/(n-s),this.set([2*s*c,0,0,0,0,2*s*d,0,0,(e+t)*c,(i+r)*d,-(n+s)*h,-1,0,0,-2*s*n*h,0]),this}frustum(t,e,r,i,s,a){return this.multiply((new d).setOrtho(t,e,r,i,s,a))}setPerspective(t,e,r,i){let s,n,c;return r!==i&&0!==e||a.h2("null frustum",o,328),r<=0&&a.h2("near <= 0",o,331),i<=0&&a.h2("far <= 0",o,334),t=Math.PI*t/180/2,n=Math.sin(t),0===n&&a.h2("null frustum",o,342),s=1/(i-r),c=Math.cos(t)/n,this.set([c/e,0,0,0,0,c,0,0,0,0,-(i+r)*s,-1,0,0,-2*r*i*s,0]),this}perspective(t,e,r,i){return this.multiply((new d).setPerspective(t,e,r,i))}setScale(t){return this.set([t.x,0,0,0,0,t.y,0,0,0,0,t.z,0,0,0,0,1]),this}scale(t){let e=this.element;return e[0]*=t.x,e[1]*=t.x,e[2]*=t.x,e[3]*=t.x,e[4]*=t.y,e[5]*=t.y,e[6]*=t.y,e[7]*=t.y,e[8]*=t.z,e[9]*=t.z,e[10]*=t.z,e[11]*=t.z,this}setTranslate(t){return this.set([1,0,0,0,0,1,0,0,0,0,1,0,t.x,t.y,t.z,1]),this}preTranslate(t){let e=this.element;return e[12]+=e[0]*t.x+e[4]*t.y+e[8]*t.z,e[13]+=e[1]*t.x+e[5]*t.y+e[9]*t.z,e[14]+=e[2]*t.x+e[6]*t.y+e[10]*t.z,e[15]+=e[3]*t.x+e[7]*t.y+e[11]*t.z,this}postTranslate(t){let e=this.element;return e[0]+=t.x*e[3],e[1]+=t.y*e[3],e[2]+=t.z*e[3],e[4]+=t.x*e[7],e[5]+=t.y*e[7],e[6]+=t.z*e[7],e[8]+=t.x*e[11],e[9]+=t.y*e[11],e[10]+=t.z*e[11],e[12]+=t.x*e[15],e[13]+=t.y*e[15],e[14]+=t.z*e[15],this}setRotate(t,e){let r,i,s,a,n,o,c,d,h,l,u,f,p,m;return t=Math.PI*t/180,r=e.x,i=e.y,s=e.z,a=Math.sin(t),n=Math.cos(t),0!==e.x&&0===e.y&&0===e.z?(e.x<0&&(a=-a),this.set([1,0,0,0,0,n,-a,0,0,a,n,0,0,0,0,1])):0===e.x&&0!==e.y&&0===e.z?(e.y<0&&(a=-a),this.set([n,0,a,0,0,1,0,0,-a,0,n,0,0,0,0,1])):0===e.x&&0===e.y&&0!==e.z?(e.z<0&&(a=-a),this.set([n,-a,0,0,a,n,0,0,0,0,1,0,0,0,0,1])):(o=e.magnitude,1!==o&&(c=1/o,r*=c,i*=c,s*=c),d=1-n,h=r*i,l=i*s,u=s*r,f=r*a,p=i*a,m=s*a,this.set([r*r*d+n,h*d+m,u*d-p,0,h*d-m,i*i*d+n,l*d+f,0,u*d+p,l*d-f,s*s*d+n,0,0,0,0,1])),this}rotate(t,e){return this.multiply((new d).setRotate(t,e)),this}setLookAt(t,e,r){let i,s,a,o,c,d,h,l,u,f,p;return i=e.x-t.x,s=e.y-t.y,a=e.z-t.z,o=1/Math.sqrt(i*i+s*s+a*a),i*=o,s*=o,a*=o,c=s*r.z-a*r.y,d=a*r.x-i*r.z,h=i*r.y-s*r.x,l=1/Math.sqrt(c*c+d*d+h*h),c*=l,d*=l,h*=l,u=d*a-h*s,f=h*i-c*a,p=c*s-d*i,this.set([c,u,-i,0,d,f,-s,0,h,p,-a,0,0,0,0,1]),this.preTranslate(new n.P([-t.x,-t.y,-t.z]))}lookAt(t,e,r){return this.multiply((new d).setLookAt(t,e,r))}toArray(){let t=[];for(let e=0;e<16;e++)t[e]=this.element[e];return t}copy(){return(new d).set(this.toArray())}}},1064:(t,e,r)=>{"use strict";r.d(e,{I:()=>a,P:()=>s});var i=r(134);class s{constructor(t){(0,i.A)(this,"element",void 0),this.element=new Float32Array(3),t&&(this.element[0]=t[0],this.element[1]=t[1],this.element[2]=t[2])}normalize(){let t=this.x,e=this.y,r=this.z,i=this.magnitude;return i?(1===i||(i=1/i,this.x=t*i,this.y=e*i,this.z=r*i),this):(this.x=this.y=this.z=0,this)}toArray(){return[this.x,this.y,this.z]}get magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}get sqrMagnitude(){return this.x*this.x+this.y*this.y+this.z*this.z}get x(){return this.element[0]}set x(t){this.element[0]=t}get y(){return this.element[1]}set y(t){this.element[1]=t}get z(){return this.element[2]}set z(t){this.element[2]=t}}class a{constructor(t){(0,i.A)(this,"element",void 0),this.element=new Float32Array(4),t&&(this.element[0]=t[0],this.element[1]=t[1],this.element[2]=t[2],this.element[4]=t[3])}}},95073:(t,e,r)=>{"use strict";function i(t,e){return t+(e-1)&~(e-1)}r.d(e,{A:()=>i})},31658:(t,e,r)=>{"use strict";function i(t,e){for(;0!==e;)[t,e]=[e,t%e];return t}r.d(e,{A:()=>i})},66551:(t,e,r)=>{"use strict";r.d(e,{B:()=>s});var i=r(45726);function s(t,e){const r=new i.A([0,0,0,0,0,0,0,0,0]);for(let i=0;i<3;i++)for(let s=0;s<3;s++){let a=t.rc(i,0)*e.rc(0,s)+t.rc(i,1)*e.rc(1,s)+t.rc(i,2)*e.rc(2,s);r.setRC(i,s,a)}return r}r(12535)},4304:(t,e,r)=>{"use strict";function i(t){return t<=0?1:Math.pow(2,Math.ceil(Math.log2(t)))}r.d(e,{A:()=>i})},60153:(t,e,r)=>{"use strict";r.d(e,{Y3:()=>s}),r(12535);var i=r(1064);function s(t,e){const r=new i.P([0,0,0]);for(let i=0;i<3;i++)r.element[i]=t.rc(i,0)*e.x+t.rc(i,1)*e.y+t.rc(i,2)*e.z;return r}},42577:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134);class s extends EventTarget{constructor(...t){super(...t),(0,i.A)(this,"peer",void 0),(0,i.A)(this,"onmessage",void 0),(0,i.A)(this,"onmessageerror",void 0)}postMessage(t,e){var r;null!==(r=this.peer)&&void 0!==r&&r.onmessage&&this.peer.onmessage({data:t})}close(){this.peer=null}start(){}}class a{constructor(){(0,i.A)(this,"port1",void 0),(0,i.A)(this,"port2",void 0),this.port1=new s,this.port2=new s,this.port1.peer=this.port2,this.port2.peer=this.port1}}},84149:(t,e,r)=>{"use strict";r.d(e,{Ay:()=>u,S3:()=>l,Wo:()=>h});var i=r(134),s=r(80662),a=r.n(s),n=r(54001),o=r.n(n),c=r(96172),d=r(34677);const h="notify",l="request";class u extends c.A{constructor(t){super(!0),(0,i.A)(this,"port",void 0),(0,i.A)(this,"requestMap",void 0),(0,i.A)(this,"seq",void 0),(0,i.A)(this,"closed",void 0),this.port=t,this.port.onmessage=this.handle.bind(this),this.seq=0,this.requestMap=new(a()),this.port.start(),this.closed=!1}handle(t){const e=t.data,r=e.type,i=e.data;if("notify"===r)this.fire(h,i);else if("reply"===r){const t=this.requestMap.get(i.seq);t&&((0,d.A)(i.result)?t.resolve(i.result):i.error?t.reject(i.error):t.resolve(void 0),this.requestMap.delete(i.seq))}else"request"===r&&this.fire(l,i)}notify(t,e={},r=[]){this.port.postMessage({type:"notify",data:{method:t,params:e}},r)}async request(t,e={},r=[]){return new(o())(((i,s)=>{const a=this.seq++;this.requestMap.set(a,{resolve:i,reject:s}),this.port.postMessage({type:"request",data:{seq:a,method:t,params:e}},r)}))}reply(t,e,r,i=[]){const s={seq:t.seq};(0,d.A)(e)?s.result=e:r&&(s.error=r),null!=i&&i.length?this.port.postMessage({type:"reply",data:s},i):this.port.postMessage({type:"reply",data:s})}getPort(){return this.port}destroy(){this.requestMap.size&&(this.requestMap.forEach((t=>{t.reject("ipc port close")})),this.requestMap.clear()),this.port&&(this.port.close(),this.port=null),this.closed=!0}}},55013:(t,e,r)=>{"use strict";r(84149).Ay},6253:(t,e,r)=>{"use strict";r.d(e,{A:()=>u});var i=r(134),s=r(39638),a=r(86932),n=r(47222),o=r(78995);let c,d=0;function h(){return c?(d++,c):(c=new n.A,d=1,c)}function l(){0!==d&&(d--,0===d&&(c.destroy(),c=null))}class u{constructor(t,e=!0,r=!1){(0,i.A)(this,"messageChannel",void 0),(0,i.A)(this,"interval",void 0),(0,i.A)(this,"started",void 0),(0,i.A)(this,"timer",void 0),(0,i.A)(this,"workerTimer",void 0),(0,i.A)(this,"workerSetTimeout",void 0),(0,i.A)(this,"onClock",void 0),(0,i.A)(this,"nextTick",void 0),(0,i.A)(this,"a",void 0),(0,i.A)(this,"b",void 0),(0,i.A)(this,"beta",void 0),(0,i.A)(this,"alpha",void 0),(0,i.A)(this,"count",void 0),(0,i.A)(this,"equivalent",void 0),(0,i.A)(this,"timestamp",void 0),(0,i.A)(this,"onVisibilityChange",void 0),(0,i.A)(this,"timeoutNext",void 0),(0,i.A)(this,"running",void 0),(0,i.A)(this,"highPerformance",void 0),(0,i.A)(this,"forceWorker",void 0),this.started=!1,this.interval=t,this.highPerformance=e,this.forceWorker=r,this.a=.2,this.b=4,this.equivalent=50,this.timestamp=0,this.nextTick=()=>{if(this.started&&!this.running)if(this.running=!0,this.interval>=4||!this.highPerformance)this.timeoutTick();else if(this.interval<=0)this.messageChannel.port1.postMessage(null);else{const t=(0,a.A)();t-this.timestamp>this.equivalent&&(this.count=0,this.timestamp=t),this.count<this.beta?this.messageChannel.port1.postMessage(null):this.timeoutTick()}},this.compute(),this.messageChannel=new MessageChannel,this.handleEvent(),this.timeoutNext=t=>{t?this.workerTimer=null:this.timer=null,this.running=!1,this.count++,this.onClock?this.onClock(this.nextTick):this.nextTick()},(0,s.A)()||"hidden"!==document.visibilityState||(this.workerSetTimeout=h()),this.running=!1}compute(t=!0){this.interval>0&&(this.beta=Math.ceil(this.equivalent*(1-this.b/this.interval)/(this.a-this.b)),this.alpha=Math.floor(this.equivalent/this.interval-this.beta),t&&(this.count=0))}timeoutTick(){this.workerSetTimeout&&"hidden"===document.visibilityState&&(this.interval<1e3||this.forceWorker)?this.workerTimer=this.workerSetTimeout.setTimeout(this.timeoutNext,this.interval):this.timer=setTimeout(this.timeoutNext,this.interval)}start(){this.started||(this.started=!0,this.timestamp=(0,a.A)(),this.nextTick())}stop(){this.started=!1,this.timer&&(clearTimeout(this.timer),this.timer=null),this.workerTimer&&this.workerSetTimeout&&this.workerSetTimeout.clearTimeout(this.workerTimer),this.running=!1}isStarted(){return this.started}setInterval(t){this.interval=Math.max(t,0),this.compute()}getInterval(){return this.interval}isZeroTimeout(){return this.interval<4}destroy(){this.stop(),this.workerSetTimeout&&(l(),this.workerSetTimeout=null),this.onVisibilityChange&&(document.removeEventListener("visibilitychange",this.onVisibilityChange),this.onVisibilityChange=null)}handleEvent(){this.messageChannel.port2.onmessage=()=>{this.started&&(this.running=!1,this.count++,this.onClock?this.onClock(this.nextTick):this.nextTick())},(0,s.A)()||(this.onVisibilityChange=(0,o.A)((t=>{"hidden"===document.visibilityState?(this.workerSetTimeout=h(),this.timer&&(clearTimeout(this.timer),this.timer=null,this.running=!1),this.nextTick()):(this.workerTimer&&(this.workerSetTimeout.clearTimeout(this.workerTimer),this.workerTimer=null,this.running=!1),this.timer&&(clearTimeout(this.timer),this.timer=null,this.running=!1),l(),this.workerSetTimeout=null,this.nextTick())}),20),document.addEventListener("visibilitychange",this.onVisibilityChange))}}},39148:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(134),s=r(54001),a=r.n(s),n=r(6253),o=r(86932);class c{constructor(t,e=0,r=0,s=!0,a=!0){(0,i.A)(this,"task",void 0),(0,i.A)(this,"count",void 0),(0,i.A)(this,"emptyCount",void 0),(0,i.A)(this,"started",void 0),(0,i.A)(this,"clock",void 0),(0,i.A)(this,"timestamp",void 0),(0,i.A)(this,"timeout",void 0),(0,i.A)(this,"interval",void 0),(0,i.A)(this,"startTimer",void 0),(0,i.A)(this,"autoInterval",void 0),(0,i.A)(this,"sync",void 0),(0,i.A)(this,"tickAfter",void 0),(0,i.A)(this,"processing",void 0),this.task=t,this.timeout=e,this.interval=r,this.autoInterval=s,this.sync=a,this.count=0,this.emptyCount=0,this.timestamp=0,this.started=!1,this.processing=!1,this.clock=new n.A(this.interval),this.clock.onClock=t=>{if(this.started)if(this.count++,this.sync)this.tickAfter&&(this.tickAfter(),this.tickAfter=null),!1===this.task()?this.stop():this.next(t);else{if(this.processing)return;this.processing=!0,this.task().then((e=>{this.processing=!1,this.tickAfter&&(this.tickAfter(),this.tickAfter=null),!1===e?this.stop():this.next(t)}))}}}next(t){if(!this.started)return;const e=(0,o.A)();if(this.autoInterval&&e-this.timestamp>50){const t=this.emptyCount/this.count;0===this.emptyCount?this.clock.setInterval(Math.max(this.clock.getInterval()>>1,this.interval)):t<.1?this.clock.setInterval(this.clock.getInterval()-1):t>.2?this.clock.setInterval(Math.min(this.clock.getInterval()+1,20)):t>.5&&this.clock.setInterval(this.clock.getInterval()<<1),this.count=0,this.emptyCount=0,this.timestamp=e}t()}start(){this.started=!0,this.timeout?this.startTimer=setTimeout((()=>{this.count=0,this.emptyCount=0,this.timestamp=(0,o.A)(),this.clock.start(),this.startTimer=null}),this.timeout):(this.count=0,this.emptyCount=0,this.timestamp=(0,o.A)(),this.clock.start())}stop(){this.started=!1,this.processing=!1,this.startTimer&&(clearTimeout(this.startTimer),this.startTimer=null),this.clock.stop()}async stopBeforeNextTick(){if(this.startTimer&&(clearTimeout(this.startTimer),this.startTimer=null),this.clock.isStarted())return this.sync?(this.started=!1,this.processing=!1,void this.clock.stop()):new(a())((t=>{this.tickAfter=()=>{this.started=!1,this.processing=!1,this.clock.stop(),t()}}))}isStarted(){return this.started}emptyTask(){this.emptyCount++}isZeroTimeout(){var t;return null===(t=this.clock)||void 0===t?void 0:t.isZeroTimeout()}restart(){this.clock&&(this.stop(),this.clock.setInterval(this.interval),this.start())}resetInterval(){this.clock.setInterval(Math.max(this.clock.getInterval()>>1,this.interval)),this.emptyCount=0,this.count=0,this.timestamp=(0,o.A)()}destroy(){this.stop(),this.task=null,this.timeout=null,this.interval=null}}},74936:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(86932);class a{constructor(){(0,i.A)(this,"base",BigInt(0)),(0,i.A)(this,"rate",BigInt(1e3)),(0,i.A)(this,"startTimestamp",BigInt(0))}start(){this.base=BigInt(0),this.startTimestamp=BigInt((0,s.A)())}getMasterTime(){return this.base+(BigInt((0,s.A)())-this.startTimestamp)*this.rate/BigInt(1e3)}setRate(t){this.base=this.getMasterTime(),this.startTimestamp=BigInt((0,s.A)()),this.rate=BigInt(1e3*t>>>0)}setMasterTime(t){this.base=t,this.startTimestamp=BigInt((0,s.A)())}}},13724:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(134),s=r(45249),a=r.n(s);class n{constructor(t){(0,i.A)(this,"timeout",void 0),(0,i.A)(this,"timer",void 0),(0,i.A)(this,"resolve",void 0),(0,i.A)(this,"reject",void 0),(0,i.A)(this,"startTime",void 0),this.timeout=t}then(t,e){this.resolve=t,this.reject=e,this.startTime=a()(),this.timer=setTimeout((()=>{this.resolve(a()()-this.startTime),this.timer=null}),1e3*this.timeout)}stop(t=!0){this.timer&&(clearTimeout(this.timer),this.timer=null,this.resolve&&t?this.resolve(a()()-this.startTime):this.reject&&!t&&this.reject(a()()-this.startTime))}reset(t){t&&(this.timeout=t),this.timer&&(clearTimeout(this.timer),this.timer=setTimeout((()=>{this.resolve(a()()-this.startTime),this.timer=null}),1e3*this.timeout))}}},54058:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(134);class s{constructor(t,e,r){(0,i.A)(this,"task",void 0),(0,i.A)(this,"timeout",void 0),(0,i.A)(this,"interval",void 0),(0,i.A)(this,"timer",void 0),this.task=t,this.timeout=e,this.interval=r}start(){const t=this;t.stop();let e=t.timeout;const r=t.interval,i=function(){!1!==t.task()&&t.timer?t.timer=setTimeout(i,t.interval):t.stop()};null==e&&(e=r),t.timer=setTimeout(i,e)}stop(){this.timer&&(clearTimeout(this.timer),this.timer=null)}updateInterval(t){this.interval=t}isStarted(){return!!this.timer}destroy(){this.stop(),this.task=this.timeout=this.interval=null}}},47222:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(80662),a=r.n(s);function n(t){t.addEventListener("message",(e=>{var r;let i=e.data.data;setTimeout((()=>{t.postMessage({type:"pong",id:i.id})}),Math.max(null!==(r=i.timeout)&&void 0!==r?r:0,4))}))}class o{constructor(){(0,i.A)(this,"worker",void 0),(0,i.A)(this,"workerUrl",void 0),(0,i.A)(this,"taskMap",void 0),(0,i.A)(this,"id",void 0),this.id=0,this.taskMap=new(a());const t=`\n      ${n.toString()}\n      ${n.name}(self)\n    `,e=new Blob([t],{type:"text/javascript"});this.workerUrl=URL.createObjectURL(e),this.worker=new Worker(this.workerUrl),this.worker.addEventListener("message",(t=>{const e=t.data,r=e.type,i=e.id;if("pong"===r){const t=this.taskMap.get(i);t&&t(!0)}}))}setTimeout(t,e=0){const r=this.id++;return this.taskMap.set(r,t),this.worker.postMessage({type:"ping",data:{timeout:e,id:r}}),r}clearTimeout(t){this.taskMap.delete(t)}destroy(){this.worker&&(this.worker.terminate(),this.worker=null),this.workerUrl&&(URL.revokeObjectURL(this.workerUrl),this.workerUrl=null),this.taskMap&&(this.taskMap.clear(),this.taskMap=null)}}},38724:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(6253);class a{constructor(t,e,r){(0,i.A)(this,"task",void 0),(0,i.A)(this,"timeout",void 0),(0,i.A)(this,"interval",void 0),(0,i.A)(this,"clock",void 0),(0,i.A)(this,"started",void 0),(0,i.A)(this,"timer",void 0),this.task=t,this.timeout=e,this.interval=r,this.started=!1,this.clock=new s.A(this.interval,!1,!0),this.clock.onClock=t=>{this.started&&!1===this.task()?this.stop():t()}}start(){this.started=!0,this.timeout>0?this.timer=setTimeout((()=>{this.timer=null,this.clock.start()}),this.timeout):this.clock.start()}stop(){this.started=!1,this.clock.stop(),this.timer&&(clearTimeout(this.timer),this.timer=null)}isStarted(){return this.started}updateInterval(t){this.interval=t,this.clock.setInterval(t)}destroy(){this.clock&&(this.stop(),this.clock.destroy(),this.clock=null),this.started=!1,this.task=this.timeout=this.interval=null}}},72739:(t,e,r)=>{"use strict";r.d(e,{$r:()=>l,El:()=>u,FB:()=>p,TF:()=>d,VC:()=>c,_:()=>f,__:()=>n,zy:()=>h});var i=r(67672),s=r(10576),a=r(56401);function n(t,e,r){if(!t)return;const{length:i}=t;if(i)if(r)for(let r=i-1;r>=0&&e(t[r],r)!==s.W8;r--);else for(let r=0;r<i&&e(t[r],r)!==s.W8;r++);}function o(t,e){t[t.length]=e}function c(t,e){!function(t,e,r){i.YO(e)?n(e,(function(e){r(t,e)})):r(t,e)}(t,e,o)}function d(t,e,r){let i=0;return n(t,(function(a,n){(r===s.W8?a==e:a===e)&&(t.splice(n,1),i++)}),s.rT),i}function h(t,e,r){return function(t,e,r){let i=s.Cy;return n(t,(function(t,a){if(r===s.W8?t==e:t===e)return i=a,s.W8})),i}(t,e,r)>=0}function l(t){return i.YO(t)?t:(0,a.A)(s.Ml.slice,t)}function u(t,e){let r=0,i=t.length-1,s=-1;for(;r<=i;){let a=(r+i)/2>>>0;const n=e(t[a]);if(0===n){s=a;break}1===n?r=a+1:(i=a-1,s=a)}return s}function f(t,e,r){const i=u(t,r);i>-1?t.splice(i,0,e):t.push(e)}function p(t,e){if(t===e)return!0;if(!t||!e)return!1;if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}},90932:(t,e,r)=>{"use strict";r.d(e,{l:()=>s});const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";function s(t,e=!0){const r=t.length;let s=0,a=0,n="";for(let e=0;e<r;e++)for(a=a<<8|t[e],s+=8;s>=5;)n+=i[a>>>s-5&31],s-=5;if(s>0&&(n+=i[a<<5-s&31]),e)for(;n.length%8!=0;)n+="=";return n}},4919:(t,e,r)=>{"use strict";r.d(e,{E_:()=>a});var i=r(72739);const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function a(t){const e="function"==typeof atob?atob(t):function(t){function e(t){const e=s.indexOf(t);return-1===e?0:e}let r="";for(let i=0;i<t.length;){const s=e(t[i++]),a=e(t[i++]),n=e(t[i++]),o=e(t[i++]),c=s<<2|a>>4,d=(15&a)<<4|n>>2,h=(3&n)<<6|o;r+=String.fromCharCode(c),64!==n&&(r+=String.fromCharCode(d)),64!==o&&(r+=String.fromCharCode(h))}return r}(t),r=new Uint8Array(e.length);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r}const n={};i.__(["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],((t,e)=>{n[t]=e}))},43607:(t,e,r)=>{"use strict";function i(t){return t>0?t:-t}function s(t,e){return t>e?t:e}function a(t,e){return t>e?e:t}r.d(e,{T9:()=>s,jk:()=>a,tn:()=>i})},86834:(t,e,r)=>{"use strict";r.d(e,{A:()=>p});var i=r(29967),s=r.n(i),a=r(72739),n=r(67672),o=r(84504),c=r(44690);function d(t){return n.Yj(t)&&t.split(".").shift()||""}const h=[["alipay",/alipay/],["wechat",/micromessenger/],["dingtalk",/dingtalk[ \/]([\d_.]+)/],["baiduApp",/baiduboxapp/],["baidu",/baidubrowser/],["baidu",/bdbrowser/],["uc",/ucbrowser/],["uc",/ucweb/],["qq",/qqbrowser/],["qqApp",/qq/],["ie",/iemobile[ \/]([\d_.]+)/],["ie",/msie[ \/]([\d_.]+)/],["ie",/trident[ \/]([\d_.]+)/,4],["edge",/edge[ \/]([\d_.]+)/],["newEdge",/edg[ \/]([\d_.]+)/],["chrome",/chrome[ \/]([\d_.]+)/],["firefox",/firefox[ \/]([\d_.]+)/],["opera",/opera(?:.*version)?[ \/]([\d_.]+)/],["safari",/version[ \/]([\d_.]+) safari/],["safari",/version[ \/]([\d_.]+) \S* safari/],["safari",/safari/]],l={},u={},f=function(t){let e,r;return(0,a.__)(h,(i=>{let a=i[1].exec(t);if(a)return e=i[0],r=a[1],r&&(r=r.replace(/_/g,"."),i[2]&&(r=s()(r,10)+i[2]+".0")),!1})),"safari"!==e||r||(r=c.A.version),{name:e||"",version:r||"",majorVersion:(l[e]||d)(r),checkVersion:u[e]||o.A}}(("object"==typeof navigator&&navigator.userAgent||"").toLowerCase());f.name&&(f[f.name]=!0);const p=f},10576:(t,e,r)=>{"use strict";r.d(e,{Cq:()=>o,Cy:()=>d,M_:()=>p,Ml:()=>v,TK:()=>m,W8:()=>n,ZG:()=>u,ZH:()=>c,aV:()=>h,rT:()=>a,s0:()=>l,u1:()=>A,x7:()=>g});var i=r(7403),s=r.n(i);const a=!0,n=!1,o=null,c=void 0,d=-1,h="undefined",l="function",u=".",f=typeof window!==h?window:c,p=(typeof document!==h&&document,typeof globalThis!==h?globalThis:typeof r.g!==h?r.g:f),m=typeof self!==h?self:p,g=function(){},v=(s()({}),s()([])),A=""},67672:(t,e,r)=>{"use strict";r.d(e,{Ik:()=>h,Pc:()=>c,YO:()=>d,Yj:()=>l,ai:()=>u,o:()=>f,sH:()=>m,sv:()=>g,zM:()=>p});var i=r(68632),s=r.n(i),a=r(88032),n=r.n(a),o=r(10576);function c(t){return typeof t===o.s0}function d(t){return s()(t)}function h(t){return t!==o.Cq&&"object"==typeof t}function l(t){return"string"==typeof t}function u(t){return"number"==typeof t&&!isNaN(t)}function f(t){return"bigint"==typeof t}function p(t){return"boolean"==typeof t}function m(t){return u(t)||l(t)&&!isNaN(n()(t))&&isFinite(+t)}function g(t){return t instanceof ArrayBuffer}},10534:(t,e,r)=>{"use strict";r.d(e,{__:()=>a}),r(20525);var i=r(10576);const s={};function a(t,e){const r=s.hasOwnProperty(t)?s[t]:s[t]=t.split(i.ZG);for(let t=0,s=r.length-1;t<=s&&e(r[t],t===s)!==i.W8;t++);}},4624:(t,e,r)=>{"use strict";r.d(e,{R8:()=>b,V$:()=>v,Yz:()=>A,h2:()=>k,pq:()=>y,rD:()=>o,z3:()=>w});var i=r(10576),s=r(62100);const a=0,n=1,o=2,c=3,d=4,h=5,l=typeof console!==i.aV?console:i.Cq,u=/common/.test((0,s.A)(i.x7))?o:c,f=l?function(t,e){l.log(t,e)}:i.x7,p=l?function(t,e){l.warn(t,e)}:i.x7,m=l?function(t,e){l.error(t,e)}:i.x7;function g(){if(i.M_){const t=i.TK.COMMON_LOG_LEVEL;if(t>=a&&t<=h)return t}return u}function v(t){i.TK.COMMON_LOG_LEVEL=t}function A(t,e,r){g()<=n&&f(`[${arguments[1]}][line ${arguments[2]}] [debug]`,t)}function y(t,e,r){g()<=o&&f(`[${arguments[1]}][line ${arguments[2]}] [info]`,t)}function b(t,e,r){g()<=c&&p(`[${arguments[1]}][line ${arguments[2]}] [warn]`,t)}function w(t,e,r){g()<=d&&m(`[${arguments[1]}][line ${arguments[2]}] [error]`,t)}function k(t,e,r){if(g()<=h)throw w(t,e,r),new Error(`[${arguments[1]}][line ${arguments[2]}] [fatal]: ${t}`)}},95335:(t,e,r)=>{"use strict";r.d(e,{C:()=>f,HP:()=>d,X$:()=>u,__:()=>h});var i=r(69736),s=r.n(i),a=r(67672),n=r(72739),o=r(10576),c=(r(10534),r(34677));function d(t){return(0,c.A)(t)?s()(t):[]}function h(t,e){for(let r in t)if(e(t[r],r)===o.W8)break}function l(t,e){return a.Ik(t)?a.Ik(e)?(h(e,(function(e,r){t[r]=e})),t):t:e}function u(t,e,r){return l(l(t,e),r)}function f(t,e){let r=t;return a.YO(t)?e?(r=[],n.__(t,(function(t,i){r[i]=f(t,e)}))):r=t.slice():a.Ik(t)&&(r={},h(t,(function(t,i){r[i]=e?f(t,e):t}))),r}},44690:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(72739);const s=[["harmony",/harmonyos ([\d_.]+)/],["harmony",/openharmony ([\d_.]+)/],["iphone",/iphone os ([\d_.]+)/],["ipad",/ipad; cpu os ([\d_.]+)/],["itouch",/itouch; cpu os ([\d_.]+)/],["android",/android ([\d_.]+)/],["wp",/windows phone ([\d_.]+)/],["windows",/windows nt ([\d_.]+)/],["linux",/linux/],["mac",/mac os x ([\d_.]+)/]],a=function(t){let e,r;return(0,i.__)(s,(i=>{let s=i[1].exec(t);if(s)return e=i[0],r=s[1],r&&(r=r.replace(/_/g,".")),!1})),{name:e||"",version:r||"",mobile:t.indexOf("mobile")>-1}}(("object"==typeof navigator&&navigator.userAgent||"").toLowerCase());a.name&&(a[a.name]=!0,{iphone:1,ipad:1,itouch:1}[a.name]&&(a.ios=!0));const n=a},20525:(t,e,r)=>{"use strict";r.d(e,{GP:()=>l,di:()=>c,qh:()=>d,zy:()=>h});var i=r(29967),s=r.n(i),a=r(67672),n=r(10576),o=r(62100);function c(t,e,r){return a.ai(r)?e===r?n.u1:t.slice(e,r):t.slice(e)}function d(t,e,r){return t.indexOf(e,r!==n.ZH?r:0)}function h(t,e){return d(t,e)>=0}function l(t,...e){let r=0;const i=e.length;return t.replace(/(%[sdvx%])|(%0(\d)+[dx])/g,(t=>{if(r>=i)return t;const a=e[r++];if(/%0(\d)+[dx]/g.test(t)){const e=s()(t.substring(1));let r="d"===t[t.length-1]?(0,o.A)(Number(a)):Number(a).toString(16);return e>r.length&&(r=new Array(e-r.length).fill("0").join("")+r),r}switch(t){case"%%":return"%";case"%s":return String(a);case"%d":return(0,o.A)(Number(a));case"%v":return"";case"%x":return Number(a).toString(16)}return t}))}},95797:(t,e,r)=>{"use strict";r.d(e,{A:()=>d});var i=r(20149),s=r.n(i),a=r(54568),n=r(39638),o=r(86834),c=r(44690);const d=function(){let t="function"==typeof Blob,e="object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate,r="function"==typeof fetch,i="object"==typeof document&&document.createElement("canvas"),d=i&&!!i.getContext("webgl"),h="function"==typeof OffscreenCanvas,l="function"==typeof Worker,u="function"==typeof ArrayBuffer,f="object"==typeof Atomics&&"Atomics"===Atomics[s()],p="function"==typeof AudioContext||"function"==typeof webkitAudioContext,m="function"==typeof AudioWorklet,g="function"==typeof VideoDecoder,v="function"==typeof VideoEncoder,A="function"==typeof AudioDecoder,y="function"==typeof AudioEncoder,b="function"==typeof SharedArrayBuffer,w="function"==typeof MediaSource||"function"==typeof ManagedMediaSource,k="function"==typeof Proxy,x=(l||(0,n.A)()||(0,a.A)())&&b&&f&&k,I="function"==typeof WebAssembly.Suspending&&"function"==typeof WebAssembly.promising;(o.A.safari&&!o.A.checkVersion(o.A.majorVersion,"11",!0)||c.A.ios&&!o.A.checkVersion(c.A.version,"11",!0))&&(e=!1),o.A.chrome&&!o.A.checkVersion(o.A.majorVersion,"94",!0)&&(g=!1,A=!1),(o.A.safari&&!o.A.checkVersion(o.A.majorVersion,"17",!0)||c.A.ios&&!o.A.checkVersion(c.A.version,"17",!0))&&(g=!1);let T="object"==typeof navigator&&"object"==typeof navigator.gpu,P="function"==typeof MediaSourceHandle,S=e&&"function"==typeof WebAssembly.Global,_="function"==typeof MediaStreamTrackGenerator;return{browser:o.A,blob:t,wasm:e,fetch:r,webgl:d,worker:l,mse:w,arrayBuffer:u,audioContext:p,audioWorklet:m,videoDecoder:g,videoEncoder:v,audioDecoder:A,audioEncoder:y,atomics:f,shareArrayBuffer:b,thread:x,webgpu:T,offscreenCanvas:h,workerMSE:P,webAssemblyGlobal:S,jspi:I,proxy:k,simd:(o.A.chrome||o.A.newEdge)&&o.A.checkVersion(o.A.majorVersion,"91",!0)||o.A.firefox&&o.A.checkVersion(o.A.majorVersion,"89",!0)||o.A.safari&&o.A.checkVersion(o.A.version,"16.4",!0)||c.A.ios&&o.A.checkVersion(c.A.version,"16.4",!0),wasmPlayerSupported:r&&e&&d&&p&&u&&S,wasmBaseSupported:e&&S&&u,trackGenerator:_}}()},50011:(t,e,r)=>{"use strict";r.r(e),r.d(e,{decode:()=>o,encode:()=>a});const i="function"==typeof TextEncoder?new TextEncoder:null,s="function"==typeof TextDecoder?new TextDecoder:null;function a(t){if(i)return i.encode(t);const e=[];for(let r=0;r<t.length;++r){let i=t.charCodeAt(r);i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&t.charCodeAt(++r)),i<=127?e.push(i):i<=2047?(e.push(192|i>>6),e.push(128|63&i)):i<=65535?(e.push(224|i>>12),e.push(128|i>>6&63),e.push(128|63&i)):(e.push(240|i>>18),e.push(128|i>>12&63),e.push(128|i>>6&63),e.push(128|63&i))}return new Uint8Array(e)}function n(t){let e="";for(let r=0;r<t.length;){let i=t[r++>>>0];if(!(128&i)){e+=String.fromCharCode(i);continue}let s=63&t[r++>>>0];if(192==(224&i)){e+=String.fromCharCode((31&i)<<6|s);continue}let a=63&t[r++>>>0];if(i=224==(240&i)?(15&i)<<12|s<<6|a:(7&i)<<18|s<<12|a<<6|63&t[r++>>>0],i<65536)e+=String.fromCharCode(i);else{let t=i-65536;e+=String.fromCharCode(55296|t>>10,56320|1023&t)}}return e}function o(t){if(t instanceof Uint8Array&&s&&!("function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer))try{return s.decode(t)}catch(e){return n(t)}return n(t)}},54825:(t,e,r)=>{"use strict";function i(t){if(!t)return-BigInt(1);let e=(t=t.trim()).split(":"),r=BigInt(0);return 3===e.length&&(r+=BigInt(+e.shift().trim())*BigInt(36e5)),r+=BigInt(+e.shift().trim())*BigInt(6e4),e=e.shift().trim().split("."),r+=BigInt(+e.shift().trim())*BigInt(1e3),e.length&&(r+=BigInt(+e.shift().trim())),r}function s(t){if(!t)return-BigInt(1);let e=(t=t.trim()).split(":"),r=BigInt(0);return 3===e.length&&(r+=BigInt(+e.shift().trim())*BigInt(36e5)),r+=BigInt(+e.shift().trim())*BigInt(6e4),e=e.shift().trim().split(","),r+=BigInt(+e.shift().trim())*BigInt(1e3),e.length&&(r+=BigInt(+e.shift().trim())),r}r.d(e,{j:()=>i,t:()=>s})},8507:(t,e,r)=>{"use strict";function i(t){const e=t,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],i=/:\/\/([^\/@]*@?)\[(\S+)\]/;let s="";i.test(t)&&(t=t.replace(i,((t,e,r)=>(s=r,`://${e||""}a.b`))));const a={},n=/^(?:(?![^:@\/]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@\/]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);let o=14;for(;o--;){var c;a[r[o]]=null!==(c=n[o])&&void 0!==c?c:""}return s&&(a.host=s,a.source=e,a.authority=s+(a.port?":"+a.port:"")),{protocol:a.protocol,file:a.file,host:a.host,port:a.port,user:a.user,password:a.password,origin:`${a.protocol}://${a.authority}`,pathname:a.path,search:`?${a.query}`,hash:a.anchor?`#${a.anchor}`:""}}r.d(e,{ll:()=>l,qg:()=>i}),r(73146),r(67672),r(6498),r(72739),r(95335);const s=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,n=/^(?=([^\/?#]*))\1([^]*)$/,o=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/;function c(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}function d(t){const e=o.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null}function h(t){for(t=t.split("").reverse().join("").replace(s,"");t.length!==(t=t.replace(a,"")).length;);return t.split("").reverse().join("")}function l(t,e,r){if(r=r||{},t=t.trim(),!(e=e.trim())){if(!r.alwaysNormalize)return t;let e=d(t);if(!e)throw new Error("Error trying to parse base URL.");return e.path=h(e.path),c(e)}let i=d(e);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return r.alwaysNormalize?(i.path=h(i.path),c(i)):e;let s=d(t);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){let t=n.exec(s.path);s.netLoc=t[1],s.path=t[2]}s.netLoc&&!s.path&&(s.path="/");const a={scheme:s.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(a.netLoc=s.netLoc,"/"!==i.path[0]))if(i.path){let t=s.path,e=t.substring(0,t.lastIndexOf("/")+1)+i.path;a.path=h(e)}else a.path=s.path,i.params||(a.params=s.params,i.query||(a.query=s.query));return null===a.path&&(a.path=r.alwaysNormalize?h(i.path):i.path),c(a)}},88096:(t,e,r)=>{"use strict";r.d(e,{$z:()=>f,GW:()=>c,WP:()=>h,bx:()=>p,p2:()=>l,tt:()=>u});var i=r(729),s=r(31865),a=r(86834),n=r(44690);function o(t){let e=0,r=0;for(;;){const i=t.readUint8();if(e|=(127&i)<<r,r+=7,!(128&i))break}return e}async function c(t){let e=0,r=0;for(;;){const i=await t.readUint8();if(e|=(127&i)<<r,r+=7,!(128&i))break}return e}function d(t){let e,r=0,i=0;for(;e=t.readUint8(),r|=(127&e)<<i,i+=7,128&e;);return 64&e&&(r|=-1<<i),r}async function h(t){let e,r=0,i=0;for(;e=await t.readUint8(),r|=(127&e)<<i,i+=7,128&e;);return 64&e&&(r|=-1<<i),r}function l(t,e){let r=!0;for(;r;){let i=127&e;0==(e>>=7)&&!(64&i)||-1===e&&64&i?r=!1:i|=128,t.writeUint8(i)}}function u(t,e){do{let r=127&e;0!=(e>>=7)&&(r|=128),t.writeUint8(r)}while(0!==e)}async function f(t,e){do{let r=127&e;0!=(e>>=7)&&(r|=128),await t.writeUint8(r)}while(0!==e)}function p(t,e){const r=new s.A(t,!0),c=new i.A(new Uint8Array(t.length+100),!0);for(c.writeBuffer(r.readBuffer(8));r.remainingSize();){const t=r.readUint8();c.writeUint8(t);const s=o(r);if(2===t){const t=new i.A(new Uint8Array(s+100));let h=o(r);for(u(t,h);h--;){const i=o(r);u(t,i),t.writeBuffer(r.readBuffer(i));const s=o(r);u(t,s),t.writeBuffer(r.readBuffer(s));const c=r.readUint8();switch(t.writeUint8(c),c){case 0:u(t,o(r));break;case 3:l(t,d(r)),u(t,o(r));break;case 2:{let i=o(r);e.shared?u(t,2|i):u(t,-3&i);const s=o(r);if(u(t,e.initial||s),1&i){let i=o(r);!e.maximum||n.A.ios&&!a.A.checkVersion(n.A.version,"17",!0)&&e.shared||(i=e.maximum),u(t,i)}break}case 1:{l(t,d(r));const e=o(r);u(t,e),u(t,o(r)),1&e&&u(t,o(r));break}}}const f=t.getWroteBuffer();u(c,f.length),c.writeBuffer(f)}else u(c,s),c.writeBuffer(r.readBuffer(s))}return c.getWroteBuffer()}},79331:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(68632),s=r.n(i),a=r(72739);const n={aloneValueName:"_@attribute"},o=[" ","/",'"',"'","<",">"];function c(t,e=n){t=(t=(t=(t=t.replace(/<!--[\s\S]*?-->/g,"")).replace(/[\n\t\r]/g,"")).replace(/>[ \t]+</g,"><")).replace(/<\?[^>]*\?>/g,"");const r=[];let i=0;function c(t,i){const a=r[r.length-1];a&&(t!==e.aloneValueName||null==a.obj[e.aloneValueName]?null==a.obj[t]?a.obj[t]=i:s()(a.obj[t])?a.obj[t].push(i):a.obj[t]=[a.obj[t],i]:a.obj[e.aloneValueName]=[a.obj[e.aloneValueName],{tagName:t,...i}])}function d(e){for(;i<t.length;){if(t[i]===e)return!0;i++}return!1}function h(){l();let e="";for(;i<t.length&&!a.zy(o,t[i]);)e+=t[i],i++;return e}function l(){for(;i<t.length&&/\s|\r|\n/.test(t[i]);)i++}const u=/\s/,f=/'/,p=/"/;function m(){if(i>=t.length)return!0;l();let e=u;'"'!==t[i]&&"'"!=t[i]||(e='"'===t[i]?p:f,i++);let r="";for(;i<t.length;){if(e.test(t[i])){i++;break}r+=t[i],i++}return r}function g(){l();let e="";for(;i<t.length&&"<"!==t[i];)e+=t[i],i++;return e}function v(){for(;"<"===t[i];){const e=i;if(i++,l(),"/"!==t[i]){i=e;break}if(i++,h()===r[r.length-1].tag){if(r.length>1){const t=r.pop();c(t.tag,t.obj)}d(">"),i++,l()}else r.pop(),d(">"),i++,l()}}return function s(){if(i>=t.length)return;let a=i;if(l(),"<"!==t[i])return i=a,c(e.aloneValueName,g()),v(),s();let n=d("<");if(!n)return;a=i,i++;const o=h();if(r.push({obj:{},tag:o,start:a}),function(){for(;l(),">"!==t[i]&&"/"!==t[i];){let t=h();if(!t)break;"="===t[t.length-1]?t=t.substring(0,t.length-1):(d("="),i++),c(t,m())}}(),l(),"/"===t[i]){if(i++,r.length>1){const t=r.pop();c(t.tag,t.obj)}return d(">"),i++,v(),s()}n=d(">"),n&&(i++,l(),"<"!==t[i]&&(c(e.aloneValueName,g()),l()),v(),s())}(),{[r[0].tag]:r[0].obj}}},34268:(t,e,r)=>{"use strict";var i=r(134),s=r(54001),a=r.n(s),n=r(84149),o=r(87503),c=r(67672),d=r(4624),h=r(44690);let l=h.A.windows||h.A.mac||h.A.linux?10:20;class u extends o.A{constructor(){super(),(0,i.A)(this,"pullIPC",void 0),(0,i.A)(this,"frontBuffer",void 0),(0,i.A)(this,"backBuffer",void 0),(0,i.A)(this,"channels",void 0),(0,i.A)(this,"backBufferOffset",void 0),(0,i.A)(this,"ended",void 0),(0,i.A)(this,"frontBuffered",void 0),(0,i.A)(this,"pause",void 0),(0,i.A)(this,"firstRendered",void 0),(0,i.A)(this,"stopped",void 0),(0,i.A)(this,"afterPullResolve",void 0),(0,i.A)(this,"lastStutterTimestamp",void 0),this.ended=!1,this.pause=!0,this.ipcPort.on(n.S3,(async t=>{switch(t.method){case"init":t.params&&t.params.bufferLength&&(l=t.params.bufferLength),this.ipcPort.reply(t);break;case"start":{const{port:e,channels:r}=t.params;this.channels=r,this.pullIPC=new n.Ay(e);const i=[],s=[];await this.pull(i),await this.pull(s),this.frontBuffer=s,this.backBuffer=i,this.backBufferOffset=0,this.ended=!1,this.frontBuffered=!0,this.pause=!1,this.firstRendered=!1,this.stopped=!1,this.lastStutterTimestamp=currentTime,this.ipcPort.reply(t);break}case"restart":{if(!this.ended)return void this.ipcPort.reply(t);const e=[],r=[];await this.pull(e),await this.pull(r),this.frontBuffer=r,this.backBuffer=e,this.backBufferOffset=0,this.ended=!1,this.frontBuffered=!0,this.pause=!1,this.firstRendered=!1,this.stopped=!1,this.lastStutterTimestamp=currentTime,this.ipcPort.reply(t);break}case"clear":this.backBufferOffset=l,this.ipcPort.reply(t);break;case"stop":this.ended||this.pause||this.frontBuffered||await new(a())((t=>{this.afterPullResolve=t})),this.stopped=!0,this.pullIPC.destroy(),this.ipcPort.reply(t);break;case"pause":this.pause=!0,this.ipcPort.reply(t);break;case"unpause":this.pause=!1,this.ipcPort.reply(t)}}))}async pull(t){const e=await this.pullIPC.request("pullBuffer",{nbSamples:128*l});if(c.ai(e))this.ended=!0;else{const r=new Float32Array(e);for(let e=0;e<this.channels;e++)t[e]=r.subarray(e*l*128,(e+1)*l*128)}this.afterPullResolve&&this.afterPullResolve()}swapBuffer(){return!!this.frontBuffered&&(this.backBuffer=this.frontBuffer,this.backBufferOffset=0,this.frontBuffer=[],this.frontBuffered=!1,this.pull(this.frontBuffer).then((()=>{this.frontBuffered=!0})),!0)}process(t,e,r){if(this.stopped)return!1;if(this.backBuffer&&!this.pause){if(this.backBufferOffset===l){if(this.ended)return this.backBuffer=null,this.frontBuffer=null,d.pq("audio source ended","src\\avrender\\pcm\\AudioSourceWorkletProcessor.ts",207),this.ipcPort.notify("ended"),!0;if(!this.swapBuffer())return currentTime-this.lastStutterTimestamp>1&&(this.ipcPort.notify("stutter"),this.lastStutterTimestamp=currentTime),!0}const t=e[0];for(let e=0;e<this.channels;e++)t[e].set(this.backBuffer[e].subarray(128*this.backBufferOffset,128*(this.backBufferOffset+1)),0);this.backBufferOffset++,this.firstRendered||(this.firstRendered=!0,this.ipcPort.notify("firstRendered"))}return!0}}registerProcessor("audio-source-processor",u)},5676:(t,e,r)=>{"use strict";var i=r(134),s=r(54001),a=r.n(s),n=r(63939),o=r(50932),c=r(84149),d=r(87503),h=r(11473),l=(r(10278),r(37837)),u=r(4624),f=r(44690);let p=f.A.windows||f.A.mac||f.A.linux?10:20;class m extends d.A{constructor(){super(),(0,i.A)(this,"pullIPC",void 0),(0,i.A)(this,"frontBuffer",void 0),(0,i.A)(this,"backBuffer",void 0),(0,i.A)(this,"channels",void 0),(0,i.A)(this,"backBufferOffset",void 0),(0,i.A)(this,"ended",void 0),(0,i.A)(this,"frontBuffered",void 0),(0,i.A)(this,"firstRendered",void 0),(0,i.A)(this,"pause",void 0),(0,i.A)(this,"stopped",void 0),(0,i.A)(this,"afterPullResolve",void 0),(0,i.A)(this,"lastStutterTimestamp",void 0),this.ended=!1,this.pause=!0,this.ipcPort.on(c.S3,(async t=>{switch(t.method){case"init":{const{memory:e,bufferLength:r}=t.params;t.params.bufferLength&&(p=r),await(0,h.Tg)({memory:e,disableAsm:!0}),this.ipcPort.reply(t);break}case"start":{const{port:e,channels:r}=t.params;this.channels=r,this.pullIPC=new c.Ay(e);const i=this.allocBuffer(),s=this.allocBuffer();await this.pullIPC.request("pull",{buffer:s}),await this.pullIPC.request("pull",{buffer:i}),this.frontBuffer=i,this.backBuffer=s,this.backBufferOffset=0,this.ended=!1,this.pause=!1,this.frontBuffered=!0,this.firstRendered=!1,this.stopped=!1,this.lastStutterTimestamp=currentTime,this.ipcPort.reply(t);break}case"restart":{if(!this.ended)return void this.ipcPort.reply(t);const e=this.backBuffer?this.backBuffer:this.allocBuffer(),r=this.frontBuffer?this.frontBuffer:this.allocBuffer();await this.pullIPC.request("pull",{buffer:r}),await this.pullIPC.request("pull",{buffer:e}),this.frontBuffer=e,this.backBuffer=r,this.backBufferOffset=0,this.ended=!1,this.pause=!1,this.frontBuffered=!0,this.firstRendered=!1,this.stopped=!1,this.lastStutterTimestamp=currentTime,this.ipcPort.reply(t);break}case"stop":this.ended||this.pause||this.frontBuffered||await new(a())((t=>{this.afterPullResolve=t})),this.freeBuffer(this.backBuffer),this.freeBuffer(this.frontBuffer),this.backBuffer=0,this.frontBuffer=0,this.stopped=!0,this.pullIPC.destroy(),this.ipcPort.reply(t);break;case"clear":this.backBufferOffset=p,this.ipcPort.reply(t);break;case"pause":this.pause=!0,this.ipcPort.reply(t);break;case"unpause":this.pause=!1,this.ipcPort.reply(t)}}))}allocBuffer(){const t=(0,l.Gy)(48);o.M[20](t,(0,l.Gy)(4*this.channels)),o.M[15](t+16,this.channels);const e=(0,l.Gy)(512*p*this.channels);for(let r=0;r<this.channels;r++)o.M[20](n.f[20](t)+4*r,e+128*p*4*r);return o.M[15](t+12,128*p),t}freeBuffer(t){t&&((0,l.aI)(n.f[20](t)),(0,l.aI)(t),(0,l.Eb)(t))}async pull(){await this.pullIPC.request("pull",{buffer:this.frontBuffer})<0&&(this.ended=!0),this.afterPullResolve&&this.afterPullResolve()}swapBuffer(){if(!this.frontBuffered)return!1;{const t=this.backBuffer;this.backBuffer=this.frontBuffer,this.frontBuffer=t,this.backBufferOffset=0}return this.frontBuffered=!1,this.pull().then((()=>{this.frontBuffered=!0})),!0}process(t,e,r){if(this.stopped)return!1;if(this.backBuffer&&!this.pause){if(this.backBufferOffset===p){if(this.ended)return this.freeBuffer(this.backBuffer),this.freeBuffer(this.frontBuffer),this.backBuffer=0,this.frontBuffer=0,u.pq("audio source ended","src\\avrender\\pcm\\AudioSourceWorkletProcessor2.ts",246),this.ipcPort.notify("ended"),!0;if(!this.swapBuffer())return currentTime-this.lastStutterTimestamp>1&&(this.ipcPort.notify("stutter"),this.lastStutterTimestamp=currentTime),!0}const t=e[0];for(let e=0;e<this.channels;e++)t[e].set(new Float32Array((0,h.Lv)(),n.f[20](n.f[20](this.backBuffer)+4*e)+128*this.backBufferOffset*4,128),0);this.backBufferOffset++,this.firstRendered||(this.firstRendered=!0,this.ipcPort.notify("firstRendered"))}return!0}}registerProcessor("audio-source-processor",m)},87503:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(84149);class a extends AudioWorkletProcessor{constructor(){super(),(0,i.A)(this,"ipcPort",void 0),this.ipcPort=new s.Ay(this.port)}async request(t,e,r){return this.ipcPort.request(t,e,r)}notify(t,e,r){this.ipcPort.notify(t,e,r)}}},74385:(t,e,r)=>{r(97863),r(25263),t.exports=r(46438).Array.from},37149:(t,e,r)=>{r(18355),t.exports=r(46438).Array.isArray},87172:(t,e,r)=>{r(23204),t.exports=r(46438).Date.now},85079:(t,e,r)=>{var i=r(46438),s=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return s.stringify.apply(s,arguments)}},92861:(t,e,r)=>{r(78978),r(97863),r(7914),r(96050),r(28337),r(74674),r(62223),t.exports=r(46438).Map},11837:(t,e,r)=>{r(21489),t.exports=r(46438).Number.isNaN},92696:(t,e,r)=>{r(74712);var i=r(46438).Object;t.exports=function(t,e,r){return i.defineProperty(t,e,r)}},22948:(t,e,r)=>{r(51780),t.exports=r(46438).Object.freeze},62160:(t,e,r)=>{r(18128),t.exports=r(46438).Object.getPrototypeOf},47567:(t,e,r)=>{r(96847),t.exports=r(46438).Object.keys},21724:(t,e,r)=>{r(4284),t.exports=r(46438).Object.setPrototypeOf},27279:(t,e,r)=>{r(95828),t.exports=r(46438).parseFloat},25216:(t,e,r)=>{r(65331),t.exports=r(46438).parseInt},34750:(t,e,r)=>{r(78978),r(97863),r(7914),r(91229),r(2639),r(46121),t.exports=r(46438).Promise},31707:(t,e,r)=>{r(66801),t.exports=r(46438).setImmediate},16560:(t,e,r)=>{r(19626),r(78978),r(42860),r(60716),t.exports=r(46438).Symbol},54220:(t,e,r)=>{r(97863),r(7914),t.exports=r(84336).f("iterator")},39967:(t,e,r)=>{t.exports=r(84336).f("toPrimitive")},48652:(t,e,r)=>{r(78978),t.exports=r(84336).f("toStringTag")},25219:t=>{t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},12560:t=>{t.exports=function(){}},2832:t=>{t.exports=function(t,e,r,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(r+": incorrect invocation!");return t}},80812:(t,e,r)=>{var i=r(24401);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},77076:(t,e,r)=>{var i=r(95838);t.exports=function(t,e){var r=[];return i(t,!1,r.push,r,e),r}},84448:(t,e,r)=>{var i=r(65133),s=r(70181),a=r(72917);t.exports=function(t){return function(e,r,n){var o,c=i(e),d=s(c.length),h=a(n,d);if(t&&r!=r){for(;d>h;)if((o=c[h++])!=o)return!0}else for(;d>h;h++)if((t||h in c)&&c[h]===r)return t||h||0;return!t&&-1}}},48219:(t,e,r)=>{var i=r(58852),s=r(7001),a=r(66310),n=r(70181),o=r(99244);t.exports=function(t,e){var r=1==t,c=2==t,d=3==t,h=4==t,l=6==t,u=5==t||l,f=e||o;return function(e,o,p){for(var m,g,v=a(e),A=s(v),y=i(o,p,3),b=n(A.length),w=0,k=r?f(e,b):c?f(e,0):void 0;b>w;w++)if((u||w in A)&&(g=y(m=A[w],w,v),t))if(r)k[w]=g;else if(g)switch(t){case 3:return!0;case 5:return m;case 6:return w;case 2:k.push(m)}else if(h)return!1;return l?-1:d||h?h:k}}},49742:(t,e,r)=>{var i=r(24401),s=r(15461),a=r(30254)("species");t.exports=function(t){var e;return s(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!s(e.prototype)||(e=void 0),i(e)&&null===(e=e[a])&&(e=void 0)),void 0===e?Array:e}},99244:(t,e,r)=>{var i=r(49742);t.exports=function(t,e){return new(i(t))(e)}},44968:(t,e,r)=>{var i=r(93417),s=r(30254)("toStringTag"),a="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),s))?r:a?i(e):"Object"==(n=i(e))&&"function"==typeof e.callee?"Arguments":n}},93417:t=>{var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},95933:(t,e,r)=>{"use strict";var i=r(78423).f,s=r(22087),a=r(30953),n=r(58852),o=r(2832),c=r(95838),d=r(88839),h=r(20322),l=r(45274),u=r(58219),f=r(75172).fastKey,p=r(6096),m=u?"_s":"size",g=function(t,e){var r,i=f(e);if("F"!==i)return t._i[i];for(r=t._f;r;r=r.n)if(r.k==e)return r};t.exports={getConstructor:function(t,e,r,d){var h=t((function(t,i){o(t,h,e,"_i"),t._t=e,t._i=s(null),t._f=void 0,t._l=void 0,t[m]=0,null!=i&&c(i,r,t[d],t)}));return a(h.prototype,{clear:function(){for(var t=p(this,e),r=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete r[i.i];t._f=t._l=void 0,t[m]=0},delete:function(t){var r=p(this,e),i=g(r,t);if(i){var s=i.n,a=i.p;delete r._i[i.i],i.r=!0,a&&(a.n=s),s&&(s.p=a),r._f==i&&(r._f=s),r._l==i&&(r._l=a),r[m]--}return!!i},forEach:function(t){p(this,e);for(var r,i=n(t,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(i(r.v,r.k,this);r&&r.r;)r=r.p},has:function(t){return!!g(p(this,e),t)}}),u&&i(h.prototype,"size",{get:function(){return p(this,e)[m]}}),h},def:function(t,e,r){var i,s,a=g(t,e);return a?a.v=r:(t._l=a={i:s=f(e,!0),k:e,v:r,p:i=t._l,n:void 0,r:!1},t._f||(t._f=a),i&&(i.n=a),t[m]++,"F"!==s&&(t._i[s]=a)),t},getEntry:g,setStrong:function(t,e,r){d(t,e,(function(t,r){this._t=p(t,e),this._k=r,this._l=void 0}),(function(){for(var t=this,e=t._k,r=t._l;r&&r.r;)r=r.p;return t._t&&(t._l=r=r?r.n:t._t._f)?h(0,"keys"==e?r.k:"values"==e?r.v:[r.k,r.v]):(t._t=void 0,h(1))}),r?"entries":"values",!r,!0),l(e)}}},5874:(t,e,r)=>{var i=r(44968),s=r(77076);t.exports=function(t){return function(){if(i(this)!=t)throw TypeError(t+"#toJSON isn't generic");return s(this)}}},99373:(t,e,r)=>{"use strict";var i=r(66670),s=r(88535),a=r(75172),n=r(81984),o=r(2677),c=r(30953),d=r(95838),h=r(2832),l=r(24401),u=r(1356),f=r(78423).f,p=r(48219)(0),m=r(58219);t.exports=function(t,e,r,g,v,A){var y=i[t],b=y,w=v?"set":"add",k=b&&b.prototype,x={};return m&&"function"==typeof b&&(A||k.forEach&&!n((function(){(new b).entries().next()})))?(b=e((function(e,r){h(e,b,t,"_c"),e._c=new y,null!=r&&d(r,v,e[w],e)})),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(t){var e="add"==t||"set"==t;!(t in k)||A&&"clear"==t||o(b.prototype,t,(function(r,i){if(h(this,b,t),!e&&A&&!l(r))return"get"==t&&void 0;var s=this._c[t](0===r?0:r,i);return e?this:s}))})),A||f(b.prototype,"size",{get:function(){return this._c.size}})):(b=g.getConstructor(e,t,v,w),c(b.prototype,r),a.NEED=!0),u(b,t),x[t]=b,s(s.G+s.W+s.F,x),A||g.setStrong(b,t,v),b}},46438:t=>{var e=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=e)},31891:(t,e,r)=>{"use strict";var i=r(78423),s=r(86260);t.exports=function(t,e,r){e in t?i.f(t,e,s(0,r)):t[e]=r}},58852:(t,e,r)=>{var i=r(25219);t.exports=function(t,e,r){if(i(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,i){return t.call(e,r,i)};case 3:return function(r,i,s){return t.call(e,r,i,s)}}return function(){return t.apply(e,arguments)}}},87608:t=>{t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},58219:(t,e,r)=>{t.exports=!r(81984)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},3802:(t,e,r)=>{var i=r(24401),s=r(66670).document,a=i(s)&&i(s.createElement);t.exports=function(t){return a?s.createElement(t):{}}},77956:t=>{t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},36473:(t,e,r)=>{var i=r(54311),s=r(59820),a=r(36569);t.exports=function(t){var e=i(t),r=s.f;if(r)for(var n,o=r(t),c=a.f,d=0;o.length>d;)c.call(t,n=o[d++])&&e.push(n);return e}},88535:(t,e,r)=>{var i=r(66670),s=r(46438),a=r(58852),n=r(2677),o=r(75509),c="prototype",d=function(t,e,r){var h,l,u,f=t&d.F,p=t&d.G,m=t&d.S,g=t&d.P,v=t&d.B,A=t&d.W,y=p?s:s[e]||(s[e]={}),b=y[c],w=p?i:m?i[e]:(i[e]||{})[c];for(h in p&&(r=e),r)(l=!f&&w&&void 0!==w[h])&&o(y,h)||(u=l?w[h]:r[h],y[h]=p&&"function"!=typeof w[h]?r[h]:v&&l?a(u,i):A&&w[h]==u?function(t){var e=function(e,r,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,r)}return new t(e,r,i)}return t.apply(this,arguments)};return e[c]=t[c],e}(u):g&&"function"==typeof u?a(Function.call,u):u,g&&((y.virtual||(y.virtual={}))[h]=u,t&d.R&&b&&!b[h]&&n(b,h,u)))};d.F=1,d.G=2,d.S=4,d.P=8,d.B=16,d.W=32,d.U=64,d.R=128,t.exports=d},81984:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},95838:(t,e,r)=>{var i=r(58852),s=r(27904),a=r(12828),n=r(80812),o=r(70181),c=r(55298),d={},h={},l=t.exports=function(t,e,r,l,u){var f,p,m,g,v=u?function(){return t}:c(t),A=i(r,l,e?2:1),y=0;if("function"!=typeof v)throw TypeError(t+" is not iterable!");if(a(v)){for(f=o(t.length);f>y;y++)if((g=e?A(n(p=t[y])[0],p[1]):A(t[y]))===d||g===h)return g}else for(m=v.call(t);!(p=m.next()).done;)if((g=s(m,A,p.value,e))===d||g===h)return g};l.BREAK=d,l.RETURN=h},66670:t=>{var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},75509:t=>{var e={}.hasOwnProperty;t.exports=function(t,r){return e.call(t,r)}},2677:(t,e,r)=>{var i=r(78423),s=r(86260);t.exports=r(58219)?function(t,e,r){return i.f(t,e,s(1,r))}:function(t,e,r){return t[e]=r,t}},76260:(t,e,r)=>{var i=r(66670).document;t.exports=i&&i.documentElement},32484:(t,e,r)=>{t.exports=!r(58219)&&!r(81984)((function(){return 7!=Object.defineProperty(r(3802)("div"),"a",{get:function(){return 7}}).a}))},20709:t=>{t.exports=function(t,e,r){var i=void 0===r;switch(e.length){case 0:return i?t():t.call(r);case 1:return i?t(e[0]):t.call(r,e[0]);case 2:return i?t(e[0],e[1]):t.call(r,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(r,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(r,e[0],e[1],e[2],e[3])}return t.apply(r,e)}},7001:(t,e,r)=>{var i=r(93417);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},12828:(t,e,r)=>{var i=r(20210),s=r(30254)("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||a[s]===t)}},15461:(t,e,r)=>{var i=r(93417);t.exports=Array.isArray||function(t){return"Array"==i(t)}},24401:t=>{t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},27904:(t,e,r)=>{var i=r(80812);t.exports=function(t,e,r,s){try{return s?e(i(r)[0],r[1]):e(r)}catch(e){var a=t.return;throw void 0!==a&&i(a.call(t)),e}}},48248:(t,e,r)=>{"use strict";var i=r(22087),s=r(86260),a=r(1356),n={};r(2677)(n,r(30254)("iterator"),(function(){return this})),t.exports=function(t,e,r){t.prototype=i(n,{next:s(1,r)}),a(t,e+" Iterator")}},88839:(t,e,r)=>{"use strict";var i=r(74742),s=r(88535),a=r(61331),n=r(2677),o=r(20210),c=r(48248),d=r(1356),h=r(66123),l=r(30254)("iterator"),u=!([].keys&&"next"in[].keys()),f="keys",p="values",m=function(){return this};t.exports=function(t,e,r,g,v,A,y){c(r,e,g);var b,w,k,x=function(t){if(!u&&t in S)return S[t];switch(t){case f:case p:return function(){return new r(this,t)}}return function(){return new r(this,t)}},I=e+" Iterator",T=v==p,P=!1,S=t.prototype,_=S[l]||S["@@iterator"]||v&&S[v],M=_||x(v),C=v?T?x("entries"):M:void 0,B="Array"==e&&S.entries||_;if(B&&(k=h(B.call(new t)))!==Object.prototype&&k.next&&(d(k,I,!0),i||"function"==typeof k[l]||n(k,l,m)),T&&_&&_.name!==p&&(P=!0,M=function(){return _.call(this)}),i&&!y||!u&&!P&&S[l]||n(S,l,M),o[e]=M,o[I]=m,v)if(b={values:T?M:x(p),keys:A?M:x(f),entries:C},y)for(w in b)w in S||a(S,w,b[w]);else s(s.P+s.F*(u||P),e,b);return b}},27899:(t,e,r)=>{var i=r(30254)("iterator"),s=!1;try{var a=[7][i]();a.return=function(){s=!0},Array.from(a,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!s)return!1;var r=!1;try{var a=[7],n=a[i]();n.next=function(){return{done:r=!0}},a[i]=function(){return n},t(a)}catch(t){}return r}},20322:t=>{t.exports=function(t,e){return{value:e,done:!!t}}},20210:t=>{t.exports={}},74742:t=>{t.exports=!0},75172:(t,e,r)=>{var i=r(19191)("meta"),s=r(24401),a=r(75509),n=r(78423).f,o=0,c=Object.isExtensible||function(){return!0},d=!r(81984)((function(){return c(Object.preventExtensions({}))})),h=function(t){n(t,i,{value:{i:"O"+ ++o,w:{}}})},l=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!s(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,i)){if(!c(t))return"F";if(!e)return"E";h(t)}return t[i].i},getWeak:function(t,e){if(!a(t,i)){if(!c(t))return!0;if(!e)return!1;h(t)}return t[i].w},onFreeze:function(t){return d&&l.NEED&&c(t)&&!a(t,i)&&h(t),t}}},53792:(t,e,r)=>{var i=r(66670),s=r(8036).set,a=i.MutationObserver||i.WebKitMutationObserver,n=i.process,o=i.Promise,c="process"==r(93417)(n);t.exports=function(){var t,e,r,d=function(){var i,s;for(c&&(i=n.domain)&&i.exit();t;){s=t.fn,t=t.next;try{s()}catch(i){throw t?r():e=void 0,i}}e=void 0,i&&i.enter()};if(c)r=function(){n.nextTick(d)};else if(!a||i.navigator&&i.navigator.standalone)if(o&&o.resolve){var h=o.resolve(void 0);r=function(){h.then(d)}}else r=function(){s.call(i,d)};else{var l=!0,u=document.createTextNode("");new a(d).observe(u,{characterData:!0}),r=function(){u.data=l=!l}}return function(i){var s={fn:i,next:void 0};e&&(e.next=s),t||(t=s,r()),e=s}}},11642:(t,e,r)=>{"use strict";var i=r(25219);function s(t){var e,r;this.promise=new t((function(t,i){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=i})),this.resolve=i(e),this.reject=i(r)}t.exports.f=function(t){return new s(t)}},22087:(t,e,r)=>{var i=r(80812),s=r(90082),a=r(77956),n=r(4566)("IE_PROTO"),o=function(){},c="prototype",d=function(){var t,e=r(3802)("iframe"),i=a.length;for(e.style.display="none",r(76260).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),d=t.F;i--;)delete d[c][a[i]];return d()};t.exports=Object.create||function(t,e){var r;return null!==t?(o[c]=i(t),r=new o,o[c]=null,r[n]=t):r=d(),void 0===e?r:s(r,e)}},78423:(t,e,r)=>{var i=r(80812),s=r(32484),a=r(10752),n=Object.defineProperty;e.f=r(58219)?Object.defineProperty:function(t,e,r){if(i(t),e=a(e,!0),i(r),s)try{return n(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},90082:(t,e,r)=>{var i=r(78423),s=r(80812),a=r(54311);t.exports=r(58219)?Object.defineProperties:function(t,e){s(t);for(var r,n=a(e),o=n.length,c=0;o>c;)i.f(t,r=n[c++],e[r]);return t}},81033:(t,e,r)=>{var i=r(36569),s=r(86260),a=r(65133),n=r(10752),o=r(75509),c=r(32484),d=Object.getOwnPropertyDescriptor;e.f=r(58219)?d:function(t,e){if(t=a(t),e=n(e,!0),c)try{return d(t,e)}catch(t){}if(o(t,e))return s(!i.f.call(t,e),t[e])}},36309:(t,e,r)=>{var i=r(65133),s=r(1743).f,a={}.toString,n="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return n&&"[object Window]"==a.call(t)?function(t){try{return s(t)}catch(t){return n.slice()}}(t):s(i(t))}},1743:(t,e,r)=>{var i=r(85081),s=r(77956).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,s)}},59820:(t,e)=>{e.f=Object.getOwnPropertySymbols},66123:(t,e,r)=>{var i=r(75509),s=r(66310),a=r(4566)("IE_PROTO"),n=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=s(t),i(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?n:null}},85081:(t,e,r)=>{var i=r(75509),s=r(65133),a=r(84448)(!1),n=r(4566)("IE_PROTO");t.exports=function(t,e){var r,o=s(t),c=0,d=[];for(r in o)r!=n&&i(o,r)&&d.push(r);for(;e.length>c;)i(o,r=e[c++])&&(~a(d,r)||d.push(r));return d}},54311:(t,e,r)=>{var i=r(85081),s=r(77956);t.exports=Object.keys||function(t){return i(t,s)}},36569:(t,e)=>{e.f={}.propertyIsEnumerable},47331:(t,e,r)=>{var i=r(88535),s=r(46438),a=r(81984);t.exports=function(t,e){var r=(s.Object||{})[t]||Object[t],n={};n[t]=e(r),i(i.S+i.F*a((function(){r(1)})),"Object",n)}},49709:(t,e,r)=>{var i=r(66670).parseFloat,s=r(24269).trim;t.exports=1/i(r(80459)+"-0")!=-1/0?function(t){var e=s(String(t),3),r=i(e);return 0===r&&"-"==e.charAt(0)?-0:r}:i},15722:(t,e,r)=>{var i=r(66670).parseInt,s=r(24269).trim,a=r(80459),n=/^[-+]?0[xX]/;t.exports=8!==i(a+"08")||22!==i(a+"0x16")?function(t,e){var r=s(String(t),3);return i(r,e>>>0||(n.test(r)?16:10))}:i},41704:t=>{t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},61037:(t,e,r)=>{var i=r(80812),s=r(24401),a=r(11642);t.exports=function(t,e){if(i(t),s(e)&&e.constructor===t)return e;var r=a.f(t);return(0,r.resolve)(e),r.promise}},86260:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},30953:(t,e,r)=>{var i=r(2677);t.exports=function(t,e,r){for(var s in e)r&&t[s]?t[s]=e[s]:i(t,s,e[s]);return t}},61331:(t,e,r)=>{t.exports=r(2677)},643:(t,e,r)=>{"use strict";var i=r(88535),s=r(25219),a=r(58852),n=r(95838);t.exports=function(t){i(i.S,t,{from:function(t){var e,r,i,o,c=arguments[1];return s(this),(e=void 0!==c)&&s(c),null==t?new this:(r=[],e?(i=0,o=a(c,arguments[2],2),n(t,!1,(function(t){r.push(o(t,i++))}))):n(t,!1,r.push,r),new this(r))}})}},44398:(t,e,r)=>{"use strict";var i=r(88535);t.exports=function(t){i(i.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},32074:(t,e,r)=>{var i=r(24401),s=r(80812),a=function(t,e){if(s(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{(i=r(58852)(Function.call,r(81033).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,r){return a(t,r),e?t.__proto__=r:i(t,r),t}}({},!1):void 0),check:a}},45274:(t,e,r)=>{"use strict";var i=r(66670),s=r(46438),a=r(78423),n=r(58219),o=r(30254)("species");t.exports=function(t){var e="function"==typeof s[t]?s[t]:i[t];n&&e&&!e[o]&&a.f(e,o,{configurable:!0,get:function(){return this}})}},1356:(t,e,r)=>{var i=r(78423).f,s=r(75509),a=r(30254)("toStringTag");t.exports=function(t,e,r){t&&!s(t=r?t:t.prototype,a)&&i(t,a,{configurable:!0,value:e})}},4566:(t,e,r)=>{var i=r(96308)("keys"),s=r(19191);t.exports=function(t){return i[t]||(i[t]=s(t))}},96308:(t,e,r)=>{var i=r(46438),s=r(66670),a="__core-js_shared__",n=s[a]||(s[a]={});(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:r(74742)?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},85614:(t,e,r)=>{var i=r(80812),s=r(25219),a=r(30254)("species");t.exports=function(t,e){var r,n=i(t).constructor;return void 0===n||null==(r=i(n)[a])?e:s(r)}},43172:(t,e,r)=>{var i=r(49383),s=r(87608);t.exports=function(t){return function(e,r){var a,n,o=String(s(e)),c=i(r),d=o.length;return c<0||c>=d?t?"":void 0:(a=o.charCodeAt(c))<55296||a>56319||c+1===d||(n=o.charCodeAt(c+1))<56320||n>57343?t?o.charAt(c):a:t?o.slice(c,c+2):n-56320+(a-55296<<10)+65536}}},24269:(t,e,r)=>{var i=r(88535),s=r(87608),a=r(81984),n=r(80459),o="["+n+"]",c=RegExp("^"+o+o+"*"),d=RegExp(o+o+"*$"),h=function(t,e,r){var s={},o=a((function(){return!!n[t]()||""!=""[t]()})),c=s[t]=o?e(l):n[t];r&&(s[r]=c),i(i.P+i.F*o,"String",s)},l=h.trim=function(t,e){return t=String(s(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(d,"")),t};t.exports=h},80459:t=>{t.exports="\t\n\v\f\r \u2028\u2029\ufeff"},8036:(t,e,r)=>{var i,s,a,n=r(58852),o=r(20709),c=r(76260),d=r(3802),h=r(66670),l=h.process,u=h.setImmediate,f=h.clearImmediate,p=h.MessageChannel,m=h.Dispatch,g=0,v={},A="onreadystatechange",y=function(){var t=+this;if(v.hasOwnProperty(t)){var e=v[t];delete v[t],e()}},b=function(t){y.call(t.data)};u&&f||(u=function(t){for(var e=[],r=1;arguments.length>r;)e.push(arguments[r++]);return v[++g]=function(){o("function"==typeof t?t:Function(t),e)},i(g),g},f=function(t){delete v[t]},"process"==r(93417)(l)?i=function(t){l.nextTick(n(y,t,1))}:m&&m.now?i=function(t){m.now(n(y,t,1))}:p?(a=(s=new p).port2,s.port1.onmessage=b,i=n(a.postMessage,a,1)):h.addEventListener&&"function"==typeof postMessage&&!h.importScripts?(i=function(t){h.postMessage(t+"","*")},h.addEventListener("message",b,!1)):i=A in d("script")?function(t){c.appendChild(d("script"))[A]=function(){c.removeChild(this),y.call(t)}}:function(t){setTimeout(n(y,t,1),0)}),t.exports={set:u,clear:f}},72917:(t,e,r)=>{var i=r(49383),s=Math.max,a=Math.min;t.exports=function(t,e){return(t=i(t))<0?s(t+e,0):a(t,e)}},49383:t=>{var e=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},65133:(t,e,r)=>{var i=r(7001),s=r(87608);t.exports=function(t){return i(s(t))}},70181:(t,e,r)=>{var i=r(49383),s=Math.min;t.exports=function(t){return t>0?s(i(t),9007199254740991):0}},66310:(t,e,r)=>{var i=r(87608);t.exports=function(t){return Object(i(t))}},10752:(t,e,r)=>{var i=r(24401);t.exports=function(t,e){if(!i(t))return t;var r,s;if(e&&"function"==typeof(r=t.toString)&&!i(s=r.call(t)))return s;if("function"==typeof(r=t.valueOf)&&!i(s=r.call(t)))return s;if(!e&&"function"==typeof(r=t.toString)&&!i(s=r.call(t)))return s;throw TypeError("Can't convert object to primitive value")}},19191:t=>{var e=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+r).toString(36))}},80218:(t,e,r)=>{var i=r(66670).navigator;t.exports=i&&i.userAgent||""},6096:(t,e,r)=>{var i=r(24401);t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},67816:(t,e,r)=>{var i=r(66670),s=r(46438),a=r(74742),n=r(84336),o=r(78423).f;t.exports=function(t){var e=s.Symbol||(s.Symbol=a?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||o(e,t,{value:n.f(t)})}},84336:(t,e,r)=>{e.f=r(30254)},30254:(t,e,r)=>{var i=r(96308)("wks"),s=r(19191),a=r(66670).Symbol,n="function"==typeof a;(t.exports=function(t){return i[t]||(i[t]=n&&a[t]||(n?a:s)("Symbol."+t))}).store=i},55298:(t,e,r)=>{var i=r(44968),s=r(30254)("iterator"),a=r(20210);t.exports=r(46438).getIteratorMethod=function(t){if(null!=t)return t[s]||t["@@iterator"]||a[i(t)]}},25263:(t,e,r)=>{"use strict";var i=r(58852),s=r(88535),a=r(66310),n=r(27904),o=r(12828),c=r(70181),d=r(31891),h=r(55298);s(s.S+s.F*!r(27899)((function(t){Array.from(t)})),"Array",{from:function(t){var e,r,s,l,u=a(t),f="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,g=void 0!==m,v=0,A=h(u);if(g&&(m=i(m,p>2?arguments[2]:void 0,2)),null==A||f==Array&&o(A))for(r=new f(e=c(u.length));e>v;v++)d(r,v,g?m(u[v],v):u[v]);else for(l=A.call(u),r=new f;!(s=l.next()).done;v++)d(r,v,g?n(l,m,[s.value,v],!0):s.value);return r.length=v,r}})},18355:(t,e,r)=>{var i=r(88535);i(i.S,"Array",{isArray:r(15461)})},52293:(t,e,r)=>{"use strict";var i=r(12560),s=r(20322),a=r(20210),n=r(65133);t.exports=r(88839)(Array,"Array",(function(t,e){this._t=n(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,s(1)):s(0,"keys"==e?r:"values"==e?t[r]:[r,t[r]])}),"values"),a.Arguments=a.Array,i("keys"),i("values"),i("entries")},23204:(t,e,r)=>{var i=r(88535);i(i.S,"Date",{now:function(){return(new Date).getTime()}})},96050:(t,e,r)=>{"use strict";var i=r(95933),s=r(6096),a="Map";t.exports=r(99373)(a,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=i.getEntry(s(this,a),t);return e&&e.v},set:function(t,e){return i.def(s(this,a),0===t?0:t,e)}},i,!0)},21489:(t,e,r)=>{var i=r(88535);i(i.S,"Number",{isNaN:function(t){return t!=t}})},74712:(t,e,r)=>{var i=r(88535);i(i.S+i.F*!r(58219),"Object",{defineProperty:r(78423).f})},51780:(t,e,r)=>{var i=r(24401),s=r(75172).onFreeze;r(47331)("freeze",(function(t){return function(e){return t&&i(e)?t(s(e)):e}}))},18128:(t,e,r)=>{var i=r(66310),s=r(66123);r(47331)("getPrototypeOf",(function(){return function(t){return s(i(t))}}))},96847:(t,e,r)=>{var i=r(66310),s=r(54311);r(47331)("keys",(function(){return function(t){return s(i(t))}}))},4284:(t,e,r)=>{var i=r(88535);i(i.S,"Object",{setPrototypeOf:r(32074).set})},78978:()=>{},95828:(t,e,r)=>{var i=r(88535),s=r(49709);i(i.G+i.F*(parseFloat!=s),{parseFloat:s})},65331:(t,e,r)=>{var i=r(88535),s=r(15722);i(i.G+i.F*(parseInt!=s),{parseInt:s})},91229:(t,e,r)=>{"use strict";var i,s,a,n,o=r(74742),c=r(66670),d=r(58852),h=r(44968),l=r(88535),u=r(24401),f=r(25219),p=r(2832),m=r(95838),g=r(85614),v=r(8036).set,A=r(53792)(),y=r(11642),b=r(41704),w=r(80218),k=r(61037),x="Promise",I=c.TypeError,T=c.process,P=T&&T.versions,S=P&&P.v8||"",_=c[x],M="process"==h(T),C=function(){},B=s=y.f,R=!!function(){try{var t=_.resolve(1),e=(t.constructor={})[r(30254)("species")]=function(t){t(C,C)};return(M||"function"==typeof PromiseRejectionEvent)&&t.then(C)instanceof e&&0!==S.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(t){}}(),D=function(t){var e;return!(!u(t)||"function"!=typeof(e=t.then))&&e},U=function(t,e){if(!t._n){t._n=!0;var r=t._c;A((function(){for(var i=t._v,s=1==t._s,a=0,n=function(e){var r,a,n,o=s?e.ok:e.fail,c=e.resolve,d=e.reject,h=e.domain;try{o?(s||(2==t._h&&$(t),t._h=1),!0===o?r=i:(h&&h.enter(),r=o(i),h&&(h.exit(),n=!0)),r===e.promise?d(I("Promise-chain cycle")):(a=D(r))?a.call(r,c,d):c(r)):d(i)}catch(t){h&&!n&&h.exit(),d(t)}};r.length>a;)n(r[a++]);t._c=[],t._n=!1,e&&!t._h&&E(t)}))}},E=function(t){v.call(c,(function(){var e,r,i,s=t._v,a=L(t);if(a&&(e=b((function(){M?T.emit("unhandledRejection",s,t):(r=c.onunhandledrejection)?r({promise:t,reason:s}):(i=c.console)&&i.error&&i.error("Unhandled promise rejection",s)})),t._h=M||L(t)?2:1),t._a=void 0,a&&e.e)throw e.v}))},L=function(t){return 1!==t._h&&0===(t._a||t._c).length},$=function(t){v.call(c,(function(){var e;M?T.emit("rejectionHandled",t):(e=c.onrejectionhandled)&&e({promise:t,reason:t._v})}))},F=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),U(e,!0))},O=function(t){var e,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw I("Promise can't be resolved itself");(e=D(t))?A((function(){var i={_w:r,_d:!1};try{e.call(t,d(O,i,1),d(F,i,1))}catch(t){F.call(i,t)}})):(r._v=t,r._s=1,U(r,!1))}catch(t){F.call({_w:r,_d:!1},t)}}};R||(_=function(t){p(this,_,x,"_h"),f(t),i.call(this);try{t(d(O,this,1),d(F,this,1))}catch(t){F.call(this,t)}},(i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(30953)(_.prototype,{then:function(t,e){var r=B(g(this,_));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=M?T.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&U(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),a=function(){var t=new i;this.promise=t,this.resolve=d(O,t,1),this.reject=d(F,t,1)},y.f=B=function(t){return t===_||t===n?new a(t):s(t)}),l(l.G+l.W+l.F*!R,{Promise:_}),r(1356)(_,x),r(45274)(x),n=r(46438)[x],l(l.S+l.F*!R,x,{reject:function(t){var e=B(this);return(0,e.reject)(t),e.promise}}),l(l.S+l.F*(o||!R),x,{resolve:function(t){return k(o&&this===n?_:this,t)}}),l(l.S+l.F*!(R&&r(27899)((function(t){_.all(t).catch(C)}))),x,{all:function(t){var e=this,r=B(e),i=r.resolve,s=r.reject,a=b((function(){var r=[],a=0,n=1;m(t,!1,(function(t){var o=a++,c=!1;r.push(void 0),n++,e.resolve(t).then((function(t){c||(c=!0,r[o]=t,--n||i(r))}),s)})),--n||i(r)}));return a.e&&s(a.v),r.promise},race:function(t){var e=this,r=B(e),i=r.reject,s=b((function(){m(t,!1,(function(t){e.resolve(t).then(r.resolve,i)}))}));return s.e&&i(s.v),r.promise}})},97863:(t,e,r)=>{"use strict";var i=r(43172)(!0);r(88839)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=i(e,r),this._i+=t.length,{value:t,done:!1})}))},19626:(t,e,r)=>{"use strict";var i=r(66670),s=r(75509),a=r(58219),n=r(88535),o=r(61331),c=r(75172).KEY,d=r(81984),h=r(96308),l=r(1356),u=r(19191),f=r(30254),p=r(84336),m=r(67816),g=r(36473),v=r(15461),A=r(80812),y=r(24401),b=r(66310),w=r(65133),k=r(10752),x=r(86260),I=r(22087),T=r(36309),P=r(81033),S=r(59820),_=r(78423),M=r(54311),C=P.f,B=_.f,R=T.f,D=i.Symbol,U=i.JSON,E=U&&U.stringify,L="prototype",$=f("_hidden"),F=f("toPrimitive"),O={}.propertyIsEnumerable,z=h("symbol-registry"),N=h("symbols"),V=h("op-symbols"),W=Object[L],G="function"==typeof D&&!!S.f,q=i.QObject,H=!q||!q[L]||!q[L].findChild,j=a&&d((function(){return 7!=I(B({},"a",{get:function(){return B(this,"a",{value:7}).a}})).a}))?function(t,e,r){var i=C(W,e);i&&delete W[e],B(t,e,r),i&&t!==W&&B(W,e,i)}:B,Y=function(t){var e=N[t]=I(D[L]);return e._k=t,e},Q=G&&"symbol"==typeof D.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof D},K=function(t,e,r){return t===W&&K(V,e,r),A(t),e=k(e,!0),A(r),s(N,e)?(r.enumerable?(s(t,$)&&t[$][e]&&(t[$][e]=!1),r=I(r,{enumerable:x(0,!1)})):(s(t,$)||B(t,$,x(1,{})),t[$][e]=!0),j(t,e,r)):B(t,e,r)},X=function(t,e){A(t);for(var r,i=g(e=w(e)),s=0,a=i.length;a>s;)K(t,r=i[s++],e[r]);return t},J=function(t){var e=O.call(this,t=k(t,!0));return!(this===W&&s(N,t)&&!s(V,t))&&(!(e||!s(this,t)||!s(N,t)||s(this,$)&&this[$][t])||e)},Z=function(t,e){if(t=w(t),e=k(e,!0),t!==W||!s(N,e)||s(V,e)){var r=C(t,e);return!r||!s(N,e)||s(t,$)&&t[$][e]||(r.enumerable=!0),r}},tt=function(t){for(var e,r=R(w(t)),i=[],a=0;r.length>a;)s(N,e=r[a++])||e==$||e==c||i.push(e);return i},et=function(t){for(var e,r=t===W,i=R(r?V:w(t)),a=[],n=0;i.length>n;)!s(N,e=i[n++])||r&&!s(W,e)||a.push(N[e]);return a};G||(o((D=function(){if(this instanceof D)throw TypeError("Symbol is not a constructor!");var t=u(arguments.length>0?arguments[0]:void 0),e=function(r){this===W&&e.call(V,r),s(this,$)&&s(this[$],t)&&(this[$][t]=!1),j(this,t,x(1,r))};return a&&H&&j(W,t,{configurable:!0,set:e}),Y(t)})[L],"toString",(function(){return this._k})),P.f=Z,_.f=K,r(1743).f=T.f=tt,r(36569).f=J,S.f=et,a&&!r(74742)&&o(W,"propertyIsEnumerable",J,!0),p.f=function(t){return Y(f(t))}),n(n.G+n.W+n.F*!G,{Symbol:D});for(var rt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),it=0;rt.length>it;)f(rt[it++]);for(var st=M(f.store),at=0;st.length>at;)m(st[at++]);n(n.S+n.F*!G,"Symbol",{for:function(t){return s(z,t+="")?z[t]:z[t]=D(t)},keyFor:function(t){if(!Q(t))throw TypeError(t+" is not a symbol!");for(var e in z)if(z[e]===t)return e},useSetter:function(){H=!0},useSimple:function(){H=!1}}),n(n.S+n.F*!G,"Object",{create:function(t,e){return void 0===e?I(t):X(I(t),e)},defineProperty:K,defineProperties:X,getOwnPropertyDescriptor:Z,getOwnPropertyNames:tt,getOwnPropertySymbols:et});var nt=d((function(){S.f(1)}));n(n.S+n.F*nt,"Object",{getOwnPropertySymbols:function(t){return S.f(b(t))}}),U&&n(n.S+n.F*(!G||d((function(){var t=D();return"[null]"!=E([t])||"{}"!=E({a:t})||"{}"!=E(Object(t))}))),"JSON",{stringify:function(t){for(var e,r,i=[t],s=1;arguments.length>s;)i.push(arguments[s++]);if(r=e=i[1],(y(e)||void 0!==t)&&!Q(t))return v(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!Q(e))return e}),i[1]=e,E.apply(U,i)}}),D[L][F]||r(2677)(D[L],F,D[L].valueOf),l(D,"Symbol"),l(Math,"Math",!0),l(i.JSON,"JSON",!0)},62223:(t,e,r)=>{r(643)("Map")},74674:(t,e,r)=>{r(44398)("Map")},28337:(t,e,r)=>{var i=r(88535);i(i.P+i.R,"Map",{toJSON:r(5874)("Map")})},2639:(t,e,r)=>{"use strict";var i=r(88535),s=r(46438),a=r(66670),n=r(85614),o=r(61037);i(i.P+i.R,"Promise",{finally:function(t){var e=n(this,s.Promise||a.Promise),r="function"==typeof t;return this.then(r?function(r){return o(e,t()).then((function(){return r}))}:t,r?function(r){return o(e,t()).then((function(){throw r}))}:t)}})},46121:(t,e,r)=>{"use strict";var i=r(88535),s=r(11642),a=r(41704);i(i.S,"Promise",{try:function(t){var e=s.f(this),r=a(t);return(r.e?e.reject:e.resolve)(r.v),e.promise}})},42860:(t,e,r)=>{r(67816)("asyncIterator")},60716:(t,e,r)=>{r(67816)("observable")},7914:(t,e,r)=>{r(52293);for(var i=r(66670),s=r(2677),a=r(20210),n=r(30254)("toStringTag"),o="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<o.length;c++){var d=o[c],h=i[d],l=h&&h.prototype;l&&!l[n]&&s(l,n,d),a[d]=a.Array}},66801:(t,e,r)=>{var i=r(88535),s=r(8036);i(i.G+i.B,{setImmediate:s.set,clearImmediate:s.clear})},84209:(t,e,r)=>{"use strict";r.d(e,{A:()=>i});const i="precision highp float;\r\n\r\nattribute vec3 point;\r\nattribute vec4 color;\r\nvarying vec4 v_color;\r\n\r\nuniform mat4 rotateMatrix;\r\n\r\nvoid main(void){\r\n  gl_Position = rotateMatrix * vec4(point, 1.0);\r\n  v_color = color;\r\n}\r\n"},23195:(t,e,r)=>{"use strict";r.d(e,{A:()=>i});const i="\r\n@group(0) @binding(1) var eTexture: texture_external;\r\n@group(0) @binding(2) var s: sampler;\r\n\r\n@fragment\r\nfn main(@location(0) in_texcoord: vec4<f32>) -> @location(0) vec4<f32> {\r\n  return textureSampleBaseClampToEdge(eTexture, s, in_texcoord.xy);\r\n}"},54895:(t,e,r)=>{"use strict";r.d(e,{A:()=>i});const i="struct PositionColorInput {\r\n    @location(0) in_position_3d: vec3<f32>,\r\n    @location(1) in_color_rgba: vec4<f32>\r\n};\r\n\r\nstruct PositionColorOutput {\r\n    @builtin(position) coords_output: vec4<f32>,\r\n    @location(0) color_output: vec4<f32>\r\n};\r\n\r\nstruct RotateMatrix {\r\n    matrix: mat4x4<f32>\r\n};\r\n\r\n@group(0) @binding(0) var<uniform> rotateMatrix: RotateMatrix;\r\n\r\n@vertex\r\nfn main(input: PositionColorInput) -> PositionColorOutput {\r\n    var output: PositionColorOutput;\r\n    output.color_output = input.in_color_rgba;\r\n    output.coords_output = rotateMatrix.matrix * vec4<f32>(input.in_position_3d, 1.0);\r\n    return output;\r\n}"},42096:(t,e,r)=>{t.exports=r(74385)},68632:(t,e,r)=>{t.exports=r(37149)},45249:(t,e,r)=>{t.exports=r(87172)},73146:(t,e,r)=>{t.exports=r(85079)},80662:(t,e,r)=>{t.exports=r(92861)},7210:(t,e,r)=>{t.exports=r(11837)},66681:(t,e,r)=>{t.exports=r(92696)},7403:(t,e,r)=>{t.exports=r(22948)},75019:(t,e,r)=>{t.exports=r(62160)},69736:(t,e,r)=>{t.exports=r(47567)},11919:(t,e,r)=>{t.exports=r(21724)},88032:(t,e,r)=>{t.exports=r(27279)},29967:(t,e,r)=>{t.exports=r(25216)},54001:(t,e,r)=>{t.exports=r(34750)},64236:(t,e,r)=>{t.exports=r(31707)},75062:(t,e,r)=>{t.exports=r(16560)},20149:(t,e,r)=>{t.exports=r(48652)},134:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(92696),s=r(87361);function a(t,e,r){return(e=(0,s.A)(e))in t?i(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},91908:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(23509),s=r(39967);function a(t,e){if("object"!=(0,i.A)(t)||!t)return t;var r=t[s];if(void 0!==r){var a=r.call(t,e||"default");if("object"!=(0,i.A)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}},87361:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(23509),s=r(91908);function a(t){var e=(0,s.A)(t,"string");return"symbol"==(0,i.A)(e)?e:String(e)}},23509:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(16560),s=r(54220);function a(t){return a="function"==typeof i&&"symbol"==typeof s?function(t){return typeof t}:function(t){return t&&"function"==typeof i&&t.constructor===i&&t!==i.prototype?"symbol":typeof t},a(t)}},65749:(t,e,r)=>{"use strict";function i(t){var e=t.toLowerCase().trim().split(/\s*;\s*/);return"banner"===e[0]?{name:e[0],delay:1*e[1]||0,leftToRight:1*e[2]||0,fadeAwayWidth:1*e[3]||0}:/^scroll\s/.test(e[0])?{name:e[0],y1:Math.min(1*e[1],1*e[2]),y2:Math.max(1*e[1],1*e[2]),delay:1*e[3]||0,fadeAwayHeight:1*e[4]||0}:""!==t?{name:t}:null}function s(t){return t?t.toLowerCase().replace(/([+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?)/g," $1 ").replace(/([mnlbspc])/g," $1 ").trim().replace(/\s+/g," ").split(/\s(?=[mnlbspc])/).map((function(t){return t.split(" ").filter((function(t,e){return!(e&&isNaN(1*t))}))})):[]}r.d(e,{wE:()=>P});var a=["b","i","u","s","fsp","k","K","kf","ko","kt","fe","q","p","pbo","a","an","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"].map((function(t){return{name:t,regex:new RegExp("^"+t+"-?\\d")}}));function n(t){for(var e,r={},i=0;i<a.length;i++){var o=a[i],c=o.name;if(o.regex.test(t))return r[c]=1*t.slice(c.length),r}if(/^fn/.test(t))r.fn=t.slice(2);else if(/^r/.test(t))r.r=t.slice(1);else if(/^fs[\d+-]/.test(t))r.fs=t.slice(2);else if(/^\d?c&?H?[0-9a-fA-F]+|^\d?c$/.test(t)){var d=t.match(/^(\d?)c&?H?(\w*)/),h=d[1],l=d[2];r["c"+(h||1)]=l&&("000000"+l).slice(-6)}else if(/^\da&?H?[0-9a-fA-F]+/.test(t)){var u=t.match(/^(\d)a&?H?([0-9a-f]+)/i),f=u[1],p=u[2];r["a"+f]=("00"+p).slice(-2)}else if(/^alpha&?H?[0-9a-fA-F]+/.test(t))e=t.match(/^alpha&?H?([0-9a-f]+)/i),r.alpha=e[1],r.alpha=("00"+r.alpha).slice(-2);else if(/^(?:pos|org|move|fad|fade)\([^)]+/.test(t)){var m=t.match(/^(\w+)\((.*?)\)?$/),g=m[1],v=m[2];r[g]=v.trim().split(/\s*,\s*/).map(Number)}else if(/^i?clip\([^)]+/.test(t)){var A=t.match(/^i?clip\((.*?)\)?$/)[1].trim().split(/\s*,\s*/);r.clip={inverse:/iclip/.test(t),scale:1,drawing:null,dots:null},1===A.length&&(r.clip.drawing=s(A[0])),2===A.length&&(r.clip.scale=1*A[0],r.clip.drawing=s(A[1])),4===A.length&&(r.clip.dots=A.map(Number))}else if(/^t\(/.test(t)){var y=t.match(/^t\((.*?)\)?$/)[1].trim().replace(/\\.*/,(function(t){return t.replace(/,/g,"\n")})).split(/\s*,\s*/);if(!y[0])return r;r.t={t1:0,t2:0,accel:1,tags:y[y.length-1].replace(/\n/g,",").split("\\").slice(1).map(n)},2===y.length&&(r.t.accel=1*y[0]),3===y.length&&(r.t.t1=1*y[0],r.t.t2=1*y[1]),4===y.length&&(r.t.t1=1*y[0],r.t.t2=1*y[1],r.t.accel=1*y[2])}return r}function o(t){for(var e=[],r=0,i="",s=t.split("\\").slice(1).concat("").join("\\"),a=0;a<s.length;a++){var o=s[a];"("===o&&r++,")"===o&&r--,r<0&&(r=0),r||"\\"!==o?i+=o:(i&&e.push(i),i="")}return e.map(n)}function c(t){var e=t.split(/{(.*?)}/),r=[];e[0].length&&r.push({tags:[],text:e[0],drawing:[]});for(var i=1;i<e.length;i+=2){var a=o(e[i]),n=a.reduce((function(t,e){return void 0===e.p?t:!!e.p}),!1);r.push({tags:a,text:n?"":e[i+1],drawing:n?s(e[i+1]):[]})}return{raw:t,combined:r.map((function(t){return t.text})).join(""),parsed:r}}function d(t,e){var r=t.split(",");if(r.length>e.length){var s=r.slice(e.length-1).join();(r=r.slice(0,e.length-1)).push(s)}for(var a,n={},o=0;o<r.length;o++){var d=e[o],h=r[o].trim();switch(d){case"Layer":case"MarginL":case"MarginR":case"MarginV":n[d]=1*h;break;case"Start":case"End":n[d]=(void 0,3600*(a=h.split(":"))[0]+60*a[1]+1*a[2]);break;case"Effect":n[d]=i(h);break;case"Text":n[d]=c(h);break;default:n[d]=h}}return n}var h=["Name","Fontname","Fontsize","PrimaryColour","SecondaryColour","OutlineColour","BackColour","Bold","Italic","Underline","StrikeOut","ScaleX","ScaleY","Spacing","Angle","BorderStyle","Outline","Shadow","Alignment","MarginL","MarginR","MarginV","Encoding"],l=["Layer","Start","End","Style","Name","MarginL","MarginR","MarginV","Effect","Text"];function u(t){var e=h.concat(l);return t.match(/Format\s*:\s*(.*)/i)[1].split(/\s*,\s*/).map((function(t){return e.find((function(e){return e.toLowerCase()===t.toLowerCase()}))||t}))}function f(t,e){var r=t.match(/Style\s*:\s*(.*)/i)[1].split(/\s*,\s*/);return Object.assign.apply(Object,[{}].concat(e.map((function(t,e){var i;return(i={})[t]=r[e],i}))))}function p(t){var e={type:null,prev:null,next:null,points:[]};/[mnlbs]/.test(t[0])&&(e.type=t[0].toUpperCase().replace("N","L").replace("B","C"));for(var r=t.length-!(1&t.length),i=1;i<r;i+=2)e.points.push({x:1*t[i],y:1*t[i+1]});return e}function m(t){return!(!t.points.length||!t.type||/C|S/.test(t.type)&&t.points.length<3)}function g(t){return t.map((function(t){return t.type+t.points.map((function(t){return t.x+","+t.y})).join(",")})).join("")}function v(t){for(var e,r=[],i=0;i<t.length;){var s=t[i],a=p(s);if(m(a)){if("S"===a.type){var n=(r[i-1]||{points:[{x:0,y:0}]}).points.slice(-1)[0],o=n.x,c=n.y;a.points.unshift({x:o,y:c})}i&&(a.prev=r[i-1].type,r[i-1].next=a.type),r.push(a),i++}else{if(i&&"S"===r[i-1].type){var d={p:a.points,c:r[i-1].points.slice(0,3)};r[i-1].points=r[i-1].points.concat((d[s[0]]||[]).map((function(t){return{x:t.x,y:t.y}})))}t.splice(i,1)}}var h=(e=[]).concat.apply(e,r.map((function(t){var e=t.type,r=t.points,i=t.prev,s=t.next;return"S"===e?function(t,e,r){var i=[],s=[0,2/3,1/3,0],a=[0,1/3,2/3,0],n=[0,1/6,2/3,1/6],o=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},c=[t[t.length-1].x,t[0].x,t[1].x,t[2].x],d=[t[t.length-1].y,t[0].y,t[1].y,t[2].y];i.push({type:"M"===e?"M":"L",points:[{x:o(n,c),y:o(n,d)}]});for(var h=3;h<t.length;h++)c=[t[h-3].x,t[h-2].x,t[h-1].x,t[h].x],d=[t[h-3].y,t[h-2].y,t[h-1].y,t[h].y],i.push({type:"C",points:[{x:o(s,c),y:o(s,d)},{x:o(a,c),y:o(a,d)},{x:o(n,c),y:o(n,d)}]});if("L"===r||"C"===r){var l=t[t.length-1];i.push({type:"L",points:[{x:l.x,y:l.y}]})}return i}(r,i,s):{type:e,points:r}})));return Object.assign({instructions:h,d:g(h)},function(t){var e,r=1/0,i=1/0,s=-1/0,a=-1/0;return(e=[]).concat.apply(e,t.map((function(t){return t.points}))).forEach((function(t){var e=t.x,n=t.y;r=Math.min(r,e),i=Math.min(i,n),s=Math.max(s,e),a=Math.max(a,n)})),{minX:r,minY:i,width:s-r,height:a-i}}(r))}var A=["fs","fsp","clip","c1","c2","c3","c4","a1","a2","a3","a4","alpha","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"];function y(t,e,r){var i,s,a;void 0===r&&(r={});var n=t[e];if(void 0===n)return null;if("pos"===e||"org"===e)return 2===n.length?((i={})[e]={x:n[0],y:n[1]},i):null;if("move"===e){var o=n[0],c=n[1],d=n[2],h=n[3],l=n[4];void 0===l&&(l=0);var u=n[5];return void 0===u&&(u=0),4===n.length||6===n.length?{move:{x1:o,y1:c,x2:d,y2:h,t1:l,t2:u}}:null}if("fad"===e||"fade"===e)return 2===n.length?{fade:{type:"fad",t1:n[0],t2:n[1]}}:7===n.length?{fade:{type:"fade",a1:n[0],a2:n[1],a3:n[2],t1:n[3],t2:n[4],t3:n[5],t4:n[6]}}:null;if("clip"===e){var f=n.inverse,p=n.scale,m=n.drawing,g=n.dots;return m?{clip:{inverse:f,scale:p,drawing:v(m),dots:g}}:g?{clip:{inverse:f,scale:p,drawing:m,dots:{x1:g[0],y1:g[1],x2:g[2],y2:g[3]}}}:null}if(/^[xy]?(bord|shad)$/.test(e)&&(n=Math.max(n,0)),"bord"===e)return{xbord:n,ybord:n};if("shad"===e)return{xshad:n,yshad:n};if(/^c\d$/.test(e))return(s={})[e]=n||r[e],s;if("alpha"===e)return{a1:n,a2:n,a3:n,a4:n};if("fr"===e)return{frz:n};if("fs"===e)return{fs:/^\+|-/.test(n)?(1*n>-10?1+n/10:1)*r.fs:1*n};if("K"===e)return{kf:n};if("t"===e){var b=n.t1,w=n.accel,k=n.tags,x=n.t2||1e3*(r.end-r.start),I={};return k.forEach((function(t){var e=Object.keys(t)[0];~A.indexOf(e)&&("clip"!==e||t[e].dots)&&Object.assign(I,y(t,e,r))})),{t:{t1:b,t2:x,accel:w,tag:I}}}return(a={})[e]=n,a}var b=[null,1,2,3,null,7,8,9,null,4,5,6],w=["r","a","an","pos","org","move","fade","fad","clip"];function k(t){for(var e,r,i,s,a,n,o,c=t.styles,d=t.style,h=t.parsed,l=t.start,u=t.end,f={q:c[d].tag.q},p=[],m={style:d,fragments:[]},g={},A=0;A<h.length;A++){for(var k=h[A],x=k.tags,I=k.text,T=k.drawing,P=void 0,S=0;S<x.length;S++){var _=x[S];P=void 0===_.r?P:_.r}for(var M={tag:void 0===P?(o=g,JSON.parse(JSON.stringify(Object.assign({},o,{k:void 0,kf:void 0,ko:void 0,kt:void 0})))):{},text:I,drawing:T.length?v(T):null},C=0;C<x.length;C++){var B=x[C];e=e||b[B.a||0]||B.an,f=y(B,"q")||f,s||(r=r||y(B,"pos")),i=i||y(B,"org"),r||(s=s||y(B,"move")),a=a||y(B,"fade")||y(B,"fad"),n=y(B,"clip")||n;var R=Object.keys(B)[0];if(R&&!~w.indexOf(R)){var D=c[d].tag,U=y(B,R,{start:l,end:u,c1:D.c1,c2:D.c2,c3:D.c3,c4:D.c4,fs:g.fs||D.fs});"t"===R?(M.tag.t=M.tag.t||[],M.tag.t.push(U.t)):Object.assign(M.tag,U)}}if(g=M.tag,void 0!==P&&(p.push(m),m={style:c[P]?P:d,fragments:[]}),M.text||M.drawing){var E=m.fragments[m.fragments.length-1]||{};E.text&&M.text&&!Object.keys(M.tag).length?E.text+=M.text:m.fragments.push(M)}}return p.push(m),Object.assign({alignment:e,slices:p},f,r,i,s,a,n)}function x(t){for(var e=t.styles,r=t.dialogues,i=1/0,s=[],a=0;a<r.length;a++){var n=r[a];if(!(n.Start>=n.End)){e[n.Style]||(n.Style="Default");var o=e[n.Style].style,c=k({styles:e,style:n.Style,parsed:n.Text.parsed,start:n.Start,end:n.End}),d=c.alignment||o.Alignment;i=Math.min(i,n.Layer),s.push(Object.assign({layer:n.Layer,start:n.Start,end:n.End,style:n.Style,name:n.Name,margin:{left:n.MarginL||o.MarginL,right:n.MarginR||o.MarginR,vertical:n.MarginV||o.MarginV},effect:n.Effect},c,{alignment:d}))}}for(var h=0;h<s.length;h++)s[h].layer-=i;return s.sort((function(t,e){return t.start-e.start||t.end-e.end}))}var I={Name:"Default",Fontname:"Arial",Fontsize:"20",PrimaryColour:"&H00FFFFFF&",SecondaryColour:"&H000000FF&",OutlineColour:"&H00000000&",BackColour:"&H00000000&",Bold:"0",Italic:"0",Underline:"0",StrikeOut:"0",ScaleX:"100",ScaleY:"100",Spacing:"0",Angle:"0",BorderStyle:"1",Outline:"2",Shadow:"2",Alignment:"2",MarginL:"10",MarginR:"10",MarginV:"10",Encoding:"1"};function T(t){if(/^(&|H|&H)[0-9a-f]{6,}/i.test(t)){var e=t.match(/&?H?([0-9a-f]{2})?([0-9a-f]{6})/i);return[e[1]||"00",e[2]]}var r=parseInt(t,10);if(!isNaN(r)){var i=-2147483648;if(r<i)return["00","000000"];var s=i<=r&&r<=2147483647?("00000000"+(r<0?r+4294967296:r).toString(16)).slice(-8):String(r).slice(0,8);return[s.slice(0,2),s.slice(2)]}return["00","000000"]}function P(t,e){void 0===e&&(e={});var r=function(t){for(var e={info:{},styles:{format:[],style:[]},events:{format:[],comment:[],dialogue:[]}},r=t.split(/\r?\n/),i=0,s=0;s<r.length;s++){var a=r[s].trim();if(!/^;/.test(a)&&(/^\[Script Info\]/i.test(a)?i=1:/^\[V4\+? Styles\]/i.test(a)?i=2:/^\[Events\]/i.test(a)?i=3:/^\[.*\]/.test(a)&&(i=0),0!==i)){if(1===i&&/:/.test(a)){var n=a.match(/(.*?)\s*:\s*(.*)/),o=n[1],c=n[2];e.info[o]=c}if(2===i&&(/^Format\s*:/i.test(a)&&(e.styles.format=u(a)),/^Style\s*:/i.test(a)&&e.styles.style.push(f(a,e.styles.format))),3===i&&(/^Format\s*:/i.test(a)&&(e.events.format=u(a)),/^(?:Comment|Dialogue)\s*:/i.test(a))){var h=a.match(/^(\w+?)\s*:\s*(.*)/i),l=h[1],p=h[2];e.events[l.toLowerCase()].push(d(p,e.events.format))}}}return e}(t),i=Object.assign(e.defaultInfo||{},r.info),s=function(t){for(var e=t.info,r=t.style,i=t.defaultStyle,s={},a=[Object.assign({},i,{Name:"Default"})].concat(r),n=function(t){var r=Object.assign({},I,a[t]);/^(\*+)Default$/.test(r.Name)&&(r.Name="Default"),Object.keys(r).forEach((function(t){"Name"===t||"Fontname"===t||/Colour/.test(t)||(r[t]*=1)}));var i=T(r.PrimaryColour),n=i[0],o=i[1],c=T(r.SecondaryColour),d=c[0],h=c[1],l=T(r.OutlineColour),u=l[0],f=l[1],p=T(r.BackColour),m=p[0],g=p[1],v={fn:r.Fontname,fs:r.Fontsize,c1:o,a1:n,c2:h,a2:d,c3:f,a3:u,c4:g,a4:m,b:Math.abs(r.Bold),i:Math.abs(r.Italic),u:Math.abs(r.Underline),s:Math.abs(r.StrikeOut),fscx:r.ScaleX,fscy:r.ScaleY,fsp:r.Spacing,frz:r.Angle,xbord:r.Outline,ybord:r.Outline,xshad:r.Shadow,yshad:r.Shadow,fe:r.Encoding,q:/^[0-3]$/.test(e.WrapStyle)?1*e.WrapStyle:2};s[r.Name]={style:r,tag:v}},o=0;o<a.length;o++)n(o);return s}({info:i,style:r.styles.style,defaultStyle:e.defaultStyle||{}});return{info:i,width:1*i.PlayResX||null,height:1*i.PlayResY||null,wrapStyle:/^[0-3]$/.test(i.WrapStyle)?1*i.WrapStyle:2,collisions:i.Collisions||"Normal",styles:s,dialogues:x({styles:s,dialogues:r.events.dialogue})}}var S={M:"m",L:"l",C:"b"};var _=function(t){return function(e){return function(r){return""+e+t+"&H"+r+"&"}}},M=_("c"),C=_("a"),B={c1:M(1),c2:M(2),c3:M(3),c4:M(4),a1:C(1),a2:C(2),a3:C(3),a4:C(4),pos:function(t){return"pos("+[t.x,t.y]+")"},org:function(t){return"org("+[t.x,t.y]+")"},move:function(t){return"move("+[t.x1,t.y1,t.x2,t.y2,t.t1,t.t2]+")"},fade:function(t){return"fad"===t.type?"fad("+[t.t1,t.t2]+")":"fade("+[t.a1,t.a2,t.a3,t.t1,t.t2,t.t3,t.t4]+")"},clip:function(t){return(t.inverse?"i":"")+"clip("+(t.dots?""+[t.dots.x1,t.dots.y1,t.dots.x2,t.dots.y2]:(1===t.scale?"":t.scale+",")+t.drawing.instructions.map((function(t){var e,r=t.type,i=t.points;return(e=[S[r]]).concat.apply(e,i.map((function(t){return[t.x,t.y]}))).join(" ")})).join(" "))+")"},t:function(t){return t.map((function(t){return"t("+[t.t1,t.t2,t.accel,(e=t.tag,Object.keys(e).map((function(t){return"\\"+(B[t]||function(e){return""+t+e})(e[t])})).join(""))]+")";var e})).join("\\")}}},49963:(t,e,r)=>{"use strict";r.d(e,{b:()=>s});var i=r(32517);function s({styles:t,dialogues:e}){let r=1/0;const s=[];for(let a=0;a<e.length;a++){const n=e[a];if(n.Start>=n.End)continue;t[n.Style]||(n.Style="Default");const o=t[n.Style].style,c=(0,i.t)({styles:t,style:n.Style,parsed:n.Text.parsed,start:n.Start,end:n.End}),d=c.alignment||o.Alignment;r=Math.min(r,n.Layer),s.push(Object.assign({layer:n.Layer,start:n.Start,end:n.End,style:n.Style,name:n.Name,margin:{left:n.MarginL||o.MarginL,right:n.MarginR||o.MarginR,vertical:n.MarginV||o.MarginV},effect:n.Effect},c,{alignment:d}))}for(let t=0;t<s.length;t++)s[t].layer-=r;return s.sort(((t,e)=>t.start-e.start||t.end-e.end))}},98786:(t,e,r)=>{"use strict";function i(t){const e={type:null,prev:null,next:null,points:[]};/[mnlbs]/.test(t[0])&&(e.type=t[0].toUpperCase().replace("N","L").replace("B","C"));for(let r=t.length-!(1&t.length),i=1;i<r;i+=2)e.points.push({x:1*t[i],y:1*t[i+1]});return e}function s(t){return!(!t.points.length||!t.type||/C|S/.test(t.type)&&t.points.length<3)}function a(t){return t.map((({type:t,points:e})=>t+e.map((({x:t,y:e})=>`${t},${e}`)).join(","))).join("")}function n(t){const e=[];let r=0;for(;r<t.length;){const a=t[r],n=i(a);if(s(n)){if("S"===n.type){const{x:t,y:i}=(e[r-1]||{points:[{x:0,y:0}]}).points.slice(-1)[0];n.points.unshift({x:t,y:i})}r&&(n.prev=e[r-1].type,e[r-1].next=n.type),e.push(n),r++}else{if(r&&"S"===e[r-1].type){const t={p:n.points,c:e[r-1].points.slice(0,3)};e[r-1].points=e[r-1].points.concat((t[a[0]]||[]).map((({x:t,y:e})=>({x:t,y:e}))))}t.splice(r,1)}}const n=[].concat(...e.map((({type:t,points:e,prev:r,next:i})=>"S"===t?function(t,e,r){const i=[],s=[0,2/3,1/3,0],a=[0,1/3,2/3,0],n=[0,1/6,2/3,1/6],o=(t,e)=>t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3];let c=[t[t.length-1].x,t[0].x,t[1].x,t[2].x],d=[t[t.length-1].y,t[0].y,t[1].y,t[2].y];i.push({type:"M"===e?"M":"L",points:[{x:o(n,c),y:o(n,d)}]});for(let e=3;e<t.length;e++)c=[t[e-3].x,t[e-2].x,t[e-1].x,t[e].x],d=[t[e-3].y,t[e-2].y,t[e-1].y,t[e].y],i.push({type:"C",points:[{x:o(s,c),y:o(s,d)},{x:o(a,c),y:o(a,d)},{x:o(n,c),y:o(n,d)}]});if("L"===r||"C"===r){const e=t[t.length-1];i.push({type:"L",points:[{x:e.x,y:e.y}]})}return i}(e,r,i):{type:t,points:e})));return Object.assign({instructions:n,d:a(n)},function(t){let e=1/0,r=1/0,i=-1/0,s=-1/0;return[].concat(...t.map((({points:t})=>t))).forEach((({x:t,y:a})=>{e=Math.min(e,t),r=Math.min(r,a),i=Math.max(i,t),s=Math.max(s,a)})),{minX:e,minY:r,width:i-e,height:s-r}}(e))}r.d(e,{EB:()=>n})},78040:(t,e,r)=>{"use strict";r.d(e,{W:()=>a});const i={Name:"Default",Fontname:"Arial",Fontsize:"20",PrimaryColour:"&H00FFFFFF&",SecondaryColour:"&H000000FF&",OutlineColour:"&H00000000&",BackColour:"&H00000000&",Bold:"0",Italic:"0",Underline:"0",StrikeOut:"0",ScaleX:"100",ScaleY:"100",Spacing:"0",Angle:"0",BorderStyle:"1",Outline:"2",Shadow:"2",Alignment:"2",MarginL:"10",MarginR:"10",MarginV:"10",Encoding:"1"};function s(t){if(/^(&|H|&H)[0-9a-f]{6,}/i.test(t)){const[,e,r]=t.match(/&?H?([0-9a-f]{2})?([0-9a-f]{6})/i);return[e||"00",r]}const e=parseInt(t,10);if(!Number.isNaN(e)){const t=-2147483648;if(e<t)return["00","000000"];const r=t<=e&&e<=2147483647?`00000000${(e<0?e+4294967296:e).toString(16)}`.slice(-8):String(e).slice(0,8);return[r.slice(0,2),r.slice(2)]}return["00","000000"]}function a({info:t,style:e,defaultStyle:r}){const a={},n=[Object.assign({},r,{Name:"Default"})].concat(e);for(let e=0;e<n.length;e++){const r=Object.assign({},i,n[e]);/^(\*+)Default$/.test(r.Name)&&(r.Name="Default"),Object.keys(r).forEach((t=>{"Name"===t||"Fontname"===t||/Colour/.test(t)||(r[t]*=1)}));const[o,c]=s(r.PrimaryColour),[d,h]=s(r.SecondaryColour),[l,u]=s(r.OutlineColour),[f,p]=s(r.BackColour),m={fn:r.Fontname,fs:r.Fontsize,c1:c,a1:o,c2:h,a2:d,c3:u,a3:l,c4:p,a4:f,b:Math.abs(r.Bold),i:Math.abs(r.Italic),u:Math.abs(r.Underline),s:Math.abs(r.StrikeOut),fscx:r.ScaleX,fscy:r.ScaleY,fsp:r.Spacing,frz:r.Angle,xbord:r.Outline,ybord:r.Outline,xshad:r.Shadow,yshad:r.Shadow,fe:r.Encoding,q:/^[0-3]$/.test(t.WrapStyle)?1*t.WrapStyle:2};a[r.Name]={style:r,tag:m}}return a}},64484:(t,e,r)=>{"use strict";r.d(e,{k:()=>a});var i=r(98786);const s=["fs","fsp","clip","c1","c2","c3","c4","a1","a2","a3","a4","alpha","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"];function a(t,e,r={}){let n=t[e];if(void 0===n)return null;if("pos"===e||"org"===e)return 2===n.length?{[e]:{x:n[0],y:n[1]}}:null;if("move"===e){const[t,e,r,i,s=0,a=0]=n;return 4===n.length||6===n.length?{move:{x1:t,y1:e,x2:r,y2:i,t1:s,t2:a}}:null}if("fad"===e||"fade"===e){if(2===n.length){const[t,e]=n;return{fade:{type:"fad",t1:t,t2:e}}}if(7===n.length){const[t,e,r,i,s,a,o]=n;return{fade:{type:"fade",a1:t,a2:e,a3:r,t1:i,t2:s,t3:a,t4:o}}}return null}if("clip"===e){const{inverse:t,scale:e,drawing:r,dots:s}=n;if(r)return{clip:{inverse:t,scale:e,drawing:(0,i.EB)(r),dots:s}};if(s){const[i,a,n,o]=s;return{clip:{inverse:t,scale:e,drawing:r,dots:{x1:i,y1:a,x2:n,y2:o}}}}return null}if(/^[xy]?(bord|shad)$/.test(e)&&(n=Math.max(n,0)),"bord"===e)return{xbord:n,ybord:n};if("shad"===e)return{xshad:n,yshad:n};if(/^c\d$/.test(e))return{[e]:n||r[e]};if("alpha"===e)return{a1:n,a2:n,a3:n,a4:n};if("fr"===e)return{frz:n};if("fs"===e)return{fs:/^\+|-/.test(n)?(1*n>-10?1+n/10:1)*r.fs:1*n};if("K"===e)return{kf:n};if("t"===e){const{t1:t,accel:e,tags:i}=n,o=n.t2||1e3*(r.end-r.start),c={};return i.forEach((t=>{const e=Object.keys(t)[0];~s.indexOf(e)&&("clip"!==e||t[e].dots)&&Object.assign(c,a(t,e,r))})),{t:{t1:t,t2:o,accel:e,tag:c}}}return{[e]:n}}},32517:(t,e,r)=>{"use strict";r.d(e,{t:()=>o});var i=r(98786),s=r(64484);const a=[null,1,2,3,null,7,8,9,null,4,5,6],n=["r","a","an","pos","org","move","fade","fad","clip"];function o({styles:t,style:e,parsed:r,start:o,end:c}){let d,h,l,u,f,p,m={q:t[e].tag.q};const g=[];let v={style:e,fragments:[]},A={};for(let b=0;b<r.length;b++){const{tags:w,text:k,drawing:x}=r[b];let I;for(let t=0;t<w.length;t++){const e=w[t];I=void 0===e.r?I:e.r}const T={tag:void 0===I?(y=A,JSON.parse(JSON.stringify(Object.assign({},y,{k:void 0,kf:void 0,ko:void 0,kt:void 0})))):{},text:k,drawing:x.length?(0,i.EB)(x):null};for(let r=0;r<w.length;r++){const i=w[r];d=d||a[i.a||0]||i.an,m=(0,s.k)(i,"q")||m,u||(h=h||(0,s.k)(i,"pos")),l=l||(0,s.k)(i,"org"),h||(u=u||(0,s.k)(i,"move")),f=f||(0,s.k)(i,"fade")||(0,s.k)(i,"fad"),p=(0,s.k)(i,"clip")||p;const g=Object.keys(i)[0];if(g&&!~n.indexOf(g)){const r=t[e].tag,{c1:a,c2:n,c3:d,c4:h}=r,l=A.fs||r.fs,u=(0,s.k)(i,g,{start:o,end:c,c1:a,c2:n,c3:d,c4:h,fs:l});"t"===g?(T.tag.t=T.tag.t||[],T.tag.t.push(u.t)):Object.assign(T.tag,u)}}if(A=T.tag,void 0!==I&&(g.push(v),v={style:t[I]?I:e,fragments:[]}),T.text||T.drawing){const t=v.fragments[v.fragments.length-1]||{};t.text&&T.text&&!Object.keys(T.tag).length?t.text+=T.text:v.fragments.push(T)}}var y;return g.push(v),Object.assign({alignment:d,slices:g},m,h,l,u,f,p)}},74672:(t,e,r)=>{"use strict";function i(t){return t?t.toLowerCase().replace(/([+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?)/g," $1 ").replace(/([mnlbspc])/g," $1 ").trim().replace(/\s+/g," ").split(/\s(?=[mnlbspc])/).map((t=>t.split(" ").filter(((t,e)=>!(e&&Number.isNaN(1*t)))))):[]}r.d(e,{O:()=>i})},44453:(t,e,r)=>{"use strict";function i(t){const e=t.toLowerCase().trim().split(/\s*;\s*/);return"banner"===e[0]?{name:e[0],delay:1*e[1]||0,leftToRight:1*e[2]||0,fadeAwayWidth:1*e[3]||0}:/^scroll\s/.test(e[0])?{name:e[0],y1:Math.min(1*e[1],1*e[2]),y2:Math.max(1*e[1],1*e[2]),delay:1*e[3]||0,fadeAwayHeight:1*e[4]||0}:""!==t?{name:t}:null}r.d(e,{d:()=>i})},53534:(t,e,r)=>{"use strict";r.d(e,{E:()=>a});var i=r(74672);const s=["b","i","u","s","fsp","k","K","kf","ko","kt","fe","q","p","pbo","a","an","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"].map((t=>({name:t,regex:new RegExp(`^${t}-?\\d`)})));function a(t){const e={};for(let r=0;r<s.length;r++){const{name:i,regex:a}=s[r];if(a.test(t))return e[i]=1*t.slice(i.length),e}if(/^fn/.test(t))e.fn=t.slice(2);else if(/^r/.test(t))e.r=t.slice(1);else if(/^fs[\d+-]/.test(t))e.fs=t.slice(2);else if(/^\d?c&?H?[0-9a-fA-F]+|^\d?c$/.test(t)){const[,r,i]=t.match(/^(\d?)c&?H?(\w*)/);e[`c${r||1}`]=i&&`000000${i}`.slice(-6)}else if(/^\da&?H?[0-9a-fA-F]+/.test(t)){const[,r,i]=t.match(/^(\d)a&?H?([0-9a-f]+)/i);e[`a${r}`]=`00${i}`.slice(-2)}else if(/^alpha&?H?[0-9a-fA-F]+/.test(t))[,e.alpha]=t.match(/^alpha&?H?([0-9a-f]+)/i),e.alpha=`00${e.alpha}`.slice(-2);else if(/^(?:pos|org|move|fad|fade)\([^)]+/.test(t)){const[,r,i]=t.match(/^(\w+)\((.*?)\)?$/);e[r]=i.trim().split(/\s*,\s*/).map(Number)}else if(/^i?clip\([^)]+/.test(t)){const r=t.match(/^i?clip\((.*?)\)?$/)[1].trim().split(/\s*,\s*/);e.clip={inverse:/iclip/.test(t),scale:1,drawing:null,dots:null},1===r.length&&(e.clip.drawing=(0,i.O)(r[0])),2===r.length&&(e.clip.scale=1*r[0],e.clip.drawing=(0,i.O)(r[1])),4===r.length&&(e.clip.dots=r.map(Number))}else if(/^t\(/.test(t)){const r=t.match(/^t\((.*?)\)?$/)[1].trim().replace(/\\.*/,(t=>t.replace(/,/g,"\n"))).split(/\s*,\s*/);if(!r[0])return e;e.t={t1:0,t2:0,accel:1,tags:r[r.length-1].replace(/\n/g,",").split("\\").slice(1).map(a)},2===r.length&&(e.t.accel=1*r[0]),3===r.length&&(e.t.t1=1*r[0],e.t.t2=1*r[1]),4===r.length&&(e.t.t1=1*r[0],e.t.t2=1*r[1],e.t.accel=1*r[2])}return e}},27637:(t,e,r)=>{"use strict";r.d(e,{r:()=>s});var i=r(53534);function s(t){const e=[];let r=0,s="";const a=t.split("\\").slice(1).concat("").join("\\");for(let t=0;t<a.length;t++){const i=a[t];"("===i&&r++,")"===i&&r--,r<0&&(r=0),r||"\\"!==i?s+=i:(s&&e.push(s),s="")}return e.map(i.E)}},93935:(t,e,r)=>{"use strict";r.d(e,{r:()=>a});var i=r(74672),s=r(27637);function a(t){const e=t.split(/{(.*?)}/),r=[];e[0].length&&r.push({tags:[],text:e[0],drawing:[]});for(let t=1;t<e.length;t+=2){const a=(0,s.r)(e[t]),n=a.reduce(((t,e)=>void 0===e.p?t:!!e.p),!1);r.push({tags:a,text:n?"":e[t+1],drawing:n?(0,i.O)(e[t+1]):[]})}return{raw:t,combined:r.map((t=>t.text)).join(""),parsed:r}}},21194:(t,e,r)=>{"use strict";r.d(e,{By:()=>n,IU:()=>a});var i=r(47924),s=r(77334);function a(t){const{box:e}=t;for(;e.lastChild;)e.lastChild.remove();t.actives=[],t.space=[]}function n(t,e){const{video:r,box:n,layoutRes:o}=e;return function(){const c=r.clientWidth,d=r.clientHeight,h=o.width||r.videoWidth||c,l=o.height||r.videoHeight||d,u=e.scriptRes.width,f=e.scriptRes.height;let p=u,m=f;const g=Math.min(c/h,d/l);"video_width"===t.resampling&&(m=u/h*l),"video_height"===t.resampling&&(p=f/l*h),e.scale=Math.min(c/p,d/m),"script_width"===t.resampling&&(e.scale=g*(h/p)),"script_height"===t.resampling&&(e.scale=g*(l/m));const v=e.scale*p,A=e.scale*m;e.width=v,e.height=A,e.resampledRes={width:p,height:m},n.style.cssText=`width:${v}px;height:${A}px;top:${(d-A)/2}px;left:${(c-v)/2}px;`,n.style.setProperty("--ass-scale",e.scale),n.style.setProperty("--ass-scale-stroke",e.sbas?e.scale:1),function(t){return function(){a(t);const{video:e,dialogues:r}=t,n=e.currentTime-t.delay;t.index=(()=>{for(let t=0;t<r.length;t+=1)if(n<r[t].end)return t;return(r.length||1)-1})(),function(t,e){const{dialogues:r,actives:a}=t,n=e-t.delay;for(let t=a.length-1;t>=0;t-=1){const e=a[t],{end:r}=e;r<n&&(e.$div.remove(),a.splice(t,1))}for(;t.index<r.length&&n>=r[t.index].start;){if(n<r[t.index].end){const e=(0,i.U)(r[t.index],t);(e.animations||[]).forEach((t=>{t.currentTime=1e3*(n-e.start)})),a.push(e),t.video.paused||(0,s.MA)(e,"play")}t.index+=1}}(t,e.currentTime)}}(e)()}}},23873:(t,e,r)=>{"use strict";r.d(e,{Mx:()=>p,Ul:()=>f,nq:()=>l,o3:()=>m});var i=r(77334),s=r(77658),a=r(60913),n=r(57131);function o(t,e){const{name:r,delay:i,leftToRight:s}=t,a="banner"===r?"X":"Y",n={X:s?1:-1,Y:/up/.test(r)?-1:1}[a],o=-100*n;return[[{offset:0,transform:`translate${a}(${o}%)`},{offset:1,transform:`translate${a}(calc(${o}% + var(--ass-scale) * ${e/(i||1)*n}px))`}],{duration:e,fill:"forwards"}]}function c(t){return`calc(var(--ass-scale) * ${t}px)`}function d(t,e){const{x1:r,y1:i,x2:s,y2:a,t1:n,t2:o}=t,d=`translate(${c(r)}, ${c(i)})`,h=`translate(${c(s)}, ${c(a)})`,l=Math.max(o,e);return[[{offset:0,transform:d},n>0?{offset:n/l,transform:d}:null,o>0&&o<e?{offset:o/l,transform:h}:null,{offset:1,transform:h}].filter(Boolean),{duration:l,fill:"forwards"}]}function h(t,e){const{type:r,a1:i,a2:s,a3:a,t1:n,t2:o,t3:c,t4:d}=t;if("fad"===r)return[[[{offset:0,opacity:1},{offset:1,opacity:0}],{duration:o,delay:e-o,fill:"forwards"}],[[{offset:0,opacity:0},{offset:1,opacity:1}],{duration:n,composite:"replace"}]];const h=Math.max(e,d),l=[i,s,a].map((t=>1-t/255));return[[[0,n,o,c,d].map((t=>t/h)).map(((t,e)=>({offset:t,opacity:l[e>>1]}))),{duration:h,fill:"forwards"}]]}function l(t){return[["real-fs",(0,s.F)(t.fn,t.fs)],["tag-fs",t.fs],["tag-fsp",t.fsp],["fill-color",(0,i.qG)(t.a1+t.c1)]].filter((([,t])=>t)).map((([t,e])=>[`--ass-${t}`,e]))}function u(t,e){if(1===e)return"linear";const r=Math.ceil(t/1e3*60);return`linear(${Array.from({length:r+1}).map(((t,i)=>(i/r)**e)).join(",")})`}function f(t,e){const{start:r,end:s,effect:a,move:n,fade:c}=e,l=1e3*(s-r);return[a&&!n?o(a,l):null,n?d(n,l):null,...c?h(c,l):[]].filter(Boolean).map((([e,r])=>(0,i.dT)(t,e,r)))}function p(t,e,r){const a={...r,...e.tag};return(e.tag.t||[]).map((({t1:e,t2:r,accel:n,tag:o})=>{const c=Object.fromEntries(Object.keys(o).flatMap((t=>function(t,e,r){const a=e[r];return void 0===a||"clip"===r?[]:"a1"===r||"c1"===r?[["fill-color",(0,i.qG)((e.a1||t.a1)+(e.c1||t.c1))]]:"a3"===r||"c3"===r?[["border-color",(0,i.qG)((e.a3||t.a3)+(e.c3||t.c3))]]:"a4"===r||"c4"===r?[["shadow-color",(0,i.qG)((e.a4||t.a4)+(e.c4||t.c4))]]:"fs"===r?[["real-fs",(0,s.F)(e.fn||t.fn,e.fs)],["tag-fs",a]]:"fscx"===r||"fscy"===r?[[`tag-${r}`,(a||100)/100]]:"xbord"===r||"ybord"===r?[["border-width",2*a]]:[[`tag-${r}`,a]]}(a,o,t))).map((([t,e])=>[`--ass-${t}`,e])).concat([["offset",1]])),d=Math.max(0,r-e);return(0,i.dT)(t,[c],{duration:d,delay:e,fill:"forwards",easing:u(d,n)})}))}function m(t,e,r){return e.slices.flatMap((t=>t.fragments)).flatMap((t=>t.tag.t||[])).filter((({tag:t})=>t.clip)).map((({t1:e,t2:s,accel:n,tag:o})=>{const c={offset:1,clipPath:(0,a.r)(o.clip,r.scriptRes.width,r.scriptRes.height)},d=Math.max(0,s-e);return(0,i.dT)(t,[c],{duration:d,delay:e,fill:"forwards",easing:u(d,n)})}))}window.CSS.registerProperty&&(["real-fs","tag-fs","tag-fsp","border-width",...["blur","xbord","ybord","xshad","yshad",...n.r8,...n.ge].map((t=>`tag-${t}`))].forEach((t=>{window.CSS.registerProperty({name:`--ass-${t}`,syntax:"<number>",inherits:!0,initialValue:0})})),["border-opacity","shadow-opacity",...n.IZ.map((t=>`tag-${t}`))].forEach((t=>{window.CSS.registerProperty({name:`--ass-${t}`,syntax:"<number>",inherits:!0,initialValue:1})})),["fill-color","border-color","shadow-color"].forEach((t=>{window.CSS.registerProperty({name:`--ass-${t}`,syntax:"<color>",inherits:!0,initialValue:"transparent"})})))},60913:(t,e,r)=>{"use strict";r.d(e,{C:()=>a,r:()=>s});var i=r(23873);function s(t,e,r){if(!t.dots)return"";const{x1:i,y1:s,x2:a,y2:n}=t.dots;return`polygon(evenodd, ${[[i,s],[i,n],[a,n],[a,s],[i,s]].map((([t,i])=>[t/e,i/r])).concat(t.inverse?[[0,0],[0,1],[1,1],[1,0],[0,0]]:[]).map((t=>t.map((t=>100*t+"%")).join(" "))).join(",")})`}function a(t,e){const{clip:r,animations:a}=t;if(!r)return{};const{width:n,height:o}=e.scriptRes,c=document.createElement("div");return e.box.insertBefore(c,t.$div),c.append(t.$div),c.className="ASS-clip-area",c.style.zIndex=t.$div.style.zIndex,c.style.clipPath=r.dots?s(r,n,o):function(t,e,r,i){if(!t.drawing)return"";const s=i.scale/(1<<t.scale-1);let a=t.drawing.instructions.map((({type:t,points:e})=>t+e.map((({x:t,y:e})=>`${t*s},${e*s}`)).join(","))).join("");return t.inverse&&(a+=`M0,0L0,${r},${e},${r},${e},0,0,0Z`),`path(evenodd, "${a}")`}(r,n,o,e),a.push(...(0,i.o3)(c,t,e)),{$div:c}}},21643:(t,e,r)=>{"use strict";r.d(e,{p:()=>c});var i=r(82873),s=r(23873),a=r(39923),n=r(57131),o=r(77334);function c(t,e){const{styles:r}=e,c=document.createElement("div");c.className="ASS-dialogue",c.dataset.wrapStyle=t.q;const d=document.createDocumentFragment(),{align:h,slices:l}=t;[["--ass-align-h",["0%","50%","100%"][h.h]],["--ass-align-v",["100%","50%","0%"][h.v]]].forEach((([t,e])=>{c.style.setProperty(t,e)}));const u=[];return l.forEach((c=>{const h=r[c.style].tag,l=r[c.style].style.BorderStyle;c.fragments.forEach((r=>{const{text:c,drawing:f}=r,p={...h,...r.tag};let m="";const g=[];g.push(...(0,a.F)(p));let v=null;const A=p.xbord||p.ybord||p.xshad||p.yshad;if(A&&(f||"00"!==p.a1||p.xbord!==p.ybord)){const t=(0,a.x)(p,e.sbas?e.scale:1),r=(0,o.An)("svg",[["width",0],["height",0]]);r.append(t.el),v={id:t.id,el:r}}if(g.push(...(0,s.nq)(p)),f||(m+=`font-family:"${p.fn}";`,m+=p.b?`font-weight:${1===p.b?"bold":p.b};`:"",m+=p.i?"font-style:italic;":"",m+=p.u||p.s?`text-decoration:${p.u?"underline":""} ${p.s?"line-through":""};`:""),f&&p.pbo){const t=-p.pbo*(p.fscy||100)/100;m+=`vertical-align:calc(var(--ass-scale) * ${t}px);`}g.push(...(0,n.l1)(p));const y=[p,...(p.t||[]).map((t=>t.tag))],b=n.r8.some((t=>y.some((e=>e[t])))),w=n.IZ.some((t=>y.some((e=>void 0!==e[t]&&100!==e[t])))),k=n.ge.some((t=>y.some((e=>e[t]))));(function(t,e){return t.replace(/\\h/g," ").replace(/\\N/g,"\n").replace(/\\n/g,2===e?"\n":" ")})(c,t.q).split("\n").forEach(((t,a)=>{const n=document.createElement("span"),o=document.createElement("span");if((w||k)&&(w&&(o.dataset.scale=""),k&&(o.dataset.skew=""),o.textContent=t),b&&(n.dataset.rotate=""),f){n.dataset.drawing="";const t=(0,i.v)(r,h,e);if(!t)return;n.style.cssText=t.cssText,n.append(t.$svg)}else{if(a){const t=document.createElement("div");t.dataset.is="br",t.style.setProperty("--ass-tag-fs",p.fs),d.append(t)}if(!t)return;w||k?n.append(o):n.textContent=t;const e=w||k?o:n;e.dataset.text=t,A&&(e.dataset.borderStyle=l,e.dataset.stroke="css"),v&&(e.dataset.stroke="svg",e.style.filter=`url(#${v.id})`,e.append(v.el))}n.style.cssText+=m,g.forEach((([t,e])=>{n.style.setProperty(t,e)})),u.push(...(0,s.Mx)(n,r,h)),d.append(n)}))}))})),u.push(...(0,s.Ul)(c,t)),c.append(d),{$div:c,animations:u}}},82873:(t,e,r)=>{"use strict";r.d(e,{v:()=>a});var i=r(77334),s=r(39923);function a(t,e,r){if(!t.drawing.d)return null;const a={...e,...t.tag},{minX:n,minY:o,width:c,height:d}=t.drawing,h=r.scale/(1<<a.p-1),l=(a.fscx?a.fscx/100:1)*h,u=(a.fscy?a.fscy/100:1)*h,f=a.blur||a.be||0,p=a.xbord+(a.xshad<0?-a.xshad:0)+f,m=a.ybord+(a.yshad<0?-a.yshad:0)+f,g=c*l+2*a.xbord+Math.abs(a.xshad)+2*f,v=d*u+2*a.ybord+Math.abs(a.yshad)+2*f,A=(0,i.An)("svg",[["width",g],["height",v],["viewBox",`${-p} ${-m} ${g} ${v}`]]),y=r.sbas?r.scale:1,b=(0,i.An)("defs"),w=(0,s.x)(a,y);b.append(w.el),A.append(b);const k=`ASS-${(0,i.uR)()}`,x=(0,i.An)("symbol",[["id",k],["viewBox",`${n} ${o} ${c} ${d}`]]);return x.append((0,i.An)("path",[["d",t.drawing.d]])),A.append(x),A.append((0,i.An)("use",[["width",c*l],["height",d*u],["xlink:href",`#${k}`],["filter",`url(#${w.id})`]])),A.style.cssText=`position:absolute;left:${n*l-p}px;top:${o*u-m}px;`,{$svg:A,cssText:`position:relative;width:${c*l}px;height:${d*u}px;`}}},76762:(t,e,r)=>{"use strict";function i(t,e){const r=document.createElement("div");r.className="ASS-effect-area",e.box.insertBefore(r,t.$div),r.append(t.$div);const{width:i,height:s}=e.scriptRes,{name:a,y1:n,y2:o,leftToRight:c,fadeAwayWidth:d,fadeAwayHeight:h}=t.effect,l=Math.min(n,o),u=Math.max(n,o);if(r.dataset.effect=a,"banner"===a&&(r.style.alignItems=c?"flex-start":"flex-end",r.style.justifyContent=["flex-end","center","flex-start"][t.align.v]),a.startsWith("scroll")){const e=l/s*100,i=(s-u)/s*100;r.style.cssText=`top:${e}%;bottom:${i}%;`,r.style.justifyContent=["flex-start","center","flex-end"][t.align.h]}if(h){const t=h/(u-l)*100;r.style.maskImage=[`linear-gradient(#000 ${100-t}%, transparent)`,`linear-gradient(transparent, #000 ${t}%)`].join(",")}if(d){const t=d/i*100;r.style.maskImage=`linear-gradient(90deg, transparent, #000 ${t}%)`}return r}r.d(e,{c:()=>i})},77658:(t,e,r)=>{"use strict";r.d(e,{F:()=>l,Y:()=>h});const i="fontBoundingBoxAscent"in TextMetrics.prototype,s=navigator.userAgent.toLowerCase().includes("firefox"),a=!i&&s?512:2048,n=Object.create(null),o=document.createElement("canvas").getContext("2d"),c=document.createElement("div");c.className="ASS-fix-font-size",c.style.fontSize=`${a}px`;const d=document.createElement("span");d.textContent="0",c.append(d);const h=i?null:c;function l(t,e){if(!n[t])if(i){o.font=`${a}px "${t}"`;const e=o.measureText("");n[t]=e.fontBoundingBoxAscent+e.fontBoundingBoxDescent}else d.style.fontFamily=`"${t}"`,n[t]=d.clientHeight;return e*a/n[t]}},51776:(t,e,r)=>{"use strict";function i(t,e){const{scale:r}=e,{move:i,align:s,width:a,height:n,margin:o,slices:c}=t;let d=0,h=0;if(t.pos||i){const e=t.pos||{x:0,y:0},i=r*e.x,o=r*e.y;d=[i,i-a/2,i-a][s.h],h=[o-n,o-n/2,o][s.v]}else d=[0,(e.width-a)/2,e.width-a-r*o.right][s.h],h=c.some((t=>t.fragments.some((({keyframes:t})=>t?.length))))?[e.height-n-o.vertical,(e.height-n)/2,o.vertical][s.v]:function(t,e){const{video:r,space:i,scale:s}=e,{layer:a,margin:n,width:o,height:c,alignment:d,end:h}=t,l=e.width-Math.trunc(s*(n.left+n.right)),u=e.height,f=Math.trunc(s*n.vertical),p=100*r.currentTime;i[a]=i[a]||{left:{width:new Uint16Array(u+1),end:new Uint32Array(u+1)},center:{width:new Uint16Array(u+1),end:new Uint32Array(u+1)},right:{width:new Uint16Array(u+1),end:new Uint32Array(u+1)}};const m=i[a],g=["right","left","center"][d%3];let v=0,A=0;const y=t=>(v=(t=>{const e=m.left.width[t],r=m.center.width[t],i=m.right.width[t],s=m.left.end[t],a=m.center.end[t],n=m.right.end[t];return"left"===g&&(s>p&&e||a>p&&r&&2*o+r>l||n>p&&i&&o+i>l)||"center"===g&&(s>p&&e&&2*e+o>l||a>p&&r||n>p&&i&&2*i+o>l)||"right"===g&&(s>p&&e&&e+o>l||a>p&&r&&2*o+r>l||n>p&&i)})(t)?0:v+1,v>=c&&(A=t,!0));if(d<=3){A=u-f-1;for(let t=A;t>f&&!y(t);t-=1);}else if(d>=7){A=f+1;for(let t=A;t<u-f&&!y(t);t+=1);}else{A=u-c>>1;for(let t=A;t<u-f&&!y(t);t+=1);}d>3&&(A-=c-1);for(let t=A;t<A+c;t+=1)m[g].width[t]=o,m[g].end[t]=100*h;return A}(t,e);return{x:d+[0,a/2,a][s.h],y:h+[n,n/2,0][s.v]}}r.d(e,{E:()=>i})},47924:(t,e,r)=>{"use strict";r.d(e,{U:()=>d});var i=r(60913),s=r(21643),a=r(51776),n=r(59950),o=r(57131),c=r(76762);function d(t,e){const{$div:r,animations:d}=(0,s.p)(t,e);Object.assign(t,{$div:r,animations:d}),e.box.append(r);const{width:h}=r.getBoundingClientRect();Object.assign(t,{width:h}),r.style.cssText+=(0,n._)(t);const{height:l}=r.getBoundingClientRect();Object.assign(t,{height:l});const{x:u,y:f}=(0,a.E)(t,e);return Object.assign(t,{x:u,y:f}),r.style.cssText+=`left:${u}px;top:${f}px;`,(0,o.Lu)(t,e.scale),Object.assign(t,(0,i.C)(t,e)),t.effect&&Object.assign(t,{$div:(0,c.c)(t,e)}),t}},39923:(t,e,r)=>{"use strict";r.d(e,{F:()=>a,x:()=>s});var i=r(77334);function s(t,e){const r=`ASS-${(0,i.uR)()}`,s=t.xbord||t.ybord,a=t.xshad||t.yshad,n="ff"!==(t.a1||"00").toLowerCase(),o=(t.blur||t.be||0)*e,c=(0,i.An)("filter",[["id",r]]);c.append((0,i.An)("feGaussianBlur",[["stdDeviation",s?0:o],["in","SourceGraphic"],["result","sg_b"]])),c.append((0,i.An)("feFlood",[["flood-color","var(--ass-fill-color)"],["result","c1"]])),c.append((0,i.An)("feComposite",[["operator","in"],["in","c1"],["in2","sg_b"],["result","main"]])),s&&(c.append((0,i.An)("feMorphology",[["radius",`${t.xbord*e} ${t.ybord*e}`],["operator","dilate"],["in","SourceGraphic"],["result","dil"]])),c.append((0,i.An)("feGaussianBlur",[["stdDeviation",o],["in","dil"],["result","dil_b"]])),c.append((0,i.An)("feComposite",[["operator","out"],["in","dil_b"],["in2","SourceGraphic"],["result","dil_b_o"]])),c.append((0,i.An)("feFlood",[["flood-color","var(--ass-border-color)"],["result","c3"]])),c.append((0,i.An)("feComposite",[["operator","in"],["in","c3"],["in2","dil_b_o"],["result","border"]]))),a&&(s||n)&&(c.append((0,i.An)("feOffset",[["dx",t.xshad*e],["dy",t.yshad*e],["in",s?n?"dil":"dil_b_o":"SourceGraphic"],["result","off"]])),c.append((0,i.An)("feGaussianBlur",[["stdDeviation",o],["in","off"],["result","off_b"]])),n||(c.append((0,i.An)("feOffset",[["dx",t.xshad*e],["dy",t.yshad*e],["in","SourceGraphic"],["result","sg_off"]])),c.append((0,i.An)("feComposite",[["operator","out"],["in","off_b"],["in2","sg_off"],["result","off_b_o"]]))),c.append((0,i.An)("feFlood",[["flood-color","var(--ass-shadow-color)"],["result","c4"]])),c.append((0,i.An)("feComposite",[["operator","in"],["in","c4"],["in2",n?"off_b":"off_b_o"],["result","shadow"]])));const d=(0,i.An)("feMerge",[]);return a&&(s||n)&&d.append((0,i.An)("feMergeNode",[["in","shadow"]])),s&&d.append((0,i.An)("feMergeNode",[["in","border"]])),d.append((0,i.An)("feMergeNode",[["in","main"]])),c.append(d),{id:r,el:c}}function a(t){return[["border-width",2*t.xbord],["border-color",(0,i.qG)(`${t.a3}${t.c3}`)],["shadow-color",(0,i.qG)(`${t.a4}${t.c4}`)],["tag-blur",t.blur||t.be||0],["tag-xbord",t.xbord],["tag-ybord",t.ybord],["tag-xshad",t.xshad],["tag-yshad",t.yshad]].map((([t,e])=>[`--ass-${t}`,e]))}},59950:(t,e,r)=>{"use strict";function i(t){const{layer:e,align:r,effect:i,pos:s,margin:a,q:n}=t;let o="";return e&&(o+=`z-index:${e};`),o+=`text-align:${["left","center","right"][r.h]};`,i||(2!==n&&(o+=`max-width:calc(100% - var(--ass-scale) * ${a.left+a.right}px);`),s||(0!==r.h&&(o+=`padding-right:calc(var(--ass-scale) * ${a.right}px);`),2!==r.h&&(o+=`padding-left:calc(var(--ass-scale) * ${a.left}px);`))),o}r.d(e,{_:()=>i})},57131:(t,e,r)=>{"use strict";r.d(e,{IZ:()=>s,Lu:()=>o,ge:()=>a,l1:()=>n,r8:()=>i});const i=["frx","fry","frz"],s=["fscx","fscy"],a=["fax","fay"];function n(t){return[...[...i,...a].map((e=>[`--ass-tag-${e}`,`${t[e]||0}`])),...s.map((e=>[`--ass-tag-${e}`,t.p?1:(t[e]||100)/100]))]}function o(t,e){const{align:r,width:i,height:s,x:a,y:n,$div:o}=t,c=(t.org?t.org.x*e:a)+[0,i/2,i][r.h],d=(t.org?t.org.y*e:n)+[s,s/2,0][r.v];for(let t=o.childNodes.length-1;t>=0;t-=1){const e=o.childNodes[t];if(""===e.dataset.rotate){const t=c-a-e.offsetLeft,r=d-n-e.offsetTop;e.style.cssText+=`transform-origin:${t}px ${r}px;`}}}},77334:(t,e,r)=>{"use strict";function i(t){const e=t.match(/(\w\w)(\w\w)(\w\w)(\w\w)/),r=function(t){return 1-`0x${t}`/255}(e[1]),i=+`0x${e[2]}`,s=+`0x${e[3]}`;return`rgba(${+`0x${e[4]}`},${s},${i},${r})`}function s(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=Math.trunc(16*Math.random());return("x"===t?e:3&e|8).toString(16)}))}function a(t,e=[]){const r=document.createElementNS("http://www.w3.org/2000/svg",t);for(let t=0;t<e.length;t+=1){const i=e[t];r.setAttributeNS("xlink:href"===i[0]?"http://www.w3.org/1999/xlink":null,i[0],i[1])}return r}function n(t,e,r){const i=t.animate(e,r);return i.pause(),i}function o(t,e){(t.animations||[]).forEach((t=>{t[e]()}))}r.d(e,{An:()=>a,MA:()=>o,dT:()=>n,qG:()=>i,uR:()=>s})}},i={};function s(t){var e=i[t];if(void 0!==e)return e.exports;var a=i[t]={exports:{}};return r[t](a,a.exports,s),a.exports}s.m=r,s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},s.f={},s.e=t=>Promise.all(Object.keys(s.f).reduce(((e,r)=>(s.f[r](t,e),e)),[])),s.u=t=>t+".avplayer.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="AVPlayer:",s.l=(r,i,a,n)=>{if(t[r])t[r].push(i);else{var o,c;if(void 0!==a)for(var d=document.getElementsByTagName("script"),h=0;h<d.length;h++){var l=d[h];if(l.getAttribute("src")==r||l.getAttribute("data-webpack")==e+a){o=l;break}}o||(c=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.setAttribute("data-webpack",e+a),o.src=r),t[r]=[i];var u=(e,i)=>{o.onerror=o.onload=null,clearTimeout(f);var s=t[r];if(delete t[r],o.parentNode&&o.parentNode.removeChild(o),s&&s.forEach((t=>t(i))),e)return e(i)},f=setTimeout(u.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=u.bind(null,o.onerror),o.onload=u.bind(null,o.onload),c&&document.head.appendChild(o)}},s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;s.g.importScripts&&(t=s.g.location+"");var e=s.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&(!t||!/^http(s?):/.test(t));)t=r[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=t})(),(()=>{var t={792:0};s.f.j=(e,r)=>{var i=s.o(t,e)?t[e]:void 0;if(0!==i)if(i)r.push(i[2]);else{var a=new Promise(((r,s)=>i=t[e]=[r,s]));r.push(i[2]=a);var n=s.p+s.u(e),o=new Error;s.l(n,(r=>{if(s.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var a=r&&("load"===r.type?"missing":r.type),n=r&&r.target&&r.target.src;o.message="Loading chunk "+e+" failed.\n("+a+": "+n+")",o.name="ChunkLoadError",o.type=a,o.request=n,i[1](o)}}),"chunk-"+e,e)}};var e=(e,r)=>{var i,a,[n,o,c]=r,d=0;if(n.some((e=>0!==t[e]))){for(i in o)s.o(o,i)&&(s.m[i]=o[i]);c&&c(s)}for(e&&e(r);d<n.length;d++)a=n[d],s.o(t,a)&&t[a]&&t[a][0](),t[a]=0},r=self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})();var a=s(61634);return a.default})()));