"use strict";(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[531],{85947:(a,e,t)=>{t.d(e,{A:()=>s});var i=t(134);class s{constructor(){(0,i.A)(this,"type",-1),(0,i.A)(this,"onStreamAdd",void 0)}async destroy(a){}}},92047:(a,e,t)=>{t.r(e),t.d(e,{default:()=>A});var i=t(134),s=t(63939),r=t(50932),n=t(4624),o=t(9705),c=t(65977),d=t(74963),p=t(85947),l=t(85428),f=t(9690),m=t(72739),u=t(14686),w=t(37837),g=t(71517),h=t(44328),z=t(77231),v=t(39381),U=t(50315);const k="src\\avformat\\formats\\IMovFormat.ts";class A extends p.A{constructor(a={}){super(),(0,i.A)(this,"type",1),(0,i.A)(this,"context",void 0),(0,i.A)(this,"firstAfterSeek",void 0),(0,i.A)(this,"options",void 0),this.options=a,this.context=(0,f.A)(),a.ignoreEditlist&&(this.context.ignoreEditlist=!0)}init(a){a.ioReader&&a.ioReader.setEndian(!0),this.firstAfterSeek=!1}async readHeader(a){try{const e=await a.ioReader.fileSize();let t=0,i=await a.ioReader.readUint32(),s=await a.ioReader.readUint32();s===(0,c.A)("ftyp")?await d.E6(a.ioReader,this.context,{type:s,size:i-8}):(!e||i<e)&&await a.ioReader.skip(i-8);let r=BigInt(0);for(;!this.context.foundMoov;){const t=a.ioReader.getPos();if(t===e)return n.z3("the file format is not mp4",k,111),o.LR;if(i=await a.ioReader.readUint32(),s=await a.ioReader.readUint32(),1===i&&(i=Number(await a.ioReader.readUint64())),i<8||e&&t+BigInt(Math.floor(i))>e)return n.z3(`invalid box size ${i}`,k,124),o.LR;s===(0,c.A)("mdat")?(this.context.foundMdat||(r=t),this.context.foundMdat=!0,await a.ioReader.seek(t+BigInt(Math.floor(i)))):s===(0,c.A)("moov")?(await d.wB(a.ioReader,a,this.context,{size:i-8,type:s}),this.context.foundMoov=!0):await a.ioReader.seek(t+BigInt(Math.floor(i)))}if(!this.context.fragment&&!this.context.foundMdat){const e=await a.ioReader.peekUint64()>>BigInt(32);Number(e)===(0,c.A)("moof")&&(this.context.fragment=!0)}if(this.context.fragment&&1&a.ioReader.flags){const e=a.ioReader.getPos(),t=await a.ioReader.fileSize();if(t>BigInt(16)){await a.ioReader.seek(t-BigInt(12));let i=await a.ioReader.readUint32();if(i===(0,c.A)("mfro")){await a.ioReader.skip(4);const e=await a.ioReader.readUint32();await a.ioReader.seek(t-BigInt(Math.floor(e)));const s=await a.ioReader.readUint32();i=await a.ioReader.readUint32(),i===(0,c.A)("mfra")&&await d.t9(a.ioReader,a,this.context,{size:s-8,type:i})}await a.ioReader.seek(e)}}return!this.context.fragment&&this.context.foundMdat&&await a.ioReader.seek(r),t}catch(e){return n.z3(e.message,k,186),this.context.foundMoov||n.z3("moov not found",k,189),a.ioReader.error}}async readAVPacket_(a,e){const{sample:t,stream:i,encryption:n}=(0,l.G)(a,this.context,a.ioReader.flags);if(!t)return-1048576;{r.M[15](e+32,i.index),r.M[17](e+16,t.dts),r.M[17](e+8,t.pts),r.M[17](e+48,BigInt(Math.floor(t.duration))),r.M[15](e+36,s.f[15](e+36)|t.flags),r.M[17](e+56,t.pos),r.M[15](e+76,i.timeBase.den),r.M[15](e+72,i.timeBase.num),i.startTime===z.Dh&&(i.startTime=s.f[17](e+8));const o=s.f[17](e+56)-a.ioReader.getPos();o!==BigInt(0)&&(o>0&&(4&a.ioReader.flags||2&a.ioReader.flags)&&!this.firstAfterSeek?await a.ioReader.skip(Number(BigInt.asIntN(32,o))):await a.ioReader.seek(s.f[17](e+56))),this.firstAfterSeek&&(this.firstAfterSeek=!1);const d=t.size,p=(0,w.sY)(d);if((0,g.NX)(e,p,d),await a.ioReader.readBuffer(d,(0,u.JW)(p,d)),94226===i.codecpar.codecId&&s.f[15](e+28)>=8){const a=v.Sg(s.f[20](e+24)+4)>>>0,t=s.f[15](e+28);if(a===(0,c.A)("vtte")&&8===t){const a=(0,w.Gy)(1);(0,g.NX)(e,a,1),r.M[15](e+28,1)}if(t>8&&(a===(0,c.A)("vtte")||a===(0,c.A)("vttc"))){let a=s.f[20](e+24)+8;const i=s.f[20](e+24)+t;for(;a<i;){const t=v.Sg(a);if(v.Sg(a+4)>>>0===(0,c.A)("payl")&&t>8){const i=(0,w.sY)(t-8);(0,u.Mr)(i,a+8,t-8),(0,g.NX)(e,i,t-8);break}a+=t}}}if(i.sideData[1]&&1&s.f[15](e+36)){const a=i.sideData[1].length,t=(0,w.sY)(a);(0,g.Ow)(e,1,t,a),(0,u.lW)(t,a,i.sideData[1]),delete i.sideData[1]}if(n){const a=(0,U.zz)(n),t=(0,w.sY)(a.length);(0,u.lW)(t,a.length,a),(0,g.Ow)(e,25,t,a.length)}}return 0}async readAVPacket(a,e){try{if(!a.streams.find((a=>{var e;const t=a.privData;return(null===(e=t.samplesIndex)||void 0===e?void 0:e.length)&&!1===t.sampleEnd}))&&this.context.fragment&&!this.context.currentFragment)for(;!this.context.currentFragment;){const e=a.ioReader.getPos(),t=await a.ioReader.readUint32(),i=await a.ioReader.readUint32();i===(0,c.A)("moof")?(this.context.currentFragment={pos:e,size:t,sequence:0,tracks:[],currentTrack:null},this.context.firstMoof||(this.context.firstMoof=e),await d.wZ(a.ioReader,a,this.context,{type:i,size:t-8})):i===(0,c.A)("moov")?await d.wB(a.ioReader,a,this.context,{size:t-8,type:i}):await a.ioReader.skip(t-8)}return await this.readAVPacket_(a,e)}catch(e){return-1048576!==a.ioReader.error&&-1048572!==a.ioReader.error?(n.z3(`read packet error, ${e}`,k,348),o.LR):a.ioReader.error}}async seek(a,e,t,i){const s=a.ioReader.getPos();if(2&i)return await a.ioReader.seek(t),s;const r=t,n=e.privData,c=()=>{this.context.currentFragment=null,a.streams.forEach((a=>{a.privData.samplesIndex.length=0}))};if(16&i&&this.context.fragment){const i=(0,h.k)(t,e.timeBase,z.i0);return await a.ioReader.seek(i,!0),c(),s}if(this.context.fragment){if(n.fragIndexes.length){let e=m.El(n.fragIndexes,(a=>a.time>r?-1:a.time===r?0:1));if(e>-1)return e>0&&n.fragIndexes[e].time>r&&e--,await a.ioReader.seek(n.fragIndexes[e].pos,!0),c(),s}return r===BigInt(0)&&this.context.firstMoof?(await a.ioReader.seek(this.context.firstMoof),c(),s):BigInt(o.E$)}let d=m.El(n.samplesIndex,(a=>a.pts>r?-1:a.pts===r?0:1));if(d>-1&&0===e.codecpar.codecType){let a=d;for(;a>=0;a--)if(1&n.samplesIndex[a].flags){d=a;break}a<0&&(d=-1)}return d>-1?(n.currentSample=d,n.sampleEnd=!1,m.__(a.streams,(a=>{if(a!==e){const t=a.privData;let i=(0,h.k)(n.samplesIndex[n.currentSample].pts,e.timeBase,a.timeBase),s=m.El(t.samplesIndex,(a=>a.pts>i?-1:a.pts===i?0:1));if(s>-1&&0===a.codecpar.codecType){let a=s;for(;a>=0;a--)if(1&t.samplesIndex[a].flags){s=a;break}a<0&&(s=-1)}s>=0?(t.currentSample=s,t.sampleEnd=!1):(t.sampleEnd=!0,t.currentSample=t.samplesIndex.length)}})),this.firstAfterSeek=!0,s):BigInt(o.LR)}getAnalyzeStreamsCount(){return 0}}},13663:(a,e,t)=>{t.d(e,{h6:()=>s,s5:()=>n,uM:()=>r});var i=t(79682);const s={[(0,i.A)("mp4v")]:12,[(0,i.A)("DIVX")]:12,[(0,i.A)("XVID")]:12,[(0,i.A)("3IV2")]:12,[(0,i.A)("vvc1")]:196,[(0,i.A)("vvi1")]:196,[(0,i.A)("hev1")]:173,[(0,i.A)("hvc1")]:173,[(0,i.A)("dvhe")]:173,[(0,i.A)("hev1")]:173,[(0,i.A)("avc1")]:27,[(0,i.A)("avc2")]:27,[(0,i.A)("avc3")]:27,[(0,i.A)("avc4")]:27,[(0,i.A)("ai5p")]:27,[(0,i.A)("ai5q")]:27,[(0,i.A)("ai52")]:27,[(0,i.A)("ai53")]:27,[(0,i.A)("ai55")]:27,[(0,i.A)("ai56")]:27,[(0,i.A)("ai1p")]:27,[(0,i.A)("ai1q")]:27,[(0,i.A)("ai12")]:27,[(0,i.A)("ai13")]:27,[(0,i.A)("ai15")]:27,[(0,i.A)("ai16")]:27,[(0,i.A)("AVin")]:27,[(0,i.A)("aivx")]:27,[(0,i.A)("rv64")]:27,[(0,i.A)("xalg")]:27,[(0,i.A)("avlg")]:27,[(0,i.A)("dva1")]:27,[(0,i.A)("dvav")]:27,[(0,i.A)("vp08")]:139,[(0,i.A)("vp09")]:167,[(0,i.A)("av01")]:225},r={[(0,i.A)("mp4a")]:86018,[(0,i.A)("ac-3")]:86019,[(0,i.A)("sac3")]:86019,[(0,i.A)("ac-4")]:86119,[(0,i.A)("dtsc")]:86020,[(0,i.A)("dtsh")]:86020,[(0,i.A)("dtsl")]:86020,[(0,i.A)("dtse")]:86020,[(0,i.A)("DTS ")]:86020,[(0,i.A)("ec-3")]:86056,[(0,i.A)(".mp3")]:86017,[(0,i.A)("mp3 ")]:86017,1836253269:86017,[(0,i.A)("spex")]:86051,[(0,i.A)("SPXN")]:86051,[(0,i.A)("fLaC")]:86028,[(0,i.A)("Opus")]:86076,[(0,i.A)("alaw")]:65543,[(0,i.A)("ulaw")]:65542,[(0,i.A)("fl32")]:65557,[(0,i.A)("fl64")]:65559,[(0,i.A)("twos")]:65537,[(0,i.A)("lpcm")]:65536,[(0,i.A)("sowt")]:65536,[(0,i.A)("in24")]:65548,[(0,i.A)("in32")]:65544,[(0,i.A)("sowt")]:65540,[(0,i.A)("raw ")]:65541,[(0,i.A)("NONE")]:65541},n={[(0,i.A)("text")]:94213,[(0,i.A)("tx3g")]:94213,[(0,i.A)("c608")]:94218}},21071:(a,e,t)=>{t.d(e,{_l:()=>i,gQ:()=>s});const i=["hmhd","nmhd","iods","xml ","url ","bxml","ipro","mere","stts","ctts","stss","stsz","stz2","stsc","stco","co64","stsd","dref","mvhd","tkhd","mdhd","hdlr"],s=["moov","trak","edts","mdia","minf","dinf","stbl","mvex","moof","traf","vttc","tref","iref","mfra","hnti","hinf","strd","sinf","rinf","schi","trgr","udta","iprp","ipco","strk","meco","encv","enca","sinf","schi"]},61179:(a,e,t)=>{function i(a,e,t,i,s=0){const r=a.privData;let n=e.baseDataOffset+BigInt(Math.floor(e.dataOffset));(e.baseIsMoof||n<i)&&(n+=t.currentFragment.pos);let o=e.baseMediaDecodeTime;const c=e.sampleSizes,d=e.sampleDurations,p=e.sampleFlags,l=e.sampleCompositionTimeOffset,f=e.remainDataOffsets,m=e.remainDataOffsetIndex;let u=0;const w=[];for(let a=0;a<e.sampleCount;a++){m[u]===a&&(n=e.baseDataOffset+BigInt(Math.floor(f[u])),e.baseIsMoof&&(n+=t.currentFragment.pos),u++);const i={dts:o,pts:o+BigInt(Math.floor(l[a])),pos:n,size:c[a],duration:d[a],flags:0};o+=BigInt(Math.floor(i.duration)),n+=BigInt(Math.floor(i.size)),16842752&p[a]||(i.flags|=1),0===a&&c.length>1&&2&s&&(i.flags|=1),w.push(i)}r.samplesIndex=w;const g=t.cencs?t.cencs[r.trackId]:null;g&&e.cenc&&e.cenc.sampleEncryption&&(r.samplesEncryption=e.cenc.sampleEncryption.map((a=>({scheme:g.schemeType,keyId:g.defaultKeyId,skipByteBlock:g.skipByteBlock,cryptByteBlock:g.cryptByteBlock,iv:a.iv,subsamples:a.subsamples}))))}t.d(e,{p:()=>i})},98859:(a,e,t)=>{t.d(e,{X:()=>o});var i=t(4624),s=t(44328),r=t(77231);const n="src\\avformat\\formats\\mov\\function\\buildIndex.ts";function o(a,e){var t;const o=a.privData,c=o.chunkOffsets,d=o.sampleSizes,p=o.cttsSampleCounts,l=o.cttsSampleOffsets,f=o.stscFirstChunk,m=o.stscSamplesPerChunk,u=o.stssSampleNumbersMap,w=o.sttsSampleCounts,g=o.sttsSampleDeltas;if(!c.length)return;let h=0,z=0,v=0,U=0,k=0,A=0,I=BigInt(0),y=0,B=BigInt(0);const b=[];if(!e.ignoreEditlist&&null!==(t=a.metadata.elst)&&void 0!==t&&t.length){let t=BigInt(0),o=0,c=!1,d=BigInt(0),p=BigInt(0);for(let e=0;e<a.metadata.elst.length;e++){const t=a.metadata.elst[e];0===e&&t.mediaTime===-BigInt(1)?(d=t.segmentDuration,o=1):e===o&&t.mediaTime>=BigInt(0)?p=t.mediaTime:c=!0}c&&i.R8("multiple edit list entries, a/v desync might occur, patch welcome",n,93),(d||p)&&e.timescale>0&&(d&&(d=(0,s.k)(d,{num:1,den:e.timescale},a.timeBase),a.duration!==r.Dh&&(a.duration+=d)),t=p-d,B=-t)}for(let e=0;e<c.length;e++)for(I=c[e],h<f.length-1&&f[h+1]===e+1&&h++,A=m[h];A>0;){const e={dts:B,pts:B,pos:I,size:d[y],duration:g[z],flags:0};(u&&u.has(y+1)||1===a.codecpar.codecType)&&(e.flags|=1),l&&(e.pts=e.dts+BigInt(Math.floor(l[U])),k++,k===p[U]&&(U++,k=0)),I+=BigInt(Math.floor(e.size)),B+=BigInt(Math.floor(g[z])),v++,v===w[z]&&(z++,v=0),y++,b.push(e),A--}b.length&&a.duration===r.Dh&&(a.duration=b[y-1].pts+BigInt(Math.floor(b[y-1].duration))),o.samplesIndex=b}},3384:(a,e,t)=>{t.d(e,{A:()=>s});var i=t(77231);function s(){return{trackId:0,baseDataOffset:BigInt(0),defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlags:0,baseMediaDecodeTime:BigInt(0),sampleCount:0,dataOffset:0,remainDataOffsets:[],remainDataOffsetIndex:[],dataOffsetPos:BigInt(0),firstSampleFlags:0,sampleDurations:[],sampleSizes:[],sampleFlags:[],sampleCompositionTimeOffset:[],baseIsMoof:!1,ioWriter:null,buffers:[],lastFragIndexDts:BigInt(0),tfdtDelay:i.Dh,trunPtsDelay:BigInt(0)}}},9690:(a,e,t)=>{t.d(e,{A:()=>s});var i=t(77231);function s(){return{isom:!1,timescale:i.N_,duration:i.Dh,foundMoov:!1,foundMdat:!1,majorBrand:0,minorVersion:0,compatibleBrand:[],creationTime:BigInt(0),modificationTime:BigInt(0),rate:i.N_,volume:i.N_,matrix:null,nextTrackId:1,fragment:!1,trexs:[],currentFragment:null,boxsPositionInfo:[],holdMoovPos:BigInt(0),currentChunk:null}}},38106:(a,e,t)=>{t.d(e,{A:()=>s});var i=t(77231);function s(){return{chunkOffsets:null,cttsSampleCounts:null,cttsSampleOffsets:null,stscFirstChunk:null,stscSamplesPerChunk:null,stscSampleDescriptionIndex:null,stssSampleNumbersMap:null,stssSampleNumbers:null,sampleSizes:null,sttsSampleCounts:null,sttsSampleDeltas:null,duration:BigInt(0),trackId:i.N_,layer:0,alternateGroup:0,volume:0,matrix:null,width:0,height:0,audioCid:0,samplesPerFrame:0,bytesPerFrame:0,currentSample:0,sampleEnd:!1,samplesIndex:[],samplesEncryption:[],fragIndexes:[],lastPts:i.Dh,lastDts:i.Dh,startDts:i.Dh,startCT:i.N_,startPts:i.Dh,lastDuration:0,chunkCount:0,firstWrote:!1,lastStscCount:0,perStreamGrouping:!1,index:0,flags:0}}},85428:(a,e,t)=>{t.d(e,{G:()=>r});var i=t(77231),s=t(44328);function r(a,e,t){let r,n,o,c,d,p,l,f=BigInt(0);if(a.streams.forEach((a=>{const e=a.privData;if(!e.samplesIndex||!e.samplesIndex.length)return e.sampleEnd=!0,!0;e.sampleEnd||c&&!(e.samplesIndex[e.currentSample].pos<c.pos)||(c=e.samplesIndex[e.currentSample],d=a),e.sampleEnd||p&&!((0,s.k)(e.samplesIndex[e.currentSample].dts,a.timeBase,i.KR)<f)||(p=e.samplesIndex[e.currentSample],f=(0,s.k)(p.dts,a.timeBase,i.KR),l=a)})),c&&p){const e=(0,s.k)(c.dts,d.timeBase,i.KR),o=(0,s.k)(p.dts,l.timeBase,i.KR);Math.abs(Number(e-o))<1e6||2&a.ioReader.flags||4&a.ioReader.flags||!(1&t)?(r=c,n=d):(r=p,n=l)}else c?(r=c,n=d):p&&(r=p,n=l);if(n){const a=n.privData;o=a.samplesEncryption[a.currentSample],a.currentSample++,a.currentSample>=a.samplesIndex.length&&(a.sampleEnd=!0)}if(e.fragment){const t=!!a.streams.find((a=>!1===a.privData.sampleEnd));t||(e.currentFragment=null)}return{sample:r,stream:n,encryption:o}}},74963:(a,e,t)=>{t.d(e,{E6:()=>z,t9:()=>A,wB:()=>U,wZ:()=>k});var i=t(61499),s=t(65977),r=t(21071),n=t(68361),o=t(4624),c=t(61179),d=t(98859),p=t(3384),l=t(38106),f=t(37837),m=t(14686),u=t(77231),w=t(50315),g=t(71517);const h="src\\avformat\\formats\\mov\\imov.ts";async function z(a,e,t){const i=a.getPos()+BigInt(Math.floor(t.size));for(e.majorBrand=await a.readUint32(),e.minorVersion=await a.readUint32(),e.majorBrand===(0,s.A)("qt  ")&&(e.isom=!0);a.getPos()<i;)e.compatibleBrand.push(await a.readUint32())}async function v(a,e,t,i){const c=a.getPos()+BigInt(Math.floor(t.size));for(;a.getPos()<c;){const t=await a.readUint32(),c=await a.readUint32();if(t<8)return void o.z3(`invalid box size ${t}`,h,74);if(n.A[c])await n.A[c](a,e,{type:c,size:t-8},i);else if(c===(0,s.A)("mdia")){let o=!1,c=BigInt(0);const d=a.getPos()+BigInt(Math.floor(t-8));for(;a.getPos()<d;){const t=await a.readUint32(),d=await a.readUint32();d===(0,s.A)("hdlr")?(await n.A[d](a,e,{type:d,size:t-8},i),o=!0):d===(0,s.A)("minf")&&o?await v(a,e,{type:d,size:t-8},i):d!==(0,s.A)("minf")||o?n.A[d]?await n.A[d](a,e,{type:d,size:t-8},i):r.gQ.some((a=>(0,s.A)(a)===d))?await v(a,e,{type:d,size:t-8},i):await a.skip(t-8):(c=a.getPos()-BigInt(8),await a.skip(t-8))}if(c){const t=a.getPos();await a.seek(c);const s=await a.readUint32(),r=await a.readUint32();await v(a,e,{type:r,size:s-8},i),await a.seek(t)}}else r.gQ.some((a=>(0,s.A)(a)===c))?await v(a,e,{type:c,size:t-8},i):await a.skip(t-8)}}async function U(a,e,t,r){t.parseOneBox=v,t.parsers=n.A;const c=a.getPos()+BigInt(Math.floor(r.size));for(;a.getPos()<c;){const i=await a.readUint32(),r=await a.readUint32();if(i<8)return void o.z3(`invalid box, type: ${r}, size ${i}`,h,207);if(n.A[r])await n.A[r](a,null,{type:r,size:i-8},t);else if(r===(0,s.A)("trak"))if(!t.foundMoov||t.fragment){const s=e.createStream();if(s.privData=(0,l.A)(),await v(a,s,{type:r,size:i-8},t),t.fragment){const a=s.privData,t=e.streams.find((e=>{const t=e.privData;if(e.index!==s.index&&t.trackId===a.trackId)return!0}));t?(s.sideData[1]&&(t.sideData[1]=s.sideData[1],t.codecpar.extradata&&(0,f.Eb)(t.codecpar.extradata),t.codecpar.extradataSize=t.sideData[1].length,t.codecpar.extradata=(0,f.sY)(t.codecpar.extradataSize),(0,m.lW)(t.codecpar.extradata,t.codecpar.extradataSize,t.sideData[1]),s.codecpar.width!==u.N_&&a.width>0&&(t.codecpar.width=a.width),s.codecpar.width!==u.N_&&a.height>0&&(t.codecpar.height=a.height)),e.removeStream(s),e.streamIndex--):(s.codecpar.width===u.N_&&a.width>0&&(s.codecpar.width=a.width),s.codecpar.width===u.N_&&a.height>0&&(s.codecpar.height=a.height))}else(0,d.X)(s,t)}else await a.skip(i-8);else r===(0,s.A)("mvex")?(t.fragment=!0,await v(a,null,{type:r,size:i-8},t)):await a.skip(i-8)}e.streams.forEach((a=>{if(t.encryptionInitInfos){const e=(0,w.bE)(t.encryptionInitInfos),s=(0,f.sY)(e.length);(0,m.lW)(s,e.length,e),(0,g.$W)(a.codecpar[i.o9]+20,a.codecpar[i.o9]+24,24,s,e.length)}if(t.cencs){const e=a.privData,i=t.cencs[e.trackId];i&&(a.metadata.encryption={schemeType:i.schemeType,schemeVersion:i.schemeVersion,cryptByteBlock:i.cryptByteBlock,skipByteBlock:i.skipByteBlock,perSampleIVSize:i.defaultPerSampleIVSize,kid:i.defaultKeyId,constantIV:i.defaultConstantIV,pattern:i.pattern})}}))}async function k(a,e,t,i){const r=a.getPos()+BigInt(Math.floor(i.size));for(;a.getPos()<r;){const i=await a.readUint32(),r=await a.readUint32();if(i<8)return void o.z3(`invalid box, type: ${r}, size ${i}`,h,341);if(n.A[r])await n.A[r](a,null,{type:r,size:i-8},t);else if(r===(0,s.A)("traf")){const s=(0,p.A)();t.currentFragment.currentTrack=s,await v(a,null,{type:r,size:i-8},t),t.currentFragment.tracks.push(s),t.currentFragment.currentTrack=null;const n=e.streams.find((a=>a.privData.trackId===s.trackId));if(n){const a=n.privData;s.streamIndex=n.index,(0,c.p)(n,s,t,e.ioReader.getPos(),e.ioReader.flags),a.currentSample=0,a.sampleEnd=!1}}else await a.skip(i-8)}}async function A(a,e,t,i){const r=a.getPos()+BigInt(Math.floor(i.size)),n={};for(e.streams.forEach((a=>{const e=a.privData;n[a.index]={samples:e.samplesIndex,currentSample:e.currentSample,sampleEnd:e.sampleEnd},e.samplesIndex=[]}));a.getPos()<r;){const i=a.getPos(),r=await a.readUint32();if(await a.readUint32()===(0,s.A)("tfra")){const i=await a.readUint8();await a.skip(3);const r=await a.readUint32(),n=await a.readUint32(),o=await a.readUint32(),c=e.streams.find((a=>a.privData.trackId===r));if(c){const r=c.privData;let d,p;for(let e=0;e<o;e++){1===i?(d=await a.readUint64(),p=await a.readUint64()):(d=BigInt(Math.floor(await a.readUint32())),p=BigInt(Math.floor(await a.readUint32()))),r.fragIndexes.push({pos:p,time:d});for(let e=0;e<1+(n>>4&3);e++)await a.skip(1);for(let e=0;e<1+(n>>2&3);e++)await a.skip(1);for(let e=0;e<1+(3&n);e++)await a.skip(1)}if(r.fragIndexes.length){await a.seek(r.fragIndexes[r.fragIndexes.length-1].pos);const i=await a.readUint32(),n=await a.readUint32();if(n===(0,s.A)("moof")&&(t.currentFragment={pos:BigInt(0),size:i,sequence:0,tracks:[],currentTrack:null},await k(a,e,t,{size:i,type:n}),r.samplesIndex.length)){const a=r.samplesIndex[r.samplesIndex.length-1];c.duration=a.pts+BigInt(Math.floor(a.duration)),r.samplesIndex.length=0}}}}await a.seek(i+BigInt(Math.floor(r)),!1,!1)}t.currentFragment=null,e.streams.forEach((a=>{var e,t,i,s,r,o;const c=a.privData;c.samplesIndex=null!==(e=null===(t=n[a.index])||void 0===t?void 0:t.samples)&&void 0!==e?e:[],c.currentSample=null!==(i=null===(s=n[a.index])||void 0===s?void 0:s.currentSample)&&void 0!==i?i:0,c.sampleEnd=null!==(r=null===(o=n[a.index])||void 0===o?void 0:o.sampleEnd)&&void 0!==r&&r}))}},6660:(a,e,t)=>{t.d(e,{Q9:()=>r,f3:()=>n,uf:()=>o,zs:()=>s});var i=t(65977);const s={86018:64,86017:105,86076:173,86028:193,86021:221,12:32,27:33,173:35,196:51,167:177,0:0},r={32:12,33:27,35:173,51:196,177:167,64:86018,102:86018,103:86018,104:86018,105:86017,107:86017,173:86076,193:86028,221:86021,0:0},n={vide:0,soun:1,clcp:3,sbtl:3,subt:3,subp:3,text:3},o={[(0,i.A)("mp4a")]:86018,1836253269:86017,[(0,i.A)("Opus")]:86076,[(0,i.A)("fLaC")]:86028,[(0,i.A)("spex")]:86051,[(0,i.A)("SPXN")]:86051,[(0,i.A)("ac-3")]:86019,[(0,i.A)("sac3")]:86019,[i.A.mp4v]:12,[(0,i.A)("av01")]:225,[(0,i.A)("vp08")]:139,[(0,i.A)("vp09")]:167,[(0,i.A)("avc1")]:27,[(0,i.A)("hev1")]:173,[(0,i.A)("hvc1")]:173,[(0,i.A)("vvc1")]:196,[(0,i.A)("vvi1")]:196,[(0,i.A)("text")]:94213,[(0,i.A)("tx3g")]:94213}},38582:(a,e,t)=>{t.d(e,{A:()=>c});var i=t(4624),s=t(14686),r=t(37837),n=t(21477);const o="src\\avformat\\formats\\mov\\parsing\\av1c.ts";async function c(a,e,t,c){const d=a.getPos();if(e.codecpar.codecId=225,t.size<=0)return;const p=(0,r.sY)(t.size),l=await a.readBuffer(t.size,(0,s.JW)(p,t.size));c.foundMoov?(e.sideData[1]=l.slice(),(0,r.Eb)(p)):(e.codecpar.extradata&&(0,r.Eb)(e.codecpar.extradata),e.codecpar.extradata=p,e.codecpar.extradataSize=t.size,n.XC(e,l));const f=t.size-Number(a.getPos()-d);f>0?await a.skip(f):f<0&&i.z3(`read avcc error, size: ${t.size}, read: ${t.size-f}`,o,66)}},73840:(a,e,t)=>{t.d(e,{A:()=>c});var i=t(37837),s=t(14686),r=t(4624),n=t(62815);const o="src\\avformat\\formats\\mov\\parsing\\avcc.ts";async function c(a,e,t,c){const d=a.getPos();if(e.codecpar.codecId=27,t.size<=0)return;const p=(0,i.sY)(t.size),l=await a.readBuffer(t.size,(0,s.JW)(p,t.size));c.foundMoov?(e.sideData[1]=l.slice(),(0,i.Eb)(p)):(e.codecpar.extradata&&(0,i.Eb)(e.codecpar.extradata),e.codecpar.extradata=p,e.codecpar.extradataSize=t.size,n.XC(e,l));const f=t.size-Number(a.getPos()-d);f>0?await a.skip(f):f<0&&r.z3(`read avcc error, size: ${t.size}, read: ${t.size-f}`,o,66)}},37213:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\co64.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const c=[],d=await a.readUint32();if(0===o)for(let e=0;e<d;e++)c.push(await a.readUint64());e.privData.chunkOffsets=c;const p=t.size-Number(a.getPos()-n);p>0?await a.skip(p):p<0&&i.z3(`read co64 error, size: ${t.size}, read: ${t.size-p}`,s,54)}},12869:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\colr.ts";async function r(a,e,t,r){const n=a.getPos();let o=await a.readString(4);if("nclx"===o||"nclc"===o||"prof"===o)if("prof"===o){const i=await a.readBuffer(t.size-4);e.sideData[28]=i}else{let t=await a.readUint16(),i=await a.readUint16(),s=await a.readUint16();if("nclx"===o){const t=await a.readUint8()>>7;e.codecpar.colorRange=t?2:1}t>=23&&(t=2),i>=19&&(i=2),s>=15&&(s=2),e.codecpar.colorPrimaries=t,e.codecpar.colorTrc=i,e.codecpar.colorSpace=s}else i.R8(`unsupported color_parameter_type: ${o}`,s,77);const c=t.size-Number(a.getPos()-n);c>0?await a.skip(c):c<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-c}`,s,85)}},59299:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\ctts.ts";async function r(a,e,t,r){const n=a.getPos(),o=e.privData;await a.skip(4);const c=[],d=[],p=await a.readUint32();for(let e=0;e<p;e++)c.push(await a.readUint32()),d.push(await a.readInt32());o.cttsSampleCounts=c,o.cttsSampleOffsets=d;const l=t.size-Number(a.getPos()-n);l>0?await a.skip(l):l<0&&i.z3(`read ctts error, size: ${t.size}, read: ${t.size-l}`,s,57)}},7320:(a,e,t)=>{t.d(e,{A:()=>l});var i=t(61499),s=t(63939),r=t(50932),n=t(4624),o=t(71517),c=t(87518),d=t(99991);const p="src\\avformat\\formats\\mov\\parsing\\dac3.ts";async function l(a,e,t,l){const f=a.getPos();if(e.codecpar.codecId=86019,t.size<=0)return;const m=(0,o.E4)(e.codecpar[i.o9]+20,e.codecpar[i.o9]+24,7,4),u=s.f[20](m),w=await a.readUint24(),g=w>>14&7,h=w>>11&7,z=w>>10&1;let v=BigInt(c.j[h]);z&&(v|=BigInt(8)),d.bl(e.codecpar[i.o9]+112),d.ML(e.codecpar[i.o9]+112,v),r.M[15](u,g);const U=t.size-Number(a.getPos()-f);U>0?await a.skip(U):U<0&&n.z3(`read avcc error, size: ${t.size}, read: ${t.size-U}`,p,75)}},36868:(a,e,t)=>{t.d(e,{A:()=>l});var i=t(61499),s=t(63939),r=t(50932),n=t(4624),o=t(71517),c=t(87518),d=t(99991);const p="src\\avformat\\formats\\mov\\parsing\\dec3.ts";async function l(a,e,t,l){const f=a.getPos();if(e.codecpar.codecId=86056,t.size<=0)return;const m=(0,o.E4)(e.codecpar[i.o9]+20,e.codecpar[i.o9]+24,7,4),u=s.f[20](m);await a.skip(2);const w=await a.readUint24(),g=w>>12&31,h=w>>9&7,z=w>>8&1;let v=BigInt(c.j[h]);z&&(v|=BigInt(8)),d.bl(e.codecpar[i.o9]+112),d.ML(e.codecpar[i.o9]+112,v),r.M[15](u,g),e.codecpar.chLayout.nbChannels>1&&7==g&&r.M[15](u,8);const U=t.size-Number(a.getPos()-f);U>0?await a.skip(U):U<0&&n.z3(`read avcc error, size: ${t.size}, read: ${t.size-U}`,p,80)}},86528:(a,e,t)=>{t.d(e,{A:()=>c});var i=t(4624),s=t(37837),r=t(14686),n=t(14769);const o="src\\avformat\\formats\\mov\\parsing\\dfla.ts";async function c(a,e,t,c){const d=a.getPos();e.codecpar.codecId=86028,await a.skip(1),await a.skip(3);const p=await a.readUint8(),l=128&p,f=127&p,m=await a.readUint24();if(0===f&&34===m){const t=(0,s.sY)(m),i=await a.readBuffer(m,(0,r.JW)(t,m));c.foundMoov?(e.sideData[1]=i.slice(),(0,s.Eb)(t)):(e.codecpar.extradata&&(0,s.Eb)(e.codecpar.extradata),e.codecpar.extradata=t,e.codecpar.extradataSize=m,n.XC(e,i))}else i.z3("streaminfo must be first FLACMetadataBlock",o,69);l||i.R8("non streaminfo FLACMetadataBlock(s) ignored",o,73);const u=t.size-Number(a.getPos()-d);u>0?await a.skip(u):u<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-u}`,o,81)}},41781:(a,e,t)=>{t.d(e,{A:()=>p});var i=t(4624),s=t(37837),r=t(14686),n=t(22576),o=t(31865),c=t(729);const d="src\\avformat\\formats\\mov\\parsing\\dops.ts";async function p(a,e,t,p){const l=a.getPos();e.codecpar.codecId=86076,await a.skip(1);const f=(0,s.sY)(t.size+8),m=(0,r.JW)(f,t.size+8),u=new o.A(m),w=new c.A(m,!1);w.writeString("OpusHead"),w.writeUint8(1),await a.readBuffer(t.size-1,(0,r.JW)(f+9,t.size-1)),u.seek(10),w.seek(10),w.writeUint16(u.readUint16()),w.writeUint32(u.readUint32()),w.writeUint16(u.readUint16()),p.foundMoov?(e.sideData[1]=m.slice(),(0,s.Eb)(f)):(e.codecpar.extradata&&(0,s.Eb)(e.codecpar.extradata),e.codecpar.extradata=f,e.codecpar.extradataSize=m.length,n.XC(e,m));const g=t.size-Number(a.getPos()-l);g>0?await a.skip(g):g<0&&i.z3(`read dops error, size: ${t.size}, read: ${t.size-g}`,d,82)}},30875:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\elst.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const c=await a.readInt32(),d=[];for(let e=0;e<c;e++){let e=BigInt(0),t=BigInt(0);1===o?(e=await a.readInt64(),t=await a.readInt64()):(e=BigInt(Math.floor(await a.readInt32())),t=BigInt(Math.floor(await a.readInt32())));const i=await a.readInt16(),s=await a.readInt16();d.push({segmentDuration:e,mediaTime:t,mediaRate:i,mediaRateFraction:s})}e.metadata.elst=d;const p=t.size-Number(a.getPos()-n);p>0?await a.skip(p):p<0&&i.z3(`read elst error, size: ${t.size}, read: ${t.size-p}`,s,75)}},28412:(a,e,t)=>{t.d(e,{A:()=>l});var i=t(4624),s=t(6660),r=t(37837),n=t(14686),o=t(95832),c=t(22576);const d="src\\avformat\\formats\\mov\\parsing\\esds.ts";async function p(a){let e=0;for(let t=0;t<4;t++){const t=await a.readUint8();if(e=e<<7|127&t,!(128&t))break}return e}async function l(a,e,t,l){const f=a.getPos();await a.skip(4);let m=a.getPos()+BigInt(Math.floor(t.size-4));for(;a.getPos()<m;){let t=await a.readUint8(),f=await p(a);if(0!==f)if(3===t){let m=a.getPos()+BigInt(Math.floor(f));if(await a.skip(2),await a.skip(1),t=await a.readUint8(),f=await p(a),0===f){i.R8("esds invalid ES descriptor size 0, skip",d,81),await a.skip(Number(m-a.getPos()));continue}if(4===t)if(e.codecpar.codecId=s.Q9[await a.readUint8()],await a.skip(1),await a.skip(3),await a.skip(4),await a.skip(4),a.getPos()<m-BigInt(5))if(t=await a.readUint8(),f=await p(a),5===t){const t=(0,r.sY)(f),i=await a.readBuffer(f,(0,n.JW)(t,f));l.foundMoov?(e.sideData[1]=i.slice(),(0,r.Eb)(t)):(e.codecpar.extradata=t,e.codecpar.extradataSize=f,86018===e.codecpar.codecId?o.XC(e,i.slice()):86076===e.codecpar.codecId&&c.XC(e,i.slice()))}else await a.skip(Number(m-a.getPos()));else await a.skip(Number(m-a.getPos()));else await a.skip(Math.min(f,Number(m-a.getPos())))}else await a.skip(Math.min(f,Number(m-a.getPos())));else i.R8("esds invalid descriptor size 0, skip",d,64),await a.skip(Number(m-a.getPos()))}const u=t.size-Number(a.getPos()-f);u>0?await a.skip(u):u<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-u}`,d,149)}},9239:(a,e,t)=>{t.d(e,{A:()=>n});var i=t(4624),s=t(13663);const r="src\\avformat\\formats\\mov\\parsing\\frma.ts";async function n(a,e,t,n){const o=a.getPos(),c=await a.peekUint32();a.setEndian(!1);const d=await a.readUint32();a.setEndian(!0);let p=s.uM[d];p>0&&0!==e.codecpar.codecType?e.codecpar.codecType=1:1!==e.codecpar.codecType&&(p=s.h6[d],p>0?e.codecpar.codecType=0:(p=s.s5[d],e.codecpar.codecType=3)),e.codecpar.codecTag=c,e.codecpar.codecId=p;const l=t.size-Number(a.getPos()-o);l>0?await a.skip(l):l<0&&i.z3(`read frma error, size: ${t.size}, read: ${t.size-l}`,r,66)}},40179:(a,e,t)=>{t.d(e,{A:()=>o});var i=t(4624),s=t(34677),r=t(6660);const n="src\\avformat\\formats\\mov\\parsing\\hdlr.ts";async function o(a,e,t,o){const c=a.getPos(),d=await a.readUint8();if(await a.skip(3),0===d){await a.skip(4);const i=await a.readString(4),n=r.f3[i];(0,s.A)(n)&&(e.codecpar.codecType=n),await a.skip(4),await a.skip(4),await a.skip(4);const c=t.size-24;if(c>0){const t=!o.isom&&await a.peekUint8()===c-1;t&&await a.skip(1),e.metadata.handlerName=await a.readString(c-(t?1:0))}}const p=t.size-Number(a.getPos()-c);p>0?await a.skip(p):p<0&&i.z3(`read hdlr error, size: ${t.size}, read: ${t.size-p}`,n,76)}},31421:(a,e,t)=>{t.d(e,{A:()=>c});var i=t(37837),s=t(14686),r=t(4624),n=t(67659);const o="src\\avformat\\formats\\mov\\parsing\\hvcc.ts";async function c(a,e,t,c){const d=a.getPos();if(e.codecpar.codecId=173,t.size<=0)return;const p=(0,i.sY)(t.size),l=await a.readBuffer(t.size,(0,s.JW)(p,t.size));c.foundMoov?(e.sideData[1]=l.slice(),(0,i.Eb)(p)):(e.codecpar.extradata&&(0,i.Eb)(e.codecpar.extradata),e.codecpar.extradata=p,e.codecpar.extradataSize=t.size,n.XC(e,l));const f=t.size-Number(a.getPos()-d);f>0?await a.skip(f):f<0&&r.z3(`read hevc error, size: ${t.size}, read: ${t.size-f}`,o,66)}},45248:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\mdhd.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);let c=BigInt(0),d=BigInt(0),p=0,l=BigInt(0);1===o?(c=await a.readUint64(),d=await a.readUint64(),p=await a.readUint32(),l=await a.readUint64()):(c=BigInt(Math.floor(await a.readUint32())),d=BigInt(Math.floor(await a.readUint32())),p=await a.readUint32(),l=BigInt(Math.floor(await a.readUint32()))),e.duration=l,e.timeBase.den=p,e.timeBase.num=1,e.metadata.creationTime=c,e.metadata.modificationTime=d;const f=await a.readUint16(),m=[];m[0]=f>>10&31,m[1]=f>>5&31,m[2]=31&f;const u=String.fromCharCode(m[0]+96,m[1]+96,m[2]+96);e.metadata.language=f,e.metadata.languageString=u,await a.skip(2);const w=t.size-Number(a.getPos()-n);w>0?await a.skip(w):w<0&&i.z3(`read mdhd error, size: ${t.size}, read: ${t.size-w}`,s,82)}},7018:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\mfhd.ts";async function r(a,e,t,r){const n=a.getPos();await a.readUint8(),await a.skip(3),r.currentFragment.sequence=await a.readUint32();const o=t.size-Number(a.getPos()-n);o>0?await a.skip(o):o<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-o}`,s,47)}},19354:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\mvhd.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3),1===o?(r.creationTime=await a.readUint64(),r.modificationTime=await a.readUint64(),r.timescale=await a.readUint32(),r.duration=await a.readUint64()):(r.creationTime=BigInt(Math.floor(await a.readUint32())),r.modificationTime=BigInt(Math.floor(await a.readUint32())),r.timescale=await a.readUint32(),r.duration=BigInt(Math.floor(await a.readUint32()))),r.rate=await a.readUint32(),r.volume=await a.readUint16()>>>8,await a.skip(10),r.matrix=new Uint32Array(9);for(let e=0;e<9;e++)r.matrix[e]=await a.readUint32();await a.skip(24),r.nextTrackId=await a.readUint32();const c=t.size-Number(a.getPos()-n);c>0?await a.skip(c):c<0&&i.z3(`read mvhd error, size: ${t.size}, read: ${t.size-c}`,s,68)}},68361:(a,e,t)=>{t.d(e,{A:()=>M});var i=t(91635),s=t(59299),r=t(63080),n=t(62831),o=t(6570),c=t(34136),d=t(15692),p=t(37213),l=t(45248),f=t(19354),m=t(27436),u=t(40179),w=t(35173),g=t(25778),h=t(7018),z=t(61807),v=t(67523),U=t(58996),k=t(30875),A=t(74551),I=t(9239),y=t(168),B=t(89417),b=t(48265),x=t(82302),P=t(73066),S=t(65977);const M={[(0,S.A)("stts")]:i.A,[(0,S.A)("ctts")]:s.A,[(0,S.A)("stss")]:r.A,[(0,S.A)("stsz")]:n.A,[(0,S.A)("stz2")]:o.A,[(0,S.A)("stsc")]:c.A,[(0,S.A)("stco")]:d.A,[(0,S.A)("co64")]:p.A,[(0,S.A)("mdhd")]:l.A,[(0,S.A)("mvhd")]:f.A,[(0,S.A)("tkhd")]:m.A,[(0,S.A)("hdlr")]:u.A,[(0,S.A)("stsd")]:w.A,[(0,S.A)("elst")]:k.A,[(0,S.A)("trex")]:g.A,[(0,S.A)("mfhd")]:h.A,[(0,S.A)("tfhd")]:z.A,[(0,S.A)("tfdt")]:v.A,[(0,S.A)("trun")]:U.A,[(0,S.A)("pssh")]:A.A,[(0,S.A)("frma")]:I.A,[(0,S.A)("schm")]:y.A,[(0,S.A)("tenc")]:B.A,[(0,S.A)("saio")]:b.A,[(0,S.A)("saiz")]:x.A,[(0,S.A)("senc")]:P.A}},74551:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\pssh.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const c=r.encryptionInitInfos||[],d={systemId:await a.readBuffer(16),keyIds:[],data:null};if(o>0){const e=await a.readUint32();for(let t=0;t<e;t++)d.keyIds.push(await a.readBuffer(16))}const p=await a.readUint32();d.data=await a.readBuffer(p),c.push(d),r.encryptionInitInfos=c;const l=t.size-Number(a.getPos()-n);l>0?await a.skip(l):l<0&&i.z3(`read pssh error, size: ${t.size}, read: ${t.size-l}`,s,66)}},48265:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\saio.ts";async function r(a,e,t,r){const n=a.getPos(),o=r.currentFragment.currentTrack,c=r.cencs?r.cencs[o.trackId]:null,d=await a.readUint8();if(1&await a.readUint24()){const e=await a.readUint32(),t=await a.readUint32();if(!c)return void await l();if(e!==c.schemeType)return i.R8("Ignoring saio box with non-zero aux_info_type",s,44),void await l();if(0!==t)return i.R8("Ignoring saio box with non-zero aux_info_type_parameter",s,49),void await l()}else if(!c)return void await l();o.cenc||(o.cenc={defaultSampleInfoSize:0,sampleCount:0,offset:0,useSubsamples:!1,sampleEncryption:[],sampleSizes:[],sampleInfoOffset:[]});const p=await a.readUint32();for(let e=0;e<p;e++)o.cenc.sampleInfoOffset.push(0===d?await a.readUint32():await a.readUint64());async function l(){const e=t.size-Number(a.getPos()-n);e>0?await a.skip(e):e<0&&i.z3(`read saio error, size: ${t.size}, read: ${t.size-e}`,s,88)}await l()}},82302:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\saiz.ts";async function r(a,e,t,r){const n=a.getPos(),o=r.currentFragment.currentTrack,c=r.cencs?r.cencs[o.trackId]:null;if(await a.skip(1),1&await a.readUint24()){const e=await a.readUint32(),t=await a.readUint32();if(!c)return void await d();if(e!==c.schemeType)return i.R8("Ignoring saiz box with non-zero aux_info_type",s,47),void await d();if(0!==t)return i.R8("Ignoring saiz box with non-zero aux_info_type_parameter",s,52),void await d()}else if(!c)return void await d();if(o.cenc||(o.cenc={defaultSampleInfoSize:0,sampleCount:0,offset:0,useSubsamples:!1,sampleEncryption:[],sampleSizes:[],sampleInfoOffset:[]}),o.cenc.defaultSampleInfoSize=await a.readUint8(),o.cenc.sampleCount=await a.readUint32(),0===o.cenc.defaultSampleInfoSize){if(!o.cenc.sampleCount)return i.z3("invalid saiz data",s,83),void await d();for(let e=0;e<o.cenc.sampleCount;e++)o.cenc.sampleSizes.push(await a.readUint8())}async function d(){const e=t.size-Number(a.getPos()-n);e>0?await a.skip(e):e<0&&i.z3(`read saiz error, size: ${t.size}, read: ${t.size-e}`,s,99)}await d()}},168:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\schm.ts";async function r(a,e,t,r){const n=a.getPos();await a.skip(4);const o=e.privData;let c=r.cencs?r.cencs[o.trackId]:null;c||(c={schemeType:0,schemeVersion:0,isProtected:0,defaultPerSampleIVSize:0,defaultKeyId:null,defaultConstantIV:null,cryptByteBlock:0,skipByteBlock:0,pattern:!1}),c.schemeType=await a.readUint32(),c.schemeVersion=await a.readUint32(),r.cencs?r.cencs[o.trackId]=c:r.cencs={[o.trackId]:c};const d=t.size-Number(a.getPos()-n);d>0?await a.skip(d):d<0&&i.z3(`read schm error, size: ${t.size}, read: ${t.size-d}`,s,72)}},73066:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\senc.ts";async function r(a,e,t,r){const n=a.getPos(),o=r.currentFragment.currentTrack,c=r.cencs?r.cencs[o.trackId]:null;await a.readUint8();const d=await a.readUint24();o.cenc||(o.cenc={defaultSampleInfoSize:0,sampleCount:0,offset:0,useSubsamples:!1,sampleEncryption:[],sampleSizes:[],sampleInfoOffset:[]});const p=await a.readUint32(),l=2&d,f=c.defaultPerSampleIVSize;for(let e=0;e<p;e++){const e={iv:f?await a.readBuffer(f):c.defaultConstantIV,subsamples:[]};if(l){const t=await a.readUint16();for(let i=0;i<t;i++)e.subsamples.push({bytesOfClearData:await a.readUint16(),bytesOfProtectedData:await a.readUint32()})}o.cenc.sampleEncryption.push(e)}l&&(o.cenc.useSubsamples=!0);const m=t.size-Number(a.getPos()-n);m>0?await a.skip(m):m<0&&i.z3(`read senc error, size: ${t.size}, read: ${t.size-m}`,s,80)}},15692:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\stco.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const c=[],d=await a.readUint32();if(0===o)for(let e=0;e<d;e++)c.push(BigInt(Math.floor(await a.readUint32())));e.privData.chunkOffsets=c;const p=t.size-Number(a.getPos()-n);p>0?await a.skip(p):p<0&&i.z3(`read stco error, size: ${t.size}, read: ${t.size-p}`,s,54)}},34136:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\stsc.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const c=e.privData,d=[],p=[],l=[],f=await a.readUint32();if(0===o)for(let e=0;e<f;e++)d.push(await a.readUint32()),p.push(await a.readUint32()),l.push(await a.readUint32());c.stscFirstChunk=d,c.stscSamplesPerChunk=p,c.stscSampleDescriptionIndex=l;const m=t.size-Number(a.getPos()-n);m>0?await a.skip(m):m<0&&i.z3(`read stsc error, size: ${t.size}, read: ${t.size-m}`,s,63)}},35173:(a,e,t)=>{t.d(e,{A:()=>U});var i=t(4624),s=t(65977),r=t(21071),n=t(6660),o=t(73840),c=t(31421),d=t(60703),p=t(83561),l=t(38582),f=t(28412),m=t(28460),u=t(86528),w=t(41781),g=t(12869),h=t(7320),z=t(36868);const v="src\\avformat\\formats\\mov\\parsing\\stsd.ts";async function U(a,e,t,U){const k=a.getPos(),A=await a.readUint8();await a.skip(3);const I=e.privData,y=await a.readUint32();for(let t=0;t<y;t++){const t=await a.readUint32(),k=await a.readUint32(),y=a.getPos()+BigInt(Math.floor(t-8));if(n.uf[k]&&(e.codecpar.codecId=n.uf[k]),0===t){i.R8("stsd entry invalid box size 0, skip",v,72),await a.skip(Number(y-a.getPos()));break}if(t>=16?(await a.skip(6),await a.skip(2)):t<=7&&i.h2(`invalid size: ${t} in stsd`,v,85),0===e.codecpar.codecType){await a.skip(2),await a.skip(2),e.metadata.vendorId=await a.readString(4),await a.skip(4),await a.skip(4),e.codecpar.width=await a.readUint16(),e.codecpar.height=await a.readUint16(),await a.skip(4),await a.skip(4),await a.skip(4),await a.skip(2);let t=await a.readUint8();for(t>31&&(t=31),e.metadata.encoder=await a.readString(t),t<31&&await a.skip(31-t),await a.skip(2),await a.skip(2);a.getPos()<y;){const t=await a.readUint32(),n=await a.readUint32();0!==t?n===(0,s.A)("avcC")?await(0,o.A)(a,e,{type:n,size:t-8},U):n===(0,s.A)("hvcC")?await(0,c.A)(a,e,{type:n,size:t-8},U):n===(0,s.A)("vvcC")?await(0,d.A)(a,e,{type:n,size:t-8},U):n===(0,s.A)("av1C")?await(0,l.A)(a,e,{type:n,size:t-8},U):n===(0,s.A)("vpcC")?await(0,p.A)(a,e,{type:n,size:t-8},U):n===(0,s.A)("esds")?await(0,f.A)(a,e,{type:n,size:t-8},U):n===(0,s.A)("wave")?await(0,m.A)(a,e,{type:n,size:t-8},U):n===(0,s.A)("colr")?await(0,g.A)(a,e,{type:n,size:t-8},U):U.parsers&&U.parsers[n]?await U.parsers[n](a,null,{type:n,size:t-8},U):U.parseOneBox&&r.gQ.some((a=>(0,s.A)(a)===n))?await U.parseOneBox(a,e,{type:n,size:t-8},U):await a.skip(Math.min(t-8,Number(y-a.getPos()))):(i.R8("stsd video invalid box size 0, skip",v,134),await a.skip(Number(y-a.getPos())))}}else if(1===e.codecpar.codecType){const t=await a.readUint16();for(await a.skip(2),e.metadata.vendorId=await a.readString(4),e.codecpar.chLayout.nbChannels=await a.readUint16(),e.codecpar.bitsPerCodedSample=await a.readUint16(),I.audioCid=await a.readUint16(),await a.skip(2),e.codecpar.sampleRate=await a.readUint32()>>>16,(!U.isom||0===A&&t>0)&&(1===t?(I.samplesPerFrame=await a.readUint32(),await a.skip(4),I.bytesPerFrame=await a.readUint32(),await a.skip(4)):2===t&&(await a.skip(4),e.codecpar.sampleRate=Number(await a.readUint64()),e.codecpar.chLayout.nbChannels=await a.readUint32(),await a.skip(4),e.codecpar.bitsPerCodedSample=await a.readUint32(),await a.skip(4),I.bytesPerFrame=await a.readUint32(),I.samplesPerFrame=await a.readUint32()));a.getPos()<y;){const t=await a.readUint32(),n=await a.readUint32();0!==t?n===(0,s.A)("esds")?await(0,f.A)(a,e,{type:n,size:t-8},U):n===(0,s.A)("dfLa")?await(0,u.A)(a,e,{type:n,size:t-8},U):n===(0,s.A)("dOps")?await(0,w.A)(a,e,{type:n,size:t-8},U):n===(0,s.A)("wave")?await(0,m.A)(a,e,{type:n,size:t-8},U):n===(0,s.A)("dac3")?await(0,h.A)(a,e,{type:n,size:t-8},U):n===(0,s.A)("dec3")?await(0,z.A)(a,e,{type:n,size:t-8},U):U.parsers&&U.parsers[n]?await U.parsers[n](a,null,{type:n,size:t-8},U):U.parseOneBox&&r.gQ.some((a=>(0,s.A)(a)===n))?await U.parseOneBox(a,e,{type:n,size:t-8},U):await a.skip(Math.min(t-8,Number(y-a.getPos()))):(i.R8("stsd audio invalid box size 0, skip",v,307),await a.skip(Number(y-a.getPos())))}}else 3===e.codecpar.codecType?(k===(0,s.A)("stpp")?e.codecpar.codecId=94232:k===(0,s.A)("wvtt")?e.codecpar.codecId=94226:k===(0,s.A)("tx3g")||k===(0,s.A)("text")?e.codecpar.codecId=94213:k===(0,s.A)("c608")&&(e.codecpar.codecId=94218),await a.skip(Math.min(t-8,Number(y-a.getPos())))):await a.skip(Math.min(t-8,Number(y-a.getPos())))}const B=t.size-Number(a.getPos()-k);B>0?await a.skip(B):B<0&&i.z3(`read stsd error, size: ${t.size}, read: ${t.size-B}`,v,434)}},63080:(a,e,t)=>{t.d(e,{A:()=>o});var i=t(80662),s=t.n(i),r=t(4624);const n="src\\avformat\\formats\\mov\\parsing\\stss.ts";async function o(a,e,t,i){const o=a.getPos(),c=await a.readUint8();await a.skip(3);const d=new(s()),p=await a.readUint32();if(0===c)for(let e=0;e<p;e++)d.set(await a.readUint32(),!0);e.privData.stssSampleNumbersMap=d;const l=t.size-Number(a.getPos()-o);l>0?await a.skip(l):l<0&&r.z3(`read stss error, size: ${t.size}, read: ${t.size-l}`,n,55)}},62831:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\stsz.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const c=[];let d=0,p=0;if(0===o){d=await a.readUint32(),p=await a.readUint32();for(let e=0;e<p;e++)0===d?c.push(await a.readUint32()):c[e]=d}e.privData.sampleSizes=c;const l=t.size-Number(a.getPos()-n);l>0?await a.skip(l):l<0&&i.z3(`read stsz error, size: ${t.size}, read: ${t.size-l}`,s,63)}},91635:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\stts.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const c=e.privData,d=[],p=[],l=await a.readUint32();let f=1;if(0===o)for(let e=0;e<l;e++)d.push(await a.readUint32()),f=await a.readInt32(),f<0&&(i.R8("File uses negative stts sample delta, using value 1 instead, sync may be lost!",s,51),f=1),p.push(f);c.sttsSampleCounts=d,c.sttsSampleDeltas=p;const m=t.size-Number(a.getPos()-n);m>0?await a.skip(m):m<0&&i.z3(`read stts error, size: ${t.size}, read: ${t.size-m}`,s,66)}},6570:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\stz2.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const c=[];let d=0,p=0;if(0===o)if(await a.skip(3),p=await a.readUint8(),d=await a.readUint32(),4===p)for(let e=0;e<d;e+=2){const t=await a.readUint8();c[e]=t>>4&15,c[e+1]=15&t}else if(8===p)for(let e=0;e<d;e++)c[e]=await a.readUint8();else if(16===p)for(let e=0;e<d;e++)c[e]=await a.readUint16();else i.z3("Error in length field in stz2 box",s,65);e.privData.sampleSizes=c;const l=t.size-Number(a.getPos()-n);l>0?await a.skip(l):l<0&&i.z3(`read stz2 error, size: ${t.size}, read: ${t.size-l}`,s,76)}},89417:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\tenc.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const c=e.privData;let d=r.cencs?r.cencs[c.trackId]:null;d||(d={schemeType:0,schemeVersion:0,isProtected:0,defaultPerSampleIVSize:0,defaultKeyId:null,defaultConstantIV:null,cryptByteBlock:0,skipByteBlock:0,pattern:!1}),await a.skip(1);const p=await a.readUint8();if(o>0&&(d.pattern=!0,d.cryptByteBlock=p>>>4&15,d.skipByteBlock=15&p),d.isProtected=await a.readUint8(),d.defaultPerSampleIVSize=await a.readUint8(),d.defaultKeyId=await a.readBuffer(16),d.isProtected&&!d.defaultPerSampleIVSize){const e=await a.readUint8();d.defaultConstantIV=await a.readBuffer(e)}r.cencs?r.cencs[c.trackId]=d:r.cencs={[c.trackId]:d};const l=t.size-Number(a.getPos()-n);l>0?await a.skip(l):l<0&&i.z3(`read schm error, size: ${t.size}, read: ${t.size-l}`,s,90)}},67523:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\tfdt.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const c=r.currentFragment.currentTrack;c&&(c.baseMediaDecodeTime=1===o?await a.readUint64():BigInt(Math.floor(await a.readUint32())));const d=t.size-Number(a.getPos()-n);d>0?await a.skip(d):d<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-d}`,s,55)}},61807:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\tfhd.ts";async function r(a,e,t,r){const n=a.getPos(),o=(await a.readUint8(),await a.readUint24()),c=await a.readUint32(),d=r.currentFragment.currentTrack;d.trackId=c,d&&(1&o&&(d.baseDataOffset=await a.readUint64()),2&o&&await a.skip(4),8&o&&(d.defaultSampleDuration=await a.readUint32()),16&o&&(d.defaultSampleSize=await a.readUint32()),32&o&&(d.defaultSampleFlags=await a.readUint32()),131072&o&&(d.baseIsMoof=!0));const p=t.size-Number(a.getPos()-n);p>0?await a.skip(p):p<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-p}`,s,73)}},27436:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\tkhd.ts";async function r(a,e,t,r){const n=e.privData,o=a.getPos(),c=await a.readUint8();n.flags=await a.readUint24(),1&n.flags&&(e.disposition|=1),1===c?(e.metadata.creationTime=await a.readUint64(),e.metadata.modificationTime=await a.readUint64(),n.trackId=await a.readUint32(),await a.skip(4),n.duration=await a.readUint64()):(e.metadata.creationTime=BigInt(Math.floor(await a.readUint32())),e.metadata.modificationTime=BigInt(Math.floor(await a.readUint32())),n.trackId=await a.readUint32(),await a.skip(4),n.duration=BigInt(Math.floor(await a.readUint32()))),await a.skip(8),n.layer=await a.readInt16(),n.alternateGroup=await a.readInt16(),n.volume=await a.readInt16()>>8,await a.skip(2);const d=[];n.matrix=new Int32Array(9);for(let e=0;e<9;e++)n.matrix[e]=await a.readInt32(),d[e]=8===e?n.matrix[e]/1073741824:n.matrix[e]/65536;n.width=await a.readUint32()>>16,n.height=await a.readUint32()>>16,e.metadata.matrix=d;const p=t.size-Number(a.getPos()-o);p>0?await a.skip(p):p<0&&i.z3(`read tkhd error, size: ${t.size}, read: ${t.size-p}`,s,90)}},25778:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\trex.ts";async function r(a,e,t,r){const n=a.getPos();await a.readUint8(),await a.skip(3);const o=await a.readUint32();await a.skip(4);const c=await a.readUint32(),d=await a.readUint32(),p=await a.readUint32();r.trexs.push({trackId:o,duration:c,size:d,flags:p});const l=t.size-Number(a.getPos()-n);l>0?await a.skip(l):l<0&&i.z3(`read trex error, size: ${t.size}, read: ${t.size-l}`,s,59)}},58996:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\trun.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8(),c=await a.readUint24(),d=r.currentFragment.currentTrack,p=r.trexs.find((a=>a.trackId===d.trackId));if(d){const e=await a.readUint32();1&c&&(d.sampleCount?(d.remainDataOffsets.push(await a.readInt32()),d.remainDataOffsetIndex.push(d.sampleCount)):d.dataOffset=await a.readInt32());let t=-1;4&c&&(t=await a.readUint32());for(let i=0;i<e;i++)256&c?d.sampleDurations.push(await a.readUint32()):d.sampleDurations.push(d.defaultSampleDuration||(null==p?void 0:p.duration)),512&c?d.sampleSizes.push(await a.readUint32()):d.sampleSizes.push(d.defaultSampleSize||(null==p?void 0:p.size)),1024&c?d.sampleFlags.push(await a.readUint32()):d.sampleFlags.push(d.defaultSampleFlags||(null==p?void 0:p.flags)),2048&c?0===o?d.sampleCompositionTimeOffset.push(await a.readUint32()):d.sampleCompositionTimeOffset.push(await a.readInt32()):d.sampleCompositionTimeOffset.push(0),t>-1&&0===i&&(d.sampleFlags.pop(),d.sampleFlags.push(t));d.sampleCount+=e}const l=t.size-Number(a.getPos()-n);l>0?await a.skip(l):l<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-l}`,s,103)}},83561:(a,e,t)=>{t.d(e,{A:()=>c});var i=t(37837),s=t(14686),r=t(4624),n=t(82014);const o="src\\avformat\\formats\\mov\\parsing\\vpcc.ts";async function c(a,e,t,c){const d=a.getPos();if(await a.readUint8(),await a.skip(3),e.codecpar.codecId=167,t.size-4<=0)return;const p=(0,i.sY)(t.size-4),l=await a.readBuffer(t.size-4,(0,s.JW)(p,t.size-4));c.foundMoov?(e.sideData[1]=l.slice(),(0,i.Eb)(p)):(e.codecpar.extradata&&(0,i.Eb)(e.codecpar.extradata),e.codecpar.extradata=p,e.codecpar.extradataSize=t.size-4,n.XC(e,l));const f=t.size-Number(a.getPos()-d);f>0?await a.skip(f):f<0&&r.z3(`read vpcc error, size: ${t.size}, read: ${t.size-f}`,o,70)}},60703:(a,e,t)=>{t.d(e,{A:()=>c});var i=t(37837),s=t(14686),r=t(4624),n=t(59166);const o="src\\avformat\\formats\\mov\\parsing\\vvcc.ts";async function c(a,e,t,c){const d=a.getPos();if(await a.readUint8(),await a.skip(3),e.codecpar.codecId=196,t.size-4<=0)return;const p=(0,i.sY)(t.size-4),l=await a.readBuffer(t.size-4,(0,s.JW)(p,t.size-4));c.foundMoov?(e.sideData[1]=l.slice(),(0,i.Eb)(p)):(e.codecpar.extradata&&(0,i.Eb)(e.codecpar.extradata),e.codecpar.extradata=p,e.codecpar.extradataSize=t.size-4,n.XC(e,l));const f=t.size-Number(a.getPos()-d);f>0?await a.skip(f):f<0&&r.z3(`read vvcc error, size: ${t.size}, read: ${t.size-f}`,o,70)}},28460:(a,e,t)=>{t.d(e,{A:()=>o});var i=t(4624),s=t(65977),r=t(28412);const n="src\\avformat\\formats\\mov\\parsing\\wave.ts";async function o(a,e,t,o){const c=a.getPos(),d=c+BigInt(Math.floor(t.size));for(;a.getPos()<d;){const t=await a.readUint32(),c=await a.readUint32();0!==t?c===(0,s.A)("esds")?await(0,r.A)(a,e,{type:c,size:t-8},o):await a.skip(Math.min(t-8,Number(d-a.getPos()))):(i.R8("wave invalid box size 0, skip",n,45),await a.skip(Number(d-a.getPos())))}const p=t.size-Number(a.getPos()-c);p>0?await a.skip(p):p<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-p}`,n,71)}},65977:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\function\\mktag.ts";function r(a){4!==a.length&&i.R8(`tag length is not 4, tag: ${a}`,s,30);let e=0;for(let t=0;t<4;t++)e=e<<8|a.charCodeAt(t);return e}},79682:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624);const s="src\\avformat\\function\\mktagle.ts";function r(a){4!==a.length&&i.R8(`tag length is not 4, tag: ${a}`,s,30);let e=0;for(let t=3;t>=0;t--)e=e<<8|a.charCodeAt(t);return e}},95832:(a,e,t)=>{t.d(e,{Bq:()=>l,Ij:()=>p,XC:()=>d,f7:()=>f,uF:()=>r});var i=t(77231),s=t(37246);const r={1:"Main",2:"LC",3:"SSR",4:"LTP",5:"HE",6:"SCALABLE",29:"HEv2",23:"LD",39:"ELD"},n={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},o=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,i.N_,i.N_,i.N_],c=[i.N_,1,2,3,4,5,6,7];function d(a,e){if(!e&&a.sideData[1]&&(e=a.sideData[1]),e){const{profile:t,sampleRate:s,channels:r}=function(a){let e=i.N_,t=i.N_,s=i.N_;return a.length>=2&&(e=a[0]>>3&31,t=o[(7&a[0])<<1|a[1]>>7],s=c[a[1]>>3&15]),{profile:e,sampleRate:t,channels:s}}(e);a.codecpar.profile=t,a.codecpar.sampleRate=s,a.codecpar.chLayout.nbChannels=r,a.codecpar.frameSize=5===t?2048:1024,a.codecpar.format=8}}function p(a){const e=n[a.sampleRate],t=a.chLayout.nbChannels,s=a.profile===i.N_?2:a.profile,r=new Uint8Array(2);return r[0]=(31&s)<<3|(14&e)>>1,r[1]=(1&e)<<7|(15&t)<<3,r}function l(a){if(a.length<7)return-1;const e=a[0]<<4|a[1]>>4;if(4095!==e)return-1;const t=1&a[1],i=(192&a[2])>>>6,s=(60&a[2])>>>2,r=(1&a[2])<<2|(192&a[3])>>>6,n=(3&a[3])<<11|a[4]<<3|(224&a[5])>>>5,d=3&a[6];let p=1===t?7:9,l=n-p;return{syncWord:e,profile:i+1,sampleRate:o[s],channels:c[r],aacFrameLength:n,numberOfRawDataBlocksInFrame:d,headerLength:p,framePayloadLength:l}}function f(a,e){function t(){const a=e.readU(2);let t=0;for(let i=0;i<=a;i++)t<<=8,t|=e.readU(8);return t}e||(e=new s.A).appendBuffer(a);const i=e.getPointer(),r={syncWord:0,profile:0,sampleRate:0,channels:0,useSameStreamMux:!1,headerLength:0,framePayloadLength:0,muxLengthBytes:0},n=e.readU(11);if(695!==n)return-1;r.syncWord=n,r.muxLengthBytes=e.readU(13);const d=1===e.readU1();if(r.useSameStreamMux=d,!d){const a=1===e.readU1();if(a&&1===e.readU1())return-1;if(a&&t(),1!==e.readU1())return-1;if(0!==e.readU(6))return-1;if(0!==e.readU(4))return-1;if(0!==e.readU(3))return-1;let i=a?t():0;const s=e.readU(5);i-=5;const n=e.readU(4);i-=4;const d=e.readU(4);if(i-=4,e.readU(3),i-=3,i>0&&e.readU(i),0!==e.readU(3))return-1;if(e.readU(8),1===e.readU1())if(a)t();else{let a=0;for(;;){a<<=8;const t=1===e.readU1();if(a+=e.readU(8),!t)break}}1===e.readU1()&&e.readU(8),r.profile=s+1,r.sampleRate=o[n],r.channels=c[d]}let p=0;for(;;){const a=e.readU(8);if(p+=a,255!==a)break}return r.framePayloadLength=p,r.headerLength=e.getPointer()-i+(8===e.getBitLeft()?0:1),r}},87518:(a,e,t)=>{t.d(e,{R:()=>m,j:()=>s});var i=t(37246);const s=[3,4,3,7,259,263,1539,1543],r=[[64,69,96],[64,70,96],[80,87,120],[80,88,120],[96,104,144],[96,105,144],[112,121,168],[112,122,168],[128,139,192],[128,140,192],[160,174,240],[160,175,240],[192,208,288],[192,209,288],[224,243,336],[224,244,336],[256,278,384],[256,279,384],[320,348,480],[320,349,480],[384,417,576],[384,418,576],[448,487,672],[448,488,672],[512,557,768],[512,558,768],[640,696,960],[640,697,960],[768,835,1152],[768,836,1152],[896,975,1344],[896,976,1344],[1024,1114,1536],[1024,1115,1536],[1152,1253,1728],[1152,1254,1728],[1280,1393,1920],[1280,1394,1920]],n=[4,5,6,5],o=[4,6,7,6],c=[48e3,44100,32e3,0],d=[32,40,48,56,64,80,96,112,128,160,192,224,256,320,384,448,512,576,640],p=[2,1,2,3,3,4,4,5],l=[1,2,3,6],f=7;function m(a){const e=new i.A(a.length);e.appendBuffer(a);const t={syncWord:0,crc1:0,srCode:0,bitstreamId:0,bitstreamMode:0,channelMode:0,lfeOn:0,frameType:0,substreamId:0,centerMixLevel:0,surroundMixLevel:0,channelMap:0,numBlocks:0,dolbySurroundMode:0,srShift:0,sampleRate:0,bitrate:0,channels:0,frameSize:0,channelLayout:BigInt(0),ac3BitrateCode:0};if(t.syncWord=e.readU(16),2935!==t.syncWord)return-1;if(t.bitstreamId=31&e.peekU(29),t.bitstreamId>16)return-2;if(t.numBlocks=6,t.ac3BitrateCode=-1,t.centerMixLevel=5,t.surroundMixLevel=6,t.dolbySurroundMode=0,t.bitstreamId<=10){if(t.crc1=e.readU(16),t.srCode=e.readU(2),3===t.srCode)return-3;const a=e.readU(6);if(a>37)return-4;t.ac3BitrateCode=a>>1,e.readU(5),t.bitstreamMode=e.readU(3),t.channelMode=e.readU(3),2==t.channelMode?t.dolbySurroundMode=e.readU(2):(1&t.channelMode&&1!=t.channelMode&&(t.centerMixLevel=n[e.readU(2)]),4&t.channelMode&&(t.surroundMixLevel=o[e.readU(2)])),t.lfeOn=e.readU(1),t.srShift=Math.max(t.bitstreamId,8)-8,t.sampleRate=c[t.srCode]>>t.srShift,t.bitrate=1e3*d[t.ac3BitrateCode]>>t.srShift,t.channels=p[t.channelMode]+t.lfeOn,t.frameSize=2*r[a][t.srCode],t.frameType=2,t.substreamId=0}else{if(t.crc1=0,t.frameType=e.readU(2),3==t.frameType)return-5;if(t.substreamId=e.readU(3),t.frameSize=e.readU(11)+1<<1,t.frameSize<f)return-6;if(t.srCode=e.readU(2),3==t.srCode){const a=e.readU(2);if(3==a)return-7;t.sampleRate=c[a]/2,t.srShift=1}else t.numBlocks=l[e.readU(2)],t.sampleRate=c[t.srCode],t.srShift=0;t.channelMode=e.readU(3),t.lfeOn=e.readU(1),t.bitrate=8*t.frameSize*t.sampleRate/(256*t.numBlocks),t.channels=p[t.channelMode]+t.lfeOn}return t.channelLayout=BigInt(s[t.channelMode]),t.lfeOn&&(t.channelLayout|=BigInt(8)),t}},21477:(a,e,t)=>{t.d(e,{Ui:()=>n,XC:()=>r,zk:()=>s});var i=t(37246);t(83314),t(97317);const s={0:"Main",1:"High",2:"Professional"};function r(a,e){if(!e&&a.sideData[1]&&(e=a.sideData[1]),e&&e.length>=4){const t=n(e);a.codecpar.profile=t.profile,a.codecpar.level=t.level}}function n(a){const e=new i.A(a.length);e.appendBuffer(a),e.readU1(),e.readU(7);const t=e.readU(3),s=e.readU(5),r=e.readU1();let n=e.readU1()?10:8;return e.readU1()&&(n=12),{profile:t,level:s,tier:r,bitDepth:n,monochrome:e.readU1(),chromaSubsamplingX:e.readU1(),chromaSubsamplingY:e.readU1(),chromaSamplePosition:e.readU(2)}}},14769:(a,e,t)=>{t.d(e,{DK:()=>o,XC:()=>d,Xr:()=>c,jA:()=>r,ob:()=>s,oe:()=>n});var i=t(31865);const s=34,r=8,n=[0,8,12,0,16,20,24,32],o=[0,88200,176400,192e3,8e3,16e3,22050,24e3,32e3,44100,48e3,96e3,0,0,0,0],c=[0,192,576,1152,2304,4608,0,0,256,512,1024,2048,4096,8192,16384,32768];function d(a,e){if(!e&&a.sideData[1]&&(e=a.sideData[1]),e&&e.length===s){const{bitsPerRawSample:t,sampleRate:s,channels:r}=function(a){const e=new i.A(a);e.skip(10);const t=e.readUint24();return{sampleRate:t>>4,channels:1+((15&t)>>>1),bitsPerRawSample:1+((1&t)<<4|(240&e.readUint8())>>>4)}}(e);a.codecpar.bitsPerRawSample=t,a.codecpar.sampleRate=s,a.codecpar.chLayout.nbChannels=r}}},22576:(a,e,t)=>{t.d(e,{Ij:()=>d,XC:()=>c,kt:()=>o});var i=t(31865),s=t(729),r=t(44328);const n=[480,960,1920,2880,480,960,1920,2880,480,960,1920,2880,480,960,480,960,120,240,480,960,120,240,480,960,120,240,480,960,120,240,480,960];function o(a){let e=0,t=0,i=0;if(a.length<1)return 0;switch(e=a[0],t=n[e>>3],3&e){case 0:i=1;break;case 1:case 2:i=2;break;case 3:if(a.length<2)return 0;i=63&a[1]}return i*t}function c(a,e){if(!e&&a.sideData[1]&&(e=a.sideData[1]),e&&e.length>=19){const t=new i.A(e,!1);t.skip(9),a.codecpar.chLayout.nbChannels=t.readUint8(),a.codecpar.initialPadding=t.readUint16(),a.codecpar.sampleRate=t.readUint32(),a.codecpar.seekPreroll=Number((0,r.k)(BigInt(80),{den:1e3,num:1},{den:48e3,num:1}))}}function d(a){const e=new Uint8Array(19),t=new s.A(e,!1);return t.writeString("OpusHead"),t.writeUint8(1),t.writeUint8(a.chLayout.nbChannels),t.writeUint16(a.initialPadding),t.writeUint32(a.sampleRate),e}},82014:(a,e,t)=>{t.d(e,{Ui:()=>n,XC:()=>r,wN:()=>s}),t(9599);var i=t(37246);t(77231),t(97317),t(44328),t(729);const s={0:"Profile0",1:"Profile1",2:"Profile2",3:"Profile3"};function r(a,e){if(!e&&a.sideData[1]&&(e=a.sideData[1]),e&&e.length>=6){const t=n(e);a.codecpar.profile=t.profile,a.codecpar.level=t.level}}function n(a){const e=new i.A(a.length);return e.appendBuffer(a),{profile:e.readU(8),level:e.readU(8),bitDepth:e.readU(4),chromaSubsampling:e.readU(3),fullRangeFlag:e.readU1(),colorPrimaries:e.readU(8),colorTrc:e.readU(8),colorSpace:e.readU(8)}}},null:()=>{},50315:(a,e,t)=>{t.d(e,{ZK:()=>o,bE:()=>c,p$:()=>r,zz:()=>n});var i=t(31865),s=t(729);function r(a){const e=new i.A(a,!0),t=e.readUint32(),s=e.readUint32(),r=e.readUint32(),n=e.readUint32(),o=e.readUint32(),c=e.readUint32(),d={scheme:t,cryptByteBlock:s,skipByteBlock:r,keyId:e.readBuffer(n),iv:e.readBuffer(o),subsamples:[]};if(c)for(let a=0;a<c;a++)d.subsamples.push({bytesOfClearData:e.readUint32(),bytesOfProtectedData:e.readUint32()});return d}function n(a){const e=new Uint8Array(24+a.keyId.length+a.iv.length+8*a.subsamples.length),t=new s.A(e,!0);return t.writeUint32(a.scheme),t.writeUint32(a.cryptByteBlock),t.writeUint32(a.skipByteBlock),t.writeUint32(a.keyId.length),t.writeUint32(a.iv.length),t.writeUint32(a.subsamples.length),t.writeBuffer(a.keyId),t.writeBuffer(a.iv),a.subsamples.forEach((a=>{t.writeUint32(a.bytesOfClearData),t.writeUint32(a.bytesOfProtectedData)})),e}function o(a){const e=new i.A(a,!0),t=e.readUint32(),s=[];for(let a=0;a<t;a++){const a=e.readUint32(),t=e.readUint32(),i=e.readUint32(),r=e.readUint32(),n={systemId:e.readBuffer(a),keyIds:[],data:null};if(t)for(let a=0;a<t;a++)n.keyIds.push(e.readBuffer(i));n.data=e.readBuffer(r),s.push(n)}return s}function c(a){let e=4;a.forEach((a=>{e+=16+a.systemId.length+a.keyIds.length*(a.keyIds.length?a.keyIds[0].length:0)+a.data.length}));const t=new Uint8Array(e),i=new s.A(t,!0);return i.writeUint32(a.length),a.forEach((a=>{i.writeUint32(a.systemId.length),i.writeUint32(a.keyIds.length),i.writeUint32(a.keyIds.length?a.keyIds[0].length:0),i.writeUint32(a.data.length),i.writeBuffer(a.systemId),a.keyIds.forEach((a=>{i.writeBuffer(a)})),i.writeBuffer(a.data)})),t}}}]);