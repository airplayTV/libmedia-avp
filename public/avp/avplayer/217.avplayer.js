"use strict";(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[217],{50848:(e,t,a)=>{a.d(t,{A:()=>b});var i=a(134),s=a(63939),n=a(50932),r=a(77162),o=a(29170),h=a(64436),c=a(14686),d=a(4624),l=a(9705),f=a(77231),p=a(95832),u=a(44328),g=a(37837),m=a(71517),A=a(67672),I=a(92647);class b extends h.A{constructor(...e){super(...e),(0,i.A)(this,"streamMuxConfig",void 0),(0,i.A)(this,"caches",void 0),(0,i.A)(this,"pendingItem",void 0)}init(e,t){return super.init(e,t),this.caches=[],this.streamMuxConfig={profile:f.N_,sampleRate:f.N_,channels:f.N_},0}sendAVPacket(e){let t=0,a=s.f[17](e+16)!==f.Dh?s.f[17](e+16):s.f[17](e+8),i=(0,c.s3)(s.f[20](e+24),s.f[15](e+28)).slice();for(this.pendingItem&&(this.pendingItem.buffer=(0,I.A)(Uint8Array,[this.pendingItem.buffer,i.subarray(0,this.pendingItem.miss)]),i=i.subarray(this.pendingItem.miss),this.caches.push(this.pendingItem),this.pendingItem=null);t<i.length;){const h=p.Bq(i.subarray(t));if(A.ai(h)){let e=t+1;for(;e<i.length-1;e++)if(4095==(i[e]<<4|i[e+1]>>4)){t=e;break}if(e<i.length-1)continue;return d.z3("AACADTSParser parse failed","src\\avformat\\bsf\\aac\\ADTS2RawFilter.ts",108),l.LR}const m={dts:a,buffer:null,extradata:null,duration:f.N_,pos:s.f[17](e+56)};m.buffer=i.subarray(t+h.headerLength,t+h.headerLength+h.framePayloadLength),this.streamMuxConfig.profile=h.profile,this.streamMuxConfig.sampleRate=h.sampleRate,this.streamMuxConfig.channels=h.channels;const I=s.f[15](this.inCodecpar+48)!==this.streamMuxConfig.profile||s.f[15](this.inCodecpar+136)!==this.streamMuxConfig.sampleRate||s.f[15](this.inCodecpar+116)!==this.streamMuxConfig.channels,b=(0,u.k)(BigInt(Math.floor(1024*(h.numberOfRawDataBlocksInFrame+1)/this.streamMuxConfig.sampleRate*f.SF)),f.KR,this.inTimeBase);if(m.duration=Number(b),I){n.M[15](this.inCodecpar+48,this.streamMuxConfig.profile),n.M[15](this.inCodecpar+136,this.streamMuxConfig.sampleRate),n.M[15](this.inCodecpar+116,this.streamMuxConfig.channels);const e=(0,p.Ij)((0,o.A)(this.inCodecpar,r.A));s.f[20](this.inCodecpar+12)&&(0,g.Eb)(s.f[20](this.inCodecpar+12)),n.M[20](this.inCodecpar+12,(0,g.sY)(e.length)),(0,c.lW)(s.f[20](this.inCodecpar+12),e.length,e),n.M[15](this.inCodecpar+16,e.length),m.extradata=e}m.buffer.length<h.framePayloadLength?this.pendingItem={...m,miss:h.framePayloadLength-m.buffer.length}:this.caches.push(m),t+=h.aacFrameLength,a+=b}return 0}receiveAVPacket(e){if(this.caches.length){(0,m.Up)(e);const t=this.caches.shift(),a=(0,g.sY)(t.buffer.length);if((0,c.lW)(a,t.buffer.length,t.buffer),(0,m.NX)(e,a,t.buffer.length),n.M[17](e+16,t.dts),n.M[17](e+8,t.dts),n.M[17](e+56,t.pos),n.M[17](e+48,BigInt(Math.floor(t.duration))),n.M[15](e+36,1|s.f[15](e+36)),t.extradata){const a=(0,g.sY)(t.extradata.length);(0,c.lW)(a,t.extradata.length,t.extradata),(0,m.Ow)(e,1,a,t.extradata.length)}return 0}return l.LT}reset(){return this.pendingItem=null,this.caches.length=0,0}}},85947:(e,t,a)=>{a.d(t,{A:()=>s});var i=a(134);class s{constructor(){(0,i.A)(this,"type",-1),(0,i.A)(this,"onStreamAdd",void 0)}async destroy(e){}}},51660:(e,t,a)=>{a.d(t,{A:()=>o});var i=a(77231),s=a(4624),n=a(9705);const r="src\\avformat\\formats\\mpegts\\function\\parsePES.ts";function o(e){const t=e.data,a=t[3],o=t[4]<<8|t[5];let h=0,c=0,d=0;if(188!==a&&190!==a&&191!==a&&240!==a&&241!==a&&255!==a&&242!==a&&248!==a){let a=i.Dh,l=i.Dh;for(;;){if(6+c>=t.length)return n.LR;if(d=t[6+c],255!==d)break;c++}if(64==(192&d)&&(c+=2,d=t[6+c]),32==(224&d))h+=5,a=a=BigInt(Math.floor(536870912*(14&t[6+c])+4194304*(255&t[7+c])+16384*(254&t[8+c])+128*(255&t[9+c])+(254&t[10+c])/2)),16&d?(l=BigInt(Math.floor(536870912*(14&t[11+c])+4194304*(255&t[12+c])+16384*(254&t[13+c])+128*(255&t[14+c])+(254&t[15+c])/2)),h+=5):l=a;else if(128==(192&d)){const e=(192&t[7+c])>>>6;h=3+t[8+c],2!==e&&3!==e||(a=BigInt(Math.floor(536870912*(14&t[9+c])+4194304*(255&t[10+c])+16384*(254&t[11+c])+128*(255&t[12+c])+(254&t[13+c])/2)),l=3===e?BigInt(Math.floor(536870912*(14&t[14+c])+4194304*(255&t[15+c])+16384*(254&t[16+c])+128*(255&t[17+c])+(254&t[18+c])/2)):a)}else{if(15!==d)return s.z3("invalid data",r,122),n.LR;h=1}e.dts=l,e.pts=a;const f=6+c+h;let p=0;if(0!==o){if(o<c+h)return s.z3("Malformed PES: PES_packet_length < 3 + PES_header_data_length",r,134),n.LR;p=o-(c+h),f+(t.byteLength-f)!=o+6&&(s.R8("PES packet size mismatch",r,139),e.flags|=2)}else p=t.byteLength-f;e.payload=t.subarray(f,f+p)}else if((188===a||191===a||240===a||241===a||255===a||242===a||248===a)&&6===e.streamId){const a=6;let i=0;i=0!==o?o:t.byteLength-a,e.payload=t.subarray(a,a+i)}return 0}},6403:(e,t,a)=>{a.d(t,{Cd:()=>d,I4:()=>f,am:()=>h,kJ:()=>l,pi:()=>c,xf:()=>p});var i=a(134),s=a(80662),n=a.n(s),r=a(77231);class o{constructor(){(0,i.A)(this,"discontinuityIndicator",0),(0,i.A)(this,"randomAccessIndicator",0),(0,i.A)(this,"elementaryStreamPriorityIndicator",0),(0,i.A)(this,"pcrFlag",0),(0,i.A)(this,"opcrFlag",0),(0,i.A)(this,"splicingPointFlag",0),(0,i.A)(this,"transportPrivateDataFlag",0),(0,i.A)(this,"adaptationFieldExtensionFlag",0),(0,i.A)(this,"pcr",BigInt(0)),(0,i.A)(this,"opcr",BigInt(0)),(0,i.A)(this,"spliceCountDown",0),(0,i.A)(this,"transportPrivateData",null),(0,i.A)(this,"extension",null)}}class h{constructor(){(0,i.A)(this,"pos",r.Dh),(0,i.A)(this,"payloadUnitStartIndicator",0),(0,i.A)(this,"transportPriority",0),(0,i.A)(this,"pid",r.N_),(0,i.A)(this,"adaptationFieldControl",0),(0,i.A)(this,"continuityCounter",0),(0,i.A)(this,"transportScramblingControl",0),(0,i.A)(this,"adaptationFieldInfo",new o),(0,i.A)(this,"payload",null)}}class c{constructor(){(0,i.A)(this,"slices",[]),(0,i.A)(this,"totalLength",0),(0,i.A)(this,"expectedLength",r.N_),(0,i.A)(this,"randomAccessIndicator",0),(0,i.A)(this,"pid",r.N_),(0,i.A)(this,"streamType",0),(0,i.A)(this,"pos",r.Dh)}}class d{constructor(){(0,i.A)(this,"versionNumber",0),(0,i.A)(this,"networkPid",r.N_),(0,i.A)(this,"program2PmtPid",new(n()))}}class l{constructor(){(0,i.A)(this,"tag",void 0),(0,i.A)(this,"buffer",void 0)}}class f{constructor(){(0,i.A)(this,"versionNumber",0),(0,i.A)(this,"programNumber",0),(0,i.A)(this,"pcrPid",0),(0,i.A)(this,"pid2StreamType",new(n())),(0,i.A)(this,"pid2ESDescriptor",new(n()))}}class p{constructor(){(0,i.A)(this,"pid",r.N_),(0,i.A)(this,"streamType",0),(0,i.A)(this,"streamId",r.N_),(0,i.A)(this,"dts",r.Dh),(0,i.A)(this,"pts",r.Dh),(0,i.A)(this,"pos",r.Dh),(0,i.A)(this,"payload",null),(0,i.A)(this,"data",null),(0,i.A)(this,"randomAccessIndicator",0),(0,i.A)(this,"flags",void 0)}}},2187:(e,t,a)=>{a.d(t,{d:()=>r});var i=a(72739),s=a(44328),n=a(77231);function r(e,t,a){let r=BigInt(0);return i.__(e,(e=>{r+=e.codecpar.bitrate*(0,s.k)(t,a,n.i0)/BigInt(8e3)})),r}},52071:(e,t,a)=>{a.d(t,{A:()=>l});var i=a(63939),s=(a(9599),a(77231)),n=a(44328),r=a(2187),o=a(71517),h=a(9705),c=a(4624);const d="src\\avformat\\function\\seekInBytes.ts";async function l(e,t,a,l,f,p){const u=e.ioReader.getPos(),g=await e.ioReader.fileSize();let m=s.Dh,A=a;t.startTime!==s.Dh?A-=t.startTime:A-=t.firstDTS;const I=(0,n.k)(a,t.timeBase,s.i0);if(I<BigInt(1e4))return c.Yz(`seek pts is earlier then 10s, seek to first packet pos(${l}) directly`,d,63),await e.ioReader.seek(l),u;let b=(0,r.d)(e.streams,A,t.timeBase);const y=g-(0,r.d)(e.streams,BigInt(1e4),s.i0),k=(0,r.d)(e.streams,BigInt(1e4),s.i0);if(b>y&&(b=y),b<l)return await e.ioReader.seek(l),u;const C=(0,o._5)();let x=g,R=BigInt(0);e:for(;x-R<k&&(b=R),await e.ioReader.seek(b),await p(e),!(8&e.ioReader.flags);){let a=await f(e,C),r=i.f[17](C+56);if(!(a>=0)){m=s.Dh;break}{const h=(0,n.Mr)(i.f[17](C+8),C+72,s.i0);let l=h-I;if(c.Yz(`try to seek to pos: ${b}, got packet pts: ${i.f[17](C+8)}(${h}ms), diff: ${l}ms`,d,100),l<=BigInt(0)&&-l<BigInt(1e4)||x-R<k){const h=[r];for(;l<=0;){if(i.f[15](C+32)===t.index&&1&i.f[15](C+36)&&h.push(r),(0,o.Up)(C),a=await f(e,C),a<0){if(-1048576===a)break;if(-1048575===a)continue;m=s.Dh;break e}r=i.f[17](C+56),l=(0,n.Mr)(i.f[17](C+8),C+72,s.i0)-I}m=h.pop();break}l>BigInt(0)?(x=b,b=R+x>>BigInt(1)):(R=b,b=R+x>>BigInt(1))}if(8&e.ioReader.flags)break}return(0,o.Qe)(C),m!==s.Dh?(c.Yz(`finally seek to pos ${m}`,d,155),await e.ioReader.seek(m),await p(e),u):(await e.ioReader.seek(u),8&e.ioReader.flags?BigInt(h.LT):BigInt(h.E$))}},43290:(e,t,a)=>{a.d(t,{R:()=>c,u:()=>h});var i=a(37246),s=a(95073);const n=[1,2,2,2,2,3,3,4,4,5,6,6,6,7,8,8],r=[0,8e3,16e3,32e3,0,0,11025,22050,44100,0,0,12e3,24e3,48e3,96e3,192e3],o=[32e3,56e3,64e3,96e3,112e3,128e3,192e3,224e3,256e3,32e4,384e3,448e3,512e3,576e3,64e4,768e3,96e4,1024e3,1152e3,128e4,1344e3,1408e3,1411200,1472e3,1536e3,192e4,2048e3,3072e3,384e4,0,0,0],h=32;function c(e){const t=new i.A(e.length);t.appendBuffer(e);const a={syncWord:0,frameType:0,deficitSamples:0,crcFlag:0,sampleBlock:0,frameSize:0,channelIndex:0,sampleRateIndex:0,bitrateIndex:0,channels:0,sampleRate:0,bitrate:0};return a.syncWord=t.readU(32),2147385345!==a.syncWord&&4269736320!==a.syncWord?-1:(a.frameType=t.readU1(),a.deficitSamples=t.readU(5)+1,a.crcFlag=t.readU1(),a.sampleBlock=t.readU(7)+1,a.frameSize=(0,s.A)(t.readU(14)+1,4),a.channelIndex=t.readU(6),a.sampleRateIndex=t.readU(4),a.bitrateIndex=t.readU(5),a.channels=n[a.channelIndex],a.sampleRate=r[a.sampleRateIndex],a.bitrate=o[a.bitrateIndex],a)}},22576:(e,t,a)=>{a.d(t,{Ij:()=>c,XC:()=>h,kt:()=>o});var i=a(31865),s=a(729),n=a(44328);const r=[480,960,1920,2880,480,960,1920,2880,480,960,1920,2880,480,960,480,960,120,240,480,960,120,240,480,960,120,240,480,960,120,240,480,960];function o(e){let t=0,a=0,i=0;if(e.length<1)return 0;switch(t=e[0],a=r[t>>3],3&t){case 0:i=1;break;case 1:case 2:i=2;break;case 3:if(e.length<2)return 0;i=63&e[1]}return i*a}function h(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=19){const a=new i.A(t,!1);a.skip(9),e.codecpar.chLayout.nbChannels=a.readUint8(),e.codecpar.initialPadding=a.readUint16(),e.codecpar.sampleRate=a.readUint32(),e.codecpar.seekPreroll=Number((0,n.k)(BigInt(80),{den:1e3,num:1},{den:48e3,num:1}))}}function c(e){const t=new Uint8Array(19),a=new s.A(t,!1);return a.writeString("OpusHead"),a.writeUint8(1),a.writeUint8(e.chLayout.nbChannels),a.writeUint16(e.initialPadding),a.writeUint32(e.sampleRate),t}}}]);