"use strict";(self.webpackChunkAVTranscoder=self.webpackChunkAVTranscoder||[]).push([[597],{64436:(t,e,i)=>{i.d(e,{A:()=>o});var r=i(134),a=i(63939),n=(i(77162),i(37837)),s=i(71766);class o{constructor(){(0,r.A)(this,"inCodecpar",void 0),(0,r.A)(this,"inTimeBase",void 0),(0,r.A)(this,"outCodecpar",void 0)}init(t,e){return this.inCodecpar=(0,n.Gy)(168),(0,s.Yi)(this.inCodecpar,t),this.inTimeBase={den:a.f[15](e+4),num:a.f[15](e)},0}destroy(){this.inCodecpar&&((0,s.dn)(this.inCodecpar),this.inCodecpar=0)}}},9848:(t,e,i)=>{i.d(e,{A:()=>h});var r=i(134),a=i(63939),n=i(64436),s=i(95832),o=i(14686),c=i(71517),d=i(37837),l=i(9705);class h extends n.A{constructor(...t){super(...t),(0,r.A)(this,"cache",void 0),(0,r.A)(this,"cached",void 0)}init(t,e){return super.init(t,e),this.cache=(0,c._5)(),0}destroy(){super.destroy(),(0,c.Qe)(this.cache),this.cache=0,this.cached=!1}sendAVPacket(t){if(!a.f[20](t+24)||!a.f[15](t+28))return 0;const e=7+a.f[15](t+28),i=(0,d.sY)(e),r=(0,o.s3)(i,e);return r[0]=255,r[1]=240,r[1]|=8,r[1]|=1,r[2]=(a.f[15](this.inCodecpar+48)-1&3)<<6,r[2]|=(15&s.Hm[a.f[15](this.inCodecpar+136)])<<2,r[2]|=(4&a.f[15](this.inCodecpar+116))>>2,r[3]=(3&a.f[15](this.inCodecpar+116))<<6,r[3]|=r.length>>11&3,r[4]=r.length>>3&255,r[5]=(7&r.length)<<5,r[5]|=31,r[6]=252,r.set((0,o.s3)(a.f[20](t+24),a.f[15](t+28)),7),(0,c.zu)(this.cache,t),(0,c.NX)(this.cache,i,e),this.cached=!0,0}receiveAVPacket(t){return this.cached?((0,c.Up)(t),(0,c.rN)(t,this.cache),this.cached=!1,0):l.LT}reset(){return 0}}},60480:(t,e,i)=>{i.d(e,{A:()=>U});var r=i(134),a=i(63939),n=i(50932),s=i(64436),o=i(95832),c=i(14686),d=i(71517),l=i(37837),h=i(9705),p=i(95335),f=i(83314);const u={mod:20},g=new Uint8Array([86,224,0]);class U extends s.A{constructor(t={}){super(),(0,r.A)(this,"cache",void 0),(0,r.A)(this,"cached",void 0),(0,r.A)(this,"bitWriter",void 0),(0,r.A)(this,"counter",void 0),(0,r.A)(this,"options",void 0),this.options=p.X$({},u,t)}init(t,e){return super.init(t,e),this.cache=(0,d._5)(),this.cached=!1,this.counter=0,this.bitWriter=new f.A,0}destroy(){super.destroy(),(0,d.Qe)(this.cache),this.cache=0}writeHeader(){this.bitWriter.writeU1(0===this.counter?0:1),0===this.counter&&(this.bitWriter.writeU1(0),this.bitWriter.writeU1(1),this.bitWriter.writeU(6,0),this.bitWriter.writeU(4,0),this.bitWriter.writeU(3,0),this.bitWriter.writeU(5,a.f[15](this.inCodecpar+48)-1&31),this.bitWriter.writeU(4,15&o.Hm[a.f[15](this.inCodecpar+136)]),this.bitWriter.writeU(4,15&a.f[15](this.inCodecpar+116)),this.bitWriter.writeU(3,0),this.bitWriter.writeU(3,0),this.bitWriter.writeU(8,255),this.bitWriter.writeU1(0),this.bitWriter.writeU1(0)),this.counter++,this.counter%=this.options.mod}copyBytes(t){for(let e=0;e<t.length;e++)this.bitWriter.writeU(8,t[e])}sendAVPacket(t){if(!a.f[20](t+24)||!a.f[15](t+28))return 0;this.bitWriter.reset();const e=(0,d.rU)(t,1);if(e){const{profile:t,sampleRate:i,channels:r}=(0,o._5)((0,c.s3)(a.f[20](e),a.f[25](e+4)));n.M[15](this.inCodecpar+48,t),n.M[15](this.inCodecpar+136,i),n.M[15](this.inCodecpar+116,r),this.counter=0}this.writeHeader();let i=0;for(;i<=a.f[15](t+28)-255;i+=255)this.bitWriter.writeU(8,255);this.bitWriter.writeU(8,a.f[15](t+28)-i);const r=(0,c.s3)(a.f[20](t+24),a.f[15](t+28));129==(225&r[0])?(this.bitWriter.writeU(8,254&r[0]),this.copyBytes(r.subarray(1))):this.copyBytes(r),this.bitWriter.padding();const s=this.bitWriter.getPointer(),h=3+s,p=(0,l.sY)(h),f=(0,c.s3)(p,h);return f.set(g,0),f[1]|=s>>8&31,f[2]|=255&s,f.set(this.bitWriter.getBuffer().subarray(0,s),3),(0,d.zu)(this.cache,t),(0,d.NX)(this.cache,p,h),this.cached=!0,0}receiveAVPacket(t){return this.cached?((0,d.Up)(t),(0,d.rN)(t,this.cache),this.cached=!1,0):h.LT}reset(){return 0}}},52251:(t,e,i)=>{i.d(e,{A:()=>u});var r=i(134),a=i(63939),n=i(50932),s=i(64436),o=i(71517),c=i(62815),d=i(67659),l=i(59166),h=i(9705),p=i(4624),f=i(14686);class u extends s.A{constructor(...t){super(...t),(0,r.A)(this,"cache",void 0),(0,r.A)(this,"cached",void 0)}init(t,e){return super.init(t,e),this.cache=(0,o._5)(),this.cached=!1,0}destroy(){super.destroy(),(0,o.Qe)(this.cache),this.cache=0}sendAVPacket(t){if(64&a.f[15](t+36))(0,o.rN)(this.cache,t);else{let e;(0,o.zu)(this.cache,t);const i=(0,o.rU)(t,1);let r=null;i&&(r=(0,f.JW)(a.f[20](i),a.f[25](i+4)));const s=(0,f.JW)(a.f[20](t+24),a.f[15](t+28));27===a.f[15](this.inCodecpar+4)?e=c.OD(s,r):173===a.f[15](this.inCodecpar+4)?e=d.OD(s,r):196===a.f[15](this.inCodecpar+4)?e=l.OD(s,r):p.h2(`not support for codecId: ${a.f[15](this.inCodecpar+4)}`,"src\\avformat\\bsf\\h2645\\Avcc2AnnexbFilter.ts",92),n.M[15](this.cache+36,64|a.f[15](this.cache+36)),(0,o.NX)(this.cache,e.bufferPointer,e.length),e.key&&n.M[15](this.cache+36,1|a.f[15](this.cache+36))}return this.cached=!0,0}receiveAVPacket(t){return this.cached?((0,o.Up)(t),(0,o.rN)(t,this.cache),this.cached=!1,0):h.LR}reset(){return 0}}},77662:(t,e,i)=>{i.d(e,{A:()=>h});var r=i(134),a=i(63939),n=i(64436),s=i(14686),o=i(71517),c=i(37837),d=i(9705),l=i(22576);class h extends n.A{constructor(...t){super(...t),(0,r.A)(this,"cache",void 0),(0,r.A)(this,"cached",void 0),(0,r.A)(this,"opusPendingTrimStart",void 0)}init(t,e){return super.init(t,e),this.cache=(0,o._5)(),this.cached=!1,this.opusPendingTrimStart=48e3*(a.f[15](this.inCodecpar+148)>0?a.f[15](this.inCodecpar+148):0)/a.f[15](this.inCodecpar+136),0}destroy(){super.destroy(),(0,o.Qe)(this.cache),this.cache=0}sendAVPacket(t){if(!a.f[20](t+24)||!a.f[15](t+28))return;const e=(0,s.s3)(a.f[20](t+24),a.f[15](t+28)),i=l.kt(e);let r=null;const n=(0,o.rU)(t,11);n&&(r=(0,s.s3)(a.f[20](n),a.f[25](n+4)));let d=0;r&&r.length>=10&&(d=48e3*(r[4]<<24|r[5]<<16|r[6]<<8|r[9])/a.f[15](this.inCodecpar+136));let h=e.length+2+e.length/255+1;this.opusPendingTrimStart&&(h+=2),d&&(h+=2);const p=(0,c.sY)(h),f=(0,s.s3)(p,h);f[0]=127,f[1]=224,this.opusPendingTrimStart&&(f[1]|=16),d&&(f[1]|=8);let u=e.length,g=2;do{f[g]=Math.min(u,255),u-=255,g++}while(u>=0);let U=0;return this.opusPendingTrimStart&&(U=Math.min(this.opusPendingTrimStart,i),f[g]=(65280&U)>>8,f[g+1]=255&U,g+=2,this.opusPendingTrimStart-=U),d&&(d=Math.min(d,i-U),f[g]=(65280&d)>>8,f[g+1]=255&d,g+=2),f.set(e,g),(0,o.zu)(this.cache,t),(0,o.NX)(this.cache,p,h),this.cached=!0,0}receiveAVPacket(t){return this.cached?((0,o.Up)(t),(0,o.rN)(t,this.cache),this.cached=!1,0):d.LR}reset(){return 0}}},15597:(t,e,i)=>{i.r(e),i.d(e,{default:()=>S});var r=i(134),a=i(61499),n=i(63939),s=(i(9599),i(19770)),o=i(6403),c=i(51597),d=i(30469),l=i(72739),h=i(95335),p=i(76538),f=i(9848),u=i(60480),g=i(77662),U=i(52251),w=i(77231),y=i(14686),m=i(44328),A=i(71517),I=i(37837),P=i(4624),b=i(60264),F=i(62815),v=i(67659),C=i(59166);const k="src\\avformat\\formats\\OMpegtsFormat.ts",x={pesMaxSize:2930,delay:1.4,latm:!1,patPeriod:.1};class S extends c.A{constructor(t={}){super(),(0,r.A)(this,"type",2),(0,r.A)(this,"context",void 0),(0,r.A)(this,"sdtPacket",void 0),(0,r.A)(this,"patPacket",void 0),(0,r.A)(this,"pmtPacket",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"firstDtsCheck",void 0),(0,r.A)(this,"firstVideoCheck",void 0),(0,r.A)(this,"lastPatDst",void 0),(0,r.A)(this,"patPeriod",void 0),(0,r.A)(this,"avpacket",void 0),this.context=(0,s.A)(),this.options=h.X$({},x,t),this.options.pesMaxSize=this.options.pesMaxSize?(this.options.pesMaxSize+14+183)/184*184-14:0,this.firstDtsCheck=!1,this.firstVideoCheck=!1,this.patPeriod=BigInt(Math.floor(this.options.patPeriod*w.SF))}init(t){return t.ioWriter.setEndian(!0),this.avpacket=(0,A._5)(),0}async destroy(t){super.destroy(t),l.__(t.streams,(t=>{const e=t.privData;e.filter&&(e.filter.destroy(),e.filter=null)})),this.avpacket&&((0,A.Qe)(this.avpacket),this.avpacket=0)}writeHeader(t){return this.context.pat=new o.Cd,this.context.pat.program2PmtPid.set(1,4096),this.context.pmt=new o.I4,this.context.pmt.programNumber=1,l.__(t.streams,(t=>{t.timeBase.den=9e4,t.timeBase.num=1;const e=this.context.startPid++;this.context.pmt.pcrPid<=0&&(this.context.pmt.pcrPid=e);let i=d.Zp(t);const r=(0,p.A)();t.privData=r;const n=new o.am;n.pid=e,n.adaptationFieldControl=1,r.tsPacket=n,r.pid=e;let s=null;switch(i){case 15:this.options.latm?(r.latm=!0,i=17,s=new u.A):s=new f.A;break;case 27:case 36:case 51:s=new U.A;break;case 6:86076===t.codecpar.codecId&&(s=new g.A)}s&&s.init(t.codecpar[a.o9],t.timeBase[a.o9]),r.filter=s,this.context.pmt.pid2StreamType.set(e,i);const c=new o.xf;c.pid=e,c.streamType=i,c.streamId=d.kw(t),r.pes=c})),this.patPacket=new o.yU,this.pmtPacket=new o.yU,this.sdtPacket=new o.yU,this.sdtPacket.pid=17,this.sdtPacket.adaptationFieldControl=1,this.patPacket.pid=0,this.patPacket.adaptationFieldControl=1,this.pmtPacket.pid=4096,this.pmtPacket.adaptationFieldControl=1,this.sdtPacket.payload=d.Gj(),this.patPacket.payload=d.sG(this.context.pat),this.pmtPacket.payload=d.in(this.context.pmt,t.streams),d.Zn(t.ioWriter,this.sdtPacket,this.context),d.Zn(t.ioWriter,this.patPacket,this.context),d.Zn(t.ioWriter,this.pmtPacket,this.context),0}writeAVPacket(t,e){if(!n.f[15](e+28))return void P.R8(`packet's size is 0: ${n.f[15](e+32)}, ignore it`,k,224);const i=t.getStreamByIndex(n.f[15](e+32));if(!i)return void P.R8(`can not found the stream width the packet's streamIndex: ${n.f[15](e+32)}, ignore it`,k,231);this.firstDtsCheck||((0,m.Mr)(n.f[17](e+16),e+72,i.timeBase)<BigInt(Math.floor(9e4*this.options.delay))&&(this.context.delay=BigInt(Math.floor(9e4*this.options.delay))-(0,m.Mr)(n.f[17](e+16),e+72,i.timeBase)),this.firstDtsCheck=!0,this.lastPatDst=(0,m.Mr)(n.f[17](e+16),e+72,w.KR)),this.patPeriod>BigInt(0)&&(0,m.Mr)(n.f[17](e+16),e+72,w.KR)-this.lastPatDst>this.patPeriod&&(d.Zn(t.ioWriter,this.sdtPacket,this.context),d.Zn(t.ioWriter,this.patPacket,this.context),d.Zn(t.ioWriter,this.pmtPacket,this.context),this.lastPatDst=(0,m.Mr)(n.f[17](e+16),e+72,w.KR));const r=i.privData;let a=(0,A.iI)(e);if(r.filter){if(!this.firstVideoCheck&&(27===i.codecpar.codecId||173===i.codecpar.codecId||196===i.codecpar.codecId)&&1&n.f[15](e+36)){let t=(0,A.fQ)(e,1);if(!t&&64&n.f[15](e+36)&&(27===i.codecpar.codecId?t=!!F.sL((0,A.iI)(e)):173===i.codecpar.codecId?t=!!v.sL((0,A.iI)(e)):196===i.codecpar.codecId&&(t=!!C.sL((0,A.iI)(e)))),this.firstVideoCheck=!0,!t&&i.codecpar.extradata)if(64&n.f[15](e+36)){let t=(0,y.s3)(i.codecpar.extradata,i.codecpar.extradataSize).slice();if(27!==i.codecpar.codecId||F.sL((0,A.iI)(e)))if(173!==i.codecpar.codecId||v.sL((0,A.iI)(e))){if(196===i.codecpar.codecId&&!C.sL((0,A.iI)(e))){let i=[],r=[],a=[];const s=[];if(b.Bs(t))b.py(t).forEach((t=>{const e=t[1]>>>3&31;14===e?a.push(t):15===e?i.push(t):16===e&&r.push(t)}));else{const e=C.HL(t);i=e.spss,r=e.ppss,a=e.vpss}b.py((0,A.iI)(e,!0)).forEach((t=>{20!=(t[1]>>>3&31)&&s.push(t)}));const o=C.wA(a,i,r,s,!!(1&n.f[15](e+36)));(0,A.NX)(e,o.bufferPointer,o.length)}}else{let i=[],r=[],a=[];const n=[];if(b.Bs(t))b.py(t).forEach((t=>{const e=t[0]>>>1&63;32===e?a.push(t):33===e?i.push(t):34===e&&r.push(t)}));else{const e=v.HL(t);i=e.spss,r=e.ppss,a=e.vpss}b.py((0,A.iI)(e,!0)).forEach((t=>{35!=(t[0]>>>1&63)&&n.push(t)}));const s=v.wA(a,i,r,n);(0,A.NX)(e,s.bufferPointer,s.length)}else{let i=[],r=[],a=[];const n=[],s=[];if(b.Bs(t))b.py(t).forEach((t=>{const e=31&t[0];7===e?i.push(t):8===e?r.push(t):13===e&&a.push(t)}));else{const e=F.MB(t);i=e.spss,r=e.ppss,a=e.spsExts}b.py((0,A.iI)(e,!0)).forEach((t=>{const e=31&t[0];6===e?n.push(t):9!==e&&s.push(t)}));const o=F.wA(i,r,a,n,s);(0,A.NX)(e,o.bufferPointer,o.length)}}else{let t=(0,y.s3)(i.codecpar.extradata,i.codecpar.extradataSize).slice();b.Bs(t)&&(27===i.codecpar.codecId?t=F.S1(t):173===i.codecpar.codecId?t=v.S1(t):196===i.codecpar.codecId&&(t=C.S1(t)));const r=(0,I.sY)(t.length);(0,y.lW)(r,t.length,t),(0,A.Ow)(e,1,r,t.length)}}r.filter.sendAVPacket(e),r.filter.receiveAVPacket(this.avpacket),a=(0,A.iI)(this.avpacket),e=this.avpacket}if(!a.length)return 0;a=a.slice();let s=!1;return(r.pesSlices.total+a.length>this.options.pesMaxSize||0===i.codecpar.codecType)&&(0===r.pesSlices.total&&(r.pesSlices.total=a.length,r.pesSlices.buffers.push(a),n.f[17](e+16)!==w.Dh&&(r.pes.dts=(0,m.Mr)(n.f[17](e+16),e+72,i.timeBase)+this.context.delay),n.f[17](e+8)!==w.Dh&&(r.pes.pts=(0,m.Mr)(n.f[17](e+8),e+72,i.timeBase)+this.context.delay),0!==i.codecpar.codecType||1&n.f[15](e+36)?r.pes.randomAccessIndicator=1:r.pes.randomAccessIndicator=0,s=!0),d.CE(t.ioWriter,r.pes,r.pesSlices,i,this.context),r.pesSlices.total=0,r.pesSlices.buffers=[]),s||(0===r.pesSlices.total&&(n.f[17](e+16)!==w.Dh&&(r.pes.dts=(0,m.Mr)(n.f[17](e+16),e+72,i.timeBase)+this.context.delay),n.f[17](e+8)!==w.Dh&&(r.pes.pts=(0,m.Mr)(n.f[17](e+8),e+72,i.timeBase)+this.context.delay),0!==i.codecpar.codecType||1&n.f[15](e+36)?r.pes.randomAccessIndicator=1:r.pes.randomAccessIndicator=0),r.pesSlices.total+=a.length,r.pesSlices.buffers.push(a)),0}writeTrailer(t){return l.__(t.streams,(e=>{const i=e.privData;i.pesSlices.total&&d.CE(t.ioWriter,i.pes,i.pesSlices,e,this.context),i.pesSlices.total=0,i.pesSlices.buffers=[]})),t.ioWriter.flush(),0}flush(t){return t.ioWriter.flush(),0}}},50762:(t,e,i)=>{function r(t){let e=4294967295;for(let i=0;i<t.length;i++){e^=t[i]<<24;for(let t=0;t<8;t++)2147483648&e?e=e<<1^79764919:e<<=1}return e>>>0}i.d(e,{E:()=>r})},19770:(t,e,i)=>{i.d(e,{A:()=>o});var r=i(80662),a=i.n(r),n=i(77231),s=i(6403);function o(){return{currentProgram:n.N_,currentPmtPid:n.N_,tsPacketSize:n.N_,hasPAT:!1,hasPMT:!1,tsSliceQueueMap:new(a()),pat:new s.Cd,pmt:new s.I4,program2Pmt:new(a()),ioEnd:!1,startPid:256,delay:BigInt(0)}}},76538:(t,e,i)=>{i.d(e,{A:()=>a});var r=i(77231);function a(){return{pid:r.N_,filter:null,tsPacket:null,pes:null,pendingPES:null,continuityCounter:0,pesSlices:{total:0,buffers:[]},latm:!1}}},27274:(t,e,i)=>{i.d(e,{$x:()=>h,GV:()=>s,OS:()=>d,VG:()=>a,ZT:()=>n,eR:()=>r,hY:()=>c,pm:()=>o,qJ:()=>l});const r=204,a=192,n=188,s=204,o=8192,c=5,d=5,l=10,h={15:[1,86018],17:[1,86018],3:[1,86017],4:[1,86017],1:[0,2],2:[0,2],27:[0,27],16:[0,12],36:[0,173],51:[0,196],129:[1,86019],135:[1,86056],130:[1,86020]}},30469:(t,e,i)=>{i.d(e,{CE:()=>m,Gj:()=>U,Zn:()=>A,Zp:()=>p,in:()=>g,kw:()=>f,sG:()=>u});var r=i(63939),a=i(27274),n=i(4624),s=i(65977),o=i(92647),c=i(77231),d=i(50762);const l="src\\avformat\\formats\\mpegts\\ompegts.ts";function h(t){if(2!==t.adaptationFieldControl&&3!==t.adaptationFieldControl)return 0;if(2===t.adaptationFieldControl)return a.ZT-4;let e=2;return t.adaptationFieldInfo.pcrFlag&&(e+=6),t.adaptationFieldInfo.opcrFlag&&(e+=6),t.adaptationFieldInfo.splicingPointFlag&&(e+=1),t.adaptationFieldInfo.transportPrivateDataFlag&&(e+=t.adaptationFieldInfo.transportPrivateData?t.adaptationFieldInfo.transportPrivateData.length:0),t.adaptationFieldInfo.adaptationFieldExtensionFlag&&(e+=t.adaptationFieldInfo.extension?t.adaptationFieldInfo.extension.length:0),e>256&&n.R8("adaptationField size is too large",l,68),e}function p(t){const e=t.privData||{};switch(t.codecpar.codecId){case 1:case 2:return 2;case 12:return 16;case 27:return 27;case 87:return 66;case 173:return 36;case 196:return 51;case 116:return 209;case 70:return 234;case 86016:case 86017:return t.codecpar.sampleRate<32e3?4:3;case 86018:return e.latm?17:15;case 86065:return 17;case 86019:return 129;case 86076:case 225:case 94209:case 98311:default:return 6;case 86060:return 131;case 86056:return 135;case 86020:return 130}}function f(t){return 0===t.codecpar.codecType?116===t.codecpar.codecId?253:224:1!==t.codecpar.codecType||86016!==t.codecpar.codecId&&86017!==t.codecpar.codecId&&86018!==t.codecpar.codecId?1===t.codecpar.codecType&&86019===t.codecpar.codecId?253:2===t.codecpar.codecType?252:189:192}function u(t){const e=new Uint8Array(1024);e[1]=0,e[2]=176,e[5]=1,e[6]=193;let i=9;t.networkPid>-1&&(i+=2,e[i++]=224|t.networkPid>>8&31,e[i++]=255&t.networkPid),t.program2PmtPid.forEach(((t,r)=>{e[i++]=r>>8&255,e[i++]=255&r,e[i++]=224|t>>8&31,e[i++]=255&t}));const r=i;i+=4;for(let t=i;t<a.ZT-4;t++)e[t]=255;const n=i-1-3;e[2]|=n>>8&15,e[3]=255&n;const s=(0,d.E)(e.subarray(1,r));return e[r]=s>>24&255,e[r+1]=s>>16&255,e[r+2]=s>>8&255,e[r+3]=255&s,e.slice(0,a.ZT-4)}function g(t,e){const i=new Uint8Array(1024);i[1]=2,i[2]=176,i[4]=t.programNumber>>8&15,i[5]=255&t.programNumber,i[6]=193;let n=9;i[n++]=224|t.pcrPid>>8&31,i[n++]=255&t.pcrPid;const o=n;function c(t){i[n++]=a.OS,i[n++]=4,i[n++]=t>>24,i[n++]=t>>16,i[n++]=t>>8,i[n++]=t}n+=2;let l=61440|n-o-2;i[o]=l>>8,i[o+1]=l;for(let t=0;t<e.length;t++){const o=p(e[t]);i[n++]=o;const d=e[t].privData;i[n++]=224|d.pid>>8&31,i[n++]=255&d.pid;const l=n;n+=2;const h=e[t].codecpar.codecId;switch(e[t].codecpar.codecType){case 1:86019===h&&c((0,s.A)("AC-3")),86056===h&&c((0,s.A)("EAC3")),65562===h&&c((0,s.A)("BSSD")),86076===h&&(c((0,s.A)("Opus")),i[n++]=127,i[n++]=2,i[n++]=128,i[n++]=e[t].codecpar.chLayout.nbChannels),i[n++]=a.qJ,i[n++]=4,i[n++]=117,i[n++]=110,i[n++]=100,i[n++]=0;break;case 0:if(225===h&&(c((0,s.A)("AV01")),e[t].codecpar.extradata)){i[n++]=128,i[n++]=e[t].codecpar.extradataSize;for(let a=0;a<e[t].codecpar.extradataSize;a++)i[n++]=r.f[2](e[t].codecpar.extradata+a)}}let f=61440|n-l-2;i[l]=f>>8,i[l+1]=f}const h=n;n+=4;for(let t=n;t<a.ZT-4;t++)i[t]=255;l=n-1-3,i[2]|=l>>8&15,i[3]=255&l;const f=(0,d.E)(i.subarray(1,h));return i[h]=f>>24&255,i[h+1]=f>>16&255,i[h+2]=f>>8&255,i[h+3]=255&f,i.slice(0,a.ZT-4)}function U(){const t=new Uint8Array(1024);t[1]=66,t[2]=240,t[5]=1,t[6]=193;let e=9;t[e++]=255,t[e++]=1,t[e++]=255,t[e++]=0,t[e++]=1,t[e++]=252;const i=e;e+=2,t[e++]=72;const r=e++;t[e++]=1;t[e++]=9;for(let i=0;i<9;i++)t[e]="format-js".charCodeAt(i),e++;t[e++]=9;for(let i=0;i<9;i++)t[e]="Service01".charCodeAt(i),e++;t[r]=e-r-1;let n=32768|e-i-2;t[i]=n>>8&255,t[i+1]=255&n;const s=e;e+=4;for(let i=e;i<a.ZT-4;i++)t[i]=255;const o=e-1-3;t[2]|=o>>8&15,t[3]=255&o;const c=(0,d.E)(t.subarray(1,s));return t[s]=c>>24&255,t[s+1]=c>>16&255,t[s+2]=c>>8&255,t[s+3]=255&c,t.slice(0,a.ZT-4)}function w(t,e,i){var r;i.tsPacketSize===a.VG&&t.skip(4),e.payload&&0!==e.payload.length||(e.adaptationFieldControl=2),1===e.adaptationFieldControl&&e.payload.length+4<a.ZT&&(e.adaptationFieldControl=3);const s=t.getPos();t.writeUint8(71);let o=0;e.payloadUnitStartIndicator&&(o|=64),o|=e.transportPriority<<5,o|=e.pid>>8,t.writeUint8(o),t.writeUint8(255&e.pid),o=(3&e.transportScramblingControl)<<6,o|=(3&e.adaptationFieldControl)<<4,o|=15&e.continuityCounter,t.writeUint8(o);let c=h(e),d=a.ZT-4-c;if(null!==(r=e.payload)&&void 0!==r&&r.length&&(d-=e.payload.length),2===e.adaptationFieldControl||3===e.adaptationFieldControl){const i=t.getPos();if(t.writeUint8(c-1+d),o=(1&e.adaptationFieldInfo.discontinuityIndicator)<<7,o|=(1&e.adaptationFieldInfo.randomAccessIndicator)<<6,o|=(1&e.adaptationFieldInfo.elementaryStreamPriorityIndicator)<<5,o|=(1&e.adaptationFieldInfo.pcrFlag)<<4,o|=(1&e.adaptationFieldInfo.opcrFlag)<<3,o|=(1&e.adaptationFieldInfo.splicingPointFlag)<<2,o|=(1&e.adaptationFieldInfo.transportPrivateDataFlag)<<1,o|=1&e.adaptationFieldInfo.adaptationFieldExtensionFlag,t.writeUint8(o),e.adaptationFieldInfo.pcrFlag){const i=Number(e.adaptationFieldInfo.pcr%BigInt(300)),r=Number((e.adaptationFieldInfo.pcr-BigInt(Math.floor(i)))/BigInt(300));t.writeUint8(r>>25&255),t.writeUint8(r>>17&255),t.writeUint8(r>>9&255),t.writeUint8(r>>1&255),t.writeUint8(r<<7|i>>8|126),t.writeUint8(i)}if(e.adaptationFieldInfo.opcrFlag){const i=Number(e.adaptationFieldInfo.pcr%BigInt(300)),r=Number((e.adaptationFieldInfo.pcr-BigInt(Math.floor(i)))/BigInt(300));t.writeUint8(r>>25&255),t.writeUint8(r>>17&255),t.writeUint8(r>>9&255),t.writeUint8(r>>1&255),t.writeUint8(r<<7|i>>8|126),t.writeUint8(i)}e.adaptationFieldInfo.splicingPointFlag&&t.writeUint8(e.adaptationFieldInfo.spliceCountDown),e.adaptationFieldInfo.transportPrivateDataFlag&&(e.adaptationFieldInfo.transportPrivateData&&e.adaptationFieldInfo.transportPrivateData.length?(t.writeUint8(e.adaptationFieldInfo.transportPrivateData.length),t.writeBuffer(e.adaptationFieldInfo.transportPrivateData)):t.writeUint8(0)),e.adaptationFieldInfo.adaptationFieldExtensionFlag&&(e.adaptationFieldInfo.extension&&e.adaptationFieldInfo.extension.length?(t.writeUint8(e.adaptationFieldInfo.extension.length),t.writeBuffer(e.adaptationFieldInfo.extension)):t.writeUint8(0));const r=Number(t.getPos()-i);for(r<c&&t.skip(c-r);d>0;)t.writeUint8(255),d--}var p;1!==e.adaptationFieldControl&&3!==e.adaptationFieldControl||null!==(p=e.payload)&&void 0!==p&&p.length&&t.writeBuffer(e.payload),Number(t.getPos()-s)!==a.ZT&&n.z3(`write error data size to ts packet, need ${a.ZT}, wrote: ${Number(t.getPos()-s)}`,l,641),i.tsPacketSize===a.eR&&t.skip(16)}function y(t,e,i,r){let a=i<<4|(7&Number(r>>BigInt(30)))<<1|1;t[e++]=a,a=(32767&Number(r>>BigInt(15)))<<1|1,t[e++]=a>>8&255,t[e++]=255&a,a=Number(r&BigInt(32767))<<1|1,t[e++]=a>>8&255,t[e++]=255&a}function m(t,e,i,r,n){const s=e.streamId,d=new Uint8Array(function(t){let e=6;const i=t.streamId;return 188!==i&&190!==i&&191!==i&&240!==i&&241!==i&&255!==i&&242!==i&&248!==i&&(e+=3,t.pts!==c.Dh&&(e+=5),t.dts!==c.Dh&&t.pts!==c.Dh&&t.dts!==t.pts&&(e+=5)),e}(e));d[2]=1,d[3]=s;let l=i.total;if(188!==s&&190!==s&&191!==s&&240!==s&&241!==s&&255!==s&&242!==s&&248!==s){let t=0,i=0;e.pts!==c.Dh&&(i+=5,t|=128),e.dts!==c.Dh&&e.pts!==c.Dh&&e.dts!==e.pts&&(i+=5,t|=64);let a=128;3!==r.codecpar.codecType&&2!==r.codecpar.codecType||(a|=4),d[6]=a,d[7]=t,d[8]=i,l+=i+3,e.pts!==c.Dh&&y(d,9,t>>6,e.pts),e.dts!==c.Dh&&e.pts!==c.Dh&&e.dts!==e.pts&&y(d,14,1,e.dts)}l<=c.zg&&0!==r.codecpar.codecType&&(d[4]=l>>8&255,d[5]=255&l),function(t,e,i,r,n){const s=r.privData,o=s.tsPacket;e.pid===n.pmt.pcrPid&&(o.adaptationFieldControl=3,o.adaptationFieldInfo.pcrFlag=1,o.adaptationFieldInfo.pcr=e.dts*BigInt(300)),o.adaptationFieldInfo.randomAccessIndicator=e.randomAccessIndicator,e.randomAccessIndicator&&(o.adaptationFieldControl=3);let c=h(o),d=s.continuityCounter;if(4+c+i.length<=a.ZT)return o.payloadUnitStartIndicator=1,o.payload=i,o.continuityCounter=d++%16,w(t,o,n),void(s.continuityCounter=d%16);let l=a.ZT-(4+c),p=0;for(;p<i.length;){let e=Math.min(p+l,i.length);o.payloadUnitStartIndicator=0===p?1:0,1===o.adaptationFieldControl&&e-p+4==a.ZT-1&&e--,o.payload=i.subarray(p,e),o.continuityCounter=d++%16,w(t,o,n),0===p&&(o.adaptationFieldInfo.randomAccessIndicator=0,o.adaptationFieldControl=1,o.adaptationFieldInfo.pcrFlag=0,c=h(o),l=a.ZT-(4+c)),p=e}s.continuityCounter=d%16}(t,e,(0,o.A)(Uint8Array,[d,...i.buffers]),r,n)}function A(t,e,i){const r=h(e);let n=e.continuityCounter;if(4+r+e.payload.length<=a.ZT)return e.payloadUnitStartIndicator=1,e.continuityCounter=n++%16,w(t,e,i),void(e.continuityCounter=n%16);const s=a.ZT-(4+r);let o=0;const c=e.payload;for(;o<c.length;){let d=Math.min(o+s,c.length);e.payloadUnitStartIndicator=0===o?1:0;const l=d-o;l+4===a.ZT?e.adaptationFieldControl=1:0===r&&l+4+1===a.ZT&&d--,e.payload=c.subarray(o,d),e.continuityCounter=n++%16,w(t,e,i),o=d}e.continuityCounter=n%16}},6403:(t,e,i)=>{i.d(e,{Cd:()=>l,I4:()=>f,am:()=>c,kJ:()=>p,pi:()=>d,xf:()=>u,yU:()=>h});var r=i(134),a=i(80662),n=i.n(a),s=i(77231);class o{constructor(){(0,r.A)(this,"discontinuityIndicator",0),(0,r.A)(this,"randomAccessIndicator",0),(0,r.A)(this,"elementaryStreamPriorityIndicator",0),(0,r.A)(this,"pcrFlag",0),(0,r.A)(this,"opcrFlag",0),(0,r.A)(this,"splicingPointFlag",0),(0,r.A)(this,"transportPrivateDataFlag",0),(0,r.A)(this,"adaptationFieldExtensionFlag",0),(0,r.A)(this,"pcr",BigInt(0)),(0,r.A)(this,"opcr",BigInt(0)),(0,r.A)(this,"spliceCountDown",0),(0,r.A)(this,"transportPrivateData",null),(0,r.A)(this,"extension",null)}}class c{constructor(){(0,r.A)(this,"pos",s.Dh),(0,r.A)(this,"payloadUnitStartIndicator",0),(0,r.A)(this,"transportPriority",0),(0,r.A)(this,"pid",s.N_),(0,r.A)(this,"adaptationFieldControl",0),(0,r.A)(this,"continuityCounter",0),(0,r.A)(this,"transportScramblingControl",0),(0,r.A)(this,"adaptationFieldInfo",new o),(0,r.A)(this,"payload",null)}}class d{constructor(){(0,r.A)(this,"slices",[]),(0,r.A)(this,"totalLength",0),(0,r.A)(this,"expectedLength",s.N_),(0,r.A)(this,"randomAccessIndicator",0),(0,r.A)(this,"pid",s.N_),(0,r.A)(this,"streamType",0),(0,r.A)(this,"pos",s.Dh)}}class l{constructor(){(0,r.A)(this,"versionNumber",0),(0,r.A)(this,"networkPid",s.N_),(0,r.A)(this,"program2PmtPid",new(n()))}}class h extends c{}class p{constructor(){(0,r.A)(this,"tag",void 0),(0,r.A)(this,"buffer",void 0)}}class f{constructor(){(0,r.A)(this,"versionNumber",0),(0,r.A)(this,"programNumber",0),(0,r.A)(this,"pcrPid",0),(0,r.A)(this,"pid2StreamType",new(n())),(0,r.A)(this,"pid2ESDescriptor",new(n()))}}class u{constructor(){(0,r.A)(this,"pid",s.N_),(0,r.A)(this,"streamType",0),(0,r.A)(this,"streamId",s.N_),(0,r.A)(this,"dts",s.Dh),(0,r.A)(this,"pts",s.Dh),(0,r.A)(this,"pos",s.Dh),(0,r.A)(this,"payload",null),(0,r.A)(this,"data",null),(0,r.A)(this,"randomAccessIndicator",0),(0,r.A)(this,"flags",void 0)}}},65977:(t,e,i)=>{i.d(e,{A:()=>n});var r=i(4624);const a="src\\avformat\\function\\mktag.ts";function n(t){4!==t.length&&r.R8(`tag length is not 4, tag: ${t}`,a,30);let e=0;for(let i=0;i<4;i++)e=e<<8|t.charCodeAt(i);return e}},22576:(t,e,i)=>{i.d(e,{Ij:()=>d,XC:()=>c,kt:()=>o});var r=i(31865),a=i(729),n=i(44328);const s=[480,960,1920,2880,480,960,1920,2880,480,960,1920,2880,480,960,480,960,120,240,480,960,120,240,480,960,120,240,480,960,120,240,480,960];function o(t){let e=0,i=0,r=0;if(t.length<1)return 0;switch(e=t[0],i=s[e>>3],3&e){case 0:r=1;break;case 1:case 2:r=2;break;case 3:if(t.length<2)return 0;r=63&t[1]}return r*i}function c(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=19){const i=new r.A(e,!1);i.skip(9),t.codecpar.chLayout.nbChannels=i.readUint8(),t.codecpar.initialPadding=i.readUint16(),t.codecpar.sampleRate=i.readUint32(),t.codecpar.seekPreroll=Number((0,n.k)(BigInt(80),{den:1e3,num:1},{den:48e3,num:1}))}}function d(t){const e=new Uint8Array(19),i=new a.A(e,!1);return i.writeString("OpusHead"),i.writeUint8(1),i.writeUint8(t.chLayout.nbChannels),i.writeUint16(t.initialPadding),i.writeUint32(t.sampleRate),e}},59166:(t,e,i)=>{i.d(e,{HL:()=>w,KD:()=>C,OD:()=>F,S1:()=>m,Ui:()=>x,XC:()=>v,kM:()=>b,oT:()=>I,sL:()=>A,wA:()=>P,wf:()=>k});var r=i(63939),a=i(72739),n=i(729),s=i(31865),o=i(37246),c=i(14686),d=i(60264),l=i(37837),h=i(23991),p=i(83314),f=i(39381),u=i(82774);const g=3;function U(t){const e=t.readU(9),i=t.readU(3),r=t.readU(2),a=t.readU(2),n=t.readU(3);t.readU(5),t.readU(2);const s=t.readU(6),o=t.readU(7),c=t.readU(1),d=t.readU(8),l=t.readU(1),h=t.readU(1),p=[],f=[];if(s){for(let e=0;e<s-1;e++)p[e]=t.readU(8);p[s-1]=t.readU(6)}else t.readU(6);if(i>1){let e=0;for(let r=i-2;r>=0;--r)e|=t.readU(1)<<r;for(let e=i;e<=8&&i>1;++e)t.readU(1);for(let r=i-2;r>=0;--r)e&1<<r&&(f[r]=t.readU(8))}const u=t.readU(8),g=[];if(u)for(let e=0;e<u;e++)g.push(t.readU(8));return{olsIdx:e,numSublayers:i,bitDepthMinus8:n,chromaFormatIdc:a,constantFrameRate:r,generalProfileIdc:o,generalTierFlag:c,generalLevelIdc:d,ptlFrameOnlyConstraintFlag:l,ptlMultilayerEnabledFlag:h,generalConstraintInfo:p,sublayerLevelIdc:f,generalSubProfileIdc:g,maxPictureWidth:t.readU(16),maxPictureHeight:t.readU(16),avgFramerate:t.readU(16)}}function w(t){const e=new s.A(t,!0);if(1&e.readUint8()){const i=new o.A;i.appendBuffer(t.subarray(1)),U(i),e.skip(i.getPointer())}let i=[],r=[],a=[];const n=e.readUint8();for(let t=0;t<n;t++){const t=31&e.readUint8();let n=1;13!==t&&12!==t&&(n=e.readUint16());const s=[];for(let t=0;t<n;t++){const t=e.readUint16();s.push(e.readBuffer(t))}14===t?i=s:15===t?r=s:16===t&&(a=s)}return{vpss:i,spss:r,ppss:a}}function y(t,e,i){const r=e[0];let s;if(r){const t=k(r);let e=t.generalConstraintInfo;e.length||(e=new Array(12).fill(0));const i=new p.A;if(i.writeU(9,0),i.writeU(3,t.spsMaxSublayersMinus1+1),i.writeU(2,1),i.writeU(2,t.chromaFormatIdc),i.writeU(3,t.bitDepthMinus8),i.writeU(5,31),i.writeU(2,0),i.writeU(6,e.length),i.writeU(7,t.profile),i.writeU1(t.tierFlag),i.writeU(8,t.level),i.writeU1(t.ptlFrameOnlyConstraintFlag),i.writeU1(t.ptlMultilayerEnabledFlag),e.length){for(let t=0;t<e.length-1;t++)i.writeU(8,e[t]);i.writeU(6,e[e.length-1])}else i.writeU(6,63);if(t.spsMaxSublayersMinus1+1>1){let e=0;for(let i=t.spsMaxSublayersMinus1-1;i>=0;i--)e=e<<1|t.ptlSublayerLevelPresentFlag[i];i.writeU(t.spsMaxSublayersMinus1,e);for(let e=t.spsMaxSublayersMinus1+1;e<=8&&t.spsMaxSublayersMinus1>0;++e)i.writeU1(0);for(let e=t.spsMaxSublayersMinus1-1;e>=0;e--)t.ptlSublayerLevelPresentFlag[e]&&i.writeU(8,t.sublayerLevelIdc[e])}i.writeU(8,t.generalSubProfileIdc.length);for(let e=0;e<t.generalSubProfileIdc.length;e++)i.writeU(8,t.sublayerLevelIdc[e]);i.writeU(16,t.width),i.writeU(16,t.height),i.writeU(16,0),i.padding(),s=i.getBuffer().subarray(0,i.getPointer())}let o=2+(s?s.length:0);t.length&&(o+=3,o=t.reduce(((t,e)=>t+2+e.length),o)),e.length&&(o+=3,o=e.reduce(((t,e)=>t+2+e.length),o)),i.length&&(o+=3,o=i.reduce(((t,e)=>t+2+e.length),o));const c=new Uint8Array(o),d=new n.A(c,!0);d.writeUint8(g<<1|(s?1:0)|248),s&&d.writeBuffer(s);let l=0;return t.length&&l++,e.length&&l++,i.length&&l++,d.writeUint8(l),t.length&&(d.writeUint8(142),d.writeUint16(t.length),a.__(t,(t=>{d.writeUint16(t.length),d.writeBuffer(t)}))),e.length&&(d.writeUint8(143),d.writeUint16(e.length),a.__(e,(t=>{d.writeUint16(t.length),d.writeBuffer(t)}))),i.length&&(d.writeUint8(144),d.writeUint16(i.length),a.__(i,(t=>{d.writeUint16(t.length),d.writeBuffer(t)}))),c}function m(t){let e=d.py(t);if(e.length>=2){const t=[],i=[],r=[];if(e.forEach((e=>{const a=e[1]>>>3&31;14===a?t.push(e):15===a?i.push(e):16===a&&r.push(e)})),i.length&&r.length)return y(t,i,r)}}function A(t){let e=d.py(t);if(e.length>=2){const t=[],i=[],r=[];if(e.forEach((e=>{const a=e[1]>>>3&31;14===a?t.push(e):15===a?i.push(e):16===a&&r.push(e)})),i.length&&r.length){const e=[i[0],r[0]];return t.length&&e.unshift(t[0]),d.nW(e,0)}}}function I(t,e=!1){let i,r=!1,a=d.py(t);if(a.length){const t=[],n=[],s=[];a.forEach((e=>{const i=e[1]>>>3&31;14===i?t.push(e):15===i?n.push(e):16===i&&s.push(e),8!==i&&7!==i&&9!==i&&10!==i||(r=!0)})),n.length&&s.length?(i=y(t,n,s),a=a.filter((t=>{const i=t[1]>>>3&31;return(e||14!==i&&15!==i&&16!==i)&&20!==i}))):a=a.filter((t=>20!=(t[1]>>>3&31)))}const n=a.reduce(((t,e)=>t+g+1+e.length),0),s=(0,l.sY)(n),o=(0,c.s3)(s,n);return d.S9(a,g,o),{bufferPointer:s,length:n,extradata:i,key:r}}function P(t,e,i,r,a){const n=[d.Le(t,0),d.Le(e,0),d.Le(i,0),d.Le(r,2)];let s=n.reduce(((t,e)=>t+e),0);const o=(0,l.sY)(s+7);let h=o;return u.w8((h+=1,h-1),0),u.w8((h+=1,h-1),0),u.w8((h+=1,h-1),0),u.w8((h+=1,h-1),1),u.w8((h+=1,h-1),0),u.w8((h+=1,h-1),161),u.w8((h+=1,h-1),(a?1:0)<<7|40),t.length&&(d.nW(t,0,(0,c.s3)(h,n[0])),h+=n[0]),e.length&&(d.nW(e,0,(0,c.s3)(h,n[1])),h+=n[1]),i.length&&(d.nW(i,0,(0,c.s3)(h,n[2])),h+=n[2]),r.length&&d.nW(r,2,(0,c.s3)(h,n[3])),{bufferPointer:o,length:s+7}}function b(t,e){let i=d.py(t).concat(d.py(e));if(i.length){let t=[],e=[],r=[],a=[];return i.forEach((i=>{const n=i[1]>>>3&31;14===n?t.push(i):15===n?e.push(i):16===n?r.push(i):20!==n&&a.push(i)})),P(t,e,r,a,!0)}}function F(t,e){const i=e?e[0]>>>1&3:g;let r=[],a=[],n=[],s=!1;if(e){const t=w(e);r=t.vpss,a=t.spss,n=t.ppss,s=!0}return{...P(r,a,n,d.wN(t,i).filter((t=>20!=(t[1]>>>3&31))),s),key:s}}function v(t,e){let i;if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&d.Bs(e))a.__(d.py(e),(t=>{if(15==(t[1]>>>3&31))return i=t,!1}));else if(e&&e.length>=6){t.metadata.naluLengthSizeMinusOne=e[0]>>>1&3;const{spss:r}=w(e);r.length&&(i=r[0])}i&&function(t,e){const{profile:i,level:r,width:a,height:n,videoDelay:s,chromaFormatIdc:o,bitDepthMinus8:c}=k(e);switch(t.codecpar.profile=i,t.codecpar.level=r,t.codecpar.width=a,t.codecpar.height=n,t.codecpar.videoDelay=s,c){case 0:t.codecpar.format=3===o?5:2===o?4:0;break;case 2:t.codecpar.format=3===o?68:2===o?64:62}}(t,i)}function C(t,e=4){if(64&r.f[15](t+36))return d.py((0,c.s3)(r.f[20](t+24),r.f[15](t+28))).some((t=>{const e=t[1]>>>3&31;return 8===e||7===e}));{const i=r.f[15](t+28);let a=0;for(;a<i-e;){const i=f.r8(r.f[20](t+24)+(a+e+1))>>>3&31;if(8===i||7===i)return!0;a+=4===e?f.Sg(r.f[20](t+24)+a):3===e?f.ht(r.f[20](t+24)+a):2===e?f.yd(r.f[20](t+24)+a):f.r8(r.f[20](t+24)+a),a+=e}return!1}}function k(t){if(!t||t.length<3)return;let e=0;0===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&(e=4);let i=0,r=0,a=0,n=0,s=0,c=1,l=0,p=0,f=0;const u=[],g=[],U=[],w=[],y=d.BN(t.subarray(e)),m=new o.A(y.length);m.appendBuffer(y),m.readU1(),m.readU1(),m.readU(6),m.readU(5),m.readU(3),m.readU(8);const A=m.readU(3);c=m.readU(2);const I=m.readU(2);if(m.readU(1)){if(i=m.readU(7),l=m.readU(1),r=m.readU(8),p=m.readU(1),f=m.readU(1),m.readU(1)){for(let t=0;t<8;t++)u[t]=m.readU(8);u[8]=m.readU(7);const t=m.readU(8);m.readU(t)}m.skipPadding();for(let t=A-1;t>=0;t--)g[t]=m.readU(1);m.skipPadding();for(let t=A-1;t>=0;t--)g[t]&&(U[t]=m.readU(8));const t=m.readU(8);if(t)for(let e=0;e<t;e++)w[e]=m.readU(32)}m.readU1(),m.readU1()&&m.readU1();const P=a=h.xb(m),b=n=h.xb(m);if(m.readU1()&&(h.xb(m),h.xb(m),h.xb(m),h.xb(m)),m.readU1()){const t=h.xb(m),e=I+5,i=1<<e,r=P/(1<<e),a=b/(1<<e),n=Math.ceil(Math.log2(r)),s=Math.ceil(Math.log2(a));let o=0,c=0,d=0;t>0&&(d=m.readU1(),c=m.readU1());for(let e=0;t>0&&e<=t;e++)c&&0!=e||(e>0&&P>i&&m.readU(n),e>0&&b>i&&m.readU(s),e<t&&P>i&&m.readU(n),e<t&&b>i&&m.readU(s)),d||m.readU(2);if(o=h.xb(m)+1,m.readU(1)&&m.readU(1))for(let e=0;e<=t;e++)m.readU(o)}s=h.xb(m),m.readU(1),m.readU(1);const F=m.readU(4),v=m.readU(1);let C=0;v&&(C=h.xb(m));const k=[],x=m.readU(2);for(let t=0;t<8*x;t++)k[t]=m.readU(1);return{profile:i,level:r,width:a,height:n,videoDelay:A+1>2?2:A,chromaFormatIdc:c,bitDepthMinus8:s,generalProfileSpace:0,tierFlag:l,generalConstraintInfo:u,generalSubProfileIdc:w,ptlFrameOnlyConstraintFlag:p,ptlMultilayerEnabledFlag:f,spsMaxSublayersMinus1:A,ptlSublayerLevelPresentFlag:g,sublayerLevelIdc:U,sps_log2_max_pic_order_cnt_lsb_minus4:F,sps_poc_msb_cycle_flag:v,sps_poc_msb_cycle_len_minus1:C,sps_num_extra_ph_bytes:x,sps_extra_ph_bit_present_flag:k}}function x(t){d.Bs(t)&&(t=m(t));const e=new o.A;return e.appendBuffer(t),1&e.readU(8)?U(e):{}}}}]);