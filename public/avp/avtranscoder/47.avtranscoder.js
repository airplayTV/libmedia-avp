"use strict";(self.webpackChunkAVTranscoder=self.webpackChunkAVTranscoder||[]).push([[47],{85947:(e,a,t)=>{t.d(a,{A:()=>s});var i=t(134);class s{constructor(){(0,i.A)(this,"type",-1),(0,i.A)(this,"onStreamAdd",void 0)}async destroy(e){}}},92047:(e,a,t)=>{t.r(a),t.d(a,{default:()=>A});var i=t(134),s=t(63939),r=t(50932),n=t(4624),o=t(9705),c=t(65977),d=t(74963),l=t(85947),f=t(85428),p=t(9690),m=t(72739),u=t(14686),w=t(37837),g=t(71517),h=t(44328),v=t(77231),z=t(39381),U=t(50315);const k="src\\avformat\\formats\\IMovFormat.ts";class A extends l.A{constructor(e={}){super(),(0,i.A)(this,"type",1),(0,i.A)(this,"context",void 0),(0,i.A)(this,"firstAfterSeek",void 0),(0,i.A)(this,"options",void 0),this.options=e,this.context=(0,p.A)(),e.ignoreEditlist&&(this.context.ignoreEditlist=!0)}init(e){e.ioReader&&e.ioReader.setEndian(!0),this.firstAfterSeek=!1}async readHeader(e){try{const a=await e.ioReader.fileSize();let t=0,i=await e.ioReader.readUint32(),s=await e.ioReader.readUint32();s===(0,c.A)("ftyp")?await d.E6(e.ioReader,this.context,{type:s,size:i-8}):(!a||i<a)&&await e.ioReader.skip(i-8);let r=BigInt(0);for(;!this.context.foundMoov;){const t=e.ioReader.getPos();if(t===a)return n.z3("the file format is not mp4",k,111),o.LR;if(i=await e.ioReader.readUint32(),s=await e.ioReader.readUint32(),1===i&&(i=Number(await e.ioReader.readUint64())),i<8||a&&t+BigInt(Math.floor(i))>a)return n.z3(`invalid box size ${i}`,k,124),o.LR;s===(0,c.A)("mdat")?(this.context.foundMdat||(r=t),this.context.foundMdat=!0,await e.ioReader.seek(t+BigInt(Math.floor(i)))):s===(0,c.A)("moov")?(await d.wB(e.ioReader,e,this.context,{size:i-8,type:s}),this.context.foundMoov=!0):await e.ioReader.seek(t+BigInt(Math.floor(i)))}if(!this.context.fragment&&!this.context.foundMdat){const a=await e.ioReader.peekUint64()>>BigInt(32);Number(a)===(0,c.A)("moof")&&(this.context.fragment=!0)}if(this.context.fragment&&1&e.ioReader.flags){const a=e.ioReader.getPos(),t=await e.ioReader.fileSize();if(t>BigInt(16)){await e.ioReader.seek(t-BigInt(12));let i=await e.ioReader.readUint32();if(i===(0,c.A)("mfro")){await e.ioReader.skip(4);const a=await e.ioReader.readUint32();await e.ioReader.seek(t-BigInt(Math.floor(a)));const s=await e.ioReader.readUint32();i=await e.ioReader.readUint32(),i===(0,c.A)("mfra")&&await d.t9(e.ioReader,e,this.context,{size:s-8,type:i})}await e.ioReader.seek(a)}}return!this.context.fragment&&this.context.foundMdat&&await e.ioReader.seek(r),t}catch(a){return n.z3(a.message,k,186),this.context.foundMoov||n.z3("moov not found",k,189),e.ioReader.error}}async readAVPacket_(e,a){const{sample:t,stream:i,encryption:n}=(0,f.G)(e,this.context,e.ioReader.flags);if(!t)return-1048576;{r.M[15](a+32,i.index),r.M[17](a+16,t.dts),r.M[17](a+8,t.pts),r.M[17](a+48,BigInt(Math.floor(t.duration))),r.M[15](a+36,s.f[15](a+36)|t.flags),r.M[17](a+56,t.pos),r.M[15](a+76,i.timeBase.den),r.M[15](a+72,i.timeBase.num),i.startTime===v.Dh&&(i.startTime=s.f[17](a+8));const o=s.f[17](a+56)-e.ioReader.getPos();o!==BigInt(0)&&(o>0&&(4&e.ioReader.flags||2&e.ioReader.flags)&&!this.firstAfterSeek?await e.ioReader.skip(Number(BigInt.asIntN(32,o))):await e.ioReader.seek(s.f[17](a+56))),this.firstAfterSeek&&(this.firstAfterSeek=!1);const d=t.size,l=(0,w.sY)(d);if((0,g.NX)(a,l,d),await e.ioReader.readBuffer(d,(0,u.JW)(l,d)),94226===i.codecpar.codecId&&s.f[15](a+28)>=8){const e=z.Sg(s.f[20](a+24)+4)>>>0,t=s.f[15](a+28);if(e===(0,c.A)("vtte")&&8===t){const e=(0,w.Gy)(1);(0,g.NX)(a,e,1),r.M[15](a+28,1)}if(t>8&&(e===(0,c.A)("vtte")||e===(0,c.A)("vttc"))){let e=s.f[20](a+24)+8;const i=s.f[20](a+24)+t;for(;e<i;){const t=z.Sg(e);if(z.Sg(e+4)>>>0===(0,c.A)("payl")&&t>8){const i=(0,w.sY)(t-8);(0,u.Mr)(i,e+8,t-8),(0,g.NX)(a,i,t-8);break}e+=t}}}if(i.sideData[1]&&1&s.f[15](a+36)){const e=i.sideData[1].length,t=(0,w.sY)(e);(0,g.Ow)(a,1,t,e),(0,u.lW)(t,e,i.sideData[1]),delete i.sideData[1]}if(n){const e=(0,U.zz)(n),t=(0,w.sY)(e.length);(0,u.lW)(t,e.length,e),(0,g.Ow)(a,25,t,e.length)}}return 0}async readAVPacket(e,a){try{if(!e.streams.find((e=>{var a;const t=e.privData;return(null===(a=t.samplesIndex)||void 0===a?void 0:a.length)&&!1===t.sampleEnd}))&&this.context.fragment&&!this.context.currentFragment)for(;!this.context.currentFragment;){const a=e.ioReader.getPos(),t=await e.ioReader.readUint32(),i=await e.ioReader.readUint32();i===(0,c.A)("moof")?(this.context.currentFragment={pos:a,size:t,sequence:0,tracks:[],currentTrack:null},this.context.firstMoof||(this.context.firstMoof=a),await d.wZ(e.ioReader,e,this.context,{type:i,size:t-8})):i===(0,c.A)("moov")?await d.wB(e.ioReader,e,this.context,{size:t-8,type:i}):await e.ioReader.skip(t-8)}return await this.readAVPacket_(e,a)}catch(a){return-1048576!==e.ioReader.error&&-1048572!==e.ioReader.error?(n.z3(`read packet error, ${a}`,k,348),o.LR):e.ioReader.error}}async seek(e,a,t,i){const s=e.ioReader.getPos();if(2&i)return await e.ioReader.seek(t),s;const r=t,n=a.privData,c=()=>{this.context.currentFragment=null,e.streams.forEach((e=>{e.privData.samplesIndex.length=0}))};if(16&i&&this.context.fragment){const i=(0,h.k)(t,a.timeBase,v.i0);return await e.ioReader.seek(i,!0),c(),s}if(this.context.fragment){if(n.fragIndexes.length){let a=m.El(n.fragIndexes,(e=>e.time>r?-1:e.time===r?0:1));if(a>-1)return a>0&&n.fragIndexes[a].time>r&&a--,await e.ioReader.seek(n.fragIndexes[a].pos,!0),c(),s}return r===BigInt(0)&&this.context.firstMoof?(await e.ioReader.seek(this.context.firstMoof),c(),s):BigInt(o.E$)}let d=m.El(n.samplesIndex,(e=>e.pts>r?-1:e.pts===r?0:1));if(d>-1&&0===a.codecpar.codecType){let e=d;for(;e>=0;e--)if(1&n.samplesIndex[e].flags){d=e;break}e<0&&(d=-1)}return d>-1?(n.currentSample=d,n.sampleEnd=!1,m.__(e.streams,(e=>{if(e!==a){const t=e.privData;let i=(0,h.k)(n.samplesIndex[n.currentSample].pts,a.timeBase,e.timeBase),s=m.El(t.samplesIndex,(e=>e.pts>i?-1:e.pts===i?0:1));if(s>-1&&0===e.codecpar.codecType){let e=s;for(;e>=0;e--)if(1&t.samplesIndex[e].flags){s=e;break}e<0&&(s=-1)}s>=0?(t.currentSample=s,t.sampleEnd=!1):(t.sampleEnd=!0,t.currentSample=t.samplesIndex.length)}})),this.firstAfterSeek=!0,s):BigInt(o.LR)}getAnalyzeStreamsCount(){return 0}}},13663:(e,a,t)=>{t.d(a,{h6:()=>s,s5:()=>n,uM:()=>r});var i=t(79682);const s={[(0,i.A)("mp4v")]:12,[(0,i.A)("DIVX")]:12,[(0,i.A)("XVID")]:12,[(0,i.A)("3IV2")]:12,[(0,i.A)("vvc1")]:196,[(0,i.A)("vvi1")]:196,[(0,i.A)("hev1")]:173,[(0,i.A)("hvc1")]:173,[(0,i.A)("dvhe")]:173,[(0,i.A)("hev1")]:173,[(0,i.A)("avc1")]:27,[(0,i.A)("avc2")]:27,[(0,i.A)("avc3")]:27,[(0,i.A)("avc4")]:27,[(0,i.A)("ai5p")]:27,[(0,i.A)("ai5q")]:27,[(0,i.A)("ai52")]:27,[(0,i.A)("ai53")]:27,[(0,i.A)("ai55")]:27,[(0,i.A)("ai56")]:27,[(0,i.A)("ai1p")]:27,[(0,i.A)("ai1q")]:27,[(0,i.A)("ai12")]:27,[(0,i.A)("ai13")]:27,[(0,i.A)("ai15")]:27,[(0,i.A)("ai16")]:27,[(0,i.A)("AVin")]:27,[(0,i.A)("aivx")]:27,[(0,i.A)("rv64")]:27,[(0,i.A)("xalg")]:27,[(0,i.A)("avlg")]:27,[(0,i.A)("dva1")]:27,[(0,i.A)("dvav")]:27,[(0,i.A)("vp08")]:139,[(0,i.A)("vp09")]:167,[(0,i.A)("av01")]:225},r={[(0,i.A)("mp4a")]:86018,[(0,i.A)("ac-3")]:86019,[(0,i.A)("sac3")]:86019,[(0,i.A)("ac-4")]:86119,[(0,i.A)("dtsc")]:86020,[(0,i.A)("dtsh")]:86020,[(0,i.A)("dtsl")]:86020,[(0,i.A)("dtse")]:86020,[(0,i.A)("DTS ")]:86020,[(0,i.A)("ec-3")]:86056,[(0,i.A)(".mp3")]:86017,[(0,i.A)("mp3 ")]:86017,1836253269:86017,[(0,i.A)("spex")]:86051,[(0,i.A)("SPXN")]:86051,[(0,i.A)("fLaC")]:86028,[(0,i.A)("Opus")]:86076,[(0,i.A)("alaw")]:65543,[(0,i.A)("ulaw")]:65542,[(0,i.A)("fl32")]:65557,[(0,i.A)("fl64")]:65559,[(0,i.A)("twos")]:65537,[(0,i.A)("lpcm")]:65536,[(0,i.A)("sowt")]:65536,[(0,i.A)("in24")]:65548,[(0,i.A)("in32")]:65544,[(0,i.A)("sowt")]:65540,[(0,i.A)("raw ")]:65541,[(0,i.A)("NONE")]:65541},n={[(0,i.A)("text")]:94213,[(0,i.A)("tx3g")]:94213,[(0,i.A)("c608")]:94218}},21071:(e,a,t)=>{t.d(a,{_l:()=>i,gQ:()=>s});const i=["hmhd","nmhd","iods","xml ","url ","bxml","ipro","mere","stts","ctts","stss","stsz","stz2","stsc","stco","co64","stsd","dref","mvhd","tkhd","mdhd","hdlr"],s=["moov","trak","edts","mdia","minf","dinf","stbl","mvex","moof","traf","vttc","tref","iref","mfra","hnti","hinf","strd","sinf","rinf","schi","trgr","udta","iprp","ipco","strk","meco","encv","enca","sinf","schi"]},61179:(e,a,t)=>{function i(e,a,t,i,s=0){const r=e.privData;let n=a.baseDataOffset+BigInt(Math.floor(a.dataOffset));(a.baseIsMoof||n<i)&&(n+=t.currentFragment.pos);let o=a.baseMediaDecodeTime;const c=a.sampleSizes,d=a.sampleDurations,l=a.sampleFlags,f=a.sampleCompositionTimeOffset,p=a.remainDataOffsets,m=a.remainDataOffsetIndex;let u=0;const w=[];for(let e=0;e<a.sampleCount;e++){m[u]===e&&(n=a.baseDataOffset+BigInt(Math.floor(p[u])),a.baseIsMoof&&(n+=t.currentFragment.pos),u++);const i={dts:o,pts:o+BigInt(Math.floor(f[e])),pos:n,size:c[e],duration:d[e],flags:0};o+=BigInt(Math.floor(i.duration)),n+=BigInt(Math.floor(i.size)),16842752&l[e]||(i.flags|=1),0===e&&c.length>1&&2&s&&(i.flags|=1),w.push(i)}r.samplesIndex=w;const g=t.cencs?t.cencs[r.trackId]:null;g&&a.cenc&&a.cenc.sampleEncryption&&(r.samplesEncryption=a.cenc.sampleEncryption.map((e=>({scheme:g.schemeType,keyId:g.defaultKeyId,skipByteBlock:g.skipByteBlock,cryptByteBlock:g.cryptByteBlock,iv:e.iv,subsamples:e.subsamples}))))}t.d(a,{p:()=>i})},98859:(e,a,t)=>{t.d(a,{X:()=>o});var i=t(4624),s=t(44328),r=t(77231);const n="src\\avformat\\formats\\mov\\function\\buildIndex.ts";function o(e,a){var t;const o=e.privData,c=o.chunkOffsets,d=o.sampleSizes,l=o.cttsSampleCounts,f=o.cttsSampleOffsets,p=o.stscFirstChunk,m=o.stscSamplesPerChunk,u=o.stssSampleNumbersMap,w=o.sttsSampleCounts,g=o.sttsSampleDeltas;if(!c.length)return;let h=0,v=0,z=0,U=0,k=0,A=0,I=BigInt(0),y=0,x=BigInt(0);const b=[];if(!a.ignoreEditlist&&null!==(t=e.metadata.elst)&&void 0!==t&&t.length){let t=BigInt(0),o=0,c=!1,d=BigInt(0),l=BigInt(0);for(let a=0;a<e.metadata.elst.length;a++){const t=e.metadata.elst[a];0===a&&t.mediaTime===-BigInt(1)?(d=t.segmentDuration,o=1):a===o&&t.mediaTime>=BigInt(0)?l=t.mediaTime:c=!0}c&&i.R8("multiple edit list entries, a/v desync might occur, patch welcome",n,93),(d||l)&&a.timescale>0&&(d&&(d=(0,s.k)(d,{num:1,den:a.timescale},e.timeBase),e.duration!==r.Dh&&(e.duration+=d)),t=l-d,x=-t)}for(let a=0;a<c.length;a++)for(I=c[a],h<p.length-1&&p[h+1]===a+1&&h++,A=m[h];A>0;){const a={dts:x,pts:x,pos:I,size:d[y],duration:g[v],flags:0};(u&&u.has(y+1)||1===e.codecpar.codecType)&&(a.flags|=1),f&&(a.pts=a.dts+BigInt(Math.floor(f[U])),k++,k===l[U]&&(U++,k=0)),I+=BigInt(Math.floor(a.size)),x+=BigInt(Math.floor(g[v])),z++,z===w[v]&&(v++,z=0),y++,b.push(a),A--}b.length&&e.duration===r.Dh&&(e.duration=b[y-1].pts+BigInt(Math.floor(b[y-1].duration))),o.samplesIndex=b}},3384:(e,a,t)=>{t.d(a,{A:()=>s});var i=t(77231);function s(){return{trackId:0,baseDataOffset:BigInt(0),defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlags:0,baseMediaDecodeTime:BigInt(0),sampleCount:0,dataOffset:0,remainDataOffsets:[],remainDataOffsetIndex:[],dataOffsetPos:BigInt(0),firstSampleFlags:0,sampleDurations:[],sampleSizes:[],sampleFlags:[],sampleCompositionTimeOffset:[],baseIsMoof:!1,ioWriter:null,buffers:[],lastFragIndexDts:BigInt(0),tfdtDelay:i.Dh,trunPtsDelay:BigInt(0)}}},9690:(e,a,t)=>{t.d(a,{A:()=>s});var i=t(77231);function s(){return{isom:!1,timescale:i.N_,duration:i.Dh,foundMoov:!1,foundMdat:!1,majorBrand:0,minorVersion:0,compatibleBrand:[],creationTime:BigInt(0),modificationTime:BigInt(0),rate:i.N_,volume:i.N_,matrix:null,nextTrackId:1,fragment:!1,trexs:[],currentFragment:null,boxsPositionInfo:[],holdMoovPos:BigInt(0),currentChunk:null}}},38106:(e,a,t)=>{t.d(a,{A:()=>s});var i=t(77231);function s(){return{chunkOffsets:null,cttsSampleCounts:null,cttsSampleOffsets:null,stscFirstChunk:null,stscSamplesPerChunk:null,stscSampleDescriptionIndex:null,stssSampleNumbersMap:null,stssSampleNumbers:null,sampleSizes:null,sttsSampleCounts:null,sttsSampleDeltas:null,duration:BigInt(0),trackId:i.N_,layer:0,alternateGroup:0,volume:0,matrix:null,width:0,height:0,audioCid:0,samplesPerFrame:0,bytesPerFrame:0,currentSample:0,sampleEnd:!1,samplesIndex:[],samplesEncryption:[],fragIndexes:[],lastPts:i.Dh,lastDts:i.Dh,startDts:i.Dh,startCT:i.N_,startPts:i.Dh,lastDuration:0,chunkCount:0,firstWrote:!1,lastStscCount:0,perStreamGrouping:!1,index:0,flags:0}}},85428:(e,a,t)=>{t.d(a,{G:()=>r});var i=t(77231),s=t(44328);function r(e,a,t){let r,n,o,c,d,l,f,p=BigInt(0);if(e.streams.forEach((e=>{const a=e.privData;if(!a.samplesIndex||!a.samplesIndex.length)return a.sampleEnd=!0,!0;a.sampleEnd||c&&!(a.samplesIndex[a.currentSample].pos<c.pos)||(c=a.samplesIndex[a.currentSample],d=e),a.sampleEnd||l&&!((0,s.k)(a.samplesIndex[a.currentSample].dts,e.timeBase,i.KR)<p)||(l=a.samplesIndex[a.currentSample],p=(0,s.k)(l.dts,e.timeBase,i.KR),f=e)})),c&&l){const a=(0,s.k)(c.dts,d.timeBase,i.KR),o=(0,s.k)(l.dts,f.timeBase,i.KR);Math.abs(Number(a-o))<1e6||2&e.ioReader.flags||4&e.ioReader.flags||!(1&t)?(r=c,n=d):(r=l,n=f)}else c?(r=c,n=d):l&&(r=l,n=f);if(n){const e=n.privData;o=e.samplesEncryption[e.currentSample],e.currentSample++,e.currentSample>=e.samplesIndex.length&&(e.sampleEnd=!0)}if(a.fragment){const t=!!e.streams.find((e=>!1===e.privData.sampleEnd));t||(a.currentFragment=null)}return{sample:r,stream:n,encryption:o}}},74963:(e,a,t)=>{t.d(a,{E6:()=>v,t9:()=>A,wB:()=>U,wZ:()=>k});var i=t(61499),s=t(65977),r=t(21071),n=t(68361),o=t(4624),c=t(61179),d=t(98859),l=t(3384),f=t(38106),p=t(37837),m=t(14686),u=t(77231),w=t(50315),g=t(71517);const h="src\\avformat\\formats\\mov\\imov.ts";async function v(e,a,t){const i=e.getPos()+BigInt(Math.floor(t.size));for(a.majorBrand=await e.readUint32(),a.minorVersion=await e.readUint32(),a.majorBrand===(0,s.A)("qt  ")&&(a.isom=!0);e.getPos()<i;)a.compatibleBrand.push(await e.readUint32())}async function z(e,a,t,i){const c=e.getPos()+BigInt(Math.floor(t.size));for(;e.getPos()<c;){const t=await e.readUint32(),c=await e.readUint32();if(t<8)return void o.z3(`invalid box size ${t}`,h,74);if(n.A[c])await n.A[c](e,a,{type:c,size:t-8},i);else if(c===(0,s.A)("mdia")){let o=!1,c=BigInt(0);const d=e.getPos()+BigInt(Math.floor(t-8));for(;e.getPos()<d;){const t=await e.readUint32(),d=await e.readUint32();d===(0,s.A)("hdlr")?(await n.A[d](e,a,{type:d,size:t-8},i),o=!0):d===(0,s.A)("minf")&&o?await z(e,a,{type:d,size:t-8},i):d!==(0,s.A)("minf")||o?n.A[d]?await n.A[d](e,a,{type:d,size:t-8},i):r.gQ.some((e=>(0,s.A)(e)===d))?await z(e,a,{type:d,size:t-8},i):await e.skip(t-8):(c=e.getPos()-BigInt(8),await e.skip(t-8))}if(c){const t=e.getPos();await e.seek(c);const s=await e.readUint32(),r=await e.readUint32();await z(e,a,{type:r,size:s-8},i),await e.seek(t)}}else r.gQ.some((e=>(0,s.A)(e)===c))?await z(e,a,{type:c,size:t-8},i):await e.skip(t-8)}}async function U(e,a,t,r){t.parseOneBox=z,t.parsers=n.A;const c=e.getPos()+BigInt(Math.floor(r.size));for(;e.getPos()<c;){const i=await e.readUint32(),r=await e.readUint32();if(i<8)return void o.z3(`invalid box, type: ${r}, size ${i}`,h,207);if(n.A[r])await n.A[r](e,null,{type:r,size:i-8},t);else if(r===(0,s.A)("trak"))if(!t.foundMoov||t.fragment){const s=a.createStream();if(s.privData=(0,f.A)(),await z(e,s,{type:r,size:i-8},t),t.fragment){const e=s.privData,t=a.streams.find((a=>{const t=a.privData;if(a.index!==s.index&&t.trackId===e.trackId)return!0}));t?(s.sideData[1]&&(t.sideData[1]=s.sideData[1],t.codecpar.extradata&&(0,p.Eb)(t.codecpar.extradata),t.codecpar.extradataSize=t.sideData[1].length,t.codecpar.extradata=(0,p.sY)(t.codecpar.extradataSize),(0,m.lW)(t.codecpar.extradata,t.codecpar.extradataSize,t.sideData[1]),s.codecpar.width!==u.N_&&e.width>0&&(t.codecpar.width=e.width),s.codecpar.width!==u.N_&&e.height>0&&(t.codecpar.height=e.height)),a.removeStream(s),a.streamIndex--):(s.codecpar.width===u.N_&&e.width>0&&(s.codecpar.width=e.width),s.codecpar.width===u.N_&&e.height>0&&(s.codecpar.height=e.height))}else(0,d.X)(s,t)}else await e.skip(i-8);else r===(0,s.A)("mvex")?(t.fragment=!0,await z(e,null,{type:r,size:i-8},t)):await e.skip(i-8)}a.streams.forEach((e=>{if(t.encryptionInitInfos){const a=(0,w.bE)(t.encryptionInitInfos),s=(0,p.sY)(a.length);(0,m.lW)(s,a.length,a),(0,g.$W)(e.codecpar[i.o9]+20,e.codecpar[i.o9]+24,24,s,a.length)}if(t.cencs){const a=e.privData,i=t.cencs[a.trackId];i&&(e.metadata.encryption={schemeType:i.schemeType,schemeVersion:i.schemeVersion,cryptByteBlock:i.cryptByteBlock,skipByteBlock:i.skipByteBlock,perSampleIVSize:i.defaultPerSampleIVSize,kid:i.defaultKeyId,constantIV:i.defaultConstantIV,pattern:i.pattern})}}))}async function k(e,a,t,i){const r=e.getPos()+BigInt(Math.floor(i.size));for(;e.getPos()<r;){const i=await e.readUint32(),r=await e.readUint32();if(i<8)return void o.z3(`invalid box, type: ${r}, size ${i}`,h,341);if(n.A[r])await n.A[r](e,null,{type:r,size:i-8},t);else if(r===(0,s.A)("traf")){const s=(0,l.A)();t.currentFragment.currentTrack=s,await z(e,null,{type:r,size:i-8},t),t.currentFragment.tracks.push(s),t.currentFragment.currentTrack=null;const n=a.streams.find((e=>e.privData.trackId===s.trackId));if(n){const e=n.privData;s.streamIndex=n.index,(0,c.p)(n,s,t,a.ioReader.getPos(),a.ioReader.flags),e.currentSample=0,e.sampleEnd=!1}}else await e.skip(i-8)}}async function A(e,a,t,i){const r=e.getPos()+BigInt(Math.floor(i.size)),n={};for(a.streams.forEach((e=>{const a=e.privData;n[e.index]={samples:a.samplesIndex,currentSample:a.currentSample,sampleEnd:a.sampleEnd},a.samplesIndex=[]}));e.getPos()<r;){const i=e.getPos(),r=await e.readUint32();if(await e.readUint32()===(0,s.A)("tfra")){const i=await e.readUint8();await e.skip(3);const r=await e.readUint32(),n=await e.readUint32(),o=await e.readUint32(),c=a.streams.find((e=>e.privData.trackId===r));if(c){const r=c.privData;let d,l;for(let a=0;a<o;a++){1===i?(d=await e.readUint64(),l=await e.readUint64()):(d=BigInt(Math.floor(await e.readUint32())),l=BigInt(Math.floor(await e.readUint32()))),r.fragIndexes.push({pos:l,time:d});for(let a=0;a<1+(n>>4&3);a++)await e.skip(1);for(let a=0;a<1+(n>>2&3);a++)await e.skip(1);for(let a=0;a<1+(3&n);a++)await e.skip(1)}if(r.fragIndexes.length){await e.seek(r.fragIndexes[r.fragIndexes.length-1].pos);const i=await e.readUint32(),n=await e.readUint32();if(n===(0,s.A)("moof")&&(t.currentFragment={pos:BigInt(0),size:i,sequence:0,tracks:[],currentTrack:null},await k(e,a,t,{size:i,type:n}),r.samplesIndex.length)){const e=r.samplesIndex[r.samplesIndex.length-1];c.duration=e.pts+BigInt(Math.floor(e.duration)),r.samplesIndex.length=0}}}}await e.seek(i+BigInt(Math.floor(r)),!1,!1)}t.currentFragment=null,a.streams.forEach((e=>{var a,t,i,s,r,o;const c=e.privData;c.samplesIndex=null!==(a=null===(t=n[e.index])||void 0===t?void 0:t.samples)&&void 0!==a?a:[],c.currentSample=null!==(i=null===(s=n[e.index])||void 0===s?void 0:s.currentSample)&&void 0!==i?i:0,c.sampleEnd=null!==(r=null===(o=n[e.index])||void 0===o?void 0:o.sampleEnd)&&void 0!==r&&r}))}},6660:(e,a,t)=>{t.d(a,{Q9:()=>r,f3:()=>n,uf:()=>o,zs:()=>s});var i=t(65977);const s={86018:64,86017:105,86076:173,86028:193,86021:221,12:32,27:33,173:35,196:51,167:177,0:0},r={32:12,33:27,35:173,51:196,177:167,64:86018,102:86018,103:86018,104:86018,105:86017,107:86017,173:86076,193:86028,221:86021,0:0},n={vide:0,soun:1,clcp:3,sbtl:3,subt:3,subp:3,text:3},o={[(0,i.A)("mp4a")]:86018,1836253269:86017,[(0,i.A)("Opus")]:86076,[(0,i.A)("fLaC")]:86028,[(0,i.A)("spex")]:86051,[(0,i.A)("SPXN")]:86051,[(0,i.A)("ac-3")]:86019,[(0,i.A)("sac3")]:86019,[i.A.mp4v]:12,[(0,i.A)("av01")]:225,[(0,i.A)("vp08")]:139,[(0,i.A)("vp09")]:167,[(0,i.A)("avc1")]:27,[(0,i.A)("hev1")]:173,[(0,i.A)("hvc1")]:173,[(0,i.A)("vvc1")]:196,[(0,i.A)("vvi1")]:196,[(0,i.A)("text")]:94213,[(0,i.A)("tx3g")]:94213}},38582:(e,a,t)=>{t.d(a,{A:()=>c});var i=t(4624),s=t(14686),r=t(37837),n=t(21477);const o="src\\avformat\\formats\\mov\\parsing\\av1c.ts";async function c(e,a,t,c){const d=e.getPos();if(a.codecpar.codecId=225,t.size<=0)return;const l=(0,r.sY)(t.size),f=await e.readBuffer(t.size,(0,s.JW)(l,t.size));c.foundMoov?(a.sideData[1]=f.slice(),(0,r.Eb)(l)):(a.codecpar.extradata&&(0,r.Eb)(a.codecpar.extradata),a.codecpar.extradata=l,a.codecpar.extradataSize=t.size,n.XC(a,f));const p=t.size-Number(e.getPos()-d);p>0?await e.skip(p):p<0&&i.z3(`read avcc error, size: ${t.size}, read: ${t.size-p}`,o,66)}},73840:(e,a,t)=>{t.d(a,{A:()=>c});var i=t(37837),s=t(14686),r=t(4624),n=t(62815);const o="src\\avformat\\formats\\mov\\parsing\\avcc.ts";async function c(e,a,t,c){const d=e.getPos();if(a.codecpar.codecId=27,t.size<=0)return;const l=(0,i.sY)(t.size),f=await e.readBuffer(t.size,(0,s.JW)(l,t.size));c.foundMoov?(a.sideData[1]=f.slice(),(0,i.Eb)(l)):(a.codecpar.extradata&&(0,i.Eb)(a.codecpar.extradata),a.codecpar.extradata=l,a.codecpar.extradataSize=t.size,n.XC(a,f));const p=t.size-Number(e.getPos()-d);p>0?await e.skip(p):p<0&&r.z3(`read avcc error, size: ${t.size}, read: ${t.size-p}`,o,66)}},37213:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\co64.ts";async function r(e,a,t,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=[],d=await e.readUint32();if(0===o)for(let a=0;a<d;a++)c.push(await e.readUint64());a.privData.chunkOffsets=c;const l=t.size-Number(e.getPos()-n);l>0?await e.skip(l):l<0&&i.z3(`read co64 error, size: ${t.size}, read: ${t.size-l}`,s,54)}},12869:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\colr.ts";async function r(e,a,t,r){const n=e.getPos();let o=await e.readString(4);if("nclx"===o||"nclc"===o||"prof"===o)if("prof"===o){const i=await e.readBuffer(t.size-4);a.sideData[28]=i}else{let t=await e.readUint16(),i=await e.readUint16(),s=await e.readUint16();if("nclx"===o){const t=await e.readUint8()>>7;a.codecpar.colorRange=t?2:1}t>=23&&(t=2),i>=19&&(i=2),s>=15&&(s=2),a.codecpar.colorPrimaries=t,a.codecpar.colorTrc=i,a.codecpar.colorSpace=s}else i.R8(`unsupported color_parameter_type: ${o}`,s,77);const c=t.size-Number(e.getPos()-n);c>0?await e.skip(c):c<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-c}`,s,85)}},59299:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\ctts.ts";async function r(e,a,t,r){const n=e.getPos(),o=a.privData;await e.skip(4);const c=[],d=[],l=await e.readUint32();for(let a=0;a<l;a++)c.push(await e.readUint32()),d.push(await e.readInt32());o.cttsSampleCounts=c,o.cttsSampleOffsets=d;const f=t.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&i.z3(`read ctts error, size: ${t.size}, read: ${t.size-f}`,s,57)}},7320:(e,a,t)=>{t.d(a,{A:()=>f});var i=t(61499),s=t(63939),r=t(50932),n=t(4624),o=t(71517),c=t(87518),d=t(99991);const l="src\\avformat\\formats\\mov\\parsing\\dac3.ts";async function f(e,a,t,f){const p=e.getPos();if(a.codecpar.codecId=86019,t.size<=0)return;const m=(0,o.E4)(a.codecpar[i.o9]+20,a.codecpar[i.o9]+24,7,4),u=s.f[20](m),w=await e.readUint24(),g=w>>14&7,h=w>>11&7,v=w>>10&1;let z=BigInt(c.j[h]);v&&(z|=BigInt(8)),d.bl(a.codecpar[i.o9]+112),d.ML(a.codecpar[i.o9]+112,z),r.M[15](u,g);const U=t.size-Number(e.getPos()-p);U>0?await e.skip(U):U<0&&n.z3(`read avcc error, size: ${t.size}, read: ${t.size-U}`,l,75)}},36868:(e,a,t)=>{t.d(a,{A:()=>f});var i=t(61499),s=t(63939),r=t(50932),n=t(4624),o=t(71517),c=t(87518),d=t(99991);const l="src\\avformat\\formats\\mov\\parsing\\dec3.ts";async function f(e,a,t,f){const p=e.getPos();if(a.codecpar.codecId=86056,t.size<=0)return;const m=(0,o.E4)(a.codecpar[i.o9]+20,a.codecpar[i.o9]+24,7,4),u=s.f[20](m);await e.skip(2);const w=await e.readUint24(),g=w>>12&31,h=w>>9&7,v=w>>8&1;let z=BigInt(c.j[h]);v&&(z|=BigInt(8)),d.bl(a.codecpar[i.o9]+112),d.ML(a.codecpar[i.o9]+112,z),r.M[15](u,g),a.codecpar.chLayout.nbChannels>1&&7==g&&r.M[15](u,8);const U=t.size-Number(e.getPos()-p);U>0?await e.skip(U):U<0&&n.z3(`read avcc error, size: ${t.size}, read: ${t.size-U}`,l,80)}},86528:(e,a,t)=>{t.d(a,{A:()=>c});var i=t(4624),s=t(37837),r=t(14686),n=t(14769);const o="src\\avformat\\formats\\mov\\parsing\\dfla.ts";async function c(e,a,t,c){const d=e.getPos();a.codecpar.codecId=86028,await e.skip(1),await e.skip(3);const l=await e.readUint8(),f=128&l,p=127&l,m=await e.readUint24();if(0===p&&34===m){const t=(0,s.sY)(m),i=await e.readBuffer(m,(0,r.JW)(t,m));c.foundMoov?(a.sideData[1]=i.slice(),(0,s.Eb)(t)):(a.codecpar.extradata&&(0,s.Eb)(a.codecpar.extradata),a.codecpar.extradata=t,a.codecpar.extradataSize=m,n.XC(a,i))}else i.z3("streaminfo must be first FLACMetadataBlock",o,69);f||i.R8("non streaminfo FLACMetadataBlock(s) ignored",o,73);const u=t.size-Number(e.getPos()-d);u>0?await e.skip(u):u<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-u}`,o,81)}},41781:(e,a,t)=>{t.d(a,{A:()=>l});var i=t(4624),s=t(37837),r=t(14686),n=t(22576),o=t(31865),c=t(729);const d="src\\avformat\\formats\\mov\\parsing\\dops.ts";async function l(e,a,t,l){const f=e.getPos();a.codecpar.codecId=86076,await e.skip(1);const p=(0,s.sY)(t.size+8),m=(0,r.JW)(p,t.size+8),u=new o.A(m),w=new c.A(m,!1);w.writeString("OpusHead"),w.writeUint8(1),await e.readBuffer(t.size-1,(0,r.JW)(p+9,t.size-1)),u.seek(10),w.seek(10),w.writeUint16(u.readUint16()),w.writeUint32(u.readUint32()),w.writeUint16(u.readUint16()),l.foundMoov?(a.sideData[1]=m.slice(),(0,s.Eb)(p)):(a.codecpar.extradata&&(0,s.Eb)(a.codecpar.extradata),a.codecpar.extradata=p,a.codecpar.extradataSize=m.length,n.XC(a,m));const g=t.size-Number(e.getPos()-f);g>0?await e.skip(g):g<0&&i.z3(`read dops error, size: ${t.size}, read: ${t.size-g}`,d,82)}},30875:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\elst.ts";async function r(e,a,t,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=await e.readInt32(),d=[];for(let a=0;a<c;a++){let a=BigInt(0),t=BigInt(0);1===o?(a=await e.readInt64(),t=await e.readInt64()):(a=BigInt(Math.floor(await e.readInt32())),t=BigInt(Math.floor(await e.readInt32())));const i=await e.readInt16(),s=await e.readInt16();d.push({segmentDuration:a,mediaTime:t,mediaRate:i,mediaRateFraction:s})}a.metadata.elst=d;const l=t.size-Number(e.getPos()-n);l>0?await e.skip(l):l<0&&i.z3(`read elst error, size: ${t.size}, read: ${t.size-l}`,s,75)}},28412:(e,a,t)=>{t.d(a,{A:()=>f});var i=t(4624),s=t(6660),r=t(37837),n=t(14686),o=t(95832),c=t(22576);const d="src\\avformat\\formats\\mov\\parsing\\esds.ts";async function l(e){let a=0;for(let t=0;t<4;t++){const t=await e.readUint8();if(a=a<<7|127&t,!(128&t))break}return a}async function f(e,a,t,f){const p=e.getPos();await e.skip(4);let m=e.getPos()+BigInt(Math.floor(t.size-4));for(;e.getPos()<m;){let t=await e.readUint8(),p=await l(e);if(0!==p)if(3===t){let m=e.getPos()+BigInt(Math.floor(p));if(await e.skip(2),await e.skip(1),t=await e.readUint8(),p=await l(e),0===p){i.R8("esds invalid ES descriptor size 0, skip",d,81),await e.skip(Number(m-e.getPos()));continue}if(4===t)if(a.codecpar.codecId=s.Q9[await e.readUint8()],await e.skip(1),await e.skip(3),await e.skip(4),await e.skip(4),e.getPos()<m-BigInt(5))if(t=await e.readUint8(),p=await l(e),5===t){const t=(0,r.sY)(p),i=await e.readBuffer(p,(0,n.JW)(t,p));f.foundMoov?(a.sideData[1]=i.slice(),(0,r.Eb)(t)):(a.codecpar.extradata=t,a.codecpar.extradataSize=p,86018===a.codecpar.codecId?o.XC(a,i.slice()):86076===a.codecpar.codecId&&c.XC(a,i.slice()))}else await e.skip(Number(m-e.getPos()));else await e.skip(Number(m-e.getPos()));else await e.skip(Math.min(p,Number(m-e.getPos())))}else await e.skip(Math.min(p,Number(m-e.getPos())));else i.R8("esds invalid descriptor size 0, skip",d,64),await e.skip(Number(m-e.getPos()))}const u=t.size-Number(e.getPos()-p);u>0?await e.skip(u):u<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-u}`,d,149)}},9239:(e,a,t)=>{t.d(a,{A:()=>n});var i=t(4624),s=t(13663);const r="src\\avformat\\formats\\mov\\parsing\\frma.ts";async function n(e,a,t,n){const o=e.getPos(),c=await e.peekUint32();e.setEndian(!1);const d=await e.readUint32();e.setEndian(!0);let l=s.uM[d];l>0&&0!==a.codecpar.codecType?a.codecpar.codecType=1:1!==a.codecpar.codecType&&(l=s.h6[d],l>0?a.codecpar.codecType=0:(l=s.s5[d],a.codecpar.codecType=3)),a.codecpar.codecTag=c,a.codecpar.codecId=l;const f=t.size-Number(e.getPos()-o);f>0?await e.skip(f):f<0&&i.z3(`read frma error, size: ${t.size}, read: ${t.size-f}`,r,66)}},40179:(e,a,t)=>{t.d(a,{A:()=>o});var i=t(4624),s=t(34677),r=t(6660);const n="src\\avformat\\formats\\mov\\parsing\\hdlr.ts";async function o(e,a,t,o){const c=e.getPos(),d=await e.readUint8();if(await e.skip(3),0===d){await e.skip(4);const i=await e.readString(4),n=r.f3[i];(0,s.A)(n)&&(a.codecpar.codecType=n),await e.skip(4),await e.skip(4),await e.skip(4);const c=t.size-24;if(c>0){const t=!o.isom&&await e.peekUint8()===c-1;t&&await e.skip(1),a.metadata.handlerName=await e.readString(c-(t?1:0))}}const l=t.size-Number(e.getPos()-c);l>0?await e.skip(l):l<0&&i.z3(`read hdlr error, size: ${t.size}, read: ${t.size-l}`,n,76)}},31421:(e,a,t)=>{t.d(a,{A:()=>c});var i=t(37837),s=t(14686),r=t(4624),n=t(67659);const o="src\\avformat\\formats\\mov\\parsing\\hvcc.ts";async function c(e,a,t,c){const d=e.getPos();if(a.codecpar.codecId=173,t.size<=0)return;const l=(0,i.sY)(t.size),f=await e.readBuffer(t.size,(0,s.JW)(l,t.size));c.foundMoov?(a.sideData[1]=f.slice(),(0,i.Eb)(l)):(a.codecpar.extradata&&(0,i.Eb)(a.codecpar.extradata),a.codecpar.extradata=l,a.codecpar.extradataSize=t.size,n.XC(a,f));const p=t.size-Number(e.getPos()-d);p>0?await e.skip(p):p<0&&r.z3(`read hevc error, size: ${t.size}, read: ${t.size-p}`,o,66)}},45248:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\mdhd.ts";async function r(e,a,t,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);let c=BigInt(0),d=BigInt(0),l=0,f=BigInt(0);1===o?(c=await e.readUint64(),d=await e.readUint64(),l=await e.readUint32(),f=await e.readUint64()):(c=BigInt(Math.floor(await e.readUint32())),d=BigInt(Math.floor(await e.readUint32())),l=await e.readUint32(),f=BigInt(Math.floor(await e.readUint32()))),a.duration=f,a.timeBase.den=l,a.timeBase.num=1,a.metadata.creationTime=c,a.metadata.modificationTime=d;const p=await e.readUint16(),m=[];m[0]=p>>10&31,m[1]=p>>5&31,m[2]=31&p;const u=String.fromCharCode(m[0]+96,m[1]+96,m[2]+96);a.metadata.language=p,a.metadata.languageString=u,await e.skip(2);const w=t.size-Number(e.getPos()-n);w>0?await e.skip(w):w<0&&i.z3(`read mdhd error, size: ${t.size}, read: ${t.size-w}`,s,82)}},7018:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\mfhd.ts";async function r(e,a,t,r){const n=e.getPos();await e.readUint8(),await e.skip(3),r.currentFragment.sequence=await e.readUint32();const o=t.size-Number(e.getPos()-n);o>0?await e.skip(o):o<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-o}`,s,47)}},19354:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\mvhd.ts";async function r(e,a,t,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3),1===o?(r.creationTime=await e.readUint64(),r.modificationTime=await e.readUint64(),r.timescale=await e.readUint32(),r.duration=await e.readUint64()):(r.creationTime=BigInt(Math.floor(await e.readUint32())),r.modificationTime=BigInt(Math.floor(await e.readUint32())),r.timescale=await e.readUint32(),r.duration=BigInt(Math.floor(await e.readUint32()))),r.rate=await e.readUint32(),r.volume=await e.readUint16()>>>8,await e.skip(10),r.matrix=new Uint32Array(9);for(let a=0;a<9;a++)r.matrix[a]=await e.readUint32();await e.skip(24),r.nextTrackId=await e.readUint32();const c=t.size-Number(e.getPos()-n);c>0?await e.skip(c):c<0&&i.z3(`read mvhd error, size: ${t.size}, read: ${t.size-c}`,s,68)}},68361:(e,a,t)=>{t.d(a,{A:()=>R});var i=t(91635),s=t(59299),r=t(63080),n=t(62831),o=t(6570),c=t(34136),d=t(15692),l=t(37213),f=t(45248),p=t(19354),m=t(27436),u=t(40179),w=t(35173),g=t(25778),h=t(7018),v=t(61807),z=t(67523),U=t(58996),k=t(30875),A=t(74551),I=t(9239),y=t(168),x=t(89417),b=t(48265),B=t(82302),P=t(73066),S=t(65977);const R={[(0,S.A)("stts")]:i.A,[(0,S.A)("ctts")]:s.A,[(0,S.A)("stss")]:r.A,[(0,S.A)("stsz")]:n.A,[(0,S.A)("stz2")]:o.A,[(0,S.A)("stsc")]:c.A,[(0,S.A)("stco")]:d.A,[(0,S.A)("co64")]:l.A,[(0,S.A)("mdhd")]:f.A,[(0,S.A)("mvhd")]:p.A,[(0,S.A)("tkhd")]:m.A,[(0,S.A)("hdlr")]:u.A,[(0,S.A)("stsd")]:w.A,[(0,S.A)("elst")]:k.A,[(0,S.A)("trex")]:g.A,[(0,S.A)("mfhd")]:h.A,[(0,S.A)("tfhd")]:v.A,[(0,S.A)("tfdt")]:z.A,[(0,S.A)("trun")]:U.A,[(0,S.A)("pssh")]:A.A,[(0,S.A)("frma")]:I.A,[(0,S.A)("schm")]:y.A,[(0,S.A)("tenc")]:x.A,[(0,S.A)("saio")]:b.A,[(0,S.A)("saiz")]:B.A,[(0,S.A)("senc")]:P.A}},74551:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\pssh.ts";async function r(e,a,t,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=r.encryptionInitInfos||[],d={systemId:await e.readBuffer(16),keyIds:[],data:null};if(o>0){const a=await e.readUint32();for(let t=0;t<a;t++)d.keyIds.push(await e.readBuffer(16))}const l=await e.readUint32();d.data=await e.readBuffer(l),c.push(d),r.encryptionInitInfos=c;const f=t.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&i.z3(`read pssh error, size: ${t.size}, read: ${t.size-f}`,s,66)}},48265:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\saio.ts";async function r(e,a,t,r){const n=e.getPos(),o=r.currentFragment.currentTrack,c=r.cencs?r.cencs[o.trackId]:null,d=await e.readUint8();if(1&await e.readUint24()){const a=await e.readUint32(),t=await e.readUint32();if(!c)return void await f();if(a!==c.schemeType)return i.R8("Ignoring saio box with non-zero aux_info_type",s,44),void await f();if(0!==t)return i.R8("Ignoring saio box with non-zero aux_info_type_parameter",s,49),void await f()}else if(!c)return void await f();o.cenc||(o.cenc={defaultSampleInfoSize:0,sampleCount:0,offset:0,useSubsamples:!1,sampleEncryption:[],sampleSizes:[],sampleInfoOffset:[]});const l=await e.readUint32();for(let a=0;a<l;a++)o.cenc.sampleInfoOffset.push(0===d?await e.readUint32():await e.readUint64());async function f(){const a=t.size-Number(e.getPos()-n);a>0?await e.skip(a):a<0&&i.z3(`read saio error, size: ${t.size}, read: ${t.size-a}`,s,88)}await f()}},82302:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\saiz.ts";async function r(e,a,t,r){const n=e.getPos(),o=r.currentFragment.currentTrack,c=r.cencs?r.cencs[o.trackId]:null;if(await e.skip(1),1&await e.readUint24()){const a=await e.readUint32(),t=await e.readUint32();if(!c)return void await d();if(a!==c.schemeType)return i.R8("Ignoring saiz box with non-zero aux_info_type",s,47),void await d();if(0!==t)return i.R8("Ignoring saiz box with non-zero aux_info_type_parameter",s,52),void await d()}else if(!c)return void await d();if(o.cenc||(o.cenc={defaultSampleInfoSize:0,sampleCount:0,offset:0,useSubsamples:!1,sampleEncryption:[],sampleSizes:[],sampleInfoOffset:[]}),o.cenc.defaultSampleInfoSize=await e.readUint8(),o.cenc.sampleCount=await e.readUint32(),0===o.cenc.defaultSampleInfoSize){if(!o.cenc.sampleCount)return i.z3("invalid saiz data",s,83),void await d();for(let a=0;a<o.cenc.sampleCount;a++)o.cenc.sampleSizes.push(await e.readUint8())}async function d(){const a=t.size-Number(e.getPos()-n);a>0?await e.skip(a):a<0&&i.z3(`read saiz error, size: ${t.size}, read: ${t.size-a}`,s,99)}await d()}},168:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\schm.ts";async function r(e,a,t,r){const n=e.getPos();await e.skip(4);const o=a.privData;let c=r.cencs?r.cencs[o.trackId]:null;c||(c={schemeType:0,schemeVersion:0,isProtected:0,defaultPerSampleIVSize:0,defaultKeyId:null,defaultConstantIV:null,cryptByteBlock:0,skipByteBlock:0,pattern:!1}),c.schemeType=await e.readUint32(),c.schemeVersion=await e.readUint32(),r.cencs?r.cencs[o.trackId]=c:r.cencs={[o.trackId]:c};const d=t.size-Number(e.getPos()-n);d>0?await e.skip(d):d<0&&i.z3(`read schm error, size: ${t.size}, read: ${t.size-d}`,s,72)}},73066:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\senc.ts";async function r(e,a,t,r){const n=e.getPos(),o=r.currentFragment.currentTrack,c=r.cencs?r.cencs[o.trackId]:null;await e.readUint8();const d=await e.readUint24();o.cenc||(o.cenc={defaultSampleInfoSize:0,sampleCount:0,offset:0,useSubsamples:!1,sampleEncryption:[],sampleSizes:[],sampleInfoOffset:[]});const l=await e.readUint32(),f=2&d,p=c.defaultPerSampleIVSize;for(let a=0;a<l;a++){const a={iv:p?await e.readBuffer(p):c.defaultConstantIV,subsamples:[]};if(f){const t=await e.readUint16();for(let i=0;i<t;i++)a.subsamples.push({bytesOfClearData:await e.readUint16(),bytesOfProtectedData:await e.readUint32()})}o.cenc.sampleEncryption.push(a)}f&&(o.cenc.useSubsamples=!0);const m=t.size-Number(e.getPos()-n);m>0?await e.skip(m):m<0&&i.z3(`read senc error, size: ${t.size}, read: ${t.size-m}`,s,80)}},15692:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\stco.ts";async function r(e,a,t,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=[],d=await e.readUint32();if(0===o)for(let a=0;a<d;a++)c.push(BigInt(Math.floor(await e.readUint32())));a.privData.chunkOffsets=c;const l=t.size-Number(e.getPos()-n);l>0?await e.skip(l):l<0&&i.z3(`read stco error, size: ${t.size}, read: ${t.size-l}`,s,54)}},34136:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\stsc.ts";async function r(e,a,t,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=a.privData,d=[],l=[],f=[],p=await e.readUint32();if(0===o)for(let a=0;a<p;a++)d.push(await e.readUint32()),l.push(await e.readUint32()),f.push(await e.readUint32());c.stscFirstChunk=d,c.stscSamplesPerChunk=l,c.stscSampleDescriptionIndex=f;const m=t.size-Number(e.getPos()-n);m>0?await e.skip(m):m<0&&i.z3(`read stsc error, size: ${t.size}, read: ${t.size-m}`,s,63)}},35173:(e,a,t)=>{t.d(a,{A:()=>U});var i=t(4624),s=t(65977),r=t(21071),n=t(6660),o=t(73840),c=t(31421),d=t(60703),l=t(83561),f=t(38582),p=t(28412),m=t(28460),u=t(86528),w=t(41781),g=t(12869),h=t(7320),v=t(36868);const z="src\\avformat\\formats\\mov\\parsing\\stsd.ts";async function U(e,a,t,U){const k=e.getPos(),A=await e.readUint8();await e.skip(3);const I=a.privData,y=await e.readUint32();for(let t=0;t<y;t++){const t=await e.readUint32(),k=await e.readUint32(),y=e.getPos()+BigInt(Math.floor(t-8));if(n.uf[k]&&(a.codecpar.codecId=n.uf[k]),0===t){i.R8("stsd entry invalid box size 0, skip",z,72),await e.skip(Number(y-e.getPos()));break}if(t>=16?(await e.skip(6),await e.skip(2)):t<=7&&i.h2(`invalid size: ${t} in stsd`,z,85),0===a.codecpar.codecType){await e.skip(2),await e.skip(2),a.metadata.vendorId=await e.readString(4),await e.skip(4),await e.skip(4),a.codecpar.width=await e.readUint16(),a.codecpar.height=await e.readUint16(),await e.skip(4),await e.skip(4),await e.skip(4),await e.skip(2);let t=await e.readUint8();for(t>31&&(t=31),a.metadata.encoder=await e.readString(t),t<31&&await e.skip(31-t),await e.skip(2),await e.skip(2);e.getPos()<y;){const t=await e.readUint32(),n=await e.readUint32();0!==t?n===(0,s.A)("avcC")?await(0,o.A)(e,a,{type:n,size:t-8},U):n===(0,s.A)("hvcC")?await(0,c.A)(e,a,{type:n,size:t-8},U):n===(0,s.A)("vvcC")?await(0,d.A)(e,a,{type:n,size:t-8},U):n===(0,s.A)("av1C")?await(0,f.A)(e,a,{type:n,size:t-8},U):n===(0,s.A)("vpcC")?await(0,l.A)(e,a,{type:n,size:t-8},U):n===(0,s.A)("esds")?await(0,p.A)(e,a,{type:n,size:t-8},U):n===(0,s.A)("wave")?await(0,m.A)(e,a,{type:n,size:t-8},U):n===(0,s.A)("colr")?await(0,g.A)(e,a,{type:n,size:t-8},U):U.parsers&&U.parsers[n]?await U.parsers[n](e,null,{type:n,size:t-8},U):U.parseOneBox&&r.gQ.some((e=>(0,s.A)(e)===n))?await U.parseOneBox(e,a,{type:n,size:t-8},U):await e.skip(Math.min(t-8,Number(y-e.getPos()))):(i.R8("stsd video invalid box size 0, skip",z,134),await e.skip(Number(y-e.getPos())))}}else if(1===a.codecpar.codecType){const t=await e.readUint16();for(await e.skip(2),a.metadata.vendorId=await e.readString(4),a.codecpar.chLayout.nbChannels=await e.readUint16(),a.codecpar.bitsPerCodedSample=await e.readUint16(),I.audioCid=await e.readUint16(),await e.skip(2),a.codecpar.sampleRate=await e.readUint32()>>>16,(!U.isom||0===A&&t>0)&&(1===t?(I.samplesPerFrame=await e.readUint32(),await e.skip(4),I.bytesPerFrame=await e.readUint32(),await e.skip(4)):2===t&&(await e.skip(4),a.codecpar.sampleRate=Number(await e.readUint64()),a.codecpar.chLayout.nbChannels=await e.readUint32(),await e.skip(4),a.codecpar.bitsPerCodedSample=await e.readUint32(),await e.skip(4),I.bytesPerFrame=await e.readUint32(),I.samplesPerFrame=await e.readUint32()));e.getPos()<y;){const t=await e.readUint32(),n=await e.readUint32();0!==t?n===(0,s.A)("esds")?await(0,p.A)(e,a,{type:n,size:t-8},U):n===(0,s.A)("dfLa")?await(0,u.A)(e,a,{type:n,size:t-8},U):n===(0,s.A)("dOps")?await(0,w.A)(e,a,{type:n,size:t-8},U):n===(0,s.A)("wave")?await(0,m.A)(e,a,{type:n,size:t-8},U):n===(0,s.A)("dac3")?await(0,h.A)(e,a,{type:n,size:t-8},U):n===(0,s.A)("dec3")?await(0,v.A)(e,a,{type:n,size:t-8},U):U.parsers&&U.parsers[n]?await U.parsers[n](e,null,{type:n,size:t-8},U):U.parseOneBox&&r.gQ.some((e=>(0,s.A)(e)===n))?await U.parseOneBox(e,a,{type:n,size:t-8},U):await e.skip(Math.min(t-8,Number(y-e.getPos()))):(i.R8("stsd audio invalid box size 0, skip",z,307),await e.skip(Number(y-e.getPos())))}}else 3===a.codecpar.codecType?(k===(0,s.A)("stpp")?a.codecpar.codecId=94232:k===(0,s.A)("wvtt")?a.codecpar.codecId=94226:k===(0,s.A)("tx3g")||k===(0,s.A)("text")?a.codecpar.codecId=94213:k===(0,s.A)("c608")&&(a.codecpar.codecId=94218),await e.skip(Math.min(t-8,Number(y-e.getPos())))):await e.skip(Math.min(t-8,Number(y-e.getPos())))}const x=t.size-Number(e.getPos()-k);x>0?await e.skip(x):x<0&&i.z3(`read stsd error, size: ${t.size}, read: ${t.size-x}`,z,434)}},63080:(e,a,t)=>{t.d(a,{A:()=>o});var i=t(80662),s=t.n(i),r=t(4624);const n="src\\avformat\\formats\\mov\\parsing\\stss.ts";async function o(e,a,t,i){const o=e.getPos(),c=await e.readUint8();await e.skip(3);const d=new(s()),l=await e.readUint32();if(0===c)for(let a=0;a<l;a++)d.set(await e.readUint32(),!0);a.privData.stssSampleNumbersMap=d;const f=t.size-Number(e.getPos()-o);f>0?await e.skip(f):f<0&&r.z3(`read stss error, size: ${t.size}, read: ${t.size-f}`,n,55)}},62831:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\stsz.ts";async function r(e,a,t,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=[];let d=0,l=0;if(0===o){d=await e.readUint32(),l=await e.readUint32();for(let a=0;a<l;a++)0===d?c.push(await e.readUint32()):c[a]=d}a.privData.sampleSizes=c;const f=t.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&i.z3(`read stsz error, size: ${t.size}, read: ${t.size-f}`,s,63)}},91635:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\stts.ts";async function r(e,a,t,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=a.privData,d=[],l=[],f=await e.readUint32();let p=1;if(0===o)for(let a=0;a<f;a++)d.push(await e.readUint32()),p=await e.readInt32(),p<0&&(i.R8("File uses negative stts sample delta, using value 1 instead, sync may be lost!",s,51),p=1),l.push(p);c.sttsSampleCounts=d,c.sttsSampleDeltas=l;const m=t.size-Number(e.getPos()-n);m>0?await e.skip(m):m<0&&i.z3(`read stts error, size: ${t.size}, read: ${t.size-m}`,s,66)}},6570:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\stz2.ts";async function r(e,a,t,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=[];let d=0,l=0;if(0===o)if(await e.skip(3),l=await e.readUint8(),d=await e.readUint32(),4===l)for(let a=0;a<d;a+=2){const t=await e.readUint8();c[a]=t>>4&15,c[a+1]=15&t}else if(8===l)for(let a=0;a<d;a++)c[a]=await e.readUint8();else if(16===l)for(let a=0;a<d;a++)c[a]=await e.readUint16();else i.z3("Error in length field in stz2 box",s,65);a.privData.sampleSizes=c;const f=t.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&i.z3(`read stz2 error, size: ${t.size}, read: ${t.size-f}`,s,76)}},89417:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\tenc.ts";async function r(e,a,t,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=a.privData;let d=r.cencs?r.cencs[c.trackId]:null;d||(d={schemeType:0,schemeVersion:0,isProtected:0,defaultPerSampleIVSize:0,defaultKeyId:null,defaultConstantIV:null,cryptByteBlock:0,skipByteBlock:0,pattern:!1}),await e.skip(1);const l=await e.readUint8();if(o>0&&(d.pattern=!0,d.cryptByteBlock=l>>>4&15,d.skipByteBlock=15&l),d.isProtected=await e.readUint8(),d.defaultPerSampleIVSize=await e.readUint8(),d.defaultKeyId=await e.readBuffer(16),d.isProtected&&!d.defaultPerSampleIVSize){const a=await e.readUint8();d.defaultConstantIV=await e.readBuffer(a)}r.cencs?r.cencs[c.trackId]=d:r.cencs={[c.trackId]:d};const f=t.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&i.z3(`read schm error, size: ${t.size}, read: ${t.size-f}`,s,90)}},67523:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\tfdt.ts";async function r(e,a,t,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=r.currentFragment.currentTrack;c&&(c.baseMediaDecodeTime=1===o?await e.readUint64():BigInt(Math.floor(await e.readUint32())));const d=t.size-Number(e.getPos()-n);d>0?await e.skip(d):d<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-d}`,s,55)}},61807:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\tfhd.ts";async function r(e,a,t,r){const n=e.getPos(),o=(await e.readUint8(),await e.readUint24()),c=await e.readUint32(),d=r.currentFragment.currentTrack;d.trackId=c,d&&(1&o&&(d.baseDataOffset=await e.readUint64()),2&o&&await e.skip(4),8&o&&(d.defaultSampleDuration=await e.readUint32()),16&o&&(d.defaultSampleSize=await e.readUint32()),32&o&&(d.defaultSampleFlags=await e.readUint32()),131072&o&&(d.baseIsMoof=!0));const l=t.size-Number(e.getPos()-n);l>0?await e.skip(l):l<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-l}`,s,73)}},27436:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\tkhd.ts";async function r(e,a,t,r){const n=a.privData,o=e.getPos(),c=await e.readUint8();n.flags=await e.readUint24(),1&n.flags&&(a.disposition|=1),1===c?(a.metadata.creationTime=await e.readUint64(),a.metadata.modificationTime=await e.readUint64(),n.trackId=await e.readUint32(),await e.skip(4),n.duration=await e.readUint64()):(a.metadata.creationTime=BigInt(Math.floor(await e.readUint32())),a.metadata.modificationTime=BigInt(Math.floor(await e.readUint32())),n.trackId=await e.readUint32(),await e.skip(4),n.duration=BigInt(Math.floor(await e.readUint32()))),await e.skip(8),n.layer=await e.readInt16(),n.alternateGroup=await e.readInt16(),n.volume=await e.readInt16()>>8,await e.skip(2);const d=[];n.matrix=new Int32Array(9);for(let a=0;a<9;a++)n.matrix[a]=await e.readInt32(),d[a]=8===a?n.matrix[a]/1073741824:n.matrix[a]/65536;n.width=await e.readUint32()>>16,n.height=await e.readUint32()>>16,a.metadata.matrix=d;const l=t.size-Number(e.getPos()-o);l>0?await e.skip(l):l<0&&i.z3(`read tkhd error, size: ${t.size}, read: ${t.size-l}`,s,90)}},25778:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\trex.ts";async function r(e,a,t,r){const n=e.getPos();await e.readUint8(),await e.skip(3);const o=await e.readUint32();await e.skip(4);const c=await e.readUint32(),d=await e.readUint32(),l=await e.readUint32();r.trexs.push({trackId:o,duration:c,size:d,flags:l});const f=t.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&i.z3(`read trex error, size: ${t.size}, read: ${t.size-f}`,s,59)}},58996:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\formats\\mov\\parsing\\trun.ts";async function r(e,a,t,r){const n=e.getPos(),o=await e.readUint8(),c=await e.readUint24(),d=r.currentFragment.currentTrack,l=r.trexs.find((e=>e.trackId===d.trackId));if(d){const a=await e.readUint32();1&c&&(d.sampleCount?(d.remainDataOffsets.push(await e.readInt32()),d.remainDataOffsetIndex.push(d.sampleCount)):d.dataOffset=await e.readInt32());let t=-1;4&c&&(t=await e.readUint32());for(let i=0;i<a;i++)256&c?d.sampleDurations.push(await e.readUint32()):d.sampleDurations.push(d.defaultSampleDuration||(null==l?void 0:l.duration)),512&c?d.sampleSizes.push(await e.readUint32()):d.sampleSizes.push(d.defaultSampleSize||(null==l?void 0:l.size)),1024&c?d.sampleFlags.push(await e.readUint32()):d.sampleFlags.push(d.defaultSampleFlags||(null==l?void 0:l.flags)),2048&c?0===o?d.sampleCompositionTimeOffset.push(await e.readUint32()):d.sampleCompositionTimeOffset.push(await e.readInt32()):d.sampleCompositionTimeOffset.push(0),t>-1&&0===i&&(d.sampleFlags.pop(),d.sampleFlags.push(t));d.sampleCount+=a}const f=t.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-f}`,s,103)}},83561:(e,a,t)=>{t.d(a,{A:()=>c});var i=t(37837),s=t(14686),r=t(4624),n=t(82014);const o="src\\avformat\\formats\\mov\\parsing\\vpcc.ts";async function c(e,a,t,c){const d=e.getPos();if(await e.readUint8(),await e.skip(3),a.codecpar.codecId=167,t.size-4<=0)return;const l=(0,i.sY)(t.size-4),f=await e.readBuffer(t.size-4,(0,s.JW)(l,t.size-4));c.foundMoov?(a.sideData[1]=f.slice(),(0,i.Eb)(l)):(a.codecpar.extradata&&(0,i.Eb)(a.codecpar.extradata),a.codecpar.extradata=l,a.codecpar.extradataSize=t.size-4,n.XC(a,f));const p=t.size-Number(e.getPos()-d);p>0?await e.skip(p):p<0&&r.z3(`read vpcc error, size: ${t.size}, read: ${t.size-p}`,o,70)}},60703:(e,a,t)=>{t.d(a,{A:()=>c});var i=t(37837),s=t(14686),r=t(4624),n=t(59166);const o="src\\avformat\\formats\\mov\\parsing\\vvcc.ts";async function c(e,a,t,c){const d=e.getPos();if(await e.readUint8(),await e.skip(3),a.codecpar.codecId=196,t.size-4<=0)return;const l=(0,i.sY)(t.size-4),f=await e.readBuffer(t.size-4,(0,s.JW)(l,t.size-4));c.foundMoov?(a.sideData[1]=f.slice(),(0,i.Eb)(l)):(a.codecpar.extradata&&(0,i.Eb)(a.codecpar.extradata),a.codecpar.extradata=l,a.codecpar.extradataSize=t.size-4,n.XC(a,f));const p=t.size-Number(e.getPos()-d);p>0?await e.skip(p):p<0&&r.z3(`read vvcc error, size: ${t.size}, read: ${t.size-p}`,o,70)}},28460:(e,a,t)=>{t.d(a,{A:()=>o});var i=t(4624),s=t(65977),r=t(28412);const n="src\\avformat\\formats\\mov\\parsing\\wave.ts";async function o(e,a,t,o){const c=e.getPos(),d=c+BigInt(Math.floor(t.size));for(;e.getPos()<d;){const t=await e.readUint32(),c=await e.readUint32();0!==t?c===(0,s.A)("esds")?await(0,r.A)(e,a,{type:c,size:t-8},o):await e.skip(Math.min(t-8,Number(d-e.getPos()))):(i.R8("wave invalid box size 0, skip",n,45),await e.skip(Number(d-e.getPos())))}const l=t.size-Number(e.getPos()-c);l>0?await e.skip(l):l<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-l}`,n,71)}},65977:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\function\\mktag.ts";function r(e){4!==e.length&&i.R8(`tag length is not 4, tag: ${e}`,s,30);let a=0;for(let t=0;t<4;t++)a=a<<8|e.charCodeAt(t);return a}},79682:(e,a,t)=>{t.d(a,{A:()=>r});var i=t(4624);const s="src\\avformat\\function\\mktagle.ts";function r(e){4!==e.length&&i.R8(`tag length is not 4, tag: ${e}`,s,30);let a=0;for(let t=3;t>=0;t--)a=a<<8|e.charCodeAt(t);return a}},95832:(e,a,t)=>{t.d(a,{Bq:()=>p,Hm:()=>n,Ij:()=>f,XC:()=>l,_5:()=>d,f7:()=>m,uF:()=>r});var i=t(77231),s=t(37246);const r={1:"Main",2:"LC",3:"SSR",4:"LTP",5:"HE",6:"SCALABLE",29:"HEv2",23:"LD",39:"ELD"},n={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},o=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,i.N_,i.N_,i.N_],c=[i.N_,1,2,3,4,5,6,7];function d(e){let a=i.N_,t=i.N_,s=i.N_;return e.length>=2&&(a=e[0]>>3&31,t=o[(7&e[0])<<1|e[1]>>7],s=c[e[1]>>3&15]),{profile:a,sampleRate:t,channels:s}}function l(e,a){if(!a&&e.sideData[1]&&(a=e.sideData[1]),a){const{profile:t,sampleRate:i,channels:s}=d(a);e.codecpar.profile=t,e.codecpar.sampleRate=i,e.codecpar.chLayout.nbChannels=s,e.codecpar.frameSize=5===t?2048:1024,e.codecpar.format=8}}function f(e){const a=n[e.sampleRate],t=e.chLayout.nbChannels,s=e.profile===i.N_?2:e.profile,r=new Uint8Array(2);return r[0]=(31&s)<<3|(14&a)>>1,r[1]=(1&a)<<7|(15&t)<<3,r}function p(e){if(e.length<7)return-1;const a=e[0]<<4|e[1]>>4;if(4095!==a)return-1;const t=1&e[1],i=(192&e[2])>>>6,s=(60&e[2])>>>2,r=(1&e[2])<<2|(192&e[3])>>>6,n=(3&e[3])<<11|e[4]<<3|(224&e[5])>>>5,d=3&e[6];let l=1===t?7:9,f=n-l;return{syncWord:a,profile:i+1,sampleRate:o[s],channels:c[r],aacFrameLength:n,numberOfRawDataBlocksInFrame:d,headerLength:l,framePayloadLength:f}}function m(e,a){function t(){const e=a.readU(2);let t=0;for(let i=0;i<=e;i++)t<<=8,t|=a.readU(8);return t}a||(a=new s.A).appendBuffer(e);const i=a.getPointer(),r={syncWord:0,profile:0,sampleRate:0,channels:0,useSameStreamMux:!1,headerLength:0,framePayloadLength:0,muxLengthBytes:0},n=a.readU(11);if(695!==n)return-1;r.syncWord=n,r.muxLengthBytes=a.readU(13);const d=1===a.readU1();if(r.useSameStreamMux=d,!d){const e=1===a.readU1();if(e&&1===a.readU1())return-1;if(e&&t(),1!==a.readU1())return-1;if(0!==a.readU(6))return-1;if(0!==a.readU(4))return-1;if(0!==a.readU(3))return-1;let i=e?t():0;const s=a.readU(5);i-=5;const n=a.readU(4);i-=4;const d=a.readU(4);if(i-=4,a.readU(3),i-=3,i>0&&a.readU(i),0!==a.readU(3))return-1;if(a.readU(8),1===a.readU1())if(e)t();else{let e=0;for(;;){e<<=8;const t=1===a.readU1();if(e+=a.readU(8),!t)break}}1===a.readU1()&&a.readU(8),r.profile=s+1,r.sampleRate=o[n],r.channels=c[d]}let l=0;for(;;){const e=a.readU(8);if(l+=e,255!==e)break}return r.framePayloadLength=l,r.headerLength=a.getPointer()-i+(8===a.getBitLeft()?0:1),r}},87518:(e,a,t)=>{t.d(a,{R:()=>m,j:()=>s});var i=t(37246);const s=[3,4,3,7,259,263,1539,1543],r=[[64,69,96],[64,70,96],[80,87,120],[80,88,120],[96,104,144],[96,105,144],[112,121,168],[112,122,168],[128,139,192],[128,140,192],[160,174,240],[160,175,240],[192,208,288],[192,209,288],[224,243,336],[224,244,336],[256,278,384],[256,279,384],[320,348,480],[320,349,480],[384,417,576],[384,418,576],[448,487,672],[448,488,672],[512,557,768],[512,558,768],[640,696,960],[640,697,960],[768,835,1152],[768,836,1152],[896,975,1344],[896,976,1344],[1024,1114,1536],[1024,1115,1536],[1152,1253,1728],[1152,1254,1728],[1280,1393,1920],[1280,1394,1920]],n=[4,5,6,5],o=[4,6,7,6],c=[48e3,44100,32e3,0],d=[32,40,48,56,64,80,96,112,128,160,192,224,256,320,384,448,512,576,640],l=[2,1,2,3,3,4,4,5],f=[1,2,3,6],p=7;function m(e){const a=new i.A(e.length);a.appendBuffer(e);const t={syncWord:0,crc1:0,srCode:0,bitstreamId:0,bitstreamMode:0,channelMode:0,lfeOn:0,frameType:0,substreamId:0,centerMixLevel:0,surroundMixLevel:0,channelMap:0,numBlocks:0,dolbySurroundMode:0,srShift:0,sampleRate:0,bitrate:0,channels:0,frameSize:0,channelLayout:BigInt(0),ac3BitrateCode:0};if(t.syncWord=a.readU(16),2935!==t.syncWord)return-1;if(t.bitstreamId=31&a.peekU(29),t.bitstreamId>16)return-2;if(t.numBlocks=6,t.ac3BitrateCode=-1,t.centerMixLevel=5,t.surroundMixLevel=6,t.dolbySurroundMode=0,t.bitstreamId<=10){if(t.crc1=a.readU(16),t.srCode=a.readU(2),3===t.srCode)return-3;const e=a.readU(6);if(e>37)return-4;t.ac3BitrateCode=e>>1,a.readU(5),t.bitstreamMode=a.readU(3),t.channelMode=a.readU(3),2==t.channelMode?t.dolbySurroundMode=a.readU(2):(1&t.channelMode&&1!=t.channelMode&&(t.centerMixLevel=n[a.readU(2)]),4&t.channelMode&&(t.surroundMixLevel=o[a.readU(2)])),t.lfeOn=a.readU(1),t.srShift=Math.max(t.bitstreamId,8)-8,t.sampleRate=c[t.srCode]>>t.srShift,t.bitrate=1e3*d[t.ac3BitrateCode]>>t.srShift,t.channels=l[t.channelMode]+t.lfeOn,t.frameSize=2*r[e][t.srCode],t.frameType=2,t.substreamId=0}else{if(t.crc1=0,t.frameType=a.readU(2),3==t.frameType)return-5;if(t.substreamId=a.readU(3),t.frameSize=a.readU(11)+1<<1,t.frameSize<p)return-6;if(t.srCode=a.readU(2),3==t.srCode){const e=a.readU(2);if(3==e)return-7;t.sampleRate=c[e]/2,t.srShift=1}else t.numBlocks=f[a.readU(2)],t.sampleRate=c[t.srCode],t.srShift=0;t.channelMode=a.readU(3),t.lfeOn=a.readU(1),t.bitrate=8*t.frameSize*t.sampleRate/(256*t.numBlocks),t.channels=l[t.channelMode]+t.lfeOn}return t.channelLayout=BigInt(s[t.channelMode]),t.lfeOn&&(t.channelLayout|=BigInt(8)),t}},21477:(e,a,t)=>{t.d(a,{Ui:()=>m,XC:()=>p,Yj:()=>u,k9:()=>f,zk:()=>c});var i=t(63939),s=t(37246),r=t(11573),n=t(83314),o=t(97317);const c={0:"Main",1:"High",2:"Professional"},d=[{level:20,maxResolution:2359296},{level:21,maxResolution:4460544},{level:30,maxResolution:10653696},{level:31,maxResolution:17040384},{level:40,maxResolution:21233664},{level:41,maxResolution:21233664},{level:50,maxResolution:35651584},{level:51,maxResolution:35651584},{level:52,maxResolution:35651584},{level:53,maxResolution:35651584},{level:60,maxResolution:142606336},{level:61,maxResolution:142606336},{level:62,maxResolution:142606336},{level:63,maxResolution:142606336}],l=[20,21,22,23,30,31,32,33,40,41,42,43,50,51,52,53,60,61,62,63,70,71,72,73];function f(e,a,t){const i=e*a;for(const e of d)if(i<=e.maxResolution)return e.level}function p(e,a){if(!a&&e.sideData[1]&&(a=e.sideData[1]),a&&a.length>=4){const t=m(a);e.codecpar.profile=t.profile,e.codecpar.level=t.level}}function m(e){const a=new s.A(e.length);a.appendBuffer(e),a.readU1(),a.readU(7);const t=a.readU(3),i=a.readU(5),r=a.readU1();let n=a.readU1()?10:8;return a.readU1()&&(n=12),{profile:t,level:i,tier:r,bitDepth:n,monochrome:a.readU1(),chromaSubsamplingX:a.readU1(),chromaSubsamplingY:a.readU1(),chromaSamplePosition:a.readU(2)}}function u(e,a){const t=new n.A(4);t.writeU1(1),t.writeU(7,1);const c=function(e){const a=new s.A;a.appendBuffer(e);const t=[];for(;a.remainingLength();){const i=a.getPointer();a.readU1(),a.readU(4);const s=a.readU1(),n=a.readU1();a.readU1(),s&&a.readU(8);const o=n?r.v(a):e.length-1-s,c=a.getPointer()-i;t.push(e.subarray(i,i+c+o)),a.skip(8*o)}return t}(a).find((e=>1==(e[0]>>>3&15)));if(c){const e=function(e){const a=new s.A(e.length);a.appendBuffer(e),a.readU1(),a.readU(4);const t=a.readU1(),i=a.readU1();a.readU1(),t&&a.readU(8),i&&r.v(a);const n=r.f(a,3),o=(r.f(a,1),r.f(a,1));let c=0,d=0,f=[0],p=[0],m=[0],u=[0],w=[0],g=[0],h=0,v=[0],z=[0],U=[0];if(o)p[0]=r.f(a,5);else{c=r.f(a,1),c?(r.f(a,32),r.f(a,32),r.f(a,1)&&r.d(a),r.f(a,1)&&(h=r.f(a,5),r.f(a,32),r.f(a,5),r.f(a,5))):d=0;let e=r.f(a,1),t=r.f(a,5);for(let i=0;i<=t;i++){if(f[i]=r.f(a,12),p[i]=r.f(a,5),p[i]>7?m[i]=r.f(a,1):m[i]=0,d){if(u[i]=r.f(a,1),u[i]){let e=h+1;v[i]=r.f(a,e),z[i]=r.f(a,e),U[i]=r.f(a,1)}}else u[i]=0;e&&(w[i]=r.f(a,1),w[i]&&(g[i]=r.f(a,4)))}}let k=r.f(a,4),A=r.f(a,4),I=k+1,y=r.f(a,I);I=A+1;let x=r.f(a,I),b=0,B=0,P=0;b=o?0:r.f(a,1),b&&(r.f(a,4),r.f(a,3)),r.f(a,1),r.f(a,1),r.f(a,1);let S=0,R=0,M=0,D=0,C=0,N=0,$=2,E=2,T=0;o||(r.f(a,1),r.f(a,1),r.f(a,1),r.f(a,1),D=r.f(a,1),D?(C=r.f(a,1),N=r.f(a,1)):(C=0,N=0),$=r.f(a,1)?2:r.f(a,1),$>0?r.f(a,1)?2:r.f(a,1):2,D&&r.f(a,3)),r.f(a,1),r.f(a,1),r.f(a,1);let F=r.f(a,1),O=0,L=0,_=0;2==n&&F?(O=r.f(a,1),L=O?12:10):n<=2&&(L=F?10:8),_=1==n?0:r.f(a,1);let V=0,W=0,X=0;r.f(a,1)?(V=r.f(a,8),W=r.f(a,8),X=r.f(a,8)):(V=2,W=2,X=2);let Y=0,j=0,K=0,H=0,J=0;return _?(Y=r.f(a,1),j=1,K=1,H=0,J=0):1==V&&13==W&&0==X?(Y=1,j=0,K=0,J=r.f(a,1)):(Y=r.f(a,1),0==n?(j=1,K=1):1==n?(j=0,K=0):12==L?(j=r.f(a,1),K=j?r.f(a,1):0):(j=1,K=0),j&&K&&(H=r.f(a,2)),J=r.f(a,1)),r.f(a,1),{width:y+1,height:x+1,profile:n,level:l[p[0]],tier:m[0],bitDepth:L,monoChrome:_,colorRange:Y,colorPrimaries:V,transferCharacteristics:W,matrixCoefficients:X,subsamplingX:j,subsamplingY:K,chromaSamplePosition:H}}(c);t.writeU(3,e.profile),t.writeU(5,e.level),t.writeU(1,e.tier),t.writeU(1,e.bitDepth>8?1:0),t.writeU(1,12===e.bitDepth?1:0),t.writeU(1,e.monoChrome),t.writeU(1,e.subsamplingX),t.writeU(1,e.subsamplingY),t.writeU(1,e.chromaSamplePosition)}else{const a=(0,o.I)(i.f[15](e+28));t.writeU(3,i.f[15](e+48)),t.writeU(5,i.f[15](e+52)),t.writeU(1,0),t.writeU(1,a.comp[0].depth>8?1:0),t.writeU(1,12===a.comp[0].depth?1:0),t.writeU(1,0),t.writeU(1,1),t.writeU(1,1),t.writeU(1,0)}return t.writeU(8,0),t.padding(),t.getBuffer()}},14769:(e,a,t)=>{t.d(a,{DK:()=>o,XC:()=>d,Xr:()=>c,jA:()=>r,ob:()=>s,oe:()=>n});var i=t(31865);const s=34,r=8,n=[0,8,12,0,16,20,24,32],o=[0,88200,176400,192e3,8e3,16e3,22050,24e3,32e3,44100,48e3,96e3,0,0,0,0],c=[0,192,576,1152,2304,4608,0,0,256,512,1024,2048,4096,8192,16384,32768];function d(e,a){if(!a&&e.sideData[1]&&(a=e.sideData[1]),a&&a.length===s){const{bitsPerRawSample:t,sampleRate:s,channels:r}=function(e){const a=new i.A(e);a.skip(10);const t=a.readUint24();return{sampleRate:t>>4,channels:1+((15&t)>>>1),bitsPerRawSample:1+((1&t)<<4|(240&a.readUint8())>>>4)}}(a);e.codecpar.bitsPerRawSample=t,e.codecpar.sampleRate=s,e.codecpar.chLayout.nbChannels=r}}},22576:(e,a,t)=>{t.d(a,{Ij:()=>d,XC:()=>c,kt:()=>o});var i=t(31865),s=t(729),r=t(44328);const n=[480,960,1920,2880,480,960,1920,2880,480,960,1920,2880,480,960,480,960,120,240,480,960,120,240,480,960,120,240,480,960,120,240,480,960];function o(e){let a=0,t=0,i=0;if(e.length<1)return 0;switch(a=e[0],t=n[a>>3],3&a){case 0:i=1;break;case 1:case 2:i=2;break;case 3:if(e.length<2)return 0;i=63&e[1]}return i*t}function c(e,a){if(!a&&e.sideData[1]&&(a=e.sideData[1]),a&&a.length>=19){const t=new i.A(a,!1);t.skip(9),e.codecpar.chLayout.nbChannels=t.readUint8(),e.codecpar.initialPadding=t.readUint16(),e.codecpar.sampleRate=t.readUint32(),e.codecpar.seekPreroll=Number((0,r.k)(BigInt(80),{den:1e3,num:1},{den:48e3,num:1}))}}function d(e){const a=new Uint8Array(19),t=new s.A(a,!1);return t.writeString("OpusHead"),t.writeUint8(1),t.writeUint8(e.chLayout.nbChannels),t.writeUint16(e.initialPadding),t.writeUint32(e.sampleRate),a}},82014:(e,a,t)=>{t.d(a,{Ui:()=>w,XC:()=>u,Yj:()=>g,k9:()=>m,wN:()=>f});var i=t(63939),s=t(9599),r=t(29170),n=t(37246),o=t(77231),c=t(97317),d=t(44328),l=t(729);const f={0:"Profile0",1:"Profile1",2:"Profile2",3:"Profile3"},p=[{level:10,maxResolution:196608,maxFrameRate:30},{level:11,maxResolution:196608,maxFrameRate:60},{level:20,maxResolution:518400,maxFrameRate:30},{level:21,maxResolution:518400,maxFrameRate:60},{level:30,maxResolution:2073600,maxFrameRate:30},{level:31,maxResolution:2073600,maxFrameRate:60},{level:40,maxResolution:3686400,maxFrameRate:30},{level:41,maxResolution:3686400,maxFrameRate:60},{level:50,maxResolution:8294400,maxFrameRate:30},{level:51,maxResolution:8294400,maxFrameRate:60},{level:60,maxResolution:8847360,maxFrameRate:30},{level:61,maxResolution:8847360,maxFrameRate:60},{level:70,maxResolution:35389440,maxFrameRate:30},{level:71,maxResolution:35389440,maxFrameRate:60}];function m(e,a,t){const i=e*a;for(const e of p)if(i<=e.maxResolution&&t<=e.maxFrameRate)return e.level}function u(e,a){if(!a&&e.sideData[1]&&(a=e.sideData[1]),a&&a.length>=6){const t=w(a);e.codecpar.profile=t.profile,e.codecpar.level=t.level}}function w(e){const a=new n.A(e.length);return a.appendBuffer(e),{profile:a.readU(8),level:a.readU(8),bitDepth:a.readU(4),chromaSubsampling:a.readU(3),fullRangeFlag:a.readU1(),colorPrimaries:a.readU(8),colorTrc:a.readU(8),colorSpace:a.readU(8)}}function g(e){const a=new l.A(new Uint8Array(8)),t=function(e){let a=i.f[15](e+48),t=i.f[15](e+52);t===o.N_&&(t=m(i.f[15](e+56),i.f[15](e+60),(0,d.lb)((0,r.A)(e+72,s.P))));const n=(0,c.I)(i.f[15](e+28));let l=i.f[15](e+40),f=1;n&&(l=n.comp[0].depth,1===n.log2ChromaW&&1===n.log2ChromaH?1===i.f[15](e+100)&&(f=0):1===n.log2ChromaW&&0===n.log2ChromaH?f=2:0===n.log2ChromaW&&0===n.log2ChromaH&&(f=3));const p=2===i.f[15](e+84)?1:0;return a===o.N_&&l&&(a=0==f||1==f?8==l?0:2:8==l?1:3),{profile:a,level:t,bitDepth:l,chromaSubsampling:f,fullRange:p}}(e);return a.writeUint8(t.profile),a.writeUint8(t.level),a.writeUint8(t.bitDepth<<4|t.chromaSubsampling<<1|t.fullRange),a.writeUint8(i.f[15](e+88)),a.writeUint8(i.f[15](e+92)),a.writeUint8(i.f[15](e+96)),a.writeUint16(0),a.getWroteBuffer()}},11573:(e,a,t)=>{function i(e,a){let t=0;for(let i=0;i<a;i++)t=2*t+e.readU1();return t}function s(e){let a=0;for(;!i(e,1);)a++;return a>=32?0:i(e,a)+(1<<a)-1}function r(e){let a=0;for(let t=0;t<8;t++){let s=i(e,8);if(a|=(127&s)<<7*t,!(128&s))break}return a}t.d(a,{d:()=>s,f:()=>i,v:()=>r})},50315:(e,a,t)=>{t.d(a,{ZK:()=>o,bE:()=>c,p$:()=>r,zz:()=>n});var i=t(31865),s=t(729);function r(e){const a=new i.A(e,!0),t=a.readUint32(),s=a.readUint32(),r=a.readUint32(),n=a.readUint32(),o=a.readUint32(),c=a.readUint32(),d={scheme:t,cryptByteBlock:s,skipByteBlock:r,keyId:a.readBuffer(n),iv:a.readBuffer(o),subsamples:[]};if(c)for(let e=0;e<c;e++)d.subsamples.push({bytesOfClearData:a.readUint32(),bytesOfProtectedData:a.readUint32()});return d}function n(e){const a=new Uint8Array(24+e.keyId.length+e.iv.length+8*e.subsamples.length),t=new s.A(a,!0);return t.writeUint32(e.scheme),t.writeUint32(e.cryptByteBlock),t.writeUint32(e.skipByteBlock),t.writeUint32(e.keyId.length),t.writeUint32(e.iv.length),t.writeUint32(e.subsamples.length),t.writeBuffer(e.keyId),t.writeBuffer(e.iv),e.subsamples.forEach((e=>{t.writeUint32(e.bytesOfClearData),t.writeUint32(e.bytesOfProtectedData)})),a}function o(e){const a=new i.A(e,!0),t=a.readUint32(),s=[];for(let e=0;e<t;e++){const e=a.readUint32(),t=a.readUint32(),i=a.readUint32(),r=a.readUint32(),n={systemId:a.readBuffer(e),keyIds:[],data:null};if(t)for(let e=0;e<t;e++)n.keyIds.push(a.readBuffer(i));n.data=a.readBuffer(r),s.push(n)}return s}function c(e){let a=4;e.forEach((e=>{a+=16+e.systemId.length+e.keyIds.length*(e.keyIds.length?e.keyIds[0].length:0)+e.data.length}));const t=new Uint8Array(a),i=new s.A(t,!0);return i.writeUint32(e.length),e.forEach((e=>{i.writeUint32(e.systemId.length),i.writeUint32(e.keyIds.length),i.writeUint32(e.keyIds.length?e.keyIds[0].length:0),i.writeUint32(e.data.length),i.writeBuffer(e.systemId),e.keyIds.forEach((e=>{i.writeBuffer(e)})),i.writeBuffer(e.data)})),t}}}]);