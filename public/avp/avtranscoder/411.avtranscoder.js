"use strict";(self.webpackChunkAVTranscoder=self.webpackChunkAVTranscoder||[]).push([[411],{64436:(e,t,r)=>{r.d(t,{A:()=>a});var i=r(134),n=r(63939),o=(r(77162),r(37837)),s=r(71766);class a{constructor(){(0,i.A)(this,"inCodecpar",void 0),(0,i.A)(this,"inTimeBase",void 0),(0,i.A)(this,"outCodecpar",void 0)}init(e,t){return this.inCodecpar=(0,o.Gy)(168),(0,s.Yi)(this.inCodecpar,e),this.inTimeBase={den:n.f[15](t+4),num:n.f[15](t)},0}destroy(){this.inCodecpar&&((0,s.dn)(this.inCodecpar),this.inCodecpar=0)}}},26173:(e,t,r)=>{r.d(t,{A:()=>g});var i=r(134),n=r(63939),o=r(50932),s=r(64436),a=r(71517),c=r(62815),d=r(67659),h=r(59166),l=r(14686),u=r(9705),f=r(37837),p=r(4624);class g extends s.A{constructor(e=!1){super(),(0,i.A)(this,"cache",void 0),(0,i.A)(this,"cached",void 0),(0,i.A)(this,"reverseSps",void 0),this.reverseSps=e}init(e,t){return super.init(e,t),this.cache=(0,a._5)(),this.cached=!1,0}destroy(){super.destroy(),(0,a.Qe)(this.cache),this.cache=0}sendAVPacket(e){if(64&n.f[15](e+36)){let t;(0,a.zu)(this.cache,e);const r=(0,l.JW)(n.f[20](e+24),n.f[15](e+28));if(27===n.f[15](this.inCodecpar+4)?t=c.oT(r,this.reverseSps):173===n.f[15](this.inCodecpar+4)?t=d.oT(r,this.reverseSps):196===n.f[15](this.inCodecpar+4)?t=h.oT(r,this.reverseSps):p.h2(`not support for codecId: ${n.f[15](this.inCodecpar+4)}`,"src\\avformat\\bsf\\h2645\\Annexb2AvccFilter.ts",96),o.M[15](this.cache+36,-65&n.f[15](this.cache+36)),(0,a.NX)(this.cache,t.bufferPointer,t.length),t.key&&o.M[15](this.cache+36,1|n.f[15](this.cache+36)),t.extradata){const e=(0,f.sY)(t.extradata.length);(0,l.lW)(e,t.extradata.length,t.extradata),(0,a.Ow)(this.cache,1,e,t.extradata.length)}}else(0,a.rN)(this.cache,e);return this.cached=!0,0}receiveAVPacket(e){return this.cached?((0,a.Up)(e),(0,a.rN)(e,this.cache),this.cached=!1,0):u.LR}reset(){return 0}}},68675:(e,t,r)=>{r.r(t),r.d(t,{default:()=>T});var i=r(134),n=r(61499),o=r(63939),s=(r(9599),r(51597)),a=r(4624),c=r(44328),d=r(71517),h=r(95335),l=r(35336),u=r(69081),f=r(31866),p=r(90519),g=r(14686),m=r(38156),x=r(77231),U=r(20525),I=r(92647),A=r(26173),y=r(60264),S=r(62815),P=r(67659),w=r(59166),_=r(39381),b=r(9705);const v="src\\avformat\\formats\\OMatroskaFormat.ts",C={isLive:!1,docType:"matroska"};function B(e){const t=e/BigInt(36e5),r=e%BigInt(36e5),i=r/BigInt(6e4),n=r%BigInt(6e4),o=n/BigInt(1e3),s=n%BigInt(1e3);return U.GP("%02d:%02d:%02d.%03d000000\0\0",Number(BigInt.asIntN(32,t)),Number(BigInt.asIntN(32,i)),Number(BigInt.asIntN(32,o)),Number(BigInt.asIntN(32,s)))}class T extends s.A{constructor(e={}){super(),(0,i.A)(this,"type",8),(0,i.A)(this,"options",void 0),(0,i.A)(this,"context",void 0),(0,i.A)(this,"random",void 0),(0,i.A)(this,"randomView",void 0),(0,i.A)(this,"avpacket",void 0),(0,i.A)(this,"annexb2AvccFilter",void 0),this.options=h.X$({},C,e),this.random=new Uint8Array(8),this.randomView=new DataView(this.random.buffer)}init(e){e.ioWriter.setEndian(!1),this.avpacket=(0,d._5)();const t={isLive:this.options.isLive,segmentStart:-BigInt(1),seekHeadEnd:-BigInt(1),header:{version:1,readVersion:1,maxIdLength:4,maxSizeLength:8,docType:this.options.docType,docTypeVersion:4,docTypeReadVersion:2},seekHead:{entry:[]},info:{muxingApp:"v0.9.0-29-gc2ccb944",writingApp:"v0.9.0-29-gc2ccb944",timestampScale:1e6,duration:0,segmentUUID:-BigInt(1)},tracks:{entry:[]},attachments:{entry:[]},chapters:{entry:[]},cues:{entry:[]},tags:{entry:[{tag:{name:"ENCODER",string:"v0.9.0-29-gc2ccb944"}}]},elePositionInfos:[],eleCaches:[],eleWriter:new l.A,currentCluster:{timeCode:-BigInt(1),pos:-BigInt(1)},hasVideo:!1};"webm"===t.header.docType&&(t.header.docTypeVersion=2,t.header.docTypeReadVersion=2),t.eleWriter.onFlush=e=>(t.eleCaches.push(e.slice()),0),p.y(this.random),t.info.segmentUUID=this.randomView.getBigUint64(0),e.privateData=this.context=t;const r="webm"===this.context.header.docType?f.N:f.e;let i=!1;return e.streams.forEach((e=>{if(4===e.codecpar.codecType)p.y(this.random),t.attachments.entry.push({uid:this.randomView.getBigUint64(0),name:e.metadata.title||"unknown",mime:e.metadata.mime||"unknown",data:{data:(0,g.s3)(e.codecpar.extradata,e.codecpar.extradataSize),size:BigInt(0|e.codecpar.extradataSize),pos:-BigInt(1)},description:e.metadata.description||"unknown"});else{const o={};if(p.y(this.random),o.uid=this.randomView.getBigUint64(0),o.codecId=function(e){let t="";return h.__(r,((r,i)=>{r===e.codecId&&(t=i)})),65559!==e.codecId&&65557!==e.codecId||(t="A_PCM/FLOAT/IEEE"),65537!==e.codecId&&65549!==e.codecId&&65545!==e.codecId||(t="A_PCM/INT/BIG"),65541!==e.codecId&&65536!==e.codecId&&65548!==e.codecId&&65544!==e.codecId||(t="A_PCM/INT/LIT"),t}(e.codecpar),!o.codecId)return i=!0,void a.z3(`codecId ${e.codecpar.codecId} not support in ${this.options.docType}`,v,244);switch(o.number=e.index+1,e.codecpar.extradata&&(o.codecPrivate={data:(0,g.s3)(e.codecpar.extradata,e.codecpar.extradataSize).slice(),pos:-BigInt(1),size:BigInt(0|e.codecpar.extradataSize)}),e.metadata.language&&(o.language=e.metadata.language),e.metadata.title&&(o.name=e.metadata.title),e.codecpar.codecType){case 1:o.type=2,o.audio={channels:e.codecpar.chLayout.nbChannels,sampleRate:e.codecpar.sampleRate,bitDepth:e.codecpar.bitsPerRawSample};break;case 0:{t.hasVideo=!0,o.type=1,o.video={pixelWidth:e.codecpar.width,pixelHeight:e.codecpar.height,color:{matrixCoefficients:e.codecpar.colorSpace,primaries:e.codecpar.colorPrimaries,transferCharacteristics:e.codecpar.colorTrc,range:e.codecpar.colorRange}};const r=(0,m.uC)(e.codecpar.chromaLocation);r&&(o.video.color.chromaSitingVert=1+(r.x>>>7),o.video.color.chromaSitingHorz=1+(r.y>>>7)),27!==e.codecpar.codecId&&173!==e.codecpar.codecId&&196!==e.codecpar.codecId||(o.codecPrivate&&y.Bs(o.codecPrivate.data)&&(27===e.codecpar.codecId?o.codecPrivate.data=S.S1(o.codecPrivate.data):173===e.codecpar.codecId?o.codecPrivate.data=P.S1(o.codecPrivate.data):196===e.codecpar.codecId&&(o.codecPrivate.data=w.S1(o.codecPrivate.data)),o.codecPrivate.size=BigInt(Math.floor(o.codecPrivate.data.length))),this.annexb2AvccFilter=new A.A,this.annexb2AvccFilter.init(e.codecpar[n.o9],e.timeBase[n.o9]));break}case 3:o.type=17}o.lastPts=BigInt(0),e.privData=o,t.tracks.entry.push(o)}})),i?b.r8:0}async destroy(e){this.annexb2AvccFilter&&(this.annexb2AvccFilter.destroy(),this.annexb2AvccFilter=null),this.avpacket&&((0,d.Qe)(this.avpacket),this.avpacket=0)}writeHeader(e){u.bx(e.ioWriter,this.context,this.context.header),u.h1(e.ioWriter,408125543);const t=e.ioWriter.getPos();return u.SW(e.ioWriter,8),this.context.elePositionInfos.push({pos:t,length:0,bytes:8}),this.context.segmentStart=e.ioWriter.getPos(),e.ioWriter.skip(96),this.context.seekHeadEnd=e.ioWriter.getPos(),0}writeBlock(e,t,r=163){const i=e.privData;u.h1(this.context.eleWriter,r),(27===e.codecpar.codecId||173===e.codecpar.codecId||196===e.codecpar.codecId)&&64&o.f[15](t+36)&&(this.annexb2AvccFilter.sendAVPacket(t),this.annexb2AvccFilter.receiveAVPacket(this.avpacket),t=this.avpacket),u.cK(this.context.eleWriter,u.qh(i.number)+2+1+o.f[15](t+28)),u.qz(this.context.eleWriter,i.number,u.qh(i.number));const n=(0,c.Mr)(o.f[17](t+8),t+72,x.i0);if(this.context.eleWriter.writeInt16(Number(BigInt.asIntN(32,n-this.context.currentCluster.timeCode))),1&o.f[15](t+36)||0!==e.codecpar.codecType?this.context.eleWriter.writeUint8(128):this.context.eleWriter.writeUint8(0),!i.codecPrivate){let e=(0,d.rU)(t,1);e&&(i.codecPrivate={data:(0,g.s3)(o.f[20](e),o.f[25](e+4)).slice(),pos:-BigInt(1),size:BigInt(o.f[25](e+4))})}this.context.eleWriter.writeBuffer((0,d.iI)(t))}writeBlockGroup(e,t){u.mI(this.context.eleWriter,this.context,160,(r=>{o.f[17](t+48)>0&&u.Wd(r,155,(0,c.Mr)(o.f[17](t+48),t+72,x.i0));const i=[];for(let e=0;e<o.f[15](t+44);e++)15===o.f[15](o.f[20](t+40)+12*e+8)&&i.push({additionalId:_.v4(o.f[20](o.f[20](t+40)+12*e)),buffer:(0,g.s3)(o.f[20](o.f[20](t+40)+12*e)+8,o.f[25](o.f[20](t+40)+12*e+4)-8)});if(i.length&&u.mI(this.context.eleWriter,this.context,30113,(e=>{u.mI(e,this.context,166,(e=>{i.forEach((t=>{u.Wd(e,238,t.additionalId),u.on(e,30113,t.buffer)}))}))})),0===e.codecpar.codecType&&!(1&o.f[15](t+36))){const i=e.privData;u.kt(r,251,i.lastPts-o.f[17](t+8))}this.writeBlock(e,t,161)}))}writeCluster(e){if(this.context.currentCluster.pos===-BigInt(1))return;e.ioWriter.flush(),this.context.eleWriter.flush();let t=(0,I.A)(Uint8Array,this.context.eleCaches);t.length&&(this.context.eleCaches.length=0,u.Wd(this.context.eleWriter,231,this.context.currentCluster.timeCode),this.context.eleWriter.flush(),t=(0,I.A)(Uint8Array,[...this.context.eleCaches,t]),u.h1(e.ioWriter,524531317),u.cK(e.ioWriter,t.length),e.ioWriter.writeBuffer(t),e.ioWriter.flush(),this.context.eleCaches.length=0)}writeAVPacket(e,t){if(!o.f[15](t+28))return a.R8(`packet's size is 0: ${o.f[15](t+32)}, ignore it`,v,469),0;const r=e.getStreamByIndex(o.f[15](t+32));if(!r)return void a.R8(`can not found the stream width the avpacket's streamIndex: ${o.f[15](t+32)}, ignore it`,v,476);const i=r.privData,n=(0,c.Mr)(o.f[17](t+8)!==x.Dh?o.f[17](t+8):o.f[17](t+16),t+72,x.i0);return(!i.maxPts||i.maxPts<n)&&(i.maxPts=n,i.duration=n,o.f[17](t+48)!==x.Dh&&(i.duration+=(0,c.Mr)(o.f[17](t+48),t+72,x.i0))),(this.options.isLive||1&o.f[15](t+36)&&(0===r.codecpar.codecType||!this.context.hasVideo&&n-this.context.currentCluster.timeCode>BigInt(5e3)))&&(this.writeCluster(e),this.context.currentCluster.timeCode=n,this.context.currentCluster.pos=e.ioWriter.getPos()-this.context.segmentStart,this.context.cues.entry.push({time:this.context.currentCluster.timeCode,pos:[{pos:this.context.currentCluster.pos,track:i.number}]})),o.f[17](t+48)>0||(0,d.fQ)(t,15)?this.writeBlockGroup(r,t):this.writeBlock(r,t),i.lastPts=o.f[17](t+8),0}writeTrailer(e){this.writeCluster(e),e.streams.forEach((e=>{const t=e.privData;if(!this.options.isLive&&null!=t&&t.duration){const e=t.duration;this.context.info.duration=Number(BigInt.asIntN(32,e)),this.context.tags.entry.push({tag:{name:"DURATION",string:B(e)},target:{trackUid:t.uid}})}})),e.ioWriter.flush(),this.context.eleWriter.flush(),this.context.eleCaches.length=0,this.context.eleWriter.reset();const t=e.ioWriter.getPos();let r=t-this.context.segmentStart;this.context.seekHead.entry.push({id:357149030,pos:this.context.eleWriter.getPos()+this.context.seekHeadEnd-this.context.segmentStart}),u.ec(this.context.eleWriter,this.context,this.context.info),this.context.seekHead.entry.push({id:374648427,pos:this.context.eleWriter.getPos()+this.context.seekHeadEnd-this.context.segmentStart}),u.mM(this.context.eleWriter,this.context,this.context.tracks),this.context.seekHead.entry.push({id:307544935,pos:this.context.eleWriter.getPos()+this.context.seekHeadEnd-this.context.segmentStart}),u.p(this.context.eleWriter,this.context,this.context.tags),this.context.eleWriter.flush();const i=(0,I.A)(Uint8Array,this.context.eleCaches);e.ioWriter.onFlush(i,this.context.seekHeadEnd),r+=BigInt(Math.floor(i.length)),this.context.cues.entry.forEach((e=>{e.pos.forEach((e=>{e.pos+=BigInt(Math.floor(i.length))}))})),this.context.cues.entry.length&&(this.context.seekHead.entry.push({id:475249515,pos:e.ioWriter.getPos()-this.context.segmentStart+BigInt(Math.floor(i.length))}),u.Uz(e.ioWriter,this.context,this.context.cues)),this.context.attachments.entry.length&&(this.context.seekHead.entry.push({id:423732329,pos:e.ioWriter.getPos()-this.context.segmentStart+BigInt(Math.floor(i.length))}),u.s0(e.ioWriter,this.context,this.context.attachments)),e.ioWriter.flush(),r+=e.ioWriter.getPos()-t,e.ioWriter.seek(this.context.segmentStart),u.jp(e.ioWriter,this.context,this.context.seekHead);const n=e.ioWriter.getPos()-this.context.segmentStart;return u.h1(e.ioWriter,236),u.cK(e.ioWriter,this.context.seekHeadEnd-this.context.segmentStart-n-BigInt(2),1),e.ioWriter.flush(),this.context.elePositionInfos[0].length=r,u.ST(e.ioWriter,this.context),this.context.eleCaches.length=0,0}flush(e){return e.ioWriter.flush(),this.context.currentCluster.timeCode=-BigInt(1),this.context.currentCluster.pos=-BigInt(1),0}}},31866:(e,t,r)=>{r.d(t,{N:()=>n,e:()=>i});const i={A_AAC:86018,A_AC3:86019,A_ALAC:86032,A_DTS:86020,A_EAC3:86056,A_FLAC:86028,A_MLP:86045,"A_MPEG/L2":86016,"A_MPEG/L1":86058,"A_MPEG/L3":86017,A_OPUS:86076,"A_OPUS/EXPERIMENTAL":86076,"A_PCM/FLOAT/IEEE":65557,"A_PCM/INT/BIG":65537,"A_PCM/INT/LIT":65536,"A_QUICKTIME/QDMC":86066,"A_QUICKTIME/QDM2":86035,"A_REAL/14_4":77824,"A_REAL/28_8":77825,"A_REAL/ATRC":86047,"A_REAL/COOK":86036,"A_REAL/SIPR":86057,A_TRUEHD:86060,A_TTA1:86038,A_VORBIS:86021,A_WAVPACK4:86041,"D_WEBVTT/SUBTITLES":94226,"D_WEBVTT/CAPTIONS":94226,"D_WEBVTT/DESCRIPTIONS":94226,"D_WEBVTT/METADATA":94226,"S_TEXT/UTF8":94225,"S_TEXT/ASCII":94210,"S_TEXT/ASS":94230,"S_TEXT/SSA":94230,S_ASS:94230,S_SSA:94230,S_VOBSUB:94208,S_DVBSUB:94209,"S_HDMV/PGS":94214,"S_HDMV/TEXTST":94231,V_AV1:225,V_DIRAC:116,V_FFV1:33,V_MJPEG:7,V_MPEG1:1,V_MPEG2:2,"V_MPEG4/ISO/ASP":12,"V_MPEG4/ISO/AP":12,"V_MPEG4/ISO/SP":12,"V_MPEG4/ISO/AVC":27,"V_MPEGH/ISO/HEVC":173,"V_MPEGH/ISO/VVC":196,"V_MPEG4/MS/V3":16,V_PRORES:147,"V_REAL/RV10":5,"V_REAL/RV20":6,"V_REAL/RV30":68,"V_REAL/RV40":69,V_SNOW:208,V_THEORA:30,V_UNCOMPRESSED:13,V_VP8:139,V_VP9:167},n={V_VP8:139,V_VP9:167,V_AV1:225,A_VORBIS:86021,A_OPUS:86076,"D_WEBVTT/SUBTITLES":94226,"D_WEBVTT/CAPTIONS":94226,"D_WEBVTT/DESCRIPTIONS":94226,"D_WEBVTT/METADATA":94226}},69081:(e,t,r)=>{r.d(t,{ST:()=>A,SW:()=>f,Uz:()=>T,Wd:()=>g,bx:()=>S,cK:()=>u,ec:()=>w,h1:()=>l,jp:()=>P,kt:()=>m,mI:()=>y,mM:()=>b,on:()=>U,p:()=>B,qh:()=>d,qz:()=>h,s0:()=>E});var i=r(67672),n=r(50011),o=r(92647),s=r(72739),a=r(95335);function c(e){let t=0;do{t++}while(e>>=i.o(e)?BigInt(7):7);return t}function d(e){return i.o(e)?c(e+BigInt(1)):c(e+1)}function h(e,t,r){if(i.o(t)){t|=BigInt(1)<<BigInt(7*r);for(let i=r-1;i>=0;i--)e.writeUint8(Number(t>>BigInt(8*i)&BigInt(255)))}else{t|=1<<7*r;for(let i=r-1;i>=0;i--)e.writeUint8(t>>8*i&255)}}function l(e,t){let r=function(e){return Math.floor((Math.log2(e)+7)/8)}(t);for(;r--;)e.writeUint8(t>>8*r)}function u(e,t,r=0){let i=d(t);0===r&&(r=i),h(e,t,r)}function f(e,t){e.writeUint8(511>>t);for(let r=0;r<t-1;r++)e.writeUint8(255)}function p(e,t,r){l(e,t),u(e,8),e.writeUint64(r)}function g(e,t,r){let n=1,o=r;if(i.o(o))for(;o>>=BigInt(8);)n++;else for(;o>>=8;)n++;l(e,t),u(e,n);for(let t=n-1;t>=0;t--)e.writeUint8(i.o(r)?Number(r>>BigInt(8*t)):r>>8*t)}function m(e,t,r){let i=0;if(r){let e=r<0?(~r).toString(2).length:r.toString(2).length;i=Math.ceil((e+1)/8)}switch(l(e,t),u(e,i),i){case 0:return;case 1:return void e.writeInt8(Number(r));case 2:return void e.writeInt16(Number(r));case 3:return void e.writeInt24(Number(r));case 4:return void e.writeInt32(Number(r))}r=BigInt.asUintN(8*i,BigInt(r));for(let t=i-1;t>=0;t--)e.writeUint8(Number(r>>BigInt(8*t)))}function x(e,t,r){l(e,t),u(e,8),e.writeDouble(r)}function U(e,t,r){l(e,t),u(e,r.length),e.writeBuffer(r)}function I(e,t,r){U(e,t,n.encode(r))}function A(e,t){const r=e.getPos(),i=e.getPointer(),n=r-BigInt(Math.floor(i)),o=[];s.__(t.elePositionInfos,(t=>{t.pos<r&&t.pos>=n?(e.seekInline(i+Number(t.pos-r)),u(e,t.length,t.bytes)):o.push(t)})),s.__(o,(t=>{e.seek(t.pos),u(e,t.length,t.bytes)})),o.length?e.seek(r):e.seekInline(i),e.flush(),t.elePositionInfos=[]}function y(e,t,r,i){t.eleWriter.flush();const n=t.eleCaches;t.eleCaches=[],i(t.eleWriter),t.eleWriter.flush();const s=(0,o.A)(Uint8Array,t.eleCaches);t.eleCaches=n,U(e,r,s)}function S(e,t,r){y(e,t,440786851,(e=>{g(e,17030,r.version),g(e,17143,r.readVersion),g(e,17138,r.maxIdLength),g(e,17139,r.maxSizeLength),I(e,17026,r.docType),g(e,17031,r.docTypeVersion),g(e,17029,r.docTypeReadVersion)}))}function P(e,t,r){y(e,t,290298740,(e=>{r.entry.forEach((r=>{!function(e,t,r){y(e,t,19899,(e=>{g(e,21419,r.id),g(e,21420,r.pos)}))}(e,t,r)}))}))}function w(e,t,r){y(e,t,357149030,(e=>{p(e,29604,r.segmentUUID),g(e,2807729,r.timestampScale),x(e,17545,r.duration),I(e,19840,r.muxingApp),I(e,22337,r.writingApp)}))}function _(e,t,r){y(e,t,174,(e=>{g(e,215,r.number),p(e,29637,r.uid),g(e,131,r.type),r.language&&I(e,21358,r.language),r.name&&I(e,21358,r.name),I(e,134,r.codecId),r.codecPrivate&&U(e,25506,r.codecPrivate.data),r.audio?function(e,t,r){y(e,t,225,(e=>{x(e,181,r.sampleRate),r.outSampleRate&&x(e,181,r.outSampleRate),g(e,25188,r.bitDepth),g(e,159,r.channels)}))}(e,t,r.audio):r.video&&function(e,t,r){y(e,t,224,(e=>{g(e,176,r.pixelWidth),g(e,186,r.pixelHeight),r.color&&function(e,t,r){y(e,t,21936,(e=>{a.zy(r,"matrixCoefficients")&&g(e,21937,r.matrixCoefficients),a.zy(r,"primaries")&&g(e,21947,r.primaries),a.zy(r,"transferCharacteristics")&&g(e,21946,r.transferCharacteristics),a.zy(r,"range")&&g(e,21945,r.range),a.zy(r,"chromaSitingVert")&&g(e,21944,r.chromaSitingVert),a.zy(r,"chromaSitingHorz")&&g(e,21943,r.chromaSitingHorz)}))}(e,t,r.color)}))}(e,t,r.video)}))}function b(e,t,r){y(e,t,374648427,(e=>{r.entry.forEach((r=>{_(e,t,r)}))}))}function v(e,t,r){y(e,t,26568,(e=>{r.name&&I(e,17827,r.name),r.string&&I(e,17543,r.string),r.language&&I(e,17530,r.language),a.zy(r,"default")&&g(e,17540,r.default),r.sub&&v(e,t,r.sub)}))}function C(e,t,r){y(e,t,29555,(e=>{r.tag&&v(e,t,r.tag),r.target&&function(e,t,r){y(e,t,25536,(e=>{r.type&&I(e,25546,r.type),a.zy(r,"typeValue")&&g(e,26826,r.typeValue),a.zy(r,"trackUid")&&p(e,25541,r.trackUid),a.zy(r,"chapterUid")&&p(e,25540,r.chapterUid),a.zy(r,"attachUid")&&p(e,25540,r.attachUid)}))}(e,t,r.target)}))}function B(e,t,r){y(e,t,307544935,(e=>{r.entry.forEach((r=>{C(e,t,r)}))}))}function T(e,t,r){y(e,t,475249515,(e=>{r.entry.forEach((r=>{!function(e,t,r){y(e,t,187,(e=>{g(e,179,r.time),r.pos.forEach((r=>{!function(e,t,r){y(e,t,183,(e=>{g(e,247,r.track),g(e,241,r.pos)}))}(e,t,r)}))}))}(e,t,r)}))}))}function E(e,t,r){const i=t.elePositionInfos;t.elePositionInfos=[],l(e,423732329);const n={pos:e.getPos(),length:0,bytes:8};u(e,0,8);const o=e.getPos();r.entry.forEach((r=>{!function(e,t,r){l(e,24999);const i={pos:e.getPos(),length:0,bytes:8};u(e,0,8);const n=e.getPos();p(e,18094,r.uid),I(e,18030,r.name),I(e,18016,r.mime),r.description&&I(e,18046,r.description),r.data&&U(e,18012,r.data.data),i.length=e.getPos()-n,t.elePositionInfos.push(i)}(e,t,r)})),n.length=e.getPos()-o,t.elePositionInfos.push(n),A(e,t),t.elePositionInfos=i}},59166:(e,t,r)=>{r.d(t,{HL:()=>x,KD:()=>b,OD:()=>w,S1:()=>I,Ui:()=>C,XC:()=>_,kM:()=>P,oT:()=>y,sL:()=>A,wA:()=>S,wf:()=>v});var i=r(63939),n=r(72739),o=r(729),s=r(31865),a=r(37246),c=r(14686),d=r(60264),h=r(37837),l=r(23991),u=r(83314),f=r(39381),p=r(82774);const g=3;function m(e){const t=e.readU(9),r=e.readU(3),i=e.readU(2),n=e.readU(2),o=e.readU(3);e.readU(5),e.readU(2);const s=e.readU(6),a=e.readU(7),c=e.readU(1),d=e.readU(8),h=e.readU(1),l=e.readU(1),u=[],f=[];if(s){for(let t=0;t<s-1;t++)u[t]=e.readU(8);u[s-1]=e.readU(6)}else e.readU(6);if(r>1){let t=0;for(let i=r-2;i>=0;--i)t|=e.readU(1)<<i;for(let t=r;t<=8&&r>1;++t)e.readU(1);for(let i=r-2;i>=0;--i)t&1<<i&&(f[i]=e.readU(8))}const p=e.readU(8),g=[];if(p)for(let t=0;t<p;t++)g.push(e.readU(8));return{olsIdx:t,numSublayers:r,bitDepthMinus8:o,chromaFormatIdc:n,constantFrameRate:i,generalProfileIdc:a,generalTierFlag:c,generalLevelIdc:d,ptlFrameOnlyConstraintFlag:h,ptlMultilayerEnabledFlag:l,generalConstraintInfo:u,sublayerLevelIdc:f,generalSubProfileIdc:g,maxPictureWidth:e.readU(16),maxPictureHeight:e.readU(16),avgFramerate:e.readU(16)}}function x(e){const t=new s.A(e,!0);if(1&t.readUint8()){const r=new a.A;r.appendBuffer(e.subarray(1)),m(r),t.skip(r.getPointer())}let r=[],i=[],n=[];const o=t.readUint8();for(let e=0;e<o;e++){const e=31&t.readUint8();let o=1;13!==e&&12!==e&&(o=t.readUint16());const s=[];for(let e=0;e<o;e++){const e=t.readUint16();s.push(t.readBuffer(e))}14===e?r=s:15===e?i=s:16===e&&(n=s)}return{vpss:r,spss:i,ppss:n}}function U(e,t,r){const i=t[0];let s;if(i){const e=v(i);let t=e.generalConstraintInfo;t.length||(t=new Array(12).fill(0));const r=new u.A;if(r.writeU(9,0),r.writeU(3,e.spsMaxSublayersMinus1+1),r.writeU(2,1),r.writeU(2,e.chromaFormatIdc),r.writeU(3,e.bitDepthMinus8),r.writeU(5,31),r.writeU(2,0),r.writeU(6,t.length),r.writeU(7,e.profile),r.writeU1(e.tierFlag),r.writeU(8,e.level),r.writeU1(e.ptlFrameOnlyConstraintFlag),r.writeU1(e.ptlMultilayerEnabledFlag),t.length){for(let e=0;e<t.length-1;e++)r.writeU(8,t[e]);r.writeU(6,t[t.length-1])}else r.writeU(6,63);if(e.spsMaxSublayersMinus1+1>1){let t=0;for(let r=e.spsMaxSublayersMinus1-1;r>=0;r--)t=t<<1|e.ptlSublayerLevelPresentFlag[r];r.writeU(e.spsMaxSublayersMinus1,t);for(let t=e.spsMaxSublayersMinus1+1;t<=8&&e.spsMaxSublayersMinus1>0;++t)r.writeU1(0);for(let t=e.spsMaxSublayersMinus1-1;t>=0;t--)e.ptlSublayerLevelPresentFlag[t]&&r.writeU(8,e.sublayerLevelIdc[t])}r.writeU(8,e.generalSubProfileIdc.length);for(let t=0;t<e.generalSubProfileIdc.length;t++)r.writeU(8,e.sublayerLevelIdc[t]);r.writeU(16,e.width),r.writeU(16,e.height),r.writeU(16,0),r.padding(),s=r.getBuffer().subarray(0,r.getPointer())}let a=2+(s?s.length:0);e.length&&(a+=3,a=e.reduce(((e,t)=>e+2+t.length),a)),t.length&&(a+=3,a=t.reduce(((e,t)=>e+2+t.length),a)),r.length&&(a+=3,a=r.reduce(((e,t)=>e+2+t.length),a));const c=new Uint8Array(a),d=new o.A(c,!0);d.writeUint8(g<<1|(s?1:0)|248),s&&d.writeBuffer(s);let h=0;return e.length&&h++,t.length&&h++,r.length&&h++,d.writeUint8(h),e.length&&(d.writeUint8(142),d.writeUint16(e.length),n.__(e,(e=>{d.writeUint16(e.length),d.writeBuffer(e)}))),t.length&&(d.writeUint8(143),d.writeUint16(t.length),n.__(t,(e=>{d.writeUint16(e.length),d.writeBuffer(e)}))),r.length&&(d.writeUint8(144),d.writeUint16(r.length),n.__(r,(e=>{d.writeUint16(e.length),d.writeBuffer(e)}))),c}function I(e){let t=d.py(e);if(t.length>=2){const e=[],r=[],i=[];if(t.forEach((t=>{const n=t[1]>>>3&31;14===n?e.push(t):15===n?r.push(t):16===n&&i.push(t)})),r.length&&i.length)return U(e,r,i)}}function A(e){let t=d.py(e);if(t.length>=2){const e=[],r=[],i=[];if(t.forEach((t=>{const n=t[1]>>>3&31;14===n?e.push(t):15===n?r.push(t):16===n&&i.push(t)})),r.length&&i.length){const t=[r[0],i[0]];return e.length&&t.unshift(e[0]),d.nW(t,0)}}}function y(e,t=!1){let r,i=!1,n=d.py(e);if(n.length){const e=[],o=[],s=[];n.forEach((t=>{const r=t[1]>>>3&31;14===r?e.push(t):15===r?o.push(t):16===r&&s.push(t),8!==r&&7!==r&&9!==r&&10!==r||(i=!0)})),o.length&&s.length?(r=U(e,o,s),n=n.filter((e=>{const r=e[1]>>>3&31;return(t||14!==r&&15!==r&&16!==r)&&20!==r}))):n=n.filter((e=>20!=(e[1]>>>3&31)))}const o=n.reduce(((e,t)=>e+g+1+t.length),0),s=(0,h.sY)(o),a=(0,c.s3)(s,o);return d.S9(n,g,a),{bufferPointer:s,length:o,extradata:r,key:i}}function S(e,t,r,i,n){const o=[d.Le(e,0),d.Le(t,0),d.Le(r,0),d.Le(i,2)];let s=o.reduce(((e,t)=>e+t),0);const a=(0,h.sY)(s+7);let l=a;return p.w8((l+=1,l-1),0),p.w8((l+=1,l-1),0),p.w8((l+=1,l-1),0),p.w8((l+=1,l-1),1),p.w8((l+=1,l-1),0),p.w8((l+=1,l-1),161),p.w8((l+=1,l-1),(n?1:0)<<7|40),e.length&&(d.nW(e,0,(0,c.s3)(l,o[0])),l+=o[0]),t.length&&(d.nW(t,0,(0,c.s3)(l,o[1])),l+=o[1]),r.length&&(d.nW(r,0,(0,c.s3)(l,o[2])),l+=o[2]),i.length&&d.nW(i,2,(0,c.s3)(l,o[3])),{bufferPointer:a,length:s+7}}function P(e,t){let r=d.py(e).concat(d.py(t));if(r.length){let e=[],t=[],i=[],n=[];return r.forEach((r=>{const o=r[1]>>>3&31;14===o?e.push(r):15===o?t.push(r):16===o?i.push(r):20!==o&&n.push(r)})),S(e,t,i,n,!0)}}function w(e,t){const r=t?t[0]>>>1&3:g;let i=[],n=[],o=[],s=!1;if(t){const e=x(t);i=e.vpss,n=e.spss,o=e.ppss,s=!0}return{...S(i,n,o,d.wN(e,r).filter((e=>20!=(e[1]>>>3&31))),s),key:s}}function _(e,t){let r;if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&d.Bs(t))n.__(d.py(t),(e=>{if(15==(e[1]>>>3&31))return r=e,!1}));else if(t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=t[0]>>>1&3;const{spss:i}=x(t);i.length&&(r=i[0])}r&&function(e,t){const{profile:r,level:i,width:n,height:o,videoDelay:s,chromaFormatIdc:a,bitDepthMinus8:c}=v(t);switch(e.codecpar.profile=r,e.codecpar.level=i,e.codecpar.width=n,e.codecpar.height=o,e.codecpar.videoDelay=s,c){case 0:e.codecpar.format=3===a?5:2===a?4:0;break;case 2:e.codecpar.format=3===a?68:2===a?64:62}}(e,r)}function b(e,t=4){if(64&i.f[15](e+36))return d.py((0,c.s3)(i.f[20](e+24),i.f[15](e+28))).some((e=>{const t=e[1]>>>3&31;return 8===t||7===t}));{const r=i.f[15](e+28);let n=0;for(;n<r-t;){const r=f.r8(i.f[20](e+24)+(n+t+1))>>>3&31;if(8===r||7===r)return!0;n+=4===t?f.Sg(i.f[20](e+24)+n):3===t?f.ht(i.f[20](e+24)+n):2===t?f.yd(i.f[20](e+24)+n):f.r8(i.f[20](e+24)+n),n+=t}return!1}}function v(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);let r=0,i=0,n=0,o=0,s=0,c=1,h=0,u=0,f=0;const p=[],g=[],m=[],x=[],U=d.BN(e.subarray(t)),I=new a.A(U.length);I.appendBuffer(U),I.readU1(),I.readU1(),I.readU(6),I.readU(5),I.readU(3),I.readU(8);const A=I.readU(3);c=I.readU(2);const y=I.readU(2);if(I.readU(1)){if(r=I.readU(7),h=I.readU(1),i=I.readU(8),u=I.readU(1),f=I.readU(1),I.readU(1)){for(let e=0;e<8;e++)p[e]=I.readU(8);p[8]=I.readU(7);const e=I.readU(8);I.readU(e)}I.skipPadding();for(let e=A-1;e>=0;e--)g[e]=I.readU(1);I.skipPadding();for(let e=A-1;e>=0;e--)g[e]&&(m[e]=I.readU(8));const e=I.readU(8);if(e)for(let t=0;t<e;t++)x[t]=I.readU(32)}I.readU1(),I.readU1()&&I.readU1();const S=n=l.xb(I),P=o=l.xb(I);if(I.readU1()&&(l.xb(I),l.xb(I),l.xb(I),l.xb(I)),I.readU1()){const e=l.xb(I),t=y+5,r=1<<t,i=S/(1<<t),n=P/(1<<t),o=Math.ceil(Math.log2(i)),s=Math.ceil(Math.log2(n));let a=0,c=0,d=0;e>0&&(d=I.readU1(),c=I.readU1());for(let t=0;e>0&&t<=e;t++)c&&0!=t||(t>0&&S>r&&I.readU(o),t>0&&P>r&&I.readU(s),t<e&&S>r&&I.readU(o),t<e&&P>r&&I.readU(s)),d||I.readU(2);if(a=l.xb(I)+1,I.readU(1)&&I.readU(1))for(let t=0;t<=e;t++)I.readU(a)}s=l.xb(I),I.readU(1),I.readU(1);const w=I.readU(4),_=I.readU(1);let b=0;_&&(b=l.xb(I));const v=[],C=I.readU(2);for(let e=0;e<8*C;e++)v[e]=I.readU(1);return{profile:r,level:i,width:n,height:o,videoDelay:A+1>2?2:A,chromaFormatIdc:c,bitDepthMinus8:s,generalProfileSpace:0,tierFlag:h,generalConstraintInfo:p,generalSubProfileIdc:x,ptlFrameOnlyConstraintFlag:u,ptlMultilayerEnabledFlag:f,spsMaxSublayersMinus1:A,ptlSublayerLevelPresentFlag:g,sublayerLevelIdc:m,sps_log2_max_pic_order_cnt_lsb_minus4:w,sps_poc_msb_cycle_flag:_,sps_poc_msb_cycle_len_minus1:b,sps_num_extra_ph_bytes:C,sps_extra_ph_bit_present_flag:v}}function C(e){d.Bs(e)&&(e=I(e));const t=new a.A;return t.appendBuffer(e),1&t.readU(8)?m(t):{}}},90519:(e,t,r)=>{function i(e){crypto.getRandomValues(e)}r.d(t,{y:()=>i})},38156:(e,t,r)=>{r.d(t,{O5:()=>u,S5:()=>f,Xo:()=>p,uC:()=>h});var i=r(63939),n=r(50932),o=r(97317),s=r(9705),a=r(77231),c=r(14686),d=r(52699);function h(e){if(!(e<=0||e>=7))return{x:128*(1&e),y:128*(e>>>1^(e<4?1:0))}}function l(e,t,r,i,n){if(!n)return s.UY;if(e<0)return s.UY;const o=1===i||2===i?n.log2ChromaW:0,c=e+(1<<o)-1>>>o;if(c&&r>a.go/c)return s.UY;let d=r*c;return 4&n.flags&&(d=d+7>>>3),d}function u(e,t,r){const i=(0,o.I)(t);if(!i)return s.UY;const{maxPixSteps:a,maxPixStepsComps:d}=function(e){const t=[0,0,0,0],r=[0,0,0,0];for(let i=0;i<4;i++)e.comp[i]&&e.comp[i].step>t[e.comp[i].plane]&&(t[e.comp[i].plane]=e.comp[i].step,r[e.comp[i].plane]=i);return{maxPixSteps:t,maxPixStepsComps:r}}(i);(0,c.sO)(e,0,16);let h=0;for(let t=0;t<4;t++){if((h=l(r,0,a[t],d[t],i))<0)return h;n.M[15](e+4*t,h)}}function f(e,t,r,d){const h=[0,0,0,0],l=(0,o.I)(t);if(!l)return s.UY;if((0,c.sO)(e,0,16),i.f[15](d)>a.go/r)return s.UY;if(n.M[25](e,i.f[15](d)*r),2&l.flags)return n.M[25](e+4,1024),0;for(let e=0;e<4;e++)l.comp[e]&&(h[l.comp[e].plane]=1);for(let t=0;t<4&&h[t];t++){let o=1===t||2===t?l.log2ChromaH:0,c=r+(1<<o)-1>>o;if(i.f[15](d+4*t)>a.go/c)return s.UY;n.M[25](e+4*t,c*i.f[15](d+4*t))}return 0}function p(e,t,r,o,h){const l=d.z(16),u=d.z(16);(0,c.sO)(e,0,16);for(let e=0;e<4;e++)n.M[15](l+4*e,i.f[15](h+4*e));let p=f(u,t,r,l);if(p<0)return g(),p;p=0;for(let e=0;e<4;e++){if(i.f[25](u+4*e)>a.go-p)return g(),s.UY;p+=i.f[25](u+4*e)}if(!o)return g(),p;n.M[20](e,o);for(let t=1;t<4&&i.f[25](u+4*t);t++)n.M[20](e+4*t,i.f[20](e+4*(t-1))+i.f[25](u+4*(t-1)));return g(),p;function g(){d.t(16),d.t(16)}}r(37837)},95073:(e,t,r)=>{function i(e,t){return e+(t-1)&~(t-1)}r.d(t,{A:()=>i})}}]);