"use strict";(self.webpackChunkAVTranscoder=self.webpackChunkAVTranscoder||[]).push([[171],{58121:(t,e,i)=>{i.d(e,{A:()=>n});var a=i(134);class n{constructor(){(0,a.A)(this,"signature",void 0),(0,a.A)(this,"version",void 0),(0,a.A)(this,"flags",void 0),(0,a.A)(this,"dataOffset",void 0),(0,a.A)(this,"hasVideo",void 0),(0,a.A)(this,"hasAudio",void 0),this.signature="FLV",this.version=1,this.flags=0,this.dataOffset=9,this.hasAudio=!1,this.hasVideo=!1}async read(t){this.signature=await t.readString(3),this.version=await t.readUint8(),this.flags=await t.readUint8(),this.dataOffset=await t.readUint32(),this.hasAudio=!!(4&this.flags),this.hasVideo=!!(1&this.flags)}write(t){this.flags=0,this.hasAudio&&(this.flags|=4),this.hasVideo&&(this.flags|=1),t.writeString(this.signature),t.writeUint8(this.version),t.writeUint8(this.flags),t.writeUint32(this.dataOffset)}}},68243:(t,e,i)=>{i.d(e,{A:()=>w});var a=i(134),n=i(35336),r=i(92647),s=i(4624),o=i(94889),c=i(9705),d=i(73040);class w{constructor(){(0,a.A)(this,"onMetaData",void 0),this.onMetaData={canSeekToEnd:!1}}async read(t,e){const i=t.getPos(),a=i+BigInt(Math.floor(e)),n=await(0,d.$x)(t,a),r=await(0,d.$x)(t,a);this[n]=r,a>t.getPos()&&await t.skip(Number(BigInt.asIntN(32,a-t.getPos())));const o=Number(t.getPos()-i),w=await t.readUint32();return o+11!==w?(s.R8(`script size not match, size: ${o+11}, previousTagSize: ${w}`,"src\\avformat\\formats\\flv\\FlvScriptTag.ts",63),c.LR):0}computeSize(){const t=[],e=new n.A;return e.onFlush=e=>(t.push(e.slice()),0),(0,d.bD)(e,"onMetaData"),(0,d.bD)(e,this.onMetaData),e.flush(),(0,r.A)(Uint8Array,t).length}write(t){if(this.onMetaData){const e=[],i=new n.A;i.onFlush=t=>(e.push(t.slice()),0),(0,d.bD)(i,"onMetaData"),(0,d.bD)(i,this.onMetaData),i.flush();const a=(0,r.A)(Uint8Array,e);o.M5(t,18,BigInt(0),void 0,a)}}dts2Position(t){if(this.canSeek()){let e=-1;const i=this.onMetaData.keyframes.times,a=this.onMetaData.keyframes.filepositions;let n;for(n=0;n<i.length;n++){if(i[n]===t){e=n;break}if(i[n]>t){e=Math.max(n-1,0);break}}return n&&n===i.length&&(e=i.length-1),{pos:a[e],dts:i[e]}}return{pos:-1,dts:-1}}position2DTS(t){if(this.canSeek()){let i=-1;const a=this.onMetaData.keyframes.times,n=this.onMetaData.keyframes.filepositions;let r=0;for(r=0;r<n.length;r++)if(n[r]>t){i=r;break}var e;return r===n.length?null!==(e=this.onMetaData.duration)&&void 0!==e?e:a[a.length-1]:a[i]}return-1}canSeek(){return!!(this.onMetaData.keyframes&&this.onMetaData.keyframes.filepositions&&this.onMetaData.keyframes.filepositions.length)}}},35028:(t,e,i)=>{i.d(e,{FJ:()=>n,FV:()=>a,Tf:()=>s,U5:()=>r});const a={65541:0,65536:3,86018:10,86017:2,86051:11,69645:1,86049:6,65543:7,65542:8,27:7,173:12,12:9,4:2,86:3,92:4,106:5,131:6},n={10:86018,2:86017,11:86051,1:69645,4:86049,5:86049,6:86049,7:65543,8:65542},r={7:27,12:173,9:12,2:4,3:86,4:92,5:106,6:131},s={27:"avc1",173:"hvc1",196:"vvc1",139:"vp08",167:"vp09",225:"av01",86019:"ac-3",86056:"ec-3",86076:"Opus",86028:"fLaC",86017:".mp3",86018:"mp4a"}},94889:(t,e,i)=>{i.d(e,{C$:()=>w,M5:()=>d,Q4:()=>h,zk:()=>l});var a=i(35028),n=i(44328),r=i(77231),s=i(65977),o=i(67672);function c(t,e,i){const a=t.getPos(),n=t.getPointer(),r=a-BigInt(Math.floor(n));e<a&&e>=r?(t.seekInline(n+Number(e-a)),t.writeUint24(i),t.seekInline(n)):(t.seek(e),t.writeUint24(i),t.seek(a))}function d(t,e,i,a,n,r){t.flush(),t.writeUint8(e);const s=t.getPos();t.writeUint24(0),t.writeUint24(Number(i&BigInt(16777215))),t.writeUint8(Number(i>>BigInt(24)&BigInt(255))),t.writeUint24(0);const d=t.getPos();a&&a(t),o.Pc(n)?(n(t),c(t,s,Number(t.getPos()-d))):n&&(c(t,s,n.length+Number(t.getPos()-d)),t.writeBuffer(n));const w=Number(t.getPos()-s)+1;r&&r(w),t.writeUint32(w)}function w(t){return 86018!==t&&27!==t&&86017!==t&&12!==t&&!!a.Tf[t]}function h(t,e,i,o,c,d,w,h,l=0){const f=e.privData;let u=o?128:0;if(u|=(1&d?1:2)<<4,o){if(i.enableNanoTimestamp&&h){const e=(0,n.Mr)(w,h,r.FQ)-(0,n.Mr)(w,h,r.i0)*BigInt(1e6);e&&(u|=7,t.writeUint8(u),t.writeUint8(2),t.writeUint24(Number(BigInt.asIntN(32,e))),u=0)}i.multiVideoTracks&&(u|=6,t.writeUint8(u),u=0),u|=c,t.writeUint8(u),t.writeUint32((0,s.A)(a.Tf[e.codecpar.codecId])),i.multiVideoTracks&&t.writeUint8(f.trackId),1===c&&t.writeInt24(l)}else u|=15&a.FV[e.codecpar.codecId],t.writeUint8(u),27!==e.codecpar.codecId&&173!==e.codecpar.codecId&&196!==e.codecpar.codecId&&12!==e.codecpar.codecId||(t.writeUint8(c),t.writeInt24(l))}function l(t,e,i,o,c,d,w){const h=e.privData;let l=(o?9:15&a.FV[e.codecpar.codecId])<<4;if(o){if(i.enableNanoTimestamp){const e=(0,n.Mr)(d,w,r.FQ)-(0,n.Mr)(d,w,r.i0)*BigInt(1e6);e&&(l|=7,t.writeUint8(l),t.writeUint8(2),t.writeUint24(Number(BigInt.asIntN(32,e))),l=0)}i.multiVideoTracks&&(l|=5,t.writeUint8(l),l=0),l|=c,t.writeUint8(l),t.writeUint32((0,s.A)(a.Tf[e.codecpar.codecId])),i.multiVideoTracks&&t.writeUint8(h.trackId)}else(86018===e.codecpar.codecId||e.codecpar.chLayout.nbChannels>1)&&(l|=1),65541!==e.codecpar.codecId&&(l|=2),86018===e.codecpar.codecId||e.codecpar.sampleRate>=44e3?l|=12:e.codecpar.sampleRate>=22e3?l|=8:e.codecpar.sampleRate>=11e3&&(l|=4),t.writeUint8(l),86018===e.codecpar.codecId&&t.writeUint8(c)}},65977:(t,e,i)=>{i.d(e,{A:()=>r});var a=i(4624);const n="src\\avformat\\function\\mktag.ts";function r(t){4!==t.length&&a.R8(`tag length is not 4, tag: ${t}`,n,30);let e=0;for(let i=0;i<4;i++)e=e<<8|t.charCodeAt(i);return e}},73040:(t,e,i)=>{i.d(e,{$x:()=>o,bD:()=>c});var a=i(67672),n=i(72739),r=i(95335);async function s(t,e){return{key:await t.readString(await t.readUint16()),value:await o(t,e)}}async function o(t,e){let i;switch(await t.readUint8()){case 0:i=await t.readDouble();break;case 1:i=!!await t.readUint8();break;case 2:i=await t.readString(await t.readUint16());break;case 3:for(i={};t.getPos()<e;){const{key:a,value:n}=await s(t,e);if(i[a]=n,9==(16777215&await t.peekUint24())){await t.skip(3);break}}break;case 8:for(i={},await t.skip(4);t.getPos()<e;){const{key:a,value:n}=await s(t,e);if(i[a]=n,9==(16777215&await t.peekUint24())){await t.skip(3);break}}break;case 9:case 5:i=null;break;case 10:i=[];const a=await t.readUint32();for(let n=0;n<a;n++)i.push(await o(t,e));break;case 11:const n=await t.readDouble(),r=await t.readInt16();i=new Date(n+60*r*1e3);break;case 12:i=await t.readString(await t.readUint32())}return i}function c(t,e){a.ai(e)?(t.writeUint8(0),t.writeDouble(e)):a.o(e)?(t.writeUint8(0),t.writeDouble(Number(e))):a.zM(e)?(t.writeUint8(1),t.writeUint8(e?1:0)):a.Yj(e)?e.length>=65536?(t.writeUint8(12),t.writeUint32(e.length),t.writeString(e)):(t.writeUint8(2),t.writeUint16(e.length),t.writeString(e)):a.YO(e)?(t.writeUint8(10),t.writeUint32(e.length),n.__(e,(e=>{c(t,e)}))):a.Ik(e)?(t.writeUint8(3),r.__(e,((e,i)=>{t.writeUint16(i.length),t.writeString(i),c(t,e)})),t.writeUint24(9)):e instanceof Date?(t.writeUint8(11),t.writeDouble(e.getTime()),t.writeInt16(0)):null==e&&t.writeUint8(5)}}}]);